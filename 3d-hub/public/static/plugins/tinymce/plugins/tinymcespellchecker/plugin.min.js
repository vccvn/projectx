/* Ephox Spell Checker Pro
 *
 * Copyright 2010-2016 Ephox Corporation.  All rights reserved.
 *
 * Version: 2.0.2-166
 */

!function(_){"use strict";var t=function(n){return parseInt(n,10)},u=function(n,e){var t=n-e;return 0===t?0:0<t?1:-1},r=function(n,e,t){return{major:n,minor:e,patch:t}},h=function(n){var e=/([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(n);return e?r(t(e[1]),t(e[2]),t(e[3])):r(0,0,0)},v=function(n,e){var t=u(n.major,e.major);if(0!==t)return t;var r=u(n.minor,e.minor);if(0!==r)return r;var o=u(n.patch,e.patch);return 0!==o?o:0},y=function(n){return h([(e=n).majorVersion,e.minorVersion].join(".").split(".").slice(0,3).join("."));var e},S=function(n,e){return!!n&&-1===v(y(n),h(e))},n=function(e){return function(n){return function(n){if(null===n)return"null";var e=typeof n;return"object"===e&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===e&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":e}(n)===e}},i=n("string"),c=n("object"),a=n("array"),o=n("boolean"),f=n("function"),s=n("number"),w=function(){},d=function(t,r){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t(r.apply(null,n))}},b=function(n){return function(){return n}},k=function(n){return n};function l(r){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=o.concat(n);return r.apply(null,t)}}var e,g,p,m,x=function(n){return n()},T=b(!1),O=b(!0),E=function(){return C},C=(e=function(n){return n.isNone()},m={fold:function(n,e){return n()},is:T,isSome:T,isNone:O,getOr:p=function(n){return n},getOrThunk:g=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:b(null),getOrUndefined:b(void 0),or:p,orThunk:g,map:E,each:w,bind:E,exists:T,forall:O,filter:E,equals:e,equals_:e,toArray:function(){return[]},toString:b("none()")},Object.freeze&&Object.freeze(m),m),I=function(t){var n=b(t),e=function(){return o},r=function(n){return n(t)},o={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:O,isNone:T,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return I(n(t))},each:function(n){n(t)},bind:r,exists:r,forall:r,filter:function(n){return n(t)?o:C},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(T,function(n){return e(t,n)})}};return o},N={some:I,none:E,from:function(n){return null==n?C:I(n)}},A=Array.prototype.slice,D=Array.prototype.indexOf,R=Array.prototype.push,L=function(n,e){return D.call(n,e)},M=function(n,e){return-1<L(n,e)},j=function(n,e){for(var t=0,r=n.length;t<r;t++){if(e(n[t],t))return!0}return!1},P=function(n,e){for(var t=n.length,r=new Array(t),o=0;o<t;o++){var u=n[o];r[o]=e(u,o)}return r},B=function(n,e){for(var t=0,r=n.length;t<r;t++){e(n[t],t)}},F=function(n,e){for(var t=[],r=0,o=n.length;r<o;r++){var u=n[r];e(u,r)&&t.push(u)}return t},z=function(n,e,t){return B(n,function(n){t=e(t,n)}),t},W=function(n,e){for(var t=0,r=n.length;t<r;t++){var o=n[t];if(e(o,t))return N.some(o)}return N.none()},q=function(n,e){for(var t=0,r=n.length;t<r;t++){if(e(n[t],t))return N.some(t)}return N.none()},U=function(n){for(var e=[],t=0,r=n.length;t<r;++t){if(!a(n[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+n);R.apply(e,n[t])}return e},V=function(n,e){return U(P(n,e))},H=function(n,e){for(var t=0,r=n.length;t<r;++t){if(!0!==e(n[t],t))return!1}return!0},J=function(n){var e=A.call(n,0);return e.reverse(),e},K=function(n){return[n]},Y=(f(Array.from)&&Array.from,Object.keys),X=Object.hasOwnProperty,$=function(n,e){for(var t=Y(n),r=0,o=t.length;r<o;r++){var u=t[r];e(n[u],u)}},G=function(n,t){return Q(n,function(n,e){return{k:e,v:t(n,e)}})},Q=function(n,r){var o={};return $(n,function(n,e){var t=r(n,e);o[t.k]=t.v}),o},Z=function(n,t){var r=[];return $(n,function(n,e){r.push(t(n,e))}),r},nn=function(n){return Z(n,function(n){return n})},en=function(n,e){return tn(n,e)?N.from(n[e]):N.none()},tn=function(n,e){return X.call(n,e)},rn=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:b(n)}},on={fromHtml:function(n,e){var t=(e||_.document).createElement("div");if(t.innerHTML=n,!t.hasChildNodes()||1<t.childNodes.length)throw _.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return rn(t.childNodes[0])},fromTag:function(n,e){var t=(e||_.document).createElement(n);return rn(t)},fromText:function(n,e){var t=(e||_.document).createTextNode(n);return rn(t)},fromDom:rn,fromPoint:function(n,e,t){var r=n.dom();return N.from(r.elementFromPoint(e,t)).map(rn)}},un=(_.Node.ATTRIBUTE_NODE,_.Node.CDATA_SECTION_NODE,_.Node.COMMENT_NODE),cn=_.Node.DOCUMENT_NODE,an=(_.Node.DOCUMENT_TYPE_NODE,_.Node.DOCUMENT_FRAGMENT_NODE,_.Node.ELEMENT_NODE),fn=_.Node.TEXT_NODE,sn=(_.Node.PROCESSING_INSTRUCTION_NODE,_.Node.ENTITY_REFERENCE_NODE,_.Node.ENTITY_NODE,_.Node.NOTATION_NODE,void 0!==_.window?_.window:Function("return this;")()),ln=function(n,e){return function(n,e){for(var t=null!=e?e:sn,r=0;r<n.length&&null!=t;++r)t=t[n[r]];return t}(n.split("."),e)},dn=function(n,e){var t=ln(n,e);if(null==t)throw new Error(n+" not available on this browser");return t},gn=function(n){var e,t=ln("ownerDocument.defaultView",n);return(e=t,dn("HTMLElement",e)).prototype.isPrototypeOf(n)},pn=function(n){return n.dom().nodeName.toLowerCase()},mn=function(n){return n.dom().nodeType},hn=function(e){return function(n){return mn(n)===e}},vn=function(n){return mn(n)===un||"#comment"===pn(n)},yn=hn(an),wn=hn(fn),bn=function(n,e,t){if(!(i(t)||o(t)||s(t)))throw _.console.error("Invalid call to Attr.set. Key ",e,":: Value ",t,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,t+"")},kn=function(n,e,t){bn(n.dom(),e,t)},xn=function(n,e){var t=n.dom().getAttribute(e);return null===t?void 0:t},Tn=function(n,e){n.dom().removeAttribute(e)};var On=function(n,e,t){return 0!=(n.compareDocumentPosition(e)&t)},En=function(n,e){return On(n,e,_.Node.DOCUMENT_POSITION_CONTAINED_BY)},_n=function(){return(_n=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}).apply(this,arguments)},Sn=function(n){var e=n,t=function(){return e};return{get:t,set:function(n){e=n},clone:function(){return Sn(t())}}},Cn=function(){return In(0,0)},In=function(n,e){return{major:n,minor:e}},Nn={nu:In,detect:function(n,e){var t=String(e).toLowerCase();return 0===n.length?Cn():function(n,e){var t=function(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(r.test(e))return r}}(n,e);if(!t)return{major:0,minor:0};var r=function(n){return Number(e.replace(t,"$"+n))};return In(r(1),r(2))}(n,t)},unknown:Cn},An="Firefox",Dn=function(n,e){return function(){return e===n}},Rn=function(n){var e=n.current;return{current:e,version:n.version,isEdge:Dn("Edge",e),isChrome:Dn("Chrome",e),isIE:Dn("IE",e),isOpera:Dn("Opera",e),isFirefox:Dn(An,e),isSafari:Dn("Safari",e)}},Ln={unknown:function(){return Rn({current:void 0,version:Nn.unknown()})},nu:Rn,edge:b("Edge"),chrome:b("Chrome"),ie:b("IE"),opera:b("Opera"),firefox:b(An),safari:b("Safari")},Mn="Windows",jn="Android",Pn="Solaris",Bn="FreeBSD",Fn="ChromeOS",zn=function(n,e){return function(){return e===n}},Wn=function(n){var e=n.current;return{current:e,version:n.version,isWindows:zn(Mn,e),isiOS:zn("iOS",e),isAndroid:zn(jn,e),isOSX:zn("OSX",e),isLinux:zn("Linux",e),isSolaris:zn(Pn,e),isFreeBSD:zn(Bn,e),isChromeOS:zn(Fn,e)}},qn={unknown:function(){return Wn({current:void 0,version:Nn.unknown()})},nu:Wn,windows:b(Mn),ios:b("iOS"),android:b(jn),linux:b("Linux"),osx:b("OSX"),solaris:b(Pn),freebsd:b(Bn),chromeos:b(Fn)},Un=function(n,e){var t=String(e).toLowerCase();return W(n,function(n){return n.search(t)})},Vn=function(n,t){return Un(n,t).map(function(n){var e=Nn.detect(n.versionRegexes,t);return{current:n.name,version:e}})},Hn=function(n,t){return Un(n,t).map(function(n){var e=Nn.detect(n.versionRegexes,t);return{current:n.name,version:e}})},Jn=function(n,e,t){return""===e||!(n.length<e.length)&&n.substr(t,t+e.length)===e},Kn=function(n,e){return-1!==n.indexOf(e)},Yn=function(n,e){return Jn(n,e,n.length-e.length)},Xn=function(n){return n.replace(/^\s+|\s+$/g,"")},$n=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Gn=function(e){return function(n){return Kn(n,e)}},Qn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return Kn(n,"edge/")&&Kn(n,"chrome")&&Kn(n,"safari")&&Kn(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,$n],search:function(n){return Kn(n,"chrome")&&!Kn(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return Kn(n,"msie")||Kn(n,"trident")}},{name:"Opera",versionRegexes:[$n,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Gn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Gn("firefox")},{name:"Safari",versionRegexes:[$n,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(Kn(n,"safari")||Kn(n,"mobile/"))&&Kn(n,"applewebkit")}}],Zn=[{name:"Windows",search:Gn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return Kn(n,"iphone")||Kn(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Gn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Gn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Gn("linux"),versionRegexes:[]},{name:"Solaris",search:Gn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Gn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Gn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],ne={browsers:b(Qn),oses:b(Zn)},ee=Sn(function(n,e){var t,r,o,u,i,c,a,f,s,l,d,g,p=ne.browsers(),m=ne.oses(),h=Vn(p,n).fold(Ln.unknown,Ln.nu),v=Hn(m,n).fold(qn.unknown,qn.nu);return{browser:h,os:v,deviceType:(r=h,o=n,u=e,i=(t=v).isiOS()&&!0===/ipad/i.test(o),c=t.isiOS()&&!i,a=t.isiOS()||t.isAndroid(),f=a||u("(pointer:coarse)"),s=i||!c&&a&&u("(min-device-width:768px)"),l=c||a&&!s,d=r.isSafari()&&t.isiOS()&&!1===/safari/i.test(o),g=!l&&!s&&!d,{isiPad:b(i),isiPhone:b(c),isTablet:b(s),isPhone:b(l),isTouch:b(f),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:b(d),isDesktop:b(g)})}}(_.navigator.userAgent,function(n){return _.window.matchMedia(n).matches})),te=function(){return ee.get()},re=an,oe=cn,ue=function(n,e){var t=n.dom();if(t.nodeType!==re)return!1;var r=t;if(void 0!==r.matches)return r.matches(e);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(e);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(e);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},ie=function(n,e){var t,r=void 0===e?_.document:e.dom();return(t=r).nodeType!==re&&t.nodeType!==oe||0===t.childElementCount?[]:P(r.querySelectorAll(n),on.fromDom)},ce=function(n,e){return n.dom()===e.dom()},ae=(te().browser.isIE(),ue),fe=function(n){var e=wn(n)?n.dom().parentNode:n.dom();return null!=e&&e.ownerDocument.body.contains(e)},se=function(n,e,t){for(var r=n.dom(),o=f(t)?t:b(!1);r.parentNode;){r=r.parentNode;var u=on.fromDom(r);if(e(u))return N.some(u);if(o(u))break}return N.none()},le=function(n,e,t){return se(n,function(n){return ue(n,e)},t)},de=function(n,e,t){return r=le,i=t,ue(o=n,u=e)?N.some(o):f(i)&&i(o)?N.none():r(o,u,i);var r,o,u,i},ge={ar:"Arabic",ca:"Catalan",zh:"Chinese",zh_cn:"Chinese (Simplified)",zh_tw:"Chinese (Traditional)",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch",en:"English",en_au:"English (Australia)",en_ca:"English (Canada)",en_gb:"English (United Kingdom)",en_us:"English (United States)",fa:"Farsi",fi:"Finnish",fr:"French",fr_ca:"French (Canada)",de:"German",el:"Greek",he:"Hebrew",hu:"Hungarian",it:"Italian",ja:"Japanese",kk:"Kazakh",ko:"Korean",nb:"Norwegian",no:"Norwegian",pl:"Polish",pt:"Portuguese",pt_br:"Portuguese (Brazil)",pt_pt:"Portuguese (Portugal)",ro:"Romanian",ru:"Russian",sk:"Slovak",sl:"Slovenian",es:"Spanish",es_419:"Spanish (Latin America)",es_es:"Spanish (Spain)",sv:"Swedish",tt:"Tatar",th:"Thai",tr:"Turkish",uk:"Ukrainian"},pe=["en_us","en_gb","da","nl","fi","fr","de","it","nb","pt","pt_pt","es","sv"],me=[{value:"no.language",text:"Off"}],he=function(n){return n.getParam("spellchecker_dialog",!1,"boolean")},ve={useDialog:he,getLanguage:function(n){return n.getParam("spellchecker_language","en_us","string")},setLanguage:function(n,e){n.settings.spellchecker_language=e},getLanguages:function(n){var e,t=!he(n),r=n.getParam("spellchecker_languages",pe),o=[];return i(r)?(e=r.split(","),o=P(e,function(n){var e=n.split("=");return{value:e[1],text:e[0]}})):a(r)&&(o=P(r,function(n){return{value:n,text:tn(ge,n)?ge[n]:n.toUpperCase()}})),t?me.concat(o):o},getWhitelist:function(n){return n.getParam("spellchecker_whitelist",[],"array")},getApiKey:function(n){return n.getParam("api_key")||n.getParam("spellchecker_api_key")},getHandler:function(n){return n.getParam("spellchecker_handler")},getRpcUrl:function(n){return n.getParam("spellchecker_rpc_url","","string")},isActive:function(n){return n.getParam("spellchecker_active",!0,"boolean")},getSelectContentLanguages:function(n){return n.getParam("spellchecker_select_languages","en,es,fr,de,pt,zh")}},ye=function(n){return void 0!==n.style&&f(n.style.getPropertyValue)},we=function(n,e,t){!function(n,e,t){if(!i(t))throw _.console.error("Invalid call to CSS.set. Property ",e,":: Value ",t,":: Element ",n),new Error("CSS value must be a string: "+t);ye(n)&&n.style.setProperty(e,t)}(n.dom(),e,t)},be=function(n,e){var t=n.dom(),r=_.window.getComputedStyle(t).getPropertyValue(e),o=""!==r||fe(n)?r:ke(t,e);return null===o?void 0:o},ke=function(n,e){return ye(n)?n.style.getPropertyValue(e):""},xe=function(n,e){var t=n.dom(),r=ke(t,e);return N.from(r).filter(function(n){return 0<n.length})},Te=function(n,e){var t,r,o,u,i=n.dom();r=e,ye(t=i)&&t.style.removeProperty(r),o="style",(u=n.dom())&&u.hasAttribute&&u.hasAttribute(o)&&""===Xn(xn(n,"style"))&&Tn(n,"style")},Oe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(e.length!==t.length)throw new Error('Wrong number of arguments to struct. Expected "['+e.length+']", got '+t.length+" arguments");var r={};return B(e,function(n,e){r[n]=b(t[e])}),r}},Ee=function(n){return n.slice(0).sort()},_e=function(n,e){throw new Error("All required keys ("+Ee(n).join(", ")+") were not specified. Specified keys were: "+Ee(e).join(", ")+".")},Se=function(n){throw new Error("Unsupported keys for object: "+Ee(n).join(", "))},Ce=function(e,n){if(!a(n))throw new Error("The "+e+" fields must be an array. Was: "+n+".");B(n,function(n){if(!i(n))throw new Error("The value "+n+" in the "+e+" fields was not a string.")})},Ie=function(n){var t=Ee(n);W(t,function(n,e){return e<t.length-1&&n===t[e+1]}).each(function(n){throw new Error("The field: "+n+" occurs more than once in the combined fields: ["+t.join(", ")+"].")})},Ne=function(n){return on.fromDom(n.dom().ownerDocument)},Ae=function(n){return N.from(n.dom().parentNode).map(on.fromDom)},De=function(n,e){for(var t=f(e)?e:T,r=n.dom(),o=[];null!==r.parentNode&&void 0!==r.parentNode;){var u=r.parentNode,i=on.fromDom(u);if(o.push(i),!0===t(i))break;r=u}return o},Re=function(n){return N.from(n.dom().previousSibling).map(on.fromDom)},Le=function(n){return N.from(n.dom().nextSibling).map(on.fromDom)},Me=function(n){return P(n.dom().childNodes,on.fromDom)},je=function(n,e){var t=n.dom().childNodes;return N.from(t[e]).map(on.fromDom)},Pe=function(n){return n.dom().childNodes.length},Be=Oe("element","offset"),Fe=function(e,t){Ae(e).each(function(n){n.dom().insertBefore(t.dom(),e.dom())})},ze=function(n,e){Le(n).fold(function(){Ae(n).each(function(n){qe(n,e)})},function(n){Fe(n,e)})},We=function(e,t){je(e,0).fold(function(){qe(e,t)},function(n){e.dom().insertBefore(t.dom(),n.dom())})},qe=function(n,e){n.dom().appendChild(e.dom())},Ue=function(n,e){Fe(n,e),qe(e,n)},Ve=function(e,n){B(n,function(n){Fe(e,n)})},He=function(r,o){B(o,function(n,e){var t=0===e?r:o[e-1];ze(t,n)})},Je=function(e,n){B(n,function(n){qe(e,n)})},Ke=function(n,e){var t=[];return B(Me(n),function(n){e(n)&&(t=t.concat([n])),t=t.concat(Ke(n,e))}),t},Ye=function(n){var e=n.dom();null!==e.parentNode&&e.parentNode.removeChild(e)},Xe=function(n){var e=Me(n);0<e.length&&Ve(n,e),Ye(n)},$e=function(n,e){return ie(e,n)};var Ge,Qe,Ze,nt=(Ge=wn,Qe="text",{get:function(n){if(!Ge(n))throw new Error("Can only get "+Qe+" value of a "+Qe+" node");return Ze(n).getOr("")},getOption:Ze=function(n){return Ge(n)?N.from(n.dom().nodeValue):N.none()},set:function(n,e){if(!Ge(n))throw new Error("Can only set raw "+Qe+" value of a "+Qe+" node");n.dom().nodeValue=e}}),et=function(n){return nt.get(n)},tt=function(n,e){nt.set(n,e)},rt=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function ot(){return{up:b({selector:le,closest:de,predicate:se,all:De}),down:b({selector:$e,predicate:Ke}),styles:b({get:be,getRaw:xe,set:we,remove:Te}),attrs:b({get:xn,set:kn,remove:Tn,copyTo:function(n,e){var t,r,o=z(n.dom().attributes,function(n,e){return n[e.name]=e.value,n},{});t=o,r=e.dom(),$(t,function(n,e){bn(r,e,n)})}}),insert:b({before:Fe,after:ze,afterAll:He,append:qe,appendAll:Je,prepend:We,wrap:Ue}),remove:b({unwrap:Xe,remove:Ye}),create:b({nu:on.fromTag,clone:function(n){return on.fromDom(n.dom().cloneNode(!1))},text:on.fromText}),query:b({comparePosition:function(n,e){return n.dom().compareDocumentPosition(e.dom())},prevSibling:Re,nextSibling:Le}),property:b({children:Me,name:pn,parent:Ae,document:function(n){return n.dom().ownerDocument},isText:wn,isComment:vn,isElement:yn,getText:et,setText:tt,isBoundary:function(n){return!!yn(n)&&("body"===pn(n)||M(rt,pn(n)))},isEmptyTag:function(n){return!!yn(n)&&M(["br","img","hr","input"],pn(n))},isNonEditable:function(n){return yn(n)&&"false"===xn(n,"contenteditable")}}),eq:ce,is:ae}}var ut=Oe("element","offset"),it=(Oe("element","deltaOffset"),Oe("element","start","finish")),ct=(Oe("begin","end"),Oe("element","text"),function(n,e){if(n.property().isText(e))return ut(e,n.property().getText(e).length);var t=n.property().children(e);return 0<t.length?ct(n,t[t.length-1]):ut(e,t.length)}),at=function(n,e,t){var r=n.property().children(e);return 0<r.length&&t<r.length?at(n,r[t],0):0<r.length&&n.property().isElement(e)&&r.length===t?ct(n,r[r.length-1]):ut(e,t)},ft=at,st=ot(),lt=function(n,e){return ft(st,n,e)},dt=function(n){var r=Oe.apply(null,n),o=[];return{bind:function(n){if(void 0===n)throw new Error("Event bind error: undefined handler");o.push(n)},unbind:function(e){o=F(o,function(n){return n!==e})},trigger:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=r.apply(null,n);B(o,function(n){n(t)})}}},gt={create:function(n){return{registry:G(n,function(n){return{bind:n.bind,unbind:n.unbind}}),trigger:G(n,function(n){return n.trigger})}}},pt=function(){return n=function(n){n.unbind()},e=Sn(N.none()),t=function(){e.get().each(n)},{clear:function(){t(),e.set(N.none())},isSet:function(){return e.get().isSome()},set:function(n){t(),e.set(N.some(n))}};var n,e,t},mt=function(t,r){var o=null;return{cancel:function(){null!==o&&(_.clearTimeout(o),o=null)},throttle:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];null!==o&&_.clearTimeout(o),o=_.setTimeout(function(){t.apply(null,n),o=null},r)}}},ht=function(i){if(!a(i))throw new Error("cases must be an array");if(0===i.length)throw new Error("there must be at least one case");var c=[],t={};return B(i,function(n,r){var e=Y(n);if(1!==e.length)throw new Error("one and only one name per case");var o=e[0],u=n[o];if(void 0!==t[o])throw new Error("duplicate key detected:"+o);if("cata"===o)throw new Error("cannot have a case named cata (sorry)");if(!a(u))throw new Error("case arguments must be an array");c.push(o),t[o]=function(){var n=arguments.length;if(n!==u.length)throw new Error("Wrong number of arguments to case "+o+". Expected "+u.length+" ("+u+"), got "+n);for(var t=new Array(n),e=0;e<t.length;e++)t[e]=arguments[e];return{fold:function(){if(arguments.length!==i.length)throw new Error("Wrong number of arguments to fold. Expected "+i.length+", got "+arguments.length);return arguments[r].apply(null,t)},match:function(n){var e=Y(n);if(c.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+c.join(",")+"\nActual: "+e.join(","));if(!H(c,function(n){return M(e,n)}))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+c.join(", "));return n[o].apply(null,t)},log:function(n){_.console.log(n,{constructors:c,constructor:o,params:t})}}}}),t},vt=ht([{aboveView:["item"]},{inView:["item"]},{belowView:["item"]}]),yt=_n(_n({},vt),{cata:function(n,e,t,r){return n.fold(e,t,r)}}),wt=function(n){var e,t,r,o,u,i,c,a=on.fromDom(n.target),f=function(){n.stopPropagation()},s=function(){n.preventDefault()},l=d(s,f);return e=a,t=n.clientX,r=n.clientY,o=f,u=s,i=l,c=n,{target:b(e),x:b(t),y:b(r),stop:o,prevent:u,kill:i,raw:b(c)}},bt=function(n,e,t,r,o){var u,i,c=(u=t,i=r,function(n){u(n)&&i(wt(n))});return n.dom().addEventListener(e,c,o),{unbind:l(kt,n,e,c,o)}},kt=function(n,e,t,r){n.dom().removeEventListener(e,t,r)},xt=b(!0),Tt=function(n,e,t){return bt(n,e,xt,t,!1)},Ot=function(n,e){return n+e.top},Et=function(n){return n.dom().getBoundingClientRect()};function _t(i,n){var t=pt(),e=gt.create({onChange:dt([])}),r=mt(function(){e.trigger.onChange()},1e3),o=function(){return!i.inline&&Kn(i.settings.plugins,"autoresize")},u=function(){return!i.inline&&!o()},c=function(){return u()?i.getWin():_.window};n&&(i.on("init",function(){var n=u()?i.getDoc():_.document,e=on.fromDom(n);t.set(Tt(e,"scroll",function(){r.throttle()})),r.throttle()}),i.on("remove",t.clear));var a=function(){if(o()){var t=(i.inline?i.getBody():i.getContentAreaContainer()).getBoundingClientRect();return function(n){var e=Et(n);return _n(_n({},e),{top:Ot(e.top,t),bottom:Ot(e.bottom,t)})}}return Et};return{sections:function(){return function(){var n=i.getBody();if(!n)return[];var e=c(),t=a(),r=e.innerHeight,o=on.fromDom(n),u=Me(o);return q(u,function(n){if(!yn(n))return!1;var e=t(n);return e.top<r&&0<e.bottom}).map(function(e){var n=q(u.slice(e+1),function(n){if(!yn(n))return!1;var e=t(n);return!(e.top<r&&0<e.bottom)}).map(function(n){return e+1+n}).getOr(u.length);return u.slice(e,n)}).getOr([o])}()},viewport:function(){var n=c(),o=n?n.innerHeight:0,u=a();return{assess:function(n){if(!yn(n))return yt.inView(n);var e,t,r=u(n);return t=o,((e=r).bottom<0?yt.aboveView:e.top>t?yt.belowView:yt.inView)(n)}}},events:e.registry}}var St={fireSpellcheckStart:function(n){return n.fire("SpellcheckStart")},fireSpellcheckEnd:function(n){return n.fire("SpellcheckEnd")},fireIgnore:function(n,e){return n.fire("SpellcheckerIgnore",{word:e})},fireIgnoreAll:function(n,e){return n.fire("SpellcheckerIgnoreAll",{word:e})},fireError:function(n,e){return n.fire("SpellcheckError",e)}},Ct=function(n,e,t,r){var o,u,i,c,a,f=(u=e,i=t,c=r,(a=Ne(o=n).dom().createRange()).setStart(o.dom(),u),a.setEnd(i.dom(),c),a),s=ce(n,t)&&e===r;return f.collapsed&&!s},It=ht([{single:["element"]},{range:["start","soffset","finish","foffset"]}]),Nt={cata:function(n,e,t){return n.fold(e,t)},single:It.single,range:function(n,e,t,r){var o=Ct(t,r,n,e),u=o?ut(n,e):ut(t,r),i=o?ut(t,r):ut(n,e);return It.range(u.element(),u.offset(),i.element(),i.offset())}},At=function(n,e){var t=xn(n,e);return void 0===t||""===t?[]:t.split(" ")},Dt=function(n){return void 0!==n.dom().classList},Rt=function(n,e){return o=e,u=At(t=n,r="class").concat([o]),kn(t,r,u.join(" ")),!0;var t,r,o,u},Lt=function(n,e){return o=e,0<(u=F(At(t=n,r="class"),function(n){return n!==o})).length?kn(t,r,u.join(" ")):Tn(t,r),!1;var t,r,o,u},Mt=function(n,e){Dt(n)?n.dom().classList.add(e):Rt(n,e)},jt=function(n){0===(Dt(n)?n.dom().classList:At(n,"class")).length&&Tn(n,"class")},Pt=function(n,e){Dt(n)?n.dom().classList.remove(e):Lt(n,e);jt(n)},Bt="\ufeff",Ft=ht([{before:["element"]},{after:["element"]},{rest:["element"]},{last:["element"]},{invalid:["element","offset"]}]),zt=(Ft.before,Ft.after,Ft.rest,Ft.last,Ft.invalid,function(n,e){return q(n,function(n){return n.start()===e})}),Wt=function(n,e,t){var r,o,u=t(n,e);return r=u,o=n.start(),P(r,function(n){return _n(_n({},n),{start:b(n.start()+o),finish:b(n.finish()+o)})})},qt=function(n,t,e){return void 0===e&&(e=0),z(n,function(e,n){return t(n,e.len).fold(b(e),function(n){return{len:n.finish(),list:e.list.concat([n])}})},{len:e,list:[]}).list},Ut=function(n,e,t){return 0===e.length?n:V(n,function(r){var n=V(e,function(n){return(t=n)>=(e=r).start()&&t<=e.finish()?[n-r.start()]:[];var e,t});return 0<n.length?Wt(r,n,t):[r]})},Vt=function(o,n,u){var e=zt(o,n),i=zt(o,u);return e.bind(function(n){var e,t,r=i.getOr((t=u,(e=o)[e.length-1]&&e[e.length-1].finish()===t?e.length+1:-1));return-1<r?N.some(o.slice(n,r)):N.none()}).getOr([])},Ht=function(r,n){if(0===n.length)return[r];var e=z(n,function(n,e){if(0===e)return n;var t=r.substring(n.prev,e);return{prev:e,values:n.values.concat([t])}},{prev:0,values:[]}),t=n[n.length-1];return t<r.length?e.values.concat(r.substring(t)):e.values},Jt=ht([{none:[]},{start:["element"]},{middle:["before","after"]},{end:["element"]}]),Kt=(Jt.none,Jt.start,Jt.middle,Jt.end,ht([{include:["item"]},{excludeWith:["item"]},{excludeWithout:["item"]}])),Yt={include:Kt.include,excludeWith:Kt.excludeWith,excludeWithout:Kt.excludeWithout,cata:function(n,e,t,r){return n.fold(e,t,r)}},Xt=function(n,t){var r=[],o=[];return B(n,function(n){var e=t(n);Yt.cata(e,function(){o.push(n)},function(){0<o.length&&r.push(o),r.push([n]),o=[]},function(){0<o.length&&r.push(o),o=[]})}),0<o.length&&r.push(o),r},$t=ht([{boundary:["item","universe"]},{empty:["item","universe"]},{text:["item","universe"]},{nonEditable:["item","universe"]}]),Gt=T,Qt=O,Zt=b(0),nr=b(1),er=function(n){return _n(_n({},n),{isBoundary:function(){return n.fold(Qt,Gt,Gt,Gt)},toText:function(){return n.fold(N.none,N.none,function(n){return N.some(n)},N.none)},is:function(t){return n.fold(Gt,Gt,function(n,e){return e.eq(n,t)},Gt)},len:function(){return n.fold(Zt,nr,function(n,e){return e.property().getText(n).length},nr)}})},tr={text:d(er,$t.text),boundary:d(er,$t.boundary),empty:d(er,$t.empty),nonEditable:d(er,$t.empty),cata:function(n,e,t,r,o){return n.fold(e,t,r,o)}},rr=b([]),or=function(e,n,t){if(e.property().isText(n))return[tr.text(n,e)];if(e.property().isEmptyTag(n))return[tr.empty(n,e)];if(e.property().isNonEditable(n))return[];if(e.property().isElement(n)){var r=e.property().children(n),o=e.property().isBoundary(n)?[tr.boundary(n,e)]:[],u=void 0!==t&&t(n)?[]:V(r,function(n){return or(e,n,t)});return o.concat(u).concat(o)}return[]},ur=or,ir=function(e,n,t){var r=V(n,function(n){return ur(e,n,t)}),o=Xt(r,function(n){return n.match({boundary:function(){return Yt.excludeWithout(n)},empty:function(){return Yt.excludeWith(n)},text:function(){return Yt.include(n)},nonEditable:function(){return Yt.excludeWithout(n)}})});return F(o,function(n){return 0<n.length})},cr=(Oe("before","after"),function(e,t){return{element:b(t),wrap:function(n){e.insert().append(t,n)}}}),ar=function(t,n,r){if(0===n.length)return n;var e=F(n,function(n){return t.property().isText(n)&&0<t.property().getText(n).length});return P(e,function(n){var e=r();return t.insert().before(n,e.element()),e.wrap(n),e.element()})},fr=ot(),sr={assess:yt.inView},lr={anything:b(sr)},dr=function(e,n){return e.up().closest(n,"[lang]",b(!1)).map(function(n){return e.attrs().get(n,"lang")})},gr=function(e){var t=[],n=[],r=[],o=e,u=function(n){n.each(function(n){t.push(n)})},i=function(n){n.each(function(n){t=t.slice(0,t.length-1)})},c=function(){0<r.length&&n.push({lang:b(o),details:b(r)})},a=function(n){c(),r=[],o=n},f=function(n){return n.or(N.from(t[t.length-1])).getOr(e)};return{openInline:function(n,e){var t=f(n);t!==o&&a(t),u(n)},closeInline:function(n,e){i(n)},addDetail:function(n){var e=f(N.none());e!==o&&a(e),r.push(n)},addEmpty:function(n){var e=f(N.none());a(e)},openBoundary:function(n,e){u(n);var t=f(n);a(t)},closeBoundary:function(n,e){i(n);var t=f(n);a(t)},done:function(){return c(),n.slice(0)}}},pr=dr,mr=function(r){return function(n,e){var t=dr(n,e);return!r.equals(t)}},hr=function(r,o){return function(n,e){var t=dr(n,e).getOr(r);return o!==t}},vr=Oe("item","mode"),yr=function(n,e,t,r){return void 0===r&&(r=wr),n.property().parent(e).map(function(n){return vr(n,r)})},wr=function(n,e,t,r){return void 0===r&&(r=br),t.sibling(n,e).map(function(n){return vr(n,r)})},br=function(n,e,t,r){void 0===r&&(r=br);var o=n.property().children(e);return t.first(o).map(function(n){return vr(n,r)})},kr=[{current:yr,next:wr,fallback:N.none()},{current:wr,next:br,fallback:N.some(yr)},{current:br,next:br,fallback:N.some(wr)}],xr=function(e,t,r,o,n){return void 0===n&&(n=kr),W(n,function(n){return n.current===r}).bind(function(n){return n.current(e,t,o,n.next).orThunk(function(){return n.fallback.bind(function(n){return xr(e,t,n,o)})})})},Tr={left:function(){return{sibling:function(n,e){return n.query().prevSibling(e)},first:function(n){return 0<n.length?N.some(n[n.length-1]):N.none()}}},right:function(){return{sibling:function(n,e){return n.query().nextSibling(e)},first:function(n){return 0<n.length?N.some(n[0]):N.none()}}}},Or=function(e,n,t,r,o,u){return xr(e,n,r,o).bind(function(n){return u(n.item())?N.none():t(n.item())?N.some(n.item()):Or(e,n.item(),t,n.mode(),o,u)})},Er=function(n,e,t,r){return Or(n,e,t,wr,Tr.right(),r)},_r=Er,Sr=function(){return{left:Tr.left,right:Tr.right}},Cr=xr,Ir=Oe("item","start","finish","text"),Nr=Oe("items","abort"),Ar=function(n,e){var t=n.property().getText(e);return Ir(e,0,t.length,t)},Dr=function(n,e,t){return Nr([],!0)},Rr=function(n,e,t){return Nr([],!1)},Lr=function(n,t,e){var r=n.property().getText(t);return e(r).fold(function(){return Nr([Ir(t,0,r.length,r)],!1)},function(n){var e=n[0]===n[1]?[]:[Ir(t,n[0],n[1],r.substring(n[0],n[1]))];return Nr(e,!0)})},Mr=Ar,jr=function(n,e){return n.property().isText(e)?Ar(n,e):Ir(e,0,0,"")},Pr=function(n,e,t,r){return(n.property().isBoundary(e)?Dr:n.property().isEmptyTag(e)?Dr:r(n,e)?Dr:n.property().isText(e)?Lr:Rr)(n,e,t)},Br=b("[^\\w'\\-\\u0100-\\u017F\\u00C0-\\u00FF\ufeff\\u2018\\u2019]"),Fr=b("[\\w'\\-\\u0100-\\u017F\\u00C0-\\u00FF\ufeff\\u2018\\u2019]"),zr=function(n,e,t,r){return{term:function(){return new RegExp(n,r.getOr("g"))},prefix:e,suffix:t}},Wr=function(n){return zr(n,b(0),b(0),N.none())},qr=function(n){return n.replace(/[-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},Ur=function(n){var e,t,r=qr(n);return e=r,t="((?:^'?)|(?:"+Br()+"+'?))"+e+"((?:'?$)|(?:'?"+Br()+"+))",zr(t,function(n){return 1<n.length?n[1].length:0},function(n){return 2<n.length?n[2].length:0},N.none())},Vr=zr,Hr=Wr,Jr=Br,Kr=Fr,Yr=function(n,e){for(var t=e.term(),r=[],o=t.exec(n);o;){var u=o.index+e.prefix(o),i=o[0].length-e.prefix(o)-e.suffix(o);r.push({start:b(u),finish:b(u+i)}),t.lastIndex=u+i,o=t.exec(n)}return r},Xr=Yr,$r=function(t,n){var e,r,o=V(n,function(e){var n=Yr(t,e.pattern());return P(n,function(n){return _n(_n({},e),n)})});return e=o,(r=Array.prototype.slice.call(e,0)).sort(function(n,e){return n.start()<e.start()?-1:e.start()<n.start()?1:0}),r},Gr=new RegExp(Jr()+"+","g"),Qr=b(0),Zr=function(n){var e=Xr(n,Vr(Jr(),Qr,Qr,N.none()));return N.from(e[e.length-1]).map(function(n){return n.start()})},no=function(n){var e=n.search(Gr);return-1<e?N.some(e):N.none()},eo={firstWord:function(e){return no(e).map(function(n){return e.substring(0,n+1)})},lastWord:function(e){return Zr(e).map(function(n){return e.substring(n)})},leftBreak:Zr,rightBreak:no,hasBreak:function(n){return no(n).isSome()}},to=Sr(),ro=to.left(),oo=to.right(),uo={left:{sibling:ro.sibling,first:ro.first,slicer:function(e){return eo.leftBreak(e).map(function(n){return[n+1,e.length]})}},right:{sibling:oo.sibling,first:oo.first,slicer:function(n){return eo.rightBreak(n).map(function(n){return[0,n]})}}},io=function(r,n,e,o,u){var t=Cr(r,n,e,o).map(function(n){var e=Pr(r,n.item(),o.slicer,u),t=e.abort()?[]:io(r,n.item(),n.mode(),o,u);return e.items().concat(t)}).getOr([]);return F(t,function(n){return 0<n.text().trim().length})},co=function(n,e,t){return io(n,e,wr,uo.left,t)},ao=function(n,e,t){return io(n,e,wr,uo.right,t)},fo=function(n,e){return!n.property().isText(e)&&0===n.down().predicate(e,n.property().isText).length},so=function(n,e,t,r){var o=co(n,e,r),u=ao(n,t,r),i=0<o.length?o[o.length-1]:jr(n,e),c=0<u.length?u[u.length-1]:jr(n,t),a=0===o.length&&0===u.length;return{left:b(i),right:b(c),isEmpty:b(a)}},lo={byBoundary:function(n,e){var t=b(!1),r=so(n,e,e,t),o=r.isEmpty()&&fo(n,e);return{left:r.left,right:r.right,isEmpty:b(o)}},getEdges:so,byLanguage:function(n,e){var t=pr(n,e),r=mr(t),o=co(n,e,r),u=ao(n,e,r),i=n.property().isText(e)?[Mr(n,e)]:[],c=J(o).concat(i).concat(u);return{all:b(c),left:b(o),middle:b(i),right:b(u),lang:b(t)}}},go=Oe("left","right"),po=Oe("first","second","splits"),mo=function(n,e,t){var r=n.property().children(e);return q(r,l(n.eq,t)).map(function(n){return{before:b(r.slice(0,n)),after:b(r.slice(n+1))}})},ho=function(r,o,n,e){var t,u,i=o(r,n);return t=function(n,e){var t=o(r,e);return vo(r,n,t)},u=i,function(n,e){for(var t=n.length-1;0<=t;t--)e(n[t],t)}(e,function(n){u=t(u,n)}),u},vo=function(e,n,t){return n.bind(function(n){return t.filter(l(e.eq,n))})},yo=function(n,e){return l(n.eq,e)},wo=function(e,n,t,r){void 0===r&&(r=T);var o=[n].concat(e.up().all(n)),u=[t].concat(e.up().all(t)),i=function(e){return q(e,r).fold(function(){return e},function(n){return e.slice(0,n+1)})},c=i(o),a=i(u),f=W(c,function(n){return j(a,yo(e,n))});return{firstpath:b(c),secondpath:b(a),shared:b(f)}},bo={sharedOne:function(n,e,t){return 0<t.length?ho(n,e,(r=t)[0],r.slice(1)):N.none();var r},subset:function(e,n,t){var r=wo(e,n,t);return r.shared().bind(function(n){return function(o,u,n,e){var i=o.property().children(u);if(o.eq(u,n[0]))return N.some([n[0]]);if(o.eq(u,e[0]))return N.some([e[0]]);var t=function(n){var e=J(n),t=q(e,yo(o,u)).getOr(-1),r=t<e.length-1?e[t+1]:e[t];return q(i,yo(o,r))},r=t(n),c=t(e);return r.bind(function(r){return c.map(function(n){var e=Math.min(r,n),t=Math.max(r,n);return i.slice(e,t+1)})})}(e,n,r.firstpath(),r.secondpath())})},ancestors:wo,breakToLeft:function(t,r,o){return mo(t,r,o).map(function(n){var e=t.create().clone(r);return t.insert().appendAll(e,n.before().concat([o])),t.insert().appendAll(r,n.after()),t.insert().before(r,e),go(e,r)})},breakToRight:function(t,r,n){return mo(t,r,n).map(function(n){var e=t.create().clone(r);return t.insert().appendAll(e,n.after()),t.insert().after(r,e),go(r,e)})},breakPath:function(u,n,i,c){var a=function(n,e,o){var t=po(n,N.none(),o);return i(n)?po(n,e,o):u.property().parent(n).bind(function(r){return c(u,r,n).map(function(n){var e=[{first:n.left,second:n.right}],t=i(r)?r:n.left();return a(t,N.some(n.right()),o.concat(e))})}).getOr(t)};return a(n,N.none(),[])}},ko=Oe("word","left","right"),xo=["'","‘","’"],To=V(xo,function(e){return P(["twas"],function(n){return e+n})}),Oo=function(n){return M(xo,n)},Eo=function(n){var e,t,r=n.word();return 2<=r.length&&Oo(r.charAt(r.length-1))&&!Oo(r.charAt(r.length-2))?(t=(e=n).word(),ko(t.substring(0,t.length-1),e.left(),N.some(t.charAt(t.length-1)))):n},_o=function(n){var e,t,r=n.word(),o=j(To,function(n){return-1<r.indexOf(n)})?2:1,u=r.substring(0,o);return H(u,Oo)&&!Oo(r.charAt(o))?(t=(e=n).word(),ko(t.substring(1),N.some(t.charAt(0)),e.right())):n},So=function(n){var e=Eo(n);return _o(e)},Co=So,Io=function(c){var n=Hr(Kr()+"+"),e=Xr(c,n),a=c.length;return P(e,function(n){var e=n.start(),t=n.finish(),r=c.substring(e,t),o=0<e?N.some(c.charAt(e-1)):N.none(),u=t<a?N.some(c.charAt(t)):N.none(),i=ko(r,o,u);return Co(i)})},No=function(o,u){var i=o.concat(u);if(0===i.length)throw new Error("You must specify at least one required or optional field.");return Ce("required",o),Ce("optional",u),Ie(i),function(e){var t=Y(e);H(o,function(n){return M(t,n)})||_e(o,t);var n=F(t,function(n){return!M(i,n)});0<n.length&&Se(n);var r={};return B(o,function(n){r[n]=b(e[n])}),B(u,function(n){r[n]=b(Object.prototype.hasOwnProperty.call(e,n)?N.some(e[n]):N.none())}),r}}(["elements","lang","words"],[]),Ao=function(n,e){var t=P(e,function(n){var e=n.details(),t=n.lang(),r=P(e,function(n){return n.text()}).join(""),o=P(e,function(n){return n.item()}),u=Io(r);return No({lang:t,words:u,elements:o})});return{zones:b(t)}},Do="trampoline.stop",Ro={stop:b(Do),run:function(n){for(var e=n();e!==Do;)e=e()}},Lo=ht([{inline:["item","mode","lang"]},{text:["item","mode"]},{empty:["item","mode"]},{boundary:["item","mode","lang"]},{concluded:["item","mode"]}]),Mo=function(n,e,t,r){var o=n.property().isElement(e)?N.from(n.attrs().get(e,"lang")):N.none();return n.property().isText(e)?Lo.text(e,t):r(e,t)?Lo.concluded(e,t):n.property().isBoundary(e)?Lo.boundary(e,t,o):n.property().isEmptyTag(e)?Lo.empty(e,t):Lo.inline(e,t,o)},jo=function(o,n,u,i,c,a){return function(){return n.fold(function(n,e,t){return(e===br?i.openInline:i.closeInline)(t,n),Po(o,n,e,u,i,c,a)},function(n,e){var t=c(o,n);return i.addDetail(t),u(n,e)?Ro.stop():Po(o,n,e,u,i,c,a)},function(n,e){return i.addEmpty(n),Po(o,n,e,u,i,c,a)},function(e,t,r){var n=a.assess(e);return yt.cata(n,function(n){return t!==yr?Po(o,e,wr,u,i,c,a):Ro.stop()},function(n){return(t===br?i.openBoundary:i.closeBoundary)(r,e),Po(o,e,t,u,i,c,a)},function(n){return Ro.stop()})},function(n,e){return Ro.stop()})}},Po=function(n,e,t,r,o,u,i){var c,a,f,s,l=(s=r,Cr(c=n,a=e,f=t,Sr().right()).fold(function(){return Lo.concluded(a,f)},function(n){return Mo(c,n.item(),n.mode(),s)}));return jo(n,l,r,o,u,i)},Bo=function(t,n,r,e,o,u){var i=function(n,e){return t.eq(n,r)&&(e!==br||t.property().isText(n)||0===t.property().children(n).length)},c=gr(e),a=Mo(t,n,br,i);return Ro.run(jo(t,a,i,c,o,u)),c.done()},Fo=function(f,n,e,s,l,d){var t=bo.subset(f,n,e).bind(function(n){if(0===n.length)return N.none();var t,r,o,u,i,c,e=n[0],a=n[n.length-1];return r=e,o=a,u=s,i=l,c=d,((t=f).eq(r,o)?N.some(r):t.property().parent(r)).map(function(n){var e=pr(t,n).getOr(u);return Bo(t,r,o,e,i,c)})}).getOr([]);return Ao(f,t)},zo=function(t,r){return function(n,e){return n.eq(e,t.item())?t:n.eq(e,r.item())?r:Mr(n,e)}},Wo=function(){return{zones:b([])}},qo={fromRange:function(n,e,t,r,o){var u=lo.getEdges(n,e,t,b(!1)),i=zo(u.left(),u.right());return Fo(n,u.left().item(),u.right().item(),r,i,o)},transformEdges:zo,fromBounded:function(n,e,t,r,o){return Fo(n,e,t,r,Mr,o)},fromBoundedWith:Fo,fromInline:function(n,e,t,r){var o=lo.byBoundary(n,e),u=zo(o.left(),o.right());return o.isEmpty()?Wo():Fo(n,o.left().item(),o.right().item(),t,u,r)},empty:Wo},Uo=function(n,e,t,r,o,u){var i,c,a=qo.fromBoundedWith(n,e,t,r,u,lr.anything()).zones();return 1===a.length?(i=a[0],c=o,i.lang()===c?N.some(i):N.none()):N.none()},Vo=function(n,e,t,r,o){return Uo(n,e,t,r,o,Mr)},Ho=function(n,e,t,r){var o=n.property().isText(e)?n.property().getText(e).length:n.property().children(e).length,u=ft(n,e,0),i=ft(n,e,o);return Vo(n,u.element(),i.element(),t,r)},Jo=Vo,Ko=function(n,e,t,r){var o=hr(t,r),u=lo.getEdges(n,e,e,o),i=qo.transformEdges(u.left(),u.right());return u.isEmpty()?Ho(n,e,t,r):Uo(n,u.left().item(),u.right().item(),t,r,i)},Yo=function(){return N.none()},Xo=function(n,e,t,r){return n.property().isBoundary(e)?Jo(n,e,e,t,r):n.property().isEmptyTag(e)?Yo():Ko(n,e,t,r)},$o=Xo,Go=ot(),Qo=function(n,e,t){return $o(Go,n,e,t)},Zo=function(n){return V(n,function(n){return Ke(n,wn)})},nu=Zo,eu=function(n){var e=Zo(n);return P(e,function(n){return wn(n)?et(n):""}).join("")},tu=function(n,e,t){return N.from(n[0]).bind(function(n){return Qo(n,e,t).bind(function(n){var e=n.words();return 1===e.length?N.some(e[0]).map(function(n){return n.word()}):N.none()})})},ru=function(n){return V(n,Me)},ou=function(t,r){var o=ru(t),u=nu(t);return N.from(t[0]).bind(function(n){Ve(n,o);var e=N.from(u[0]);return e.each(function(n){tt(n,r)}),B(u.slice(1),function(n){tt(n,"")}),B(t,Ye),e})};Oe("component","index");var uu=function(t){return{is:function(n){return t===n},isValue:O,isError:T,getOr:b(t),getOrThunk:b(t),getOrDie:b(t),or:function(n){return uu(t)},orThunk:function(n){return uu(t)},fold:function(n,e){return e(t)},map:function(n){return uu(n(t))},mapError:function(n){return uu(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOption:function(){return N.some(t)}}},iu=function(t){return{is:T,isValue:T,isError:O,getOr:k,getOrThunk:function(n){return n()},getOrDie:function(){return n=String(t),function(){throw new Error(n)}();var n},or:function(n){return n},orThunk:function(n){return n()},fold:function(n,e){return n(t)},map:function(n){return iu(t)},mapError:function(n){return iu(n(t))},each:w,bind:function(n){return iu(t)},exists:T,forall:O,toOption:N.none}},cu={value:uu,error:iu,fromOption:function(n,e){return n.fold(function(){return iu(e)},uu)}},au=function(n){return n.replace(/\./g,"-")},fu=function(n,e){return n+"-"+e},su=function(n){var t=au(n);return{resolve:function(n){var e=n.split(" ");return P(e,function(n){return fu(t,n)}).join(" ")}}};su("ephox.flour").resolve;var lu={resolve:su("data.mce").resolve},du=lu.resolve("annotation"),gu=lu.resolve("highlight-id"),pu=function(n){return N.from(xn(n,gu))},mu={nonIgnoredMarker:function(n,e,t){return de(n,"."+e+":not(."+t+")")},allNonIgnoredMarkers:function(n,e,t){return P(n.dom.select("."+e+":not(."+t+")"),on.fromDom)},marker:function(n,e){return de(n,"."+e)},id:pu,set:function(n,e){kn(n,gu,e),Mt(n,e)},sameId:function(t){return pu(t).fold(b([t]),function(n){var e=Ne(t);return $e(e,"."+n)})},all:function(t){var n;return(n=t,N.from(xn(n,du))).fold(b([t]),function(n){var e=Ne(t);return $e(e,"span["+du+"="+n+"]")})},otherCurrents:function(n,e){var t=Ne(n);return $e(t,"."+e)},label:b(du)},hu={resolve:su("mce").resolve},vu=lu.resolve("lingo"),yu=hu.resolve("spellchecker-annotation"),wu=hu.resolve("spellchecker-word"),bu=hu.resolve("spellchecker-ignore"),ku=hu.resolve("spellchecker-current"),xu=function(n,e){return N.from(xn(n,e))},Tu={nu:function(){var e,n=on.fromTag("span");return e=n,B([yu,wu],function(n){Mt(e,n)}),kn(n,"aria-invalid","spelling"),cr(fr,n)},set:function(n,e,t){kn(n,"data-mce-bogus",1),kn(n,mu.label(),t),kn(n,vu,e)},setCurrent:function(n){Mt(n,ku)},unSetCurrent:function(n){Pt(n,ku)},label:b(yu),wordLabel:b(wu),ignoreLabel:b(bu),currentLabel:b(ku),detail:function(r){return mu.id(r).bind(function(t){return xu(r,mu.label()).bind(function(e){return xu(r,vu).map(function(n){return{id:b(t),word:b(e),lang:b(n),element:b(r)}})})})}},Ou=function(n){return{fold:n}},Eu=function(t){return Ou(function(n,e){return e(t)})},_u=function(t){return Ou(function(n,e){return n(t)})},Su=hu.resolve("wrap-disabled"),Cu=function(n){var e=mu.sameId(n);B(e,function(n){Pt(n,Su)})},Iu=0,Nu=function(n){var e=(new Date).getTime();return n+"_"+Math.floor(1e9*Math.random())+ ++Iu+String(e)},Au=Oe("id","match","current"),Du=Oe("word","pattern"),Ru=function(o,n,e){var t=V(e,function(n){return[n.start(),n.finish()]}),u=Ut(n,t,function(n,e){return function(o,n,e){var t=o.property().getText(n),r=F(Ht(t,e),function(n){return 0<n.length});if(r.length<=1)return[it(n,0,t.length)];o.property().setText(n,r[0]);var u=qt(r.slice(1),function(n,e){var t=o.create().text(n),r=it(t,e,e+n.length);return N.some(r)},r[0].length),i=P(u,function(n){return n.element()});return o.insert().afterAll(n,i),[it(n,0,r[0].length)].concat(u)}(o,n.element(),e)});return P(e,function(n){var e=Vt(u,n.start(),n.finish()),t=P(e,function(n){return n.element()}),r=P(t,o.property().getText).join("");return{elements:function(){return t},word:n.word,exact:function(){return r}}})},Lu=function(i,n,c,e){var t=ir(i,n,e);return V(t,function(n){var r,e=V(n,function(n){return n.fold(rr,rr,function(n){return[n]},rr)}),t=P(e,i.property().getText).join(""),o=$r(t,c),u=(r=i,qt(e,function(n,e){var t=e+r.property().getText(n).length;return N.from(it(n,e,t))}));return Ru(i,u,o)})},Mu=function(n,e,t,r){var o=P(t,function(n){var e=Ur(n);return Du(n,e)});return Lu(n,e,o,r)},ju=ot(),Pu=function(n,e,t){return Mu(ju,n,e,t)},Bu=function(n,u){return P(n,function(n){return t=u,r=V((e=n).elements(),function(n){return mu.marker(n,t).fold(b([]),function(n){return[n]})}),o=Nu("mce-cram"),Au(o,e,N.from(r[0]));var e,t,r,o})},Fu=Oe("id","elements","word","lang"),zu=function(n){return{fold:n}},Wu=function(t){return zu(function(n,e){e(t)})},qu=function(t){return zu(function(n,e){n(t)})},Uu=function(n,e,t,r){var o=eu(n),u=tu(n,t,r);return o===e&&u.is(e)},Vu=function(n,e,t,r,o){var u,i,c,a,f,s,l,d=(u=n.elements(),i=e,c={},B(u,function(n){mu.marker(n,i.label()).filter(fe).each(function(u){i.detail(u).each(function(n){var e=n.id(),t=n.word(),r=n.lang(),o=mu.sameId(u);0<o.length&&(c[e]=Fu(e,o,t,r))})})}),c),g=(a=d,f=o,s=n.lang(),l=nn(a),P(l,function(n){return n.lang()===s&&Uu(n.elements(),n.word(),f,n.lang())?Wu(n):qu(n)}));B(g,function(n){var e=function(e){return function(n){B(n.elements(),e)}};n.fold(e(r),e(t))})},Hu=function(n){return mu.nonIgnoredMarker(n,Tu.label(),Tu.ignoreLabel())},Ju={label:Tu.label,highlight:function(c,a,n,e){Vu(a,Tu,Cu,Xe,c.lang());var t=Pu(a.elements(),n,e),r=Bu(t,Tu.label());return V(r,function(i){return i.current().fold(function(){var n=i.match(),e=n.word();if(c.ignore(n))return[];var t,r,o=F(n.elements(),function(n){return wn(n)?Ae(n).fold(function(){return!1},function(n){return"false"!==n.dom().contentEditable}):gn(n.dom())?"false"!==n.dom().contentEditable:n.dom().isContentEditable}),u=(t=o,r=Tu.nu,ar(fr,t,r)||[]);return B(u,function(n){mu.set(n,i.id()),Tu.set(n,a.lang(),e)}),0<u.length?[Eu(u)]:[]},function(n){return[_u(n)]})})},marker:Hu,allMarkers:function(n){return mu.allNonIgnoredMarkers(n,Tu.label(),Tu.ignoreLabel())},substitute:function(n,e){var t=Hu(n).fold(b([]),mu.sameId);return ou(t,e)},ignore:function(n){var e=Hu(n).fold(b([]),mu.sameId);B(e,function(n){Pt(n,Tu.wordLabel()),Mt(n,Tu.ignoreLabel())})},ignoreAll:function(n){var e=Hu(n).fold(b([]),mu.all);B(e,Xe)},detail:function(n){return Tu.detail(n)},setCurrent:function(n){var e=mu.otherCurrents(n,Tu.currentLabel());B(e,Tu.unSetCurrent),Tu.setCurrent(n)}},Ku=Ju.label(),Yu={isWrap:function(n){return t=Ku,Dt(e=n)&&e.dom().classList.contains(t);var e,t}},Xu=Oe("area","f");var $u=function(n,e,t,r){return n.property().isBoundary(e)?qo.fromBounded(n,e,e,t,r):n.property().isEmptyTag(e)?Gu():qo.fromInline(n,e,t,r)},Gu=qo.empty,Qu={single:$u,range:function(n,e,t,r,o,u,i){var c=ft(n,e,t),a=ft(n,r,o);return n.eq(c.element(),a.element())?$u(n,c.element(),u,i):qo.fromRange(n,c.element(),a.element(),u,i)},empty:Gu},Zu=ot(),ni={single:function(n,e,t){return Qu.single(Zu,n,e,t)},range:function(n,e,t,r,o,u){return Qu.range(Zu,n,e,t,r,o,u)},empty:function(){return Qu.empty()}};function ei(n,o){var t,r,u,i=Sn(n),e=(r=!(t=[]),u=function(){r=!0,N.from(t.shift()).fold(function(){r=!1},function(n){n.f()(n.area(),u)})},{enqueue:function(n,e){t.push(Xu(n,e)),r||u()},destroy:function(){t=[]}}),c=function(n,e,t,r){e(n,Nt.cata(t,function(n){return fe(n)?ni.single(n,i.get(),o()):ni.empty()},function(n,e,t,r){return fe(n)&&fe(t)?ni.range(n,e,t,r,i.get(),o()):ni.empty()}),i.get(),r)};return{run:function(n,e,t,r){void 0===r&&(r=k),c(n,e,t,r)},setLang:i.set,schedule:function(t,r,n,o){e.enqueue(n,function(n,e){void 0!==o&&o()?e():c(t,r,n,e)})},destroy:function(){e.destroy()}}}var ti,ri,oi,ui=function(n,e){return n.fold(function(){return!1},function(n){return!n.ignore()&&(n.suggestions().isSome()||!e)})},ii={update:function(e,t,r){var n=Y(r);B(n,function(n){e.add(t,n,r[n])})},getInCache:function(t,r,n,o){return F(n,function(n){var e=t.get(r,n.word());return ui(e,o)})},getInCacheString:function(t,r,n,o){return F(n,function(n){var e=t.get(r,n);return ui(e,o)})}},ci={highlight:function(n,e,t){var r={ignore:b(!1),lang:b(t)},u=P(e,function(n){return n.word()}),o=F(u,function(n,e){return(t=u,r=n,o=L(t,r),-1===o?N.none():N.some(o)).filter(function(n){return n===e}).isSome();var t,r,o});Ju.highlight(r,n,o,b(!1))}},ai=function(n){var e=new RegExp(Bt,"g"),t=new RegExp("[‘’]","g");return n.replace(e,"").replace(t,"'")},fi={},si={exports:fi};ri=fi,oi=si,ti=void 0,function(n){"object"==typeof ri&&void 0!==oi?oi.exports=n():"function"==typeof ti&&ti.amd?ti([],n):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=n()}(function(){return function u(i,c,a){function f(e,n){if(!c[e]){if(!i[e]){var t=!1;if(!n&&t)return t(e,!0);if(s)return s(e,!0);var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}var o=c[e]={exports:{}};i[e][0].call(o.exports,function(n){return f(i[e][1][n]||n)},o,o.exports,u,i,c,a)}return c[e].exports}for(var s=!1,n=0;n<a.length;n++)f(a[n]);return f}({1:[function(n,e,t){var r,o,u=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function a(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(n){try{return r.call(null,e,0)}catch(n){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(n){r=i}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(n){o=c}}();var f,s=[],l=!1,d=-1;function g(){l&&f&&(l=!1,f.length?s=f.concat(s):d=-1,s.length&&p())}function p(){if(!l){var n=a(g);l=!0;for(var e=s.length;e;){for(f=s,s=[];++d<e;)f&&f[d].run();d=-1,e=s.length}f=null,l=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(n){try{return o.call(null,e)}catch(n){return o.call(this,e)}}}(n)}}function m(n,e){this.fun=n,this.array=e}function h(){}u.nextTick=function(n){var e=new Array(arguments.length-1);if(1<arguments.length)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];s.push(new m(n,e)),1!==s.length||l||a(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=h,u.addListener=h,u.once=h,u.off=h,u.removeListener=h,u.removeAllListeners=h,u.emit=h,u.prependListener=h,u.prependOnceListener=h,u.listeners=function(n){return[]},u.binding=function(n){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(n){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},{}],2:[function(n,l,e){(function(t){!function(n){var e=setTimeout;function r(){}function u(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],s(n,this)}function o(t,r){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,u._immediateFn(function(){var n=1===t._state?r.onFulfilled:r.onRejected;if(null!==n){var e;try{e=n(t._value)}catch(n){return void c(r.promise,n)}i(r.promise,e)}else(1===t._state?i:c)(r.promise,t._value)})):t._deferreds.push(r)}function i(e,n){try{if(n===e)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then;if(n instanceof u)return e._state=3,e._value=n,void a(e);if("function"==typeof t)return void s((r=t,o=n,function(){r.apply(o,arguments)}),e)}e._state=1,e._value=n,a(e)}catch(n){c(e,n)}var r,o}function c(n,e){n._state=2,n._value=e,a(n)}function a(n){2===n._state&&0===n._deferreds.length&&u._immediateFn(function(){n._handled||u._unhandledRejectionFn(n._value)});for(var e=0,t=n._deferreds.length;e<t;e++)o(n,n._deferreds[e]);n._deferreds=null}function f(n,e,t){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof e?e:null,this.promise=t}function s(n,e){var t=!1;try{n(function(n){t||(t=!0,i(e,n))},function(n){t||(t=!0,c(e,n))})}catch(n){if(t)return;t=!0,c(e,n)}}u.prototype.catch=function(n){return this.then(null,n)},u.prototype.then=function(n,e){var t=new this.constructor(r);return o(this,new f(n,e,t)),t},u.all=function(n){var c=Array.prototype.slice.call(n);return new u(function(r,o){if(0===c.length)return r([]);var u=c.length;function i(e,n){try{if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then;if("function"==typeof t)return void t.call(n,function(n){i(e,n)},o)}c[e]=n,0==--u&&r(c)}catch(n){o(n)}}for(var n=0;n<c.length;n++)i(n,c[n])})},u.resolve=function(e){return e&&"object"==typeof e&&e.constructor===u?e:new u(function(n){n(e)})},u.reject=function(t){return new u(function(n,e){e(t)})},u.race=function(o){return new u(function(n,e){for(var t=0,r=o.length;t<r;t++)o[t].then(n,e)})},u._immediateFn="function"==typeof t?function(n){t(n)}:function(n){e(n,0)},u._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},u._setImmediateFn=function(n){u._immediateFn=n},u._setUnhandledRejectionFn=function(n){u._unhandledRejectionFn=n},void 0!==l&&l.exports?l.exports=u:n.Promise||(n.Promise=u)}(this)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(a,n,f){(function(n,e){var r=a("process/browser.js").nextTick,t=Function.prototype.apply,o=Array.prototype.slice,u={},i=0;function c(n,e){this._id=n,this._clearFn=e}f.setTimeout=function(){return new c(t.call(setTimeout,window,arguments),clearTimeout)},f.setInterval=function(){return new c(t.call(setInterval,window,arguments),clearInterval)},f.clearTimeout=f.clearInterval=function(n){n.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},f.enroll=function(n,e){clearTimeout(n._idleTimeoutId),n._idleTimeout=e},f.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},f._unrefActive=f.active=function(n){clearTimeout(n._idleTimeoutId);var e=n._idleTimeout;0<=e&&(n._idleTimeoutId=setTimeout(function(){n._onTimeout&&n._onTimeout()},e))},f.setImmediate="function"==typeof n?n:function(n){var e=i++,t=!(arguments.length<2)&&o.call(arguments,1);return u[e]=!0,r(function(){u[e]&&(t?n.apply(null,t):n.call(null),f.clearImmediate(e))}),e},f.clearImmediate="function"==typeof e?e:function(n){delete u[n]}}).call(this,a("timers").setImmediate,a("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,e,t){var r=n("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")();e.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)});var li=si.exports.boltExport,di=function(n){var t=N.none(),e=[],r=function(n){o()?i(n):e.push(n)},o=function(){return t.isSome()},u=function(n){B(n,i)},i=function(e){t.each(function(n){_.setTimeout(function(){e(n)},0)})};return n(function(n){t=N.some(n),u(e),e=[]}),{get:r,map:function(t){return di(function(e){r(function(n){e(t(n))})})},isReady:o}},gi={nu:di,pure:function(e){return di(function(n){n(e)})}},pi=function(n){_.setTimeout(function(){throw n},0)},mi=function(t){var n=function(n){t().then(n,pi)};return{map:function(n){return mi(function(){return t().then(n)})},bind:function(e){return mi(function(){return t().then(function(n){return e(n).toPromise()})})},anonBind:function(n){return mi(function(){return t().then(function(){return n.toPromise()})})},toLazy:function(){return gi.nu(n)},toCached:function(){var n=null;return mi(function(){return null===n&&(n=t()),n})},toPromise:t,get:n}},hi={nu:function(n){return mi(function(){return new li(n)})},pure:function(n){return mi(function(){return li.resolve(n)})}},vi=function(i,n){return n(function(r){var o=[],u=0;0===i.length?r([]):B(i,function(n,e){var t;n.get((t=e,function(n){o[t]=n,++u>=i.length&&r(o)}))})})},yi=function(n){return vi(n,hi.nu)},wi=(ht([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(n){var e=[],t=[];return B(n,function(n){n.fold(function(n){e.push(n)},function(n){t.push(n)})}),{errors:e,values:t}}),bi=function(n){return cu.error(new Error(n))},ki=function(n,e){return F(n,function(n){return!M(e,n)})},xi=function(u,t,r){return hi.nu(function(o){var n=P(u.words(),function(n){return ai(n.word())}),e=ki(n,r);t(e,u.lang()).get(function(n){return n.fold(function(n){var e=bi(n);o(e)},function(n){var e,t,r=(e=u,t=n,cu.value({spelling:b(t),zone:b(e)}));o(r)})})})},Ti=function(e,o,t,u){return hi.nu(function(r){var n=ki(e,u);t.correctionMany(n,o).get(function(n){return n.fold(function(n){var e=bi(n);r(e)},function(n){var e,t;r((e=o,t=n,cu.value({spelling:b(t),lang:b(e)})))})})})},Oi=function(n){var e,t,r;return function(n,e){if(0===n.length)return[];for(var t=e(n[0]),r=[],o=[],u=0,i=n.length;u<i;u++){var c=n[u],a=e(c);a!==t&&(r.push(o),o=[]),t=a,o.push(c)}return 0!==o.length&&r.push(o),r}((e=n,t=function(n,e){return n.detail.lang()<e.detail.lang()?-1:e.detail.lang()<n.detail.lang()?1:0},(r=A.call(e,0)).sort(t),r),function(n){return n.detail.lang()})},Ei={scan:function(u,e,n,t,i){var r=function(n){var e=n.zone();ii.update(u,e.lang(),n.spelling());var t=Y(n.spelling()),r=ii.getInCacheString(u,e.lang(),t,i),o=F(e.words(),function(n){var e=ai(n.word());return M(r,e)});return{zone:b(e),words:b(o)}},o=P(n,function(n){return xi(n,e,t)});return yi(o).map(function(n){var e=V(n,function(n){return n.fold(b([]),K)});return P(e,r)})},fetch:function(e,t,n,r){var o=function(n){ii.update(e,n.lang(),n.spelling())},u=Oi(n),i=P(u,function(n){var e=P(n,function(n){return n.detail.word()});return Ti(e,n[0].detail.lang(),t,r)});return yi(i).map(function(n){return B(n,function(n){n.each(o)}),wi(n)})}},_i=!0;function Si(u,i,c,a){var f=function(n,e,t){n(function(){B(e,function(n){ci.highlight(n.zone(),n.words(),t)})})};return{local:function(n,e,t,r){var o=e.zones(),u=P(o,function(n){var e=ii.getInCache(i,n.lang(),n.words(),_i);return{zone:b(n),words:b(e),lang:n.lang}});f(n,u,t),r()},remote:function(e,n,t,r){var o=n.zones();Ei.scan(i,c.correctionMany,o,a,_i).get(function(n){u.removed||(f(e,n,t),r())})},check:function(e,n,t,r){var o=n.zones();Ei.scan(i,c.check,o,a,!_i).get(function(n){u.removed||(f(e,n,t),r())})},fetch:function(n){return Ei.fetch(i,c,n,a)}}}var Ci,Ii,Ni=Object.prototype.hasOwnProperty,Ai=function(i){return function(){for(var n=new Array(arguments.length),e=0;e<n.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var t={},r=0;r<n.length;r++){var o=n[r];for(var u in o)Ni.call(o,u)&&(t[u]=i(t[u],o[u]))}return t}},Di=Ai(function(n,e){return c(n)&&c(e)?Di(n,e):e}),Ri=Ai(function(n,e){return e}),Li=function(){return{zh_hk:"zh_tw",iw:"he",no:"nb",nn:"nb",en:"en",ar:"ar",ca:"ca",cs:"cs",da:"da",de:"de",el:"el",es:"es",fa:"fa",fi:"fi",fr:"fr",he:"he",hr:"hr",hu:"hu",it:"it",ja:"ja",kk:"kk",ko:"ko",nl:"nl",nb:"nb",pl:"pl",pt:"pt",pt_pt:"pt_pt",ro:"ro",ru:"ru",sl:"sl",sk:"sk",sv:"sv",th:"th",tr:"tr",uk:"uk",zh:"zh",zh_tw:"zh_tw"}},Mi=function(n){var e=n.toLowerCase().replace("-","_"),t=e.indexOf(";"),r=-1<t?e.substring(0,t):e,o=Xn(r),u=o.indexOf("_"),i=-1<u?o.substring(0,u):o;return{full:o,languageCode:i}},ji=function(n,r){var e=n.split(","),t=P(e,function(n){return e=r,t=Mi(n),e[t.full]||e[t.languageCode]||"";var e,t});return W(t,function(n){return""!==n})},Pi={extract:Mi,determine:function(n){return ji(n,{zh_hk:"zh_tw",iw:"he",no:"nb",nn:"nb",en:"en",ar:"ar",ca:"ca",cs:"cs",da:"da",de:"de",el:"el",es:"es",fa:"fa",fi:"fi",fr:"fr",he:"he",hr:"hr",hu:"hu",it:"it",ja:"ja",kk:"kk",ko:"ko",nl:"nl",nb:"nb",pl:"pl",pt:"pt",pt_pt:"pt_pt",ro:"ro",ru:"ru",sl:"sl",sk:"sk",sv:"sv",th:"th",tr:"tr",uk:"uk",zh:"zh",zh_tw:"zh_tw"})},determineFrom:ji,localeList:Li},Bi="no.language",Fi={en_au:"en_gb",en_bz:"en_gb",en_ca:"en_gb",en_gb:"en_gb",en_ie:"en_gb",en_in:"en_gb",en_jm:"en_gb",en_my:"en_gb",en_nz:"en_gb",en_ph:"en_gb",en_sg:"en_gb",en_tt:"en_gb",en_za:"en_gb",en_zw:"en_gb",en_us:"en_us",en:"en_us"},zi=["da","de","en","en_au","en_br","en_gb","en_uk","en_us","es","fi","fr","it","nb","nl","pt","pt_pt","sv"],Wi={determine:function(n){return n===Bi?N.some(n):(e=n,t=Ri(Pi.localeList(),Fi),Pi.determineFrom(e,t).filter(function(n){return M(zi,n)}));var e,t},isOn:function(n){return n!==Bi},offKey:b(Bi)};(Ii=Ci||(Ci={}))[Ii.Error=0]="Error",Ii[Ii.Value=1]="Value";var qi,Ui,Vi=function(n,e,t){return n.stype===Ci.Error?e(n.serror):t(n.svalue)},Hi=function(n){return{stype:Ci.Value,svalue:n}},Ji=function(n){return{stype:Ci.Error,serror:n}},Ki=function(n){return Vi(n,cu.error,cu.value)},Yi=Hi,Xi=function(n){var e=[],t=[];return B(n,function(n){Vi(n,function(n){return t.push(n)},function(n){return e.push(n)})}),{values:e,errors:t}},$i=Ji,Gi=function(n,e){return n.stype===Ci.Value?e(n.svalue):n},Qi=function(n,e){return n.stype===Ci.Error?e(n.serror):n},Zi=function(n,e){return n.stype===Ci.Value?{stype:Ci.Value,svalue:e(n.svalue)}:n},nc=function(n,e){return n.stype===Ci.Error?{stype:Ci.Error,serror:e(n.serror)}:n},ec=function(n){return c(n)&&100<Y(n).length?" removed due to size":JSON.stringify(n,null,2)},tc=function(n,e){return $i([{path:n,getErrorInfo:e}])},rc=ht([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),oc=rc.strict,uc=(rc.asOption,rc.defaultedThunk,rc.asDefaultedOptionThunk,rc.mergeWithThunk,function(n,e){var t;return(t={})[n]=e,t}),ic=function(n){return d($i,U)(n)},cc=function(n,e){var t,r,o=Xi(n);return 0<o.errors.length?ic(o.errors):(t=o.values,r=e,0<t.length?Yi(Di(r,Ri.apply(void 0,t))):Yi(r))},ac=function(n){var e=Xi(n);return 0<e.errors.length?ic(e.errors):Yi(e.values)},fc=ht([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),sc=function(t,r,o){return en(r,o).fold(function(){return n=o,e=r,tc(t,function(){return'Could not find valid *strict* value for "'+n+'" in '+ec(e)});var n,e},Yi)},lc=function(n,e,t){var r=en(n,e).fold(function(){return t(n)},k);return Yi(r)},dc=function(c,a,n,f){return n.fold(function(o,t,n,r){var u=function(n){var e=r.extract(c.concat([o]),f,n);return Zi(e,function(n){return uc(t,f(n))})},i=function(n){return n.fold(function(){var n=uc(t,f(N.none()));return Yi(n)},function(n){var e=r.extract(c.concat([o]),f,n);return Zi(e,function(n){return uc(t,f(N.some(n)))})})};return n.fold(function(){return Gi(sc(c,a,o),u)},function(n){return Gi(lc(a,o,n),u)},function(){return Gi(Yi(en(a,o)),i)},function(n){return Gi((t=n,r=en(e=a,o).map(function(n){return!0===n?t(e):n}),Yi(r)),i);var e,t,r},function(n){var e=n(a),t=Zi(lc(a,o,b({})),function(n){return Di(e,n)});return Gi(t,u)})},function(n,e){var t=e(a);return Yi(uc(n,f(t)))})},gc=function(r){return{extract:function(t,n,e){return Qi(r(e,n),function(n){return e=n,tc(t,function(){return e});var e})},toString:function(){return"val"}}},pc=function(c){return{extract:function(n,e,t){return r=n,o=t,u=e,i=P(c,function(n){return dc(r,o,n,u)}),cc(i,{});var r,o,u,i},toString:function(){return"obj{\n"+P(c,function(n){return n.fold(function(n,e,t,r){return n+" -> "+r.toString()},function(n,e){return"state("+n+")"})}).join("\n")+"}"}}},mc=b(gc(Yi)),hc=d(function(o){return{extract:function(t,r,n){var e=P(n,function(n,e){return o.extract(t.concat(["["+e+"]"]),r,n)});return ac(e)},toString:function(){return"array("+o.toString()+")"}}},pc),vc=(fc.state,fc.field),yc=function(n,e,t){return Ki((r=n,o=k,u=t,i=e.extract([r],o,u),nc(i,function(n){return{input:u,errors:n}})));var r,o,u,i},wc=function(n,e,t){return yc(n,e,t).fold(function(n){throw new Error(bc(n))},k)},bc=function(n){return"Errors: \n"+(e=n.errors,t=10<e.length?e.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):e,P(t,function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()})).join("\n")+"\n\nInput object: "+ec(n.input);var e,t},kc=function(u){return _n(_n({},u),{toCached:function(){return kc(u.toCached())},bindFuture:function(e){return kc(u.bind(function(n){return n.fold(function(n){return hi.pure(cu.error(n))},function(n){return e(n)})}))},bindResult:function(e){return kc(u.map(function(n){return n.bind(e)}))},mapResult:function(e){return kc(u.map(function(n){return n.map(e)}))},mapError:function(e){return kc(u.map(function(n){return n.mapError(e)}))},foldResult:function(e,t){return u.map(function(n){return n.fold(e,t)})},withTimeout:function(n,o){return kc(hi.nu(function(e){var t=!1,r=_.setTimeout(function(){t=!0,e(cu.error(o()))},n);u.get(function(n){t||(_.clearTimeout(r),e(n))})}))}})},xc=function(n){return kc(hi.nu(n))},Tc=function(n){return kc(hi.pure(cu.value(n)))},Oc={nu:xc,wrap:kc,pure:Tc,value:Tc,error:function(n){return kc(hi.pure(cu.error(n)))},fromResult:function(n){return kc(hi.pure(n))},fromFuture:function(n){return kc(n.map(cu.value))},fromPromise:function(n){return xc(function(e){n.then(function(n){e(cu.value(n))},function(n){e(cu.error(n))})})}},Ec=function(){return(new Date).getTime()},_c=function(n,t){void 0===t&&(t=36e5);var e,r,o={},u=function(n,e,t){o[n]={result:e,timestamp:t}},i=function(n,e){return n-e<t};return c(n)&&(e=n,r=Ec(),$(e,function(n,e){i(r,n.timestamp)&&u(e,n.result,n.timestamp)})),{set:u,get:function(e,n){return N.from(o[n]).filter(function(n){return i(e,n.timestamp)}).map(function(n){return n.result})},dump:function(){return o}}};(Ui=qi||(qi={})).JSON="json",Ui.Blob="blob",Ui.Text="text",Ui.FormData="formdata",Ui.MultipartFormData="multipart/form-data";var Sc,Cc,Ic,Nc,Ac=function(n){try{var e=JSON.parse(n);return cu.value(e)}catch(n){return cu.error("Response was not JSON.")}},Dc=function(e){return hi.nu(function(t){var n=new _.FileReader;n.onload=function(n){var e=n.target?n.target.result:new _.Blob([]);t(e)},n.readAsText(e)})},Rc=function(n){return hi.pure(n.response)},Lc=function(n,e){switch(n){case qi.JSON:return Ac(e.response).fold(function(){return Rc(e)},hi.pure);case qi.Blob:return t=e,N.from(t.response).map(Dc).getOr(hi.pure("no response content"));case qi.Text:default:return Rc(e)}var t},Mc=function(n){var e,t=(e=n.body,N.from(e).bind(function(n){switch(n.type){case qi.JSON:return N.some("application/json");case qi.FormData:return N.some("application/x-www-form-urlencoded; charset=UTF-8");case qi.MultipartFormData:return N.none();case qi.Text:default:return N.some("text/plain")}})),r=!0===n.credentials?N.some(!0):N.none(),o=function(n){switch(n){case qi.Blob:return"application/octet-stream";case qi.JSON:return"application/json, text/javascript";case qi.Text:return"text/plain";default:return""}}(n.responseType)+", */*; q=0.01",u=void 0!==n.headers?n.headers:{};return{contentType:t,responseType:function(n){switch(n){case qi.JSON:return N.none();case qi.Blob:return N.some("blob");case qi.Text:return N.some("text");default:return N.none()}}(n.responseType),credentials:r,accept:o,headers:u,progress:f(n.progress)?N.some(n.progress):N.none()}},jc=function(n){var t=new _.FormData;return $(n,function(n,e){t.append(e,n)}),t},Pc=function(a){return Oc.nu(function(r){var o,u=new _.XMLHttpRequest;u.open(a.method,(o=a.url,N.from(a.query).map(function(n){var e=Z(n,function(n,e){return encodeURIComponent(e)+"="+encodeURIComponent(n)}),t=Kn(o,"?")?"&":"?";return 0<e.length?o+t+e.join("&"):o}).getOr(o)),!0);var t,n,e=Mc(a);t=u,(n=e).contentType.each(function(n){return t.setRequestHeader("Content-Type",n)}),t.setRequestHeader("Accept",n.accept),n.credentials.each(function(n){return t.withCredentials=n}),n.responseType.each(function(n){return t.responseType=n}),n.progress.each(function(e){return t.upload.addEventListener("progress",function(n){return e(n.loaded,n.total)})}),$(n.headers,function(n,e){return t.setRequestHeader(e,n)});var i,c=function(){var e,n,t;(e=a.url,n=a.responseType,t=u,Lc(n,t).map(function(n){return{message:0===t.status?"Unknown HTTP error (possible cross-domain request)":"Could not load url "+e+": "+t.statusText,status:t.status,responseText:n}})).get(function(n){return r(cu.error(n))})};u.onerror=c,u.onload=function(){var n;0!==u.status||(n=a.url,Jn(n,"file:",0))?u.status<100||400<=u.status?c():function(n,e){var t=function(){return Oc.pure(e.response)},r=function(n){return Oc.error({message:n,status:e.status,responseText:e.responseText})};switch(n){case qi.JSON:return Ac(e.response).fold(r,Oc.pure);case qi.Blob:case qi.Text:return t();default:return r("unknown data type")}}(a.responseType,u).get(r):c()},(i=a.body,N.from(i).map(function(n){return n.type===qi.JSON?JSON.stringify(n.data):n.type===qi.FormData?jc(n.data):n.type===qi.MultipartFormData?jc(n.data):n})).fold(function(){return u.send()},function(n){u.send(n)})})},Bc=function(n){return n.fold(function(n){var e=n.responseText,t=c(e)?e:n.message;return cu.error(t)},cu.value)},Fc=function(c,a){var n,f=en(n=a,"tiny-api-key").orThunk(function(){return en(n,"tinymce-api-key")}).orThunk(function(){return en(n,"textbox-api-key")}).getOrUndefined();return{execute:function(n){var e,t,r,o,u,i=(e={url:(r=c,o=f,u=-1===r.indexOf("?")?"?":"&",o?r+u+"apiKey="+encodeURIComponent(o):r),body:(t=n,{type:qi.JSON,data:t}),responseType:qi.JSON,credentials:!0,headers:a},Pc(_n(_n({},e),{method:"post"}))).map(Bc);return Oc.wrap(i)}}},zc=function(e,o,n,u,t){return!0===t?{known:{},unknown:n}:z(n,function(t,n){var r=u(n);return e(o,r).fold(function(){return{known:t.known,unknown:t.unknown.concat([n])}},function(n){var e=uc(r,n);return{known:_n(_n({},t.known),e),unknown:t.unknown}})},{known:{},unknown:[]})},Wc=function(n,e,t,r,o,u){var i,c,a,f,s,l=zc(e.get,o,t,r,u);return 0===l.unknown.length?Oc.value(l.known):(i=n,c=e,a=l.known,f=l.unknown,s=o,i(f,u).mapResult(function(n){return $(n,function(n,e){c.set(e,n,s)}),_n(_n({},a),n)}))},qc=function(n){return vc(n,n,oc(),mc())},Uc=function(n,e){return vc(n,n,(t=e,rc.defaultedThunk(b(t))),mc());var t},Vc="iframely",Hc="oembed",Jc="fallback",Kc="wikipedia",Yc=function(n){return"["+n.join(", ")+"]"},Xc=[Vc,Hc,Jc],$c=function(e,n,t){return j(n,function(n){return M(e,n)})?cu.error("Embed response source: "+Yc(e)+" contains more than one of "+Yc(Xc)):cu.value(t)},Gc=(pc([qc("url"),qc("maxWidth"),Uc("fresh",!1)]),pc([qc("status_code"),qc("sub_code"),qc("msg")]),pc([qc("html"),(Sc="rels",Cc=[vc("source","source",oc(),(Ic=function(n){return a(n)?M(e=n,Vc)?$c(e,[Hc,Jc,Kc],Vc):M(e,Hc)?$c(e,[Vc,Jc,Kc],Hc):M(e,Jc)?$c(e,[Vc,Hc,Kc],Jc):M(e,Kc)?$c(e,[Vc,Hc,Jc],Kc):cu.error("Embed response source: "+Yc(e)+" did not contain any of: "+Yc(Xc)):cu.error("Sources was not an array: "+n);var e},gc(function(n){return Ic(n).fold($i,Yi)})))],vc(Sc,Sc,oc(),pc(Cc)))]),[qc("url"),Uc("fresh",!1)]),Qc=(pc([vc("urls","urls",oc(),(Nc=Gc,hc(Nc)))]),ht([{invalid:["invalidUrl"]},{unknown:["unknownUrl"]},{valid:["validUrl"]}]),pc([qc("language"),qc("words")])),Zc=function(t,o,r,n,e){var u=P(function(n,e){for(var t=[],r=0;r<n.length;r+=e){var o=A.call(n,r,r+e);t.push(o)}return t}(n,e),function(n){var e=wc("ephox.spelling.service.many.ajax.service.get",Qc,{language:r,words:n});return t.execute(e)});return Oc.wrap(yi(u).map(function(n){var e=wi(n);if(0<e.values.length){var t=P(e.values,o),r=z(t,Ri,{});return cu.value(r)}return 0<e.errors.length?cu.error("Failures communicating with the spelling server: "+e.errors.join(", ")):cu.error("Unknown error")}))},na=function(r,o,u,n,i,e){var c=function(n){return n.spell};return Wc(function(n,e){var t=wc("ephox.spelling.service.many.ajax.service.get",Qc,{language:u,words:n});return r.execute(t).mapResult(c)},o,n,k,i,void 0!==e&&e).mapResult(function(e){B(n,function(n){tn(e,n)||o.set(n,ta,i)});var r={};return $(e,function(e,t){o.get(i,t).each(function(n){n!==ta&&(r[t]=e)})}),r})},ea=function(n){void 0===n&&(n={});var t={};return $(n,function(n,e){t[e]=_c(n)}),t},ta=Nu("good-spelling"),ra=function(n,e){return en(n,e).getOrThunk(function(){return _c()})},oa=function(n,e,t,r){var g=ea(r),p=ea({}),m=Fc(n,t),o=Fc(e,t);return{checkMany:function(n,e){var t,r,o,u,i,c,a,f=(t={},B(e,function(n){t[n]={}}),Y(t)),s=Ec(),l=ra(p,n),d=ra(g,n);return p[n]=l,g[n]=d,r=m,o=d,u=n,a=function(n){return n.check},Wc(function(n,e){return Zc(r,a,u,n,1e3)},l,f,k,i=s,void 0!==c&&c).mapResult(function(n){var t=[],r={};return $(n,function(n,e){n?o.set(e,ta,i):r[e]=t}),r})},correctOne:function(n,e){var t=Ec(),r=ra(g,n);return g[n]=r,na(o,r,n,[e],t)},correctMany:function(n,e){var t=Ec(),r=ra(g,n);return g[n]=r,na(o,r,n,e,t)},dumpCache:function(){return G(g,function(n){return n.dump()})}}},ua={consoleMessage:function(n){if(f((t=n).message)&&f(t.status)&&f(t.responseText)){var e=n.responseText();return n.message()+". Response code "+n.status()+(0===e.length?".":". Error details: "+e)}return n;var t}},ia={get:function(n){var e=ve.getApiKey(n);return null===e?{}:{"tiny-api-key":e}}},ca={spelling:b("1")},aa=function(n,e){var t,r;return(Yn(t=n,r="/")?t:t+r)+e},fa={corsQuery:function(n){return aa(n,"version")},spelling:function(n){return aa(n,ca.spelling())+"/"}};function sa(e){var r=e.gaol,t=e.editor,n=e.language,o=ve.getHandler(t),u=o||function(n,o,u,i){var e=fa.spelling(o),t=oa(e+"correct",e+"correction",ia.get(n)),c=gt.create({failed:dt(["resource"])}),a=gi.nu(function(n){t.checkMany(u,["startup"]).get(n)});a.get(function(n){n.fold(function(n){_.console.error("Unable to communicate with the spelling service:",ua.consoleMessage(n)),c.trigger.failed(o)},w)});var r=function(t,r){return hi.nu(function(e){a.get(function(n){n.fold(function(){return e(n)},function(){r(i?t:u).get(function(n){e(n),n.fold(function(n){_.console.error("Error response from the spelling service:",ua.consoleMessage(n)),c.trigger.failed(o)},w)})})})})};return{check:function(e,n){return r(n,function(n){return t.checkMany(n,e)})},correction:function(e,n){return r(n,function(n){return t.correctOne(n,e)})},correctionMany:function(e,n){return r(n,function(n){return t.correctMany(n,e)})},events:c.registry,state:function(){return t.dumpCache()}}}(t,e.url,n,e.multilingual),i=gt.create({failed:dt(["resource"])});u.events.failed.bind(function(n){i.trigger.failed(n.resource())});var c=ei(n,e.viewable.viewport),a=Si(t,e.cache,u,ve.getWhitelist(t)),f=function(){return!Wi.isOn(r.spelling().get())},s=function(){var n,e;n="mce-spellchecker-word",e=t.dom.select("span."+n),B(e,function(n){!function(n){var e=n.parentNode,t=n.childNodes;if(e){for(;0<t.length;)e.insertBefore(t[0],n);e.removeChild(n)}}(n)})};return e.editor.on("remove",function(){c.destroy()}),{run:function(n,e){var t=r.spelling().get();Wi.isOn(t)&&(c.setLang(t),c.run(n,a.local,e),c.schedule(n,a.remote,e,f))},fetch:a.fetch,check:function(n,e,t){c.setLang(r.nonOffSpelling()),c.run(n,a.check,e,t)},refresh:function(){var n=r.spelling().get();Wi.isOn(n)&&e.asYouType||s()},clear:s,state:u.state,events:i.registry}}var la=function(){var n=!1;return{isBlocked:function(){return n},block:function(){n=!0},unblock:function(){n=!1}}},da=function(n,e){return{control:n,instance:e}},ga={tap:function(t){var r=la();return da(r,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];r.isBlocked()||t.apply(null,n)})}},pa=function(n,e,t,r){var o=ce(n,t)&&e===r;return{startContainer:b(n),startOffset:b(e),endContainer:b(t),endOffset:b(r),collapsed:b(o)}},ma={isSpace:function(n){return 32===(n.which||n.keyCode)},isEnter:function(n){return 13===(n.which||n.keyCode)}};function ha(r){var o=gt.create({lookup:dt(["element"])}),e=function(){var n,e;n=function(n){o.trigger.lookup(n.startContainer())},e=r.selection.getRng(),n(pa(on.fromDom(e.startContainer),e.startOffset,on.fromDom(e.endContainer),e.endOffset))},n=function(n){ma.isSpace(n)&&e()};return r.on("keyup",n),r.on("remove",function(){r.off("keyup",n)}),r.on("init",function(){var t=on.fromDom(r.getBody()),n=function(n){if(!n.selectionChange){var e=on.fromDom(n.element);ce(t,e)||(o.trigger.lookup(t),t=e)}};r.on("nodechange",n),r.on("remove",function(){r.off("nodechange",n)})}),{events:o.registry}}var va=te().browser.isFirefox(),ya=function(n){return n.filter(function(n){return"img"===pn(n)})},wa=function(n){return wn(n)&&0===et(n).length},ba=function(u){var n,i=ya(je(u.startContainer(),u.startOffset()));return(n=u,ya(Le(n.startContainer()))).orThunk(function(){return i}).bind(function(o){return(n=u,ya(Re(n.endContainer()))).bind(function(n){var e=ce(o,n),t=u.startContainer().dom().length===u.startOffset(),r=0===u.endOffset();return e&&(t||i.isSome())&&r?N.some(o):N.none()});var n})},ka=function(n){return n.filter(function(n){return!n.collapsed()}).bind(function(n){return function(n){var e=n.startContainer();if(!ce(e,n.endContainer()))return N.none();if("img"===pn(e))return N.some(e);var t=Math.min(n.startOffset(),n.endOffset()),r=Math.max(n.startOffset(),n.endOffset()),o=ya(je(e,t));return r===t||r===t+1?o:va&&r===t+2?o.filter(function(n){return Le(n).filter(wa).isSome()}):N.none()}(n).orThunk(function(){return ba(n)})})},xa=Oe("image"),Ta={detect:function(n){return ka(n).map(xa)}},Oa=function(r,o,u){if(0===o.length)throw new Error("You must specify at least one required field.");return Ce("required",o),Ie(o),function(e){var t=Y(e);H(o,function(n){return M(t,n)})||_e(o,t),r(o,t);var n=F(o,function(n){return!u.validate(e[n],n)});return 0<n.length&&function(n,e){throw new Error("All values need to be of type: "+e+". Keys ("+Ee(n).join(", ")+") were not.")}(n,u.label),e}},Ea=function(e,n){var t=F(n,function(n){return!M(e,n)});0<t.length&&Se(t)},_a=Oe("ch","offset"),Sa=function(n,e){return _a(n.charAt(e),e)},Ca=function(n,e){for(var t=e.getOr(n.length)-1;0<=t;t--)if(n.charAt(t)!==Bt)return N.some(Sa(n,t));return N.none()},Ia=function(n,e){for(var t=e.getOr(0)+1;t<n.length;t++)if(n.charAt(t)!==Bt)return N.some(Sa(n,t));return N.none()},Na=function(n,e){e.lastIndex=-1;var t=J(n).join(""),r=t.match(e);return null!=r&&void 0!==r.index&&0<=r.index?N.some(t.length-1-r.index):N.none()},Aa=function(n,e){e.lastIndex=-1;var t=n.match(e);return null!=t&&void 0!==t.index&&0<=t.index?N.some(t.index):N.none()},Da=function(n,e){return M(["br","img","hr","input"],n.property().name(e))},Ra=Da,La=Sr().left(),Ma=Sr().right(),ja=ht([{abort:[]},{kontinue:[]},{finish:["info"]}]),Pa=ht([{aborted:[]},{edge:["element"]},{success:["info"]}]),Ba=function(n,e){return Ra(n,e)||n.property().isBoundary(e)},Fa=function(t,n,r,e,o,u,i){var c=function(){return i.fold(Pa.aborted,Pa.edge)},a=function(e){return Cr(t,n,r,u).fold(c,function(n){return Fa(t,n.item(),n.mode(),N.none(),o,u,e)})};if(Ba(t,n))return c();if(t.property().isText(n)){var f=t.property().getText(n);return o(t,ja,n,f,e).fold(c,function(){return a(N.some(n))},Pa.success)}return a(i)},za=function(e,n,t,r){var o,u,i,c,a=ft(e,n,t);return e.property().isText(n)?N.none():(o=e,u=a.element(),i=e.property().isText,c=r,Or(o,u,i,wr,Tr.left(),c)).map(function(n){return ut(n,e.property().getText(n).length)})},Wa=function(o,u,i){var c=function(n){return Ba(o,n)};return za(o,u,i,c).orThunk(function(){return t=c,r=ft(n=o,e=u,i),n.property().isText(e)?N.none():Er(n,r.element(),n.property().isText,t).map(function(n){return ut(n,0)});var n,e,t,r}).getOr(ut(u,i))},qa=function(n,e,t,r){var o=Wa(n,e,t);return Fa(n,o.element(),wr,N.some(o.offset()),r,La,N.none())},Ua=function(n,e,t,r){var o=Wa(n,e,t);return Fa(n,o.element(),wr,N.some(o.offset()),r,Ma,N.none())},Va=Oa(Ea,["regex","attempt"],{validate:f,label:"function"}),Ha=qa,Ja=Ua,Ka=function(e,n,t){var r=b(!1);if(!e.property().isText(n))return N.none();var o=e.property().getText(n);return t<=o.length?N.some(ut(n,t)):_r(e,n,e.property().isText,r).bind(function(n){return Ka(e,n,t-o.length)})},Ya={previousChar:Ca,nextChar:Ia,repeatLeft:Ha,repeatRight:Ja,expandLeft:function(n,e,t,r){var i=Va(r);return Ha(n,e,t,function(n,e,t,r,o){var u=o.getOr(r.length);return Na(r.substring(0,u),i.regex()).fold(function(){return e.kontinue()},function(n){return i.attempt(e,t,r,n)})})},expandRight:function(n,e,t,r){var i=Va(r);return Ja(n,e,t,function(n,e,t,r,o){var u=o.getOr(0);return Aa(r.substring(u),i.regex()).fold(function(){return e.kontinue()},function(n){return i.attempt(e,t,r,u+n)})})},scanRight:Ka},Xa=ot(),$a=function(n,e){return Ya.scanRight(Xa,n,e)},Ga=function(n,e){var t=ut(n,e);return wn(n)?$a(n,e).getOr(t):t},Qa={handle:function(n){var e=Ga(n.startContainer(),n.startOffset()),t=Ga(n.endContainer(),n.endOffset());return pa(e.element(),e.offset(),t.element(),t.offset())}},Za=te().browser,nf=function(n){return Ct(n.endContainer(),n.endOffset(),n.startContainer(),n.startOffset())},ef=function(n){var e,t,r,o=(e=n.startContainer(),t=n.startOffset(),r=Me(e),0<r.length&&t<r.length?Be(r[t],0):Be(e,t)).element();return yn(o)&&"false"===xn(o,"contenteditable")&&ce(n.startContainer(),n.endContainer())&&n.startOffset()===n.endOffset()-1},tf=function(n){return wn(n)||"br"===pn(n)};function rf(c){var a=function(){var n=c.selection.getRng(),e=on.fromDom(n.startContainer),t=on.fromDom(n.endContainer);return pa(e,n.startOffset,t,n.endOffset)},u=function(n,e){var t,r,o=n(),u=Qa.handle(e),i=a();return(!ce(i.startContainer(),u.startContainer())||!ce(i.endContainer(),u.endContainer())||i.startOffset()!==u.startOffset()||i.endOffset()!==u.endOffset())&&(t=u,(r=c.dom.createRng()).setStart(t.startContainer().dom(),t.startOffset()),r.setEnd(t.endContainer().dom(),t.endOffset()),c.selection.setRng(r)),o},o=function(n,e){var t,r,o;return tf(e.startContainer())&&tf(e.endContainer())||Ta.detect(N.some(e)).isSome()?u(n,e):(t=n,r=c.selection.getBookmark(),o=t(),c.selection.moveToBookmark(r),o)};return{transaction:function(n){var e=a(),t=e.collapsed()||!Za.isIE()||nf(e),r=function(n,e){if(!e||Za.isFirefox()||ef(n))return n;var t=lt(n.endContainer(),n.endOffset()),r=lt(n.startContainer(),n.startOffset());return pa(r.element(),r.offset(),t.element(),t.offset())}(e,t);return(t?o:x)(n,r)}}}function of(o,t,r,n,e){var u,i,c,a,f,s,l=_t(o,e),d=sa({editor:o,gaol:n,viewable:l,cache:r,url:t,language:n.spelling().get(),multilingual:!0,asYouType:e}),g=(u=o,i=d,c=e,a=ga.tap(function(n){var e=n.element();if(c){var t=Nt.single(e);s(t)}}),f=rf(u),s=function(n){i.run(f.transaction,n)},c&&ha(u).events.lookup.bind(function(n){a.instance(n)}),{scan:s,check:function(n,e){i.check(f.transaction,n,e)},lock:function(n){var e=a.control.isBlocked();a.control.block(),n(),e||a.control.unblock()}}),p=gt.create({analytics:dt(["message"])});d.events.failed.bind(function(n){var e=o.translate(["The spelling service was not found: ({0})",t]);St.fireError(o,{message:e}),_.console.error(e)}),o.on("init",function(){var n=o.getBody(),e=on.fromDom(n);kn(e,"spellcheck",!1),d.refresh()}),o.on("remove",function(){var n=o.getBody(),e=on.fromDom(n);Tn(e,"spellcheck"),r.destroy()});var m=function(n,e,t,r){var o=Yu.isWrap(n)?lt(n,e):ut(n,e),u=Yu.isWrap(t)?lt(t,r):ut(t,r);return Nt.range(o.element(),o.offset(),u.element(),u.offset())},h=function(n){var e=n[0],t=n[n.length-1],r=Pe(t);return m(e,0,t,r)},v=function(){var n=l.sections();if(0<n.length){var e=h(n);g.scan(e)}};l.events.onChange.bind(v);var y=d.clear;return{events:function(){return p.registry},scanView:v,scanRange:function(n,e,t,r){(0,g.scan)(m(n,e,t,r))},fetch:d.fetch,checkDocument:function(n){var e=on.fromDom(o.getBody()),t=Me(e);if(0<t.length){var r=h(t);g.check(r,n)}},lock:function(n){return g.lock(n)},clear:y}}var uf=function(n){return"img"===pn(n)?1:(e=n,nt.getOption(e)).fold(function(){return Me(n).length},function(n){return n.length});var e},cf=function(n,t){return Ju.marker(n).bind(Ju.detail).map(function(n){var e=t.suggestions(n.lang(),n.word());return{detail:n,suggestions:e}})},af=function(t,n,e){t.undoManager.transact(function(){Ju.substitute(n,e).each(function(n){var e=uf(n);t.selection.setCursorLocation(n.dom(),e),t.focus()})})},ff=cf,sf=function(n,e,t){n.undoManager.transact(function(){Ju.ignore(e)}),St.fireIgnore(n,t)},lf=function(n,e,t,r,o){o.ignore(r,t),Ju.ignoreAll(e),St.fireIgnoreAll(n,t)},df=function(n,e,t,r,o){var u=4<r.length?o.getSubstituteItemsOverMax(n,r,4):o.getSubstituteItems(n,r),i=[o.getSeparator(),o.getIgnoreItem(n,t),o.getIgnoreAllItem(n,t,e)];return u.concat(i)},gf=function(n,e,t){void 0===t&&(t=100);var r,o=n.length>t?t:n.length,u=n.slice(0,o),i=function(n){for(var e=[],t=function(n){e.push(n)},r=0;r<n.length;r++)n[r].each(t);return e}(P(u,function(n){return cf(n,e)}));return r={},B(i,function(n){r[n.detail.word()]=n}),nn(r)},pf=function(n){var e,t=Ju.allMarkers(n);return(e=t,0===e.length?N.none():N.some(e[0])).bind(Ju.detail)},mf=function(n){return Ju.allMarkers(n)},hf=function(t,e,u,i,r){var o=function(n){var e=Wi.isOn(n);(e?u.scanView:u.clear)(),(e?St.fireSpellcheckStart:St.fireSpellcheckEnd)(t)},c=function(e,n,t,r){var o=function(){r<3?c(e,n,t,r+1):n()};u.fetch(e).get(function(n){0<n.values.length?cf(e[0].detail.element(),i).fold(function(){o()},function(n){n.suggestions.fold(function(){o()},function(n){t(n)})}):o()})};return{changeLanguage:function(n){e.spelling().setAndCache(t,n),r&&o(n)},toggleLanguage:function(){var n=Wi.isOn(e.spelling().get())?Wi.offKey():e.nonOffSpelling();e.spelling().setAndCache(t,n),o(n)},getWordsAsync:function(n){u.checkDocument(n)},getWordsSuggestionsAsync:c}},vf=function(r,o){var a=function(n,e){return{text:e,onAction:function(){af(r,n,e)}}},u={getSubstituteItemsOverMax:function(e,n,t){var r=n.slice(0,t),o=n.slice(t),u=P(r,function(n){return a(e,n)}),i=P(o,function(n){return a(e,n)}),c={type:"submenu",text:"More...",getSubmenuItems:function(){return i}};return u.concat([c])},getSubstituteItems:function(e,n){return P(n,function(n){return a(e,n)})},getSeparator:function(){return{type:"separator"}},getIgnoreItem:function(n,e){return{text:"Ignore",onAction:function(){sf(r,n,e)}}},getIgnoreAllItem:function(n,e,t){return{text:"Ignore all",onAction:function(){lf(r,n,e,t,o)}}}};r.ui.registry.addContextMenu("spellchecker",{update:function(n){var t,e=on.fromDom(n);return ff(t=e,o).bind(function(e){return e.suggestions.map(function(n){return df(t,e.detail.lang(),e.detail.word(),n,u)})}).getOr([])}})},yf="SpellcheckStart SpellcheckEnd",wf=function(o,n,t,r,e){var u=P(n,function(n){return _n(_n({},n),{type:"choiceitem"})}),i={tooltip:"Spellcheck...",icon:"spell-check",onAction:function(){o.execCommand("mceSpellcheckDocument")}},c={tooltip:"Spellcheck...",icon:"spell-check",onAction:function(){o.execCommand("mceSpellcheckDocument")},select:function(n){return n===t.spelling().get()},fetch:function(n){n(u)},onItemAction:function(n,e){r.changeLanguage(e)}},a={tooltip:"Spellcheck",icon:"spell-check",onAction:r.toggleLanguage,onSetup:function(n){var e=function(){n.setActive(Wi.isOn(t.spelling().get()))};return e(),o.on(yf,e),function(){return o.off(yf,e)}},select:function(n){return n===t.spelling().get()},fetch:function(n){n(u)},onItemAction:function(n,e){r.changeLanguage(e)}},f={text:"Spellcheck...",icon:"spell-check",onAction:function(){o.execCommand("mceSpellcheckDocument")}};e?(o.ui.registry.addSplitButton("spellchecker",a),o.ui.registry.addToggleMenuItem("spellchecker",{text:"Spellcheck",icon:"spell-check",onAction:r.toggleLanguage,onSetup:function(n){var e=function(){return n.setActive(Wi.isOn(t.spelling().get()))};return e(),o.on(yf,e),function(){return o.off(yf,e)}}}),o.ui.registry.addButton("spellcheckdialog",i),o.ui.registry.addMenuItem("spellcheckdialog",f)):(o.ui.registry.addSplitButton("spellchecker",c),o.ui.registry.addMenuItem("spellchecker",f));var s,l,d,g=function(n){return{type:"togglemenuitem",text:n.text,onAction:function(){return r.changeLanguage(n.value)},active:n.value===t.spelling().get()}};if(o.ui.registry.addNestedMenuItem("spellcheckerlanguage",{text:"Spellcheck Language",getSubmenuItems:function(){return P(u,g)}}),l=tinymce,d="5.0.3",l&&1===v(y(l),h(d))){var p=ve.getSelectContentLanguages(o),m=(s={},B(p.split(","),function(n){n=n.toLowerCase(),s[n]=tn(ge,n)?ge[n]:n.toUpperCase()}),s);o.ui.registry.addMenuButton("language",{tooltip:"Language",icon:"translate",fetch:function(n){var e,t,r=(e=o,t=m,de(on.fromDom(e.selection.getNode()),"[lang]").map(function(n){var e=xn(n,"lang").toLowerCase();return tn(t,e)||(t[e]=tn(ge,e)?ge[e]:e.toUpperCase()),e}));n(Z(m,function(n,t){return{type:"togglemenuitem",value:t,text:n,onSetup:function(n){return r.is(t)&&n.setActive(!0),w},onAction:function(){var n,e;e=t,(n=o).formatter.has("powerspell_language_select")||n.formatter.register("powerspell_language_select",{inline:"span",attributes:{lang:"%value"}}),n.undoManager.transact(function(){n.focus(),n.formatter.toggle("powerspell_language_select",{value:e}),n.nodeChanged()})}}}))},onSetup:function(t){var n=function(n){var e;t.setActive((e=n.parents,j(e,function(n){return""!==n.lang})))};return o.on("NodeChange",n),function(){o.off("NodeChange",n)}}})}},bf=function(n,e){n.addCommand("mceSpellcheckDocument",e.open)},kf=function(t,r,n,e,o){return{title:"Spellcheck",body:{type:"panel",items:[{type:"input",name:"textlabel",label:"Misspelled word"},{type:"selectbox",name:"suggestions",label:"Suggestions",size:6,items:P(n,function(n){return{text:n,value:n}})}]},initialData:{textlabel:r,suggestions:0<n.length?n[0]:""},onClose:function(){t.close()},onAction:function(n,e){switch(e.name){case"change":t.replace(n,r);break;case"ignore":t.ignore(n);break;case"ignoreall":t.ignoreAll(n)}n.focus("textlabel")},buttons:[{type:"custom",primary:!0,name:"change",text:"Change"},{type:"custom",name:"ignore",text:"Ignore"},{type:"custom",name:"ignoreall",text:"Ignore all"},{type:"cancel",text:"Close"}]}},xf=function(i,u,n,e,o){var c=function(){var n=i.translate("No misspellings found.");i.notificationManager.open({text:n,type:"info",timeout:3e3})},a=function(n,e,t,r){n.redial(kf(d,e,t))},f=function(e,n){e.block("Finding word suggestions");var t=gf(n,u),r=F(t,function(n){return n.suggestions.isNone()});o.getWordsSuggestionsAsync(r,function(){e.unblock()},function(n){a(e,t[0].detail.word(),n,t[0].detail),e.unblock()},0)},s=function(n){var e=gf(n,u);if(0<F(e,function(n){return n.suggestions.isNone()}).length){o.getWordsSuggestionsAsync(e,function(){},function(n){},0)}},l=function(n){var t,r,e=mf(i);0<e.length?(t=n,ff((r=e)[0],u).each(function(e){e.suggestions.fold(function(){f(t,r)},function(n){a(t,e.detail.word(),n,e.detail),s(r)})})):(c(),n.close())},d={replace:function(n,e){var t=n.getData(),r=t.textlabel,o=t.suggestions,u=r===e?o:r;pf(i).each(function(n){af(i,n.element(),u)}),l(n)},ignore:function(n){pf(i).each(function(n){sf(i,n.element(),n.word())}),l(n)},ignoreAll:function(n){pf(i).each(function(n){lf(i,n.element(),n.word(),n.lang(),u)}),l(n)},close:function(){e||n.clear()}},t=function(o){var n=o[0];ff(n,u).each(function(r){r.suggestions.fold(function(){var n,e,t=(n=r.detail.word(),e=[],r.detail,i.windowManager.open(kf(d,n,e)));f(t,o)},function(n){var e,t;e=r.detail.word(),t=n,r.detail,i.windowManager.open(kf(d,e,t)),s(o)})})},r={open:function(){o.getWordsAsync(function(){var n=mf(i);0<n.length?t(n):c()})}};return bf(i,r),r},Tf=tinymce.dom.DOMUtils,Of=function(i,r){var o=function(r,n){return P(n,function(n){return e=r,{text:t=n,onclick:function(){af(i,e,t)}};var e,t})},u={getSubstituteItemsOverMax:function(n,e,t){var r=e.slice(0,t);return o(n,r)},getSubstituteItems:o,getSeparator:function(){return{text:"-"}},getIgnoreItem:function(n,e){return{text:"Ignore",onclick:function(){sf(i,n,e)}}},getIgnoreAllItem:function(n,e,t){return{text:"Ignore all",onclick:function(){lf(i,n,e,t,r)}}}},c=function(n){var t;return ff(t=n,r).bind(function(e){return e.suggestions.map(function(n){return df(t,e.detail.lang(),e.detail.word(),n,u)})}).getOr([])};i.on("contextmenu",function(n){var e=on.fromDom(n.target),t=c(e);0<t.length&&(n.preventDefault(),n.stopImmediatePropagation(),function(n,e){var t=tinymce.ui.Factory.create("menu",{items:e,context:"contextmenu",onautohide:function(n){-1!==n.target.className.indexOf("spellchecker")&&n.preventDefault()},onhide:function(){t.remove()}});t.renderTo(_.document.body);var r=Tf.DOM.getPos(i.getContentAreaContainer()),o=i.dom.getPos(n.dom()),u=i.dom.getRoot();"BODY"===u.nodeName?(o.x-=u.ownerDocument.documentElement.scrollLeft||u.scrollLeft,o.y-=u.ownerDocument.documentElement.scrollTop||u.scrollTop):(o.x-=u.scrollLeft,o.y-=u.scrollTop),r.x+=o.x,r.y+=o.y,t.moveTo(r.x,r.y+n.dom().offsetHeight)}(e,t))},!0)},Ef="SpellcheckStart SpellcheckEnd",_f=function(c,u,n,e,o){var t,r=function(){var n=c.translate("No misspellings found.");c.notificationManager.open({text:n,type:"info",timeout:3e3})},i=(t=Sn(N.none()),{clear:function(){t.set(N.none())},set:function(n){t.set(N.some(n))},isSet:function(){return t.get().isSome()},on:function(n){t.get().each(n)}}),a=function(t,r){i.on(function(n){n.find("#text")[0].value(t);var e=n.find("#suggestions")[0];e.options(r),e.getEl().selectedIndex=0,e.getEl().focus()})},f=function(n){var e=n.find("#text")[0],t=n.find("#change")[0],r=n.find("#ignore")[0],o=n.find("#ignoreall")[0];e.disabled(!1),t.disabled(!1),r.disabled(!1),o.disabled(!1)},s=function(n){i.on(function(n){var e,t,r,o,u,i;t=(e=n).find("#text")[0],r=e.find("#suggestions")[0],o=e.find("#change")[0],u=e.find("#ignore")[0],i=e.find("#ignoreall")[0],t.value("Finding word suggestions"),t.disabled(!0),r.options([]),o.disabled(!0),u.disabled(!0),i.disabled(!0)});var e=gf(n,u),t=F(e,function(n){return n.suggestions.isNone()});o.getWordsSuggestionsAsync(t,function(){i.on(function(n){f(n)})},function(n){i.on(function(n){f(n)}),a(t[0].detail.word(),n)},0)},l=function(n){var e=gf(n,u);if(0<F(e,function(n){return n.suggestions.isNone()}).length){var t=w,r=w;o.getWordsSuggestionsAsync(e,r,t,0)}},d=function(n){var t,e=mf(c);0<e.length?ff((t=e)[0],u).each(function(e){e.suggestions.fold(function(){s(t)},function(n){a(e.detail.word(),n),l(t)})}):(r(),n.close())},g=function(n){i.on(function(i){pf(c).each(function(n){var e=i.find("#text")[0],t=i.find("#suggestions")[0],r=e.value(),o=t.getEl().value,u=r===n.word()?o:r;af(c,n.element(),u),d(i)})})},p={change:g,submit:g,ignore:function(n){i.on(function(n){pf(c).each(function(n){sf(c,n.element(),n.word())}),d(n)})},ignoreall:function(n){i.on(function(n){pf(c).each(function(n){lf(c,n.element(),n.word(),n.lang(),u)}),d(n)})},close:function(n){i.on(function(n){n.close()})},cleanUp:function(){e||n.clear(),i.clear()}},m=function(n,e){return c.windowManager.open({layout:"flex",align:"stretch",direction:"column",title:"Spellcheck",spacing:10,padding:10,callbacks:t=p,minWidth:350,items:[{type:"label",name:"textlabel",text:"Misspelled word"},{type:"textbox",name:"text",ariaLabel:"Misspelled word",spellcheck:!1,value:n},{type:"label",name:"suggestionslabel",text:"Suggestions"},{type:"container",layout:"flex",direction:"row",align:"stretch",spacing:10,items:[{type:"selectbox",name:"suggestions",ariaLabel:"Suggestion",minWidth:150,flex:1,size:6,border:1,options:e},{type:"container",layout:"flex",flex:1,spacing:5,direction:"column",pack:"center",align:"stretch",items:[{type:"button",subtype:"primary",name:"change",text:"Change",onclick:"change"},{type:"button",name:"ignore",text:"Ignore",onclick:"ignore"},{type:"button",name:"ignoreall",text:"Ignore all",onclick:"ignoreall"}]}]}],onsubmit:function(n){n.preventDefault(),t.replace()},onclose:function(n){t.cleanUp()},buttons:[{text:"Close",onclick:"close"}]});var t},h={open:function(){o.getWordsAsync(function(){var o,n,e=mf(c);0<e.length?(n=(o=e)[0],ff(n,u).each(function(r){r.suggestions.fold(function(){var n=m(r.detail.word(),[]);i.set(n),s(o)},function(n){var e=m(r.detail.word(),n),t=e.find("#suggestions")[0];t.options(n),t.getEl().selectedIndex=0,t.getEl().focus(),i.set(e),l(o)})})):r()})}};return bf(c,h),h},Sf=Oe("suggestions","ignore"),Cf=function(n){return function(n){void 0===n&&(n={});var r={},o=function(n){return r.hasOwnProperty(n)&&void 0!==r[n]?r[n]:{}},e=function(n,e){var t=o(n);e(t),r[n]=t},u=function(n,e){return e(o(n))},i=function(n,r,o){e(n,function(n){var e=ai(r);if(!tn(n,e)||n[e].suggestions().isNone()){var t=0<o.length?N.some(o):N.none();n[e]=Sf(t,!1)}})},c=function(n,u){e(n,function(n){var e=ai(u),t=n.hasOwnProperty(e)?n[e]:void 0,r=void 0!==t?t.suggestions():N.none(),o=Sf(r,!0);n[e]=o})};$(n,function(n,t){$(n,function(n,e){!0===n.ignore&&c(t,e),void 0!==n.suggestions&&i(t,e,n.suggestions)})});return{add:i,get:function(n,t){return u(n,function(n){var e=ai(t);return n.hasOwnProperty(e)?N.from(n[e]):N.none()})},ignore:c,suggestions:function(n,t){return u(n,function(n){var e=ai(t);return(n.hasOwnProperty(e)?N.from(n[e]):N.none()).bind(function(n){return n.ignore()?N.none():n.suggestions()})})},state:function(){return G(r,function(n,e){return G(n,function(n,e){return{ignore:n.ignore(),suggestions:n.suggestions().getOr([])}})})},destroy:function(){r={}}}}(n)},If=function(){try{var n=sn.localStorage,e="__storage_test__";return n.setItem(e,e),n.removeItem(e),N.some(n)}catch(n){return N.none()}}().fold(function(){var t={};return{getItem:function(n){return t[n]},setItem:function(n,e){t[n]=e}}},function(t){return{getItem:function(n){return t.getItem("mce."+n)},setItem:function(n,e){t.setItem("mce."+n,e)}}}),Nf=function(n,e){var t;return(t=n,N.from(If.getItem(t))).map(JSON.parse).getOr(e)},Af=function(n){return Nf(n,{})},Df=function(n,e){var t=JSON.stringify(e);If.setItem(n,t)},Rf={read:Af,readOr:Nf,write:Df,access:function(n){return{read:l(Af,n),write:l(Df,n)}}};tinymce.PluginManager.requireLangPack("tinymcespellchecker","ar,bg_BG,ca,cs,da,de,el,es,eu,fa,fi,fr_FR,he_IL,hr,hu_HU,id,it,ja,kk,ko_KR,nb_NO,nl,pl,pt_BR,pt_PT,ro,ru,sk,sl_SI,sv_SE,th_TH,tr,uk,zh_CN,zh_TW"),tinymce.PluginManager.add("tinymcespellchecker",function(n,e){if(S(tinymce,"4.2.8"))return _.console.error('The "tinymcespellchecker" plugin requires at least version 4.2.8 of TinyMCE.'),function(){};var t,r,o,u,i,c,a,f=ve.getLanguage(n),s=ve.getRpcUrl(n),l=Cf({}),d=(t=f,r=Rf.readOr("spelling",t),o=Sn(r),u=Sn("no.language"===r?"en_us":r),i=o.set,c=o.get,a={setAndCache:function(n,e){ve.setLanguage(n,e),i(e),Rf.write("spelling",e),Wi.isOn(e)&&u.set(e)},set:i,get:c},{spelling:function(){return a},nonOffSpelling:u.get});ve.isActive(n)||"no.language"===d.spelling().get()||d.spelling().set("no.language");var g,p,m,h,v,y,w,b,k,x=ve.getLanguages(n),T=!ve.useDialog(n),O=of(n,s,l,d,T),E=hf(n,d,O,l,T);S(tinymce,"5.0.0")?(Of(n,l),g=n,p=d,m=E,h=T,v=P(x,function(n){return{selectable:!0,text:n.text,data:n.value,onclick:function(){m.changeLanguage(n.value)}}}),w={icon:"spellchecker",type:"splitbutton",tooltip:"Spellcheck...",menu:v,onclick:function(){g.execCommand("mceSpellcheckDocument")},onshow:y=function(n){var e=p.spelling().get();B(n.control.items(),function(n){n.active(n.data.data===e)})}},b={type:"splitbutton",tooltip:"Spellcheck",menu:v,onclick:m.toggleLanguage,onPostRender:function(n){var e=function(){n.control.active(Wi.isOn(p.spelling().get()))};e(),g.on(Ef,e)},onshow:y},k={text:"Spellcheck...",context:"tools",onclick:function(){g.execCommand("mceSpellcheckDocument")}},h?(g.addButton("spellchecker",b),g.addMenuItem("spellchecker",{text:"Spellcheck",context:"tools",onclick:m.toggleLanguage,onPostRender:function(n){var e=function(){return n.control.active(Wi.isOn(p.spelling().get()))};e(),g.on(Ef,e)},selectable:!0}),g.addButton("spellcheckdialog",w),g.addMenuItem("spellcheckdialog",k)):(g.addButton("spellchecker",w),g.addMenuItem("spellchecker",k)),g.addMenuItem("spellcheckerlanguage",{text:"Spellcheck Language",context:"tools",menu:v,onPostRender:function(n){n.control.on("show",function(n){y(n)})}}),_f(n,l,O,T,E)):(vf(n,l),wf(n,x,d,E,T),xf(n,l,O,T,E))})}(window);