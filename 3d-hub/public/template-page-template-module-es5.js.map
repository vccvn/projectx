{"version":3,"sources":["webpack:///src/app/template-page/_store/data.ts","webpack:///src/app/template-page/header/header.component.ts","webpack:///src/app/template-page/header/header.component.html","webpack:///src/app/template-page/list/list.component.ts","webpack:///src/app/template-page/list/list.component.html","webpack:///src/app/template-page/_store/effects.ts","webpack:///src/app/_3D/services/template-editor.service.ts","webpack:///src/app/template-page/template.module.ts","webpack:///src/app/template-page/_store/reducers.ts","webpack:///src/app/template-page/workspace/workspace.component.ts","webpack:///src/app/template-page/workspace/workspace.component.html","webpack:///src/app/template-page/_store/index.ts","webpack:///src/app/template-page/_store/services.ts","webpack:///src/app/template-page/template-routing.module.ts","webpack:///src/app/_store/template/table.ts"],"names":["BlankData","id","name","category_id","description","thumbnail","status","renderer","params","antialias","alpha","shadowMap","enabled","outputEncoding","composer","shadow","pcss","scene","size","width","height","depth","floor","above","type","props","position","x","y","z","camera","fov","near","far","autofit","control","autoUpdateScene","maxDistance","minDistance","enableDamping","dampingFactor","enablePan","highPerformance","constraint","smoothZoom","zoomDampingFactor","smoothZoomSpeed","lights","data","color","intensity","secret_key","castShadow","mapSize","left","right","top","bottom","darkness","bias","radius","objects","meshes","HeaderComponent","storage","cd","clickSave","isVisible","percent","renderLoading","downloadUrl","downloadAvailable","mode","isInited","logo","link","subcribe","download_source_url","detectChanges","event","preventDefault","emit","onClickUndo","onClickRedo","save","ListComponent","activatedRoute","router","templateService","categoryService","itemService","elemRef","isLoading","app","urlPath","templates","defaultThumbnail","lockSidebar","workspaceKey","rand","assign","moduleKey","preload","isFocus","editorMode","getAll","subscribe","rs","length","itemTable","get","setTimeout","map","item","r","first","insert","templateTable","effects","TemplateEditorService","editorClass","engineClass","TemplateModule","forFeature","reducers","selectContainerState","WorkspaceComponent","editor","events","viewportService","toolbar","vectorControls","confirmService","geoService","panelModelService","panelLightService","editorToolbar","template","downloadBtn","target","href","download","engineEvent","e","tasks","hideLoading","showLoading","appinit","engine","setControlEngine","detachLight","appBeforeInit","on","subEventService","sub","s","setState","registerEventService","document","updateProps","updateTargetProps","show","doAction","action","onDetach","showLight","beforeinit","init","dropModelItem","activeEventServiceRegistered","value","saveView","saveCurrentCameraPosition","saveThumbnail","exportImage","deactiveEventServiceRegistered","off","hide","snapshot","paramMap","loadTemplate","setTemplateData","secret_id","lazyLoadTemplate","update","create","error","project","preData","complete","progress","setTemplate","unselect","capture","image","updateThumbnail","attr","el","click","open","d","key","close","closeAllPanel","updateLightDataAndScene","title","showDeleteConfirm","success","deleteLight","ed","getEditObjectData","obj","getObject","object","updateModelMeshMaterial","updateObjectSettingDataAndScene","model","createElement","setAttribute","body","appendChild","remove","showConfirm","content","dat","updateSceneSizeAndFloorAndGridNyChildren","sceneData","getRealSceneSize","tan","Math","ds","dz","updateCameraSetting","settings","custom","updateCanvasSize","services","ENTRIES_COMPONENTS","COMPONENTS","routes","path","children","component","TemplateRoutingModule","forChild","TemplateTableService","dbService","columns","autoIncrement","required","defVal"],"mappings":"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","file":"template-page-template-module-es5.js","sourcesContent":["import { AppData } from \"@app/_3D/store/data.type\";\r\n\r\nexport const BlankData: AppData = {\r\n    id: 1,\r\n    name: \"View 1\",\r\n    category_id: 2,\r\n    description: \"Đây là màn hình view\",\r\n    thumbnail: \"\",\r\n    status: \"published\",\r\n    renderer: {\r\n        params: {\r\n            antialias: true,\r\n            alpha: true\r\n        },\r\n        shadowMap: {\r\n            enabled: true\r\n        },\r\n        outputEncoding: \"{THREE.sRGBEncoding}\"\r\n    },\r\n    composer: {},\r\n    shadow: {\r\n        enabled: true,\r\n        pcss: false\r\n    },\r\n    scene: {\r\n        size: {\r\n            width: 4,\r\n            height: 4,\r\n            depth: 4\r\n        },\r\n        floor: {\r\n            enabled: true,\r\n            above: true,\r\n            params: {\r\n                type: \"plane\",\r\n                width: 4,\r\n                height: 4\r\n            },\r\n            props: {\r\n                position: {\r\n                    x:0,\r\n                    y: -0.2,\r\n                    z: 0\r\n                }\r\n            }\r\n        }\r\n    },\r\n    camera: {\r\n        fov: 45,\r\n        near: 0.001,\r\n        far: 1000,\r\n        position: {\r\n            x: 0,\r\n            y: 0.4,\r\n            z: 1.5\r\n        },\r\n        autofit: true\r\n\r\n    },\r\n    control: {\r\n        type: \"orbit\",\r\n        autoUpdateScene: true,\r\n        maxDistance: 1200,\r\n        minDistance: 0.001,\r\n        enableDamping: true,\r\n        dampingFactor: 0.1,\r\n        enablePan: false,\r\n        highPerformance: true,\r\n        constraint: {\r\n            smoothZoom: true,\r\n            zoomDampingFactor: 0.2,\r\n            smoothZoomSpeed: 5\r\n        }\r\n    },\r\n    lights: [\r\n        {\r\n            type: \"ambient\",\r\n            data: {\r\n                params: {\r\n                    color: \"#ffffff\",\r\n                    intensity: 0.5\r\n                }\r\n            },\r\n            secret_key: \"DUkWmYXqHLn30h8srtGc1fClZ5VBh7Vs\"\r\n        },\r\n        {\r\n            type: \"point\",\r\n            data: {\r\n                params: {\r\n                    color: \"#4444cc\",\r\n                    intensity: 0.3\r\n                },\r\n                props: {\r\n                    position: {\r\n                        x: 0,\r\n                        y: -10\r\n                    }\r\n                }\r\n            },\r\n            secret_key: \"QT2uvl11GYiE9lBJ31kWLN7uZ4LVUY5h\"\r\n        },\r\n        {\r\n            type: \"Directionallight\",\r\n            data: {\r\n                params: {\r\n                    color: \"#FFE0B5\",\r\n                    intensity: 0.4\r\n                },\r\n                props: {\r\n                    position: {\r\n                        x: 10,\r\n                        y: 10,\r\n                        z: 8\r\n                    },\r\n                    castShadow: true,\r\n                    shadow: {\r\n                        mapSize: {\r\n                            width: 4096,\r\n                            height: 4096\r\n                        },\r\n                        camera: {\r\n                            near: 0.1,\r\n                            far: 100,\r\n                            left: 10,\r\n                            right: -10,\r\n                            top: 10,\r\n                            bottom: -10\r\n                        },\r\n                        darkness: 0.1,\r\n                        bias: -0.0002,\r\n                        radius: 5\r\n                    }\r\n                }\r\n            },\r\n            secret_key: \"4SBlh9qasmkym2qVinqXZQmrE1wyPz4g\"\r\n        },\r\n        {\r\n            type: \"Directionallight\",\r\n            data: {\r\n                params: {\r\n                    color: \"#ffffff\",\r\n                    intensity: 0.4\r\n                },\r\n                props: {\r\n                    position: {\r\n                        x: -8.713868426053745,\r\n                        y: 2.1376221949126535,\r\n                        z: -1.994170574933185\r\n                    }\r\n                }\r\n            },\r\n            secret_key: \"FSFhrzuO3FGYgYwdNRfMIaTuF0vwNr53\"\r\n        },\r\n        {\r\n            secret_key: \"wnrnh6P4c3lYDTJDWv3MUOkjp1ds3eOF\",\r\n            type: \"Directionallight\",\r\n            data: {\r\n                params: {\r\n                    color: \"#b5ebff\",\r\n                    intensity: 0.28\r\n                },\r\n                props: {\r\n                    position: {\r\n                        x: 10,\r\n                        y: 10,\r\n                        z: -7\r\n                    },\r\n                    castShadow: true,\r\n                    shadow: {\r\n                        mapSize: {\r\n                            width: 4096,\r\n                            height: 4096\r\n                        },\r\n                        camera: {\r\n                            near: 0.1,\r\n                            far: 100,\r\n                            left: 10,\r\n                            right: -10,\r\n                            top: 10,\r\n                            bottom: -10\r\n                        },\r\n                        darkness: 0.1,\r\n                        bias: -0.0002,\r\n                        radius: 5\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    ],\r\n    objects: [\r\n\r\n    ],\r\n    meshes: [\r\n\r\n    ]\r\n    \r\n\r\n}","import { Component, ChangeDetectorRef, ElementRef, ViewChild, OnInit, Input, Output, EventEmitter } from '@angular/core';\r\nimport { AppEditorStorageService } from '@app/_3D/services/app-editor-storage.service';\r\nimport { getConfig } from '@app/_core/config';\r\nimport { BaseComponent } from '@app/_shared/components/base/base.component';\r\n\r\nimport { Subject, Observable } from 'rxjs';\r\n\r\n@Component({\r\n    selector: 'app-header',\r\n    templateUrl: './header.component.html',\r\n    styleUrls: ['./header.component.scss'],\r\n})\r\nexport class HeaderComponent extends BaseComponent implements OnInit {\r\n    @ViewChild('inputElement', { static: false }) inputElement?: ElementRef;\r\n\r\n    @Output() clickSave = new EventEmitter<any>();\r\n\r\n    renderData$: Observable<Blob>;\r\n    renderLoading$: Observable<boolean>;\r\n    isVisible = false;\r\n    data: any;\r\n    percent = 0;\r\n    renderLoading = true;\r\n\r\n    downloadUrl: string = 'javascript:void(0);';\r\n    downloadAvailable: boolean = false;\r\n\r\n\r\n\r\n    mode: string = 'list';\r\n\r\n    isInited: boolean = false;\r\n    \r\n    logo = getConfig('urls.logo_url');\r\n    link = getConfig('urls.logo_link');\r\n    \r\n    constructor(\r\n        private storage: AppEditorStorageService,\r\n        private cd: ChangeDetectorRef\r\n    ) {\r\n        super();\r\n    }\r\n\r\n    initOnce() {\r\n        this.storage.subcribe('template', (data) => {\r\n            if (data && data.download_source_url) {\r\n                this.downloadAvailable = true;\r\n                this.downloadUrl = data.download_source_url;\r\n            }\r\n        }, true);\r\n        this.storage.subcribe('editorMode', mode => {\r\n            this.mode = mode;\r\n            this.cd.detectChanges();\r\n        }, true);\r\n        // window['hdStorage'] = this.storage;\r\n\r\n    }\r\n\r\n    download(event: Event) {\r\n        if (!this.downloadAvailable) {\r\n            event.preventDefault();\r\n            return false;\r\n        }\r\n    }\r\n\r\n    save(event) {\r\n        // console.log(this.editor.data);\r\n        this.clickSave.emit(true);\r\n    }\r\n\r\n    handleOk(): void {\r\n        this.isVisible = false;\r\n    }\r\n\r\n    handleCancel(): void {\r\n        this.isVisible = false;\r\n    }\r\n\r\n    onClickUndo() {\r\n        // this.editor.historyManager.undo();\r\n    }\r\n    onClickRedo() {\r\n        // this.editor.historyManager.redo();\r\n    }\r\n}","<div class=\"group-first\">\r\n\t<a href=\"{link}\" target=\"_blank\">\r\n\t\t<img class=\"logo\" src=\"{{logo}}\" alt=\"Cretip logo\" />\r\n\t</a>\r\n\t\r\n\t<div class=\"group-center\">\r\n\t\t<button class=\"btn btn-ghost btn-icon\" nz-button nzType=\"text\" (click)=\"onClickUndo()\">\r\n\t\t\t<img src=\"/assets/icons/new-design/header/undo.svg\" />\r\n\t\t</button>\r\n\t\t<button class=\"btn btn-ghost btn-icon mr-auto\" nz-button nzType=\"text\" (click)=\"onClickRedo()\">\r\n\t\t\t<img src=\"/assets/icons/new-design/header/redo.svg\" />\r\n\t\t</button>\r\n\t\t<button class=\"btn btn-ghost btn-icon hidden invisble\" nz-button nzType=\"text\" (click)=\"save($event)\">\r\n\t\t\t<img src=\"/assets/icons/new-design/header/save.svg\" />\r\n\t\t\t<span>Save</span>\r\n\t\t</button>\r\n\t</div>\r\n\r\n\t\r\n</div>\r\n\r\n<div class=\"group-last\">\r\n\t<!-- <a class=\"btn btn-ghost btn-icon\" nz-button nzType=\"text\" style=\"margin-right: 32px\" href=\"{{downloadUrl}}\" (click)=\"download($event)\">\r\n\t\t<img src=\"/assets/icons/new-design/header/download.svg\" />\r\n\t\t<span>Download</span>\r\n\t\t\r\n\t</a> -->\r\n\t\r\n\t<button class=\"btn btn-primary btn-icon\" nz-button nzType=\"text\" (click)=\"save($event)\">\r\n\t\t<img src=\"/assets/icons/new-design/header/save.svg\" />\r\n\t\t<span>Save</span>\r\n\t</button>\r\n\r\n</div>","import { Component, NgZone, OnInit, ChangeDetectorRef, ViewEncapsulation, ElementRef, AfterViewInit, OnDestroy } from '@angular/core';\r\nimport { ActivatedRoute, Router, NavigationEnd } from '@angular/router';\r\nimport { TransparentBase64Image } from '@app/_3D/libs/three.libs';\r\nimport { AppEditorEventService } from '@app/_3D/services/app-editor-event.service';\r\nimport { AppEditorService } from '@app/_3D/services/app-editor.service';\r\nimport { assignValue, assignWithout, copyByList, inArray, isEmpty, Str } from '@app/_core/helpers/utils';\r\nimport { AppEditorStorageService } from '@app/_3D/services/app-editor-storage.service';\r\nimport { CategoryService } from '@app/_store/category';\r\nimport { ItemService, ItemTableService } from '@app/_store/item';\r\nimport { TemplateModel, TemplateService } from '@app/_store/template';\r\nimport { TemplateTableService } from '@app/_store/template/table';\r\nimport { BaseComponent } from '@app/_shared/components/base/base.component';\r\n\r\n\r\n@Component({\r\n    selector: 'app-root-template-list',\r\n    templateUrl: './list.component.html',\r\n    styleUrls: ['../../../styles/design/_index.scss', './list.component.scss'],\r\n    encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class ListComponent extends BaseComponent implements OnInit, AfterViewInit, OnDestroy {\r\n    isInited: boolean = false;\r\n    id: number = 0;\r\n    mode: string = 'list';\r\n    isLoading: boolean = true;\r\n    app: AppEditorService = null;\r\n    urlPath: string = null;\r\n    templates: TemplateModel[] = [];\r\n    defaultThumbnail: string = TransparentBase64Image;\r\n    lockSidebar: boolean = false;\r\n    subEventService: AppEditorEventService;\r\n    workspaceKey: string = Str.rand();\r\n    constructor(\r\n        public cd: ChangeDetectorRef,\r\n        public activatedRoute: ActivatedRoute,\r\n        public router: Router,\r\n        \r\n        private storage: AppEditorStorageService,\r\n\r\n        public templateService: TemplateService,\r\n        public categoryService: CategoryService,\r\n        public itemService: ItemService,\r\n        // public itemTable: ItemTableService,\r\n        // public templateTable: TemplateTableService,\r\n        private elemRef: ElementRef\r\n    ) {\r\n        super();\r\n        this.storage.assign('editorMode', this.mode, mode => this.mode = mode);\r\n        // window['templateList'] = this;\r\n    }\r\n    initOnce() {\r\n        this.moduleKey = this.workspaceKey;\r\n    }\r\n\r\n    onInit() {\r\n\r\n        this.moduleKey = this.workspaceKey;\r\n\r\n        this.preload();\r\n        this.cd.detectChanges();\r\n\r\n        // this.checkDemoData();\r\n\r\n        // this.router.events.subscribe((val) => {\r\n        //     // see also \r\n        //     // console.log(val instanceof NavigationEnd)\r\n\r\n        // });\r\n\r\n    }\r\n\r\n    onDestroy() {\r\n\r\n    }\r\n\r\n    preload() {\r\n        if (!this.isFocus) return;\r\n        this.storage.editorMode = 'list';\r\n        // let templates = this.templateTable.select('*', null, { id: 'DESC' });\r\n        \r\n        // if (templates.length) {\r\n        //     this.templates = templates as TemplateModel[];\r\n        //     this.isLoading = false;\r\n        // }\r\n        // else {\r\n            this.templateService.getAll({}).subscribe(rs => {\r\n                this.isLoading = false;\r\n                if (rs.data.length) {\r\n                    this.templates = rs.data;\r\n                    // rs.data.map(template => {\r\n                    //     const temp = this.templateTable.first({id:template.id});\r\n                    //     if (!(temp && !isEmpty(temp))) {\r\n                    //         this.templateTable.insert(assignWithout({}, temp, ['id']));\r\n                    //     }\r\n                    // })\r\n                }\r\n            }, () => this.isLoading = false);\r\n        // }\r\n    }\r\n\r\n    checkDemoDAta(){\r\n        if (!this.itemTable.get().length) {\r\n            setTimeout(() => {\r\n                if (!this.itemTable.get().length) {\r\n                    this.itemService.getAll({}).subscribe(rs => {\r\n                        if (rs.data && !this.itemTable.get().length) {\r\n                            rs.data.map(item => {\r\n                                var r = this.itemTable.first({ id: item.id });\r\n                                if (!(r && !isEmpty(r))) {\r\n                                    this.itemTable.insert(assignWithout({}, item, ['id']));\r\n                                }\r\n                            })\r\n                        }\r\n                    });\r\n                }\r\n            }, 100);\r\n        }\r\n\r\n        if (!this.templateTable.get().length) {\r\n            setTimeout(() => {\r\n                this.templateService.getAll({}).subscribe(rs => {\r\n                    if (rs.data) {\r\n                        rs.data.map(item => {\r\n                            var r = this.templateTable.first({ id: item.id });\r\n                            if (!(r && !isEmpty(r))) {\r\n                                this.templateTable.insert(assignWithout({}, item, ['id']));\r\n                            }\r\n                        })\r\n                    }\r\n                })\r\n            }, 100);\r\n        }\r\n    }\r\n\r\n    nzCollapsedChange(event) {\r\n        if (!this.isFocus) return;\r\n        // this.app.updateCanvasSize();\r\n    }\r\n\r\n\r\n    ngAfterViewInit(): void {\r\n        if (!this.isFocus) return;\r\n        // this.app.updateCanvasSize();\r\n    }\r\n\r\n}\r\n","<nz-layout>\r\n    <nz-header>\r\n        <app-header (clickSave)=\"clickSave($event)\"></app-header>\r\n    </nz-header>\r\n    <nz-content>\r\n        <ng-container *ngIf=\"isLoading; then loadingTemplate; else editorTemplate\"></ng-container>\r\n        <ng-template #loadingTemplate>\r\n            <div class=\"alert\">\r\n                <h3>Vui lòng chờ giây lát</h3>\r\n            </div>\r\n        </ng-template>\r\n        <ng-template #editorTemplate>\r\n            <ng-container *ngIf=\"mode=='notfound'; then notFoundTemplate; else editorTemplate\"></ng-container>\r\n            <ng-template #notFoundTemplate>\r\n                <div class=\"alert not-found\">\r\n                    template Not Found\r\n                </div>\r\n            </ng-template>\r\n            <ng-template #editorTemplate>\r\n                <div class=\"list-template\">\r\n                    <div class=\"list-header\">\r\n                        <h2>Danh sách template</h2>\r\n                    </div>\r\n                    <ng-container *ngIf=\"templates.length; then listTem; else emptyTem\"></ng-container>\r\n                    <ng-template #listTem>\r\n                        <div class=\"list container\" >\r\n                            <div class=\"template-item\" *ngFor=\"let template of templates\" >\r\n                                <div class=\"inner\">\r\n                                    <div class=\"thumbnail\">\r\n                                        <a href=\"/template/{{template.id}}/edit\">\r\n                                            <img src=\"{{template.thumbnail!=''?template.thumbnail:defaultThumbnail}}\" alt=\"{{template.name}}\">\r\n                                        </a>\r\n                                        \r\n                                    </div>\r\n                                    <div class=\"detail\">\r\n                                        <h3>\r\n                                            <a href=\"/template/{{template.id}}/edit\">\r\n                                                {{template.name}}\r\n                                            </a>\r\n                                        </h3>\r\n                                        <p>{{template.description}}</p>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                        </div>\r\n                    </ng-template>\r\n                    <ng-template #emptyTem>\r\n                        Không có template\r\n                    </ng-template>\r\n                    \r\n                    \r\n                </div>\r\n            </ng-template>\r\n\r\n        </ng-template>\r\n\r\n\r\n    </nz-content>\r\n</nz-layout>\r\n","// import { CollectionEffects } from './collection/effects';\r\n\r\nexport const effects: any[] = [\r\n  // CollectionEffects,\r\n  \r\n];\r\n","import { Injectable } from '@angular/core';\nimport ClientEditorEngine from '../engines/client-editor.engine';\nimport ProjectEditor from '../libs/project-editor';\nimport TemplateEditor from '../libs/template-editor';\nimport { AppEditorService } from './app-editor.service';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class TemplateEditorService extends AppEditorService {\n    editorClass = ProjectEditor\n    engineClass = ClientEditorEngine\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\n\nimport { SharedModule } from '../_shared/shared.module';\nimport { AppUIModule } from '../app-ui.module';\nimport { AuthModule } from '../auth/auth.module';\n\nimport { TemplateRoutingModule, COMPONENTS, ENTRIES_COMPONENTS } from './template-routing.module';\nimport { DragDropModule } from '@angular/cdk/drag-drop';\nimport { reducers, effects, services } from './_store';\nimport { NzCollapseModule } from 'ng-zorro-antd/collapse';\n\n@NgModule({\n  declarations: [...COMPONENTS, ...ENTRIES_COMPONENTS],\n  imports: [\n    DragDropModule,\n    AuthModule,\n    CommonModule,\n    AppUIModule,\n    SharedModule,\n    TemplateRoutingModule,\n    StoreModule.forFeature('templateStore', reducers),\n    EffectsModule.forFeature(effects),\n    NzCollapseModule,\n  ],\n  entryComponents: ENTRIES_COMPONENTS,\n  providers: [...services],\n})\nexport class TemplateModule {}\n","import { ActionReducerMap, createFeatureSelector } from '@ngrx/store';\r\nexport interface ItemState {\r\n}\r\n\r\nexport const reducers: ActionReducerMap<ItemState> = {\r\n};\r\n\r\nexport const selectContainerState = createFeatureSelector<ItemState>('itemStore');\r\n","import { Component, NgZone, OnInit, ChangeDetectorRef, ViewEncapsulation, ElementRef, AfterViewInit, OnDestroy } from '@angular/core';\r\nimport { ActivatedRoute, Router, NavigationEnd } from '@angular/router';\r\nimport { TransparentBase64Image } from '@app/_3D/libs/three.libs';\r\nimport { AppEditorEventService } from '@app/_3D/services/app-editor-event.service';\r\nimport { assignValue, assignWithout, copyByList, degreeToRadians, inArray, isEmpty, Str } from '@app/_core/helpers/utils';\r\nimport { MeshGeometryService } from '@app/_shared/components/panels/mesh-geometry/mesh-geometry.service';\r\nimport { PanelLightService } from '@app/_shared/components/panels/panel-light/panel-light.service';\r\nimport { PanelModelObjectService } from '@app/_shared/components/panels/panel-model-object/panel-model-object.service';\r\nimport { EditorToolbarService } from '@app/_shared/components/viewport/editor-toolbar/editor-toolbar.service';\r\nimport { ClientEditToolbarService } from '@app/_shared/components/viewport/client-edit-toolbar/client-edit-toolbar.service';\r\nimport { VectorControlsService } from '@app/_shared/components/viewport/vector-controls/vector-controls.service';\r\nimport { ViewportService } from '@app/_shared/components/viewport/viewport.service';\r\nimport { AppEditorStorageService } from '@app/_3D/services/app-editor-storage.service';\r\nimport { ModalConfirmService } from '@app/_shared/services/modal-confirm.service';\r\nimport { CategoryService } from '@app/_store/category';\r\nimport { ItemService, ItemTableService } from '@app/_store/item';\r\nimport { TemplateModel, TemplateService } from '@app/_store/template';\r\nimport { BlankData } from '../_store/data';\r\nimport { BaseComponent } from '@app/_shared/components/base/base.component';\r\nimport { TemplateEditorService } from '@app/_3D/services/template-editor.service';\r\nimport { A } from '@app/_core/helpers/html-elements';\r\nimport { getConfig } from '@app/_core/config';\r\nimport { runTask } from '@app/_core/tasks';\r\n\r\n\r\n@Component({\r\n    selector: 'app-workspace',\r\n    templateUrl: './workspace.component.html',\r\n    styleUrls: ['../../../styles/design/_index.scss', './workspace.component.scss'],\r\n    encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class WorkspaceComponent extends BaseComponent implements OnInit, AfterViewInit, OnDestroy {\r\n    isInited: boolean = false;\r\n    id: number = 0;\r\n    secret_id: string;\r\n    mode: string = 'create';\r\n    isLoading: boolean = true;\r\n    app: TemplateEditorService = null;\r\n    urlPath: string = null;\r\n    templates: TemplateModel[] = [];\r\n    template: TemplateModel = null;\r\n    defaultThumbnail: string = TransparentBase64Image;\r\n    lockSidebar: boolean = false;\r\n    subEventService: AppEditorEventService;\r\n    workspaceKey: string = \"templateWorkspace\";\r\n\r\n    downloadBtn = A(\".download\", { target: \"_blank\", href: \"\", download: \"screenshot.png\" });\r\n\r\n    engineEvent: any = {\r\n        \"load.success\": e => e.tasks == 0 && this.hideLoading(),\r\n        \"load.fail\": e => e.tasks == 0 && this.hideLoading(),\r\n        \"object.load.starting\": () => this.showLoading(),\r\n        \"object.load.completed\": () => {\r\n            this.hideLoading()\r\n            runTask('loading.complete');\r\n        },\r\n        \"loadmore.progress\": e => runTask(\"loading.progress\", [e.percent])\r\n    };\r\n    appinit: (e) => any = e => {\r\n        this.app.engine.setControlEngine(this.vectorControls.engine);\r\n        this.app.editor.detachLight();\r\n    };\r\n\r\n    appBeforeInit: (e) => any = e => {\r\n        this.app.engine.on(this.engineEvent);\r\n    };\r\n\r\n\r\n    constructor(\r\n        public cd: ChangeDetectorRef,\r\n        public activatedRoute: ActivatedRoute,\r\n        public router: Router,\r\n        public templateService: TemplateService,\r\n        public editor: TemplateEditorService,\r\n        public categoryService: CategoryService,\r\n        public storage: AppEditorStorageService,\r\n        public events: AppEditorEventService,\r\n        public viewportService: ViewportService,\r\n        public toolbar: ClientEditToolbarService,\r\n        public vectorControls: VectorControlsService,\r\n        public confirmService: ModalConfirmService,\r\n        public geoService: MeshGeometryService,\r\n        public panelModelService: PanelModelObjectService,\r\n        public panelLightService: PanelLightService,\r\n        public editorToolbar: EditorToolbarService,\r\n        public itemService: ItemService,\r\n        // public itemTable: ItemTableService,\r\n        // public templateTable: TemplateTableService,\r\n        private elemRef: ElementRef\r\n    ) {\r\n        super();\r\n        this.subEventService = this.events.sub(this.workspaceKey);\r\n        this.editor.events = this.subEventService;\r\n        this.app = this.editor;\r\n        this.toolbar = toolbar.sub(this.workspaceKey);\r\n        this.viewportService = viewportService.sub(this.workspaceKey);\r\n        this.vectorControls = vectorControls.sub(this.workspaceKey);\r\n        this.editorToolbar = editorToolbar.sub(this.workspaceKey)\r\n\r\n    }\r\n    initOnce() {\r\n        this.moduleKey = this.workspaceKey;\r\n        this.viewportService.emit({\r\n            type: 'app.set',\r\n            app: this.app\r\n        }, true)\r\n\r\n        this.storage.assign('template', null, template => this.template = template);\r\n        // this.storage.assign({\r\n        //     info: {}\r\n        // })\r\n        this.storage.assign('editorMode', this.mode, mode => this.mode = mode);\r\n        // window['wpStorage'] = this.storage;\r\n        this.categoryService.getAll({ s: \"\" }).subscribe(data => {\r\n            this.storage.setState(\"categories\", data.data);\r\n        });\r\n        this.registerEventService(document, {\r\n            'pointerup': e => this.subEventService.emit(e),\r\n            'pointermove': e => this.subEventService.emit(e)\r\n        });\r\n        this.registerEventService(this.app, {\r\n            \"editor.update.mesh.props\": e => this.geoService.updateProps(e.data),\r\n            \"editor.update.model.props\": e => this.panelModelService.updateProps(e.data),\r\n            \"editor.update.light.props\": e => this.panelLightService.updateProps(e.data),\r\n            \"editor.update.light.props.target\": e => this.panelLightService.updateTargetProps(e.data),\r\n            \"editor.attach:object\": e => this.toolbar.show(\"object\", e.secret_key),\r\n            \"editor.attach:mesh\": e => this.toolbar.show(\"mesh\", e.secret_key),\r\n            \"editor.attach:light\": e => this.toolbar.show(\"light\", e.secret_key),\r\n            \"editor.delete:light\": e => this.doAction({ action: \"delete\", type: \"light\", secret_key: e.secret_key }),\r\n            \"editor.delete:object\": e => this.doAction({ action: \"delete\", type: \"object\", secret_key: e.secret_key }),\r\n            \"editor.detach\": e => this.onDetach(),\r\n            \"light.showform\": e => this.showLight(e.data),\r\n            beforeinit: this.appBeforeInit,\r\n            init: this.appinit\r\n        });\r\n        this.registerEventService(this.subEventService, {\r\n            \"modelitem.drop.confirm\": e => this.dropModelItem(e.data),\r\n            \"app.loading.show\": e => this.showLoading(),\r\n            \"app.loading.hide\": e => this.hideLoading()\r\n        });\r\n        this.registerEventService(this.toolbar, {\r\n            \"mode.select\": e => this.app.emit({ type: \"toolbar.change:mode\", mode: e.mode }),\r\n            \"action\": e => this.doAction(e.data)\r\n        });\r\n\r\n        // window['templateWorkspace'] = this;\r\n    }\r\n\r\n    onInit() {\r\n\r\n        this.moduleKey = this.workspaceKey;\r\n        this.activeEventServiceRegistered(this.app);\r\n        this.activeEventServiceRegistered(this.subEventService);\r\n        this.activeEventServiceRegistered(this.toolbar);\r\n        this.activeEventServiceRegistered(document);\r\n\r\n        if (this.app.engine) {\r\n            this.app.engine.on(this.engineEvent);\r\n        }\r\n        this.preload();\r\n        this.cd.detectChanges();\r\n\r\n        this.vectorControls.emit({\r\n            type: \"show\",\r\n            value: true\r\n        }, null, true);\r\n\r\n\r\n        this.editorToolbar.show({\r\n            saveView: e => this.app.saveCurrentCameraPosition(),\r\n            saveThumbnail: e => this.saveThumbnail(),\r\n            exportImage: e => this.exportImage()\r\n        });\r\n    }\r\n\r\n    onDestroy() {\r\n        this.deactiveEventServiceRegistered(this.app);\r\n        this.deactiveEventServiceRegistered(this.events);\r\n        this.deactiveEventServiceRegistered(this.toolbar);\r\n        this.deactiveEventServiceRegistered(document);\r\n\r\n        if (this.app.engine) {\r\n            this.app.engine.off(this.engineEvent);\r\n        }\r\n        this.editorToolbar.hide();        \r\n        this.vectorControls.emit({\r\n            type: \"show\",\r\n            value: false\r\n        }, null, true);\r\n\r\n    }\r\n\r\n    showLoading() {\r\n        if (!this.isFocus) return;\r\n        this.viewportService.emit(\"show:loading\", 0, true);\r\n        this.events.emit(\"show:sidebar-lock\");\r\n    }\r\n    hideLoading() {\r\n        if (!this.isFocus) return;\r\n        this.viewportService.emit(\"hide:loading\", 0, true);\r\n        this.events.emit(\"hide:sidebar-lock\");\r\n    }\r\n\r\n    initUpdate() {\r\n        if (!this.isFocus) return;\r\n        this.id = +this.activatedRoute.snapshot.paramMap.get(\"id\");\r\n        if (this.id > 0) {\r\n            this.loadTemplate(this.id);\r\n        }\r\n        else {\r\n            this.storage.editorMode = 'notfound';\r\n            this.cd.detectChanges();\r\n        }\r\n    }\r\n    initCreate() {\r\n        if (!this.isFocus) return;\r\n        this.storage.editorMode = 'create';\r\n        let data = assignValue({}, BlankData);\r\n        this.setTemplateData(data);\r\n        // console.log(\"create\", data);\r\n        this.isLoading = false;\r\n        this.cd.detectChanges();\r\n    }\r\n\r\n    preload() {\r\n        if (!this.isFocus) return;\r\n        this.secret_id = this.activatedRoute.snapshot.paramMap.get(\"id\");\r\n        if (this.secret_id == getConfig('data.template.secret_id')) {\r\n            let data = getConfig('data.template');\r\n            this.storage.template = data;\r\n            this.lazyLoadTemplate(data.data);\r\n            this.isLoading = false;\r\n            this.storage.editorMode = 'update';\r\n            this.cd.detectChanges();\r\n\r\n        } else {\r\n            this.storage.editorMode = 'notfound';\r\n            this.isLoading = false;\r\n        }\r\n\r\n\r\n\r\n    }\r\n\r\n\r\n    clickSave(event) {\r\n        if (!this.isFocus) return;\r\n        if (this.mode == \"update\") {\r\n            this.template.data = this.app.data;\r\n            this.templateService.update(this.template).subscribe(rs => {\r\n                // lam gi do\r\n            });\r\n        } else if (this.mode == \"create\") {\r\n            this.template.data = this.app.data;\r\n            this.templateService.create(this.template).subscribe(rs => {\r\n                this.id = rs.data.id;\r\n                this.mode = \"update\";\r\n                this.app.data.id = this.id;\r\n\r\n            });\r\n\r\n        }\r\n    }\r\n\r\n\r\n\r\n\r\n    loadTemplate(id: number) {\r\n        if (!this.isFocus) return;\r\n        // var template = this.templateTable.find(id);\r\n        this.showLoading();\r\n        // if (template && !isEmpty(template)) {\r\n        //     this.storage.editorMode = 'update';\r\n        //     this.storage.template = template;\r\n        //     this.lazyLoadTemplate(template as TemplateModel);\r\n        //     this.isLoading = false;\r\n        //     this.cd.detectChanges();\r\n        // } \r\n        // else {\r\n        this.templateService.get(this.id).subscribe(data => {\r\n            this.storage.template = data;\r\n            this.lazyLoadTemplate(data.data);\r\n            this.isLoading = false;\r\n            this.storage.editorMode = 'update';\r\n            this.cd.detectChanges();\r\n        }, error => {\r\n            this.storage.editorMode = 'notfound';\r\n            this.hideLoading();\r\n            this.cd.detectChanges();\r\n        });\r\n        // }\r\n    }\r\n\r\n    lazyLoadTemplate(project) {\r\n        let preData = assignWithout({}, project, ['objects', 'meshes', 'models', 'scene']);\r\n        preData.scene = assignWithout({}, project.scene, ['foregrounds', 'background']);\r\n        this.setTemplateData(preData);\r\n        runTask('loading.progress', [20]);\r\n        setTimeout(() => {\r\n            if (!project.objects || !project.objects.length) {\r\n                setTimeout(() => {\r\n                    runTask('loading.progress', [50]);\r\n                    setTimeout(() => {\r\n                        runTask('loading.progress', [100]);\r\n                        setTimeout(() => {\r\n                            runTask('loading.complete', [project]);\r\n                        }, 1000);\r\n                    }, 1000);\r\n                }, 500);\r\n            }\r\n            else {\r\n                this.showLoading();\r\n            }\r\n\r\n        }, 11);\r\n        setTimeout(() => {\r\n            this.setTemplateData(project);\r\n        }, 25);\r\n    }\r\n\r\n\r\n\r\n\r\n    setTemplateData(data: TemplateModel, complete?: (...args: any[]) => any, error?: (...args: any[]) => any, progress?: (...args: any[]) => any) {\r\n        if (!this.isFocus) return;\r\n        this.app.setTemplate(data);\r\n    }\r\n\r\n\r\n\r\n    saveThumbnail() {\r\n        if (!this.isFocus) return false;\r\n        this.app.editor.unselect();\r\n        this.showLoading();\r\n        setTimeout(() => {\r\n            this.app.capture(image => {\r\n                this.template.thumbnail = image;\r\n                this.templateService.updateThumbnail({\r\n                    id: this.template.id,\r\n                    thumbnail: this.template.thumbnail\r\n                } as TemplateModel).subscribe(rs => {\r\n                    this.hideLoading();\r\n                }, e => {\r\n                    this.hideLoading();\r\n                });\r\n            });\r\n\r\n        }, 1000);\r\n    }\r\n\r\n\r\n    exportImage() {\r\n        if (!this.isFocus) return false;\r\n        this.app.editor.unselect();\r\n        this.showLoading();\r\n        setTimeout(() => {\r\n            this.app.capture(image => {\r\n                this.downloadBtn.attr(\"href\", image);\r\n                this.downloadBtn.el.click();\r\n                this.hideLoading();\r\n            });\r\n\r\n        }, 2000);\r\n\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    onMeshAttach(data) {\r\n        if (!this.isFocus) return;\r\n        this.geoService.open(data, e => {\r\n            let d: any = {};\r\n            if (inArray(['props', 'geometry', 'material'], e.key)) {\r\n                d[e.key] = e.data[e.key];\r\n                switch (e.key) {\r\n                    case \"props\":\r\n\r\n                        break;\r\n                    case \"geometry\":\r\n\r\n                        break;\r\n\r\n                    case \"material\":\r\n\r\n                        break;\r\n\r\n\r\n                    default:\r\n                        break;\r\n                }\r\n                this.events.emit({\r\n                    type: \"mesh.setting.update\",\r\n                    secret_key: data.secret_key,\r\n                    data: d\r\n                });\r\n            }\r\n\r\n        });\r\n    }\r\n\r\n    closeAllPanel() {\r\n        if (!this.isFocus) return;\r\n        // this.toolbar.hide();\r\n        this.geoService.close();\r\n        this.panelModelService.close();\r\n        this.panelLightService.close();\r\n    }\r\n\r\n    onDetach() {\r\n        if (!this.isFocus) return;\r\n        this.toolbar.hide();\r\n        this.closeAllPanel();\r\n\r\n    }\r\n\r\n    showLight(data) {\r\n        if (!this.isFocus) return;\r\n        this.panelLightService.open(data, e => {\r\n            let update: any = {};\r\n            // if(e.type==\"params\"){\r\n            update[e.type] = {};\r\n            update[e.type][e.name] = e.value;\r\n\r\n            // }\r\n            this.app.updateLightDataAndScene(e.secret_key, update);\r\n        })\r\n    }\r\n\r\n    doAction(data) {\r\n        if (!this.isFocus) return;\r\n        if (data.action == \"delete\") {\r\n            var title = inArray(['object', 'mesh'], data.type) ? \"Are you sure delete this object?\" : \"Are you sure delete this light?\";\r\n            this.confirmService.showDeleteConfirm(title, () => {\r\n                if (inArray(['object', 'mesh'], data.type)) {\r\n                    this.app.emit({\r\n                        type: \"toolbar.delete:object\",\r\n                        secret_key: data.secret_key,\r\n                        success: () => this.onDetach()\r\n                    })\r\n                }\r\n                else if (data.type == \"light\") {\r\n                    this.app.deleteLight(data.secret_key, () => this.onDetach());\r\n                }\r\n            })\r\n        }\r\n        else if (data.action == \"edit\") {\r\n            let ed = this.app.getEditObjectData(data.secret_key);\r\n            if (ed != null) {\r\n                if (ed.type == \"mesh\") {\r\n                    this.closeAllPanel();\r\n                    this.geoService.open(ed, e => {\r\n                        let d: any = {};\r\n                        if (inArray(['props', 'geometry', 'material'], e.key)) {\r\n                            d[e.key] = e.data[e.key];\r\n                            switch (e.key) {\r\n                                case \"props\":\r\n\r\n                                    break;\r\n                                case \"geometry\":\r\n\r\n                                    break;\r\n\r\n                                case \"material\":\r\n\r\n                                    break;\r\n\r\n\r\n                                default:\r\n                                    break;\r\n                            }\r\n                            this.events.emit({\r\n                                type: \"mesh.setting.update\",\r\n                                secret_key: data.secret_key,\r\n                                data: d\r\n                            });\r\n                        }\r\n\r\n                    });\r\n                } else if (ed.type == \"model\") {\r\n                    this.closeAllPanel();\r\n                    let obj = this.app.engine.getObject(data.secret_key).object;\r\n                    ed.object = obj;\r\n\r\n                    this.panelModelService.open(ed, e => {\r\n                        if (e.type == \"material\") {\r\n                            this.app.updateModelMeshMaterial(e.secret_key, e.name, e.data);\r\n                        }\r\n                        else if (e.type == \"props\") {\r\n                            let props: any = {};\r\n                            props[e.key] = e.data[e.key];\r\n                            this.app.updateObjectSettingDataAndScene(e.secret_key, { props: props }, { props: true })\r\n                        }\r\n\r\n                    });\r\n                }\r\n                else if (ed.type == \"light\") {\r\n                    this.showLight(ed.data);\r\n                }\r\n            }\r\n        }\r\n        else if (data.action == 'download') {\r\n            let model = this.app.getObject(data.secret_key);\r\n\r\n            if (model.type == \"model\" && model.data.download_source_url != \"\") {\r\n                const link = document.createElement('a');\r\n                link.setAttribute('target', '_blank');\r\n                link.setAttribute('href', model.data.download_source_url);\r\n                link.setAttribute('download', model.data.name + \".zip\");\r\n                document.body.appendChild(link);\r\n                link.click();\r\n                link.remove();\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    dropModelItem(data) {\r\n        if (!this.isFocus) return;\r\n        this.confirmService.showConfirm({\r\n            title: \"Drop Item confirm\",\r\n            content: \"Item's size is bigger than size of Scene. Do you want to continue?\"\r\n        }, d => {\r\n            this.events.emit('viewport.droppable.loading');\r\n            this.events.emit({\r\n                type: 'item.dropped',\r\n                item: data.item,\r\n                success: (dat) => {\r\n                    this.events.emit('viewport.droppable.hide');\r\n                    var size = data.item.size;\r\n                    this.app.updateSceneSizeAndFloorAndGridNyChildren(2);\r\n                    // this.app.updateSceneSizeSetting()\r\n                    if (this.app.data.scene.floor.above) {\r\n                        data.position.y = this.app.data.scene.floor.props.position.y + size.y / 2;\r\n                    } else {\r\n                        data.position.y = size.y / 2;\r\n                    }\r\n                    this.app.updateObjectSettingDataAndScene(dat.secret_key, {\r\n                        props: {\r\n                            position: data.position\r\n                        }\r\n                    }, { props: true })\r\n\r\n\r\n                    var sceneData = this.app.getRealSceneSize();\r\n                    var x = sceneData.size.x;\r\n                    var y = sceneData.size.y;\r\n                    var z = sceneData.size.z;\r\n                    var fov = this.app.engine.camera.fov;\r\n                    var tan = Math.tan(degreeToRadians(fov / 2));\r\n                    var ds = (z / 2) + ((x > y ? x : y) / 2) / tan;\r\n                    var dz = ds * 1.5;\r\n                    var far = this.app.engine.camera.far > dz ? this.app.engine.camera.far : dz;\r\n                    var near = this.app.engine.camera.near;\r\n                    if (z >= 50) {\r\n                        near = 1;\r\n                    }\r\n                    else if (z > 20) {\r\n                        near = 0.5;\r\n                    }\r\n                    else if (z > 10) {\r\n                        near = 0.1;\r\n                    }\r\n                    if (near < this.app.engine.camera.near) near = this.app.engine.camera.near;\r\n\r\n\r\n                    this.app.updateCameraSetting({\r\n                        far: far,\r\n                        near: near,\r\n                        position: {\r\n                            z: ds * 1.5,\r\n                            y: y / 2,\r\n                            x: 0\r\n                        },\r\n                        settings: {\r\n                            position: {\r\n                                type: \"custom\",\r\n                                custom: {\r\n                                    z: ds * 1.5,\r\n                                    y: y / 2,\r\n                                    x: 0\r\n                                }\r\n                            }\r\n                        }\r\n                    }, true);\r\n                    // this.app.engine.updateMainCameraSettings({\r\n                    //     position:{\r\n\r\n                    //         z: ds * 1.5,\r\n                    //         y: y/2,\r\n                    //         x: 0\r\n                    //     },\r\n\r\n                    // })\r\n                    // assignValue(this.app.engine.camera, {\r\n\r\n                    // })\r\n\r\n                    this.hideLoading();\r\n                }\r\n            })\r\n        }, () => {\r\n            this.events.emit('viewport.droppable.hide');\r\n        });\r\n    }\r\n\r\n    nzCollapsedChange(event) {\r\n        if (!this.isFocus) return;\r\n        this.app.updateCanvasSize();\r\n    }\r\n\r\n\r\n    ngAfterViewInit(): void {\r\n        if (!this.isFocus) return;\r\n        this.app.updateCanvasSize();\r\n    }\r\n\r\n    addDemo() {\r\n\r\n        if (!this.itemTable.get().length) {\r\n            setTimeout(() => {\r\n                if (!this.itemTable.get().length) {\r\n                    this.itemService.getAll({}).subscribe(rs => {\r\n                        if (rs.data && !this.itemTable.get().length) {\r\n                            rs.data.map(item => {\r\n                                var r = this.itemTable.first({ id: item.id });\r\n                                if (!(r && !isEmpty(r))) {\r\n                                    this.itemTable.insert(assignWithout({}, item, ['id']));\r\n                                }\r\n                            })\r\n                        }\r\n                    });\r\n                }\r\n            }, 100);\r\n        }\r\n\r\n        if (!this.templateTable.get().length) {\r\n            setTimeout(() => {\r\n                this.templateService.getAll({}).subscribe(rs => {\r\n                    if (rs.data) {\r\n                        rs.data.map(item => {\r\n                            var r = this.templateTable.first({ id: item.id });\r\n                            if (!(r && !isEmpty(r))) {\r\n                                this.templateTable.insert(assignWithout({}, item, ['id']));\r\n                            }\r\n                        })\r\n                    }\r\n                })\r\n            }, 100);\r\n        }\r\n    }\r\n}\r\n","<ng-container *ngIf=\"__show__; then thenTemplate; else elseTemplate\"></ng-container>\r\n<ng-template #thenTemplate>\r\n\r\n    <nz-layout>\r\n        <nz-header>\r\n            <app-header (clickSave)=\"clickSave($event)\"></app-header>\r\n        </nz-header>\r\n        <nz-content>\r\n            <ng-container *ngIf=\"isLoading; then loadingTemplate; else editorTemplate\"></ng-container>\r\n            <ng-template #loadingTemplate>\r\n                <div class=\"alert\">\r\n                    <h3>Vui lòng chờ giây lát</h3>\r\n                </div>\r\n            </ng-template>\r\n            <ng-template #editorTemplate>\r\n                <ng-container *ngIf=\"mode=='notfound'; then notFoundTemplate; else editorTemplate\"></ng-container>\r\n                <ng-template #notFoundTemplate>\r\n                    <div class=\"alert not-found\">\r\n                        template Not Found\r\n                    </div>\r\n                </ng-template>\r\n                <ng-template #editorTemplate>\r\n                    <nz-layout class=\"inner-layout\" *ngIf=\"mode == 'create' || mode=='update'\">\r\n                        <nz-sider nzWidth=\"380px\" nzTheme=\"dark\" (nzCollapsedChange)=\"nzCollapsedChange($event)\">\r\n                            <app-template-sidebar></app-template-sidebar>\r\n                        </nz-sider>\r\n                        <nz-content class=\"nz-layout-content\">\r\n                            <section id=\"content\">\r\n                                <app-client-viewport></app-client-viewport>\r\n                            </section>\r\n                        </nz-content>\r\n                    </nz-layout>\r\n                </ng-template>\r\n            </ng-template>\r\n        </nz-content>\r\n    </nz-layout>\r\n    <dragging-item></dragging-item>\r\n    <dragging-geometry></dragging-geometry>\r\n    <modal-image-library [app]=\"app\"></modal-image-library>\r\n    <panel-mesh-geometry></panel-mesh-geometry>\r\n    <panel-model-object></panel-model-object>\r\n    <panel-light></panel-light>\r\n    <app-panel-mesh-customize></app-panel-mesh-customize>\r\n    <app-sidebar-lock></app-sidebar-lock>\r\n</ng-template>\r\n<ng-template #elseTemplate>\r\n\r\n</ng-template>","export * from './reducers';\r\n// export * from './actions';\r\nexport * from './effects';\r\n// export * from './selectors';\r\nexport * from './services';\r\n// export * from './item';\r\n// export * from './category';\r\n","import { CategoryService } from \"@app/_store/category\";\r\nimport { TemplateService } from \"@app/_store/template\";\r\nimport { TemplateTableService } from \"@app/_store/template/table\";\r\n// import { TemplateEventsService } from \"./events.service\";\r\n\r\nexport const services = [\r\n  TemplateService,\r\n  CategoryService,\r\n  \r\n  TemplateTableService,\r\n];\r\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nimport { WorkspaceComponent } from './workspace/workspace.component';\nimport { HeaderComponent } from './header/header.component';\nimport { ListComponent } from './list/list.component';\n\n\n\nexport const ENTRIES_COMPONENTS = [];\n\n\nexport const COMPONENTS = [\n  WorkspaceComponent,\n  HeaderComponent,\n  ListComponent\n];\n\nconst routes: Routes = [\n  {\n    path: '',\n    children: [\n      {\n        path: ':id/edit',\n        component: WorkspaceComponent,\n      },\n      // {\n      //   path: ':id/update',\n      //   component: WorkspaceComponent,\n      // },\n      // {\n      //   path: 'create',\n      //   component: WorkspaceComponent,\n      // },\n      // {\n      //   path: 'list',\n      //   component: ListComponent,\n      // },\n      // {\n      //   path: '**',\n      //   redirectTo: 'list',\n      // },\n    ],\n  },\n];\n\n@NgModule({\n  imports: [\n    RouterModule.forChild(routes)\n  ],\n  exports: [RouterModule],\n})\nexport class TemplateRoutingModule { }\n","import { Injectable } from '@angular/core';\nimport { DbTableColumns } from '@app/_core/helpers/local-db';\nimport { LostDbTableService } from '@app/_core/services/lost-db-table.service';\nimport { LostDbService } from '@app/_core/services/lost-db.service';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class TemplateTableService extends LostDbTableService {\n    name: string = 'templates';\n    columns: DbTableColumns = {\n        id: {\n            type: \"number\",\n            autoIncrement: true\n        },\n        name: {\n            type: \"string\",\n            required: true,\n        },\n        category_id: {\n            type: \"number\",\n            defVal: 0\n        },\n        description: {\n            type: \"string\",\n            defVal: \"\"\n        },\n        status: {\n            type: \"string\",\n            defVal: \"draft\"\n        },\n        thumbnail: {\n            type: \"string\",\n            defVal: \"\"\n        },\n        renderer: {\n            type: \"object\",\n            defVal: {}\n        },\n        scene: {\n            type: \"object\",\n            defVal: {}\n        },\n\n        composer: {\n            type: \"object\",\n            defVal: {}\n        },\n        shadow: {\n            type: \"object\",\n            defVal: {}\n        },\n        camera: {\n            type: \"object\",\n            defVal: {}\n        },\n        control: {\n            type: \"object\",\n            defVal: {}\n        },\n        lights: {\n            type: \"array\",\n            defVal: []\n        },\n        // objects\n        objects: {\n            type: \"array\",\n            defVal: []\n        },\n        // objects\n        meshes: {\n            type: \"array\",\n            defVal: []\n        }\n\n    }\n    constructor(private dbService: LostDbService) {\n        super(dbService);\n        this.init();\n    }\n}\n"]}