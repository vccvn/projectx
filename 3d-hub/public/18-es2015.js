"use strict";(self.webpackChunkcretip_3dwebapp=self.webpackChunkcretip_3dwebapp||[]).push([[18],{32018:function(t,e,n){n.r(e),n.d(e,{ItemModule:function(){return eo}});var i=n(38583),o=n(91601),s=n(86710),r=n(28855),a=n(84978),c=n(28747),l=n(95987);const h={renderer:{autoStart:!1,params:{antialias:!0},shadowMap:{enabled:!0},outputEncoding:"{THREE.sRGBEncoding}"},composer:{effect1:"bloom",params:{options:{blendFunction:16,luminanceThreshold:.9,luminanceSmoothing:.025,resolutionScale:.5,intensity:1}}},shadow:{pcss:!1},scene:{background:{type1:"file",format:"hdr",path:"/textures/equirectangular/",file:"royal_esplanade_1k.hdr"},env0:{type:"room"}},camera:{fov:45,near:.001,far:1e3,position:{x:0,y:.3,z:1},"@lookAt":[0,3,0],autofit:!0},control:{type:"orbit",autoUpdateScene:!0,maxPolarAngle0:"{Math.PI * 0.52}",maxDistance:1200,enableDamping:!0,dampingFactor:.08,constraint:{smoothZoom:!0,zoomDampingFactor:.2,smoothZoomSpeed:5}},lights:[{type:"ambient",params:["#ffffff",.5]},{type:"point",params:["#4444cc",.3],props:{position:{x:0,y:-10}}},{type:"Directionallight",params:{color:"#FFE0B5",intensity:.4},props:{position:{x:40,y:40,z:30},castShadow:!0,shadow:{mapSize:{width:4096,height:4096},camera:{near:.1,far:100,left:10,right:-10,top:10,bottom:-10},darkness:.1,bias:-2e-4,radius:5}}},{type:"Directionallight",params:{color:"#FFE0B5",intensity:.4},props:{position:{x:60,y:30,z:30}}}],objects:[]};var p=n(37716),d=n(83586);let g=(()=>{class t{constructor(){this.moduleKey="",this.eventService=null,this.emitter=new p.vpe,this.eventServiceContainers=[],this.isFocus=!1,this.isInited=!1,this.subEvents=null,this.isChangeSubEvents=!1,Object.defineProperty(this,"_listeners",{configurable:!1,enumerable:!1,value:{}}),Object.defineProperty(this,"_dispatchedEvents",{configurable:!1,enumerable:!1,value:{}}),"function"==typeof this.boot&&this.boot(),"function"==typeof this.onBoot&&this.onBoot()}ngOnInit(){if(this.isFocus=!0,this.isChangeSubEvents=!1,(0,d.aX)(this,"events")&&this.events&&this.moduleKey){const t=this.events.sub(this.moduleKey);t&&t!==this.subEvents&&(this.subEvents=t,this.deactiveEventServiceRegistered(this.subEvents),this.deregisterAllEventService(this.subEvents),this.isChangeSubEvents=!0,"function"==typeof this.onChangeSubEvents&&(this.onChangeSubEvents(),this.activeEventServiceRegistered(this.subEvents)))}this.isInited||("function"==typeof this.initOnce?this.initOnce():"function"==typeof this.initFirst&&this.initFirst()),"function"==typeof this.init&&this.init(),"function"==typeof this.onInit&&this.onInit(),this.isChangeSubEvents=!1}ngOnDestroy(){this.isFocus=!1,"function"==typeof this.destroy&&this.destroy(),"function"==typeof this.onDestroy&&this.onDestroy(),"function"==typeof this.onChangeSubEvents&&this.deactiveEventServiceRegistered(this.subEvents)}registerEventService(t,e,n,i){let o={};if((0,d.Kn)(e)){let t=(0,d.jn)(n)?n:i;for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const i=e[n];if("function"==typeof i){let e=n.split("|");o[e[0]]=[[i,e.length>1&&"dispatch"==e[1]||t]]}}}else(0,d.HD)(e)&&(0,d.GV)(n)&&(o[e]=[[n,i]]);let s=-1;for(let r=0;r<this.eventServiceContainers.length;r++){const e=this.eventServiceContainers[r];if(e.service==t){s=r;for(const t in o)if(Object.prototype.hasOwnProperty.call(o,t)){const n=o[t][0];void 0===e.events[t]?e.events[t]=[n]:e.events[t].push(n)}break}}-1==s&&this.eventServiceContainers.push({service:t,events:o})}activeEventServiceRegistered(t,e){this.eventServiceContainers.map(n=>{if(n.service==t)if(e)(0,d.HD)(e)?(0,d.kJ)(n.events[e])&&n.events[e].map(t=>{n.service.removeEventListener(e,t[0]),n.service.addEventListener(e,t[0],t[1])}):(0,d.kJ)(e)&&e.map(t=>{(0,d.kJ)(n.events[t])&&n.events[t].map(e=>{n.service.removeEventListener(t,e[0]),n.service.addEventListener(t,e[0],e[1])})});else for(const t in n.events)Object.prototype.hasOwnProperty.call(n.events,t)&&n.events[t].map(e=>{n.service.removeEventListener(t,e[0]),n.service.addEventListener(t,e[0],e[1])})})}deactiveEventServiceRegistered(t,e){this.eventServiceContainers.map(n=>{if(n.service==t)if(e)(0,d.HD)(e)?(0,d.kJ)(n.events[e])&&n.events[e].map(t=>{n.service.removeEventListener(e,t[0])}):(0,d.kJ)(e)&&e.map(t=>{(0,d.kJ)(n.events[t])&&n.events[t].map(e=>{n.service.removeEventListener(t,e[0])})});else for(const t in n.events)Object.prototype.hasOwnProperty.call(n.events,t)&&n.events[t].map(e=>{n.service.removeEventListener(t,e[0])})})}deregisterEventService(t,e,n){this.eventServiceContainers.map((i,o)=>{if(i.service==t)if(e)(0,d.HD)(e)?(0,d.kJ)(i.events[e])&&i.events[e].map((t,o)=>{n?n==t[0]&&(i.service.removeEventListener(e,t[0]),i.events[e].splice(o,1)):(i.service.removeEventListener(e,t[0]),i.events[e].splice(o,1))}):(0,d.kJ)(e)&&e.map(t=>{(0,d.kJ)(i.events[t])&&(i.events[t].map(e=>{i.service.removeEventListener(t,e[0])}),i.events[t].splice(0),delete i.events[t])});else{for(const t in i.events)Object.prototype.hasOwnProperty.call(i.events,t)&&(i.events[t].map(e=>{i.service.removeEventListener(t,e[0])}),i.events[t].splice(0),delete i.events[t]);this.eventServiceContainers.splice(o,1)}})}deregisterAllEventService(t){this.eventServiceContainers.map((e,n)=>{if(!t||t===e.service){for(const t in e.events)Object.prototype.hasOwnProperty.call(e.events,t)&&(e.events[t].map(n=>{e.service.removeEventListener(t,n[0])}),e.events[t].splice(0),delete e.events[t]);this.eventServiceContainers.splice(n,1)}})}__parseEventHandler(t){var e=this;if("function"==typeof t)return t;var n=t||function(t){console.log(t)};if("string"==typeof t){var i=[],o=t.split(":");2==o.length&&(t=o[0],i=o[1].split(",").map(function(t){return t.trim()})),n=function(n){var o=[n];if(i.map(function(t){o.push(t)}),"function"==typeof e[t])return e[t].apply(e,o)}}return n}__addEventListener(t,e,n){var i=this.__parseEventHandler(e);null==this._listeners&&(this._listeners={}),t=String(t).toLowerCase();const o=this._listeners;return void 0===o[t]&&(o[t]=[]),!0===n&&this.__handleDispatchedEvents(t,i),-1===o[t].indexOf(i)&&o[t].push(i),i}__hasEventListener(t,e){if(null==this._listeners)return!1;const n=this._listeners;return void 0!==n[t=String(t).toLowerCase()]&&(!e||-1!==n[t].indexOf(e))}__removeEventListener(t,e){if(null==this._listeners)return!1;t=String(t).toLowerCase();const n=this._listeners[t];if(void 0!==n){if(!e)return this._listeners[t].splice(0,this._listeners[t].length),!0;const i=n.indexOf(e);if(-1!==i)return n.splice(i,1),!0}return!1}__dispatchEvent(t,e,n){if(null==this._listeners||!t)return null;var i={};if((0,d.HD)(t))i.type=t,e&&(i.data=e);else{if(!(0,d.Kn)(t))return!1;if(!(i=t).type)return!1;!i.data&&e&&(i.data=e),(0,d.jn)(e)&&void 0===n&&(n=e)}i.constructor===Object&&(i.type=String(i.type).toLowerCase());const o=this._listeners[i.type];var s=!0;if(i.target||(i.target=this),i.stopImmediatePropagation||(i.stopImmediatePropagation=function(){s=!1}),!0===n&&this.__addDispatchedEvent(i),void 0!==o){const t=o.slice(0);for(var r=[],a=0,c=t.length;a<c;a++){let e=t[a].call(this,i);if(!s)break;void 0!==e&&r.push(e)}return s&&r.length?1==r.length&&1==t.length?r[0]:r:s}}on(t,e,n){if((0,d.Kn)(t)){var i={};const s=t;var o=(0,d.jn)(e)?e:!!(0,d.jn)(n)&&n;for(const e in s)if(Object.hasOwnProperty.call(s,e)){const n=t[e];if((0,d.mf)(n)||(0,d.HD)(n)){const t=this.__addEventListener(e,n,o);t&&(i[e]=t)}}return i}return this.__addEventListener(t,e,n)}off(t,e){return this.__removeEventListener(t,e)}__addDispatchedEvent(t){return void 0===this._dispatchedEvents[t.type]&&(this._dispatchedEvents[t.type]=[]),this._dispatchedEvents[t.type].push(t),this}__handleDispatchedEvents(t,e){var n=this._dispatchedEvents[t];if(void 0!==n){const t=n.slice(0);for(var i=0,o=t.length;i<o;i++){var s=e.call(this,t[i]);if(!1===s)return s}}}listen(t){var e=this.__dispatchEvent(t),n=!0;"function"==typeof this.eventHandler&&(n=this.eventHandler(t)),!1!==e&&!1!==n&&this.emit(t)}emit(t,e,n){var i={};if((0,d.HD)(t))i.type=t,e&&(i.data=e);else{if(!(0,d.Kn)(t))return!1;if(!(i=t).type)return!1;!i.data&&e&&(i.data=e),(0,d.jn)(e)&&void 0===n&&(n=e)}i.constructor===Object&&(i.type=String(i.type).toLowerCase()),this.emitter.emit(i)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.Xpm({type:t,selectors:[["ng-component"]],inputs:{moduleKey:"moduleKey",eventService:"eventService"},outputs:{emitter:"emitter"},decls:0,vars:0,template:function(t,e){},encapsulation:2}),t})();var u=n(28658);d.W3.rand();const m=void 0!==window.__3DHubTaskManager__&&(0,d.Kn)(window.__3DHubTaskManager__)?window.__3DHubTaskManager__:{tasks:{},add:function(t,e){return(0,d.aX)(this.tasks,t)||(this.tasks[t]=[]),!(!(0,d.GV)(e)||!this.tasks[t].push(e))},has:function(t,e){return!(!(0,d.aX)(this.tasks,t)||!this.tasks[t].length||e&&-1==this.tasks[t].indexOf(e))},remove:function(t,e){return!(!(0,d.aX)(this.tasks,t)||!this.tasks[t].length||(e?-1==this.tasks[t].indexOf(e)||(this.tasks[t].splice(e,1),0):(this.tasks[t].splice(0),delete this.tasks[t],0)))},run:function(t,e){if(!(0,d.aX)(this.tasks,t)||!this.tasks[t].length)return!1;let n=e&&(0,d.kJ)(e)?e:[];if(1==this.tasks[t].length)return(0,d.GV)(this.tasks[t][0])?this.tasks[t][0](...n):null;let i=[];for(let o=0;o<this.tasks[t].length;o++){const e=this.tasks[t][o];(0,d.GV)(e)&&i.push(e(...n))}return i}},f=(t,e)=>m.run(t,e);var v=n(4782);const b="items";let _=(()=>{class t{constructor(t){this.httpService=t}getAll(t){return this.httpService.get(b+"/list",t)}getByCategories(t){return this.httpService.get(b+"/category",t)}get(t){return this.httpService.get(`${b}/${t}`)}create(t){return this.httpService.post(b+"/create",t)}update(t){return this.httpService.put(`${b}/update/${t.id}`,t)}updateSize(t){return this.httpService.put(`${b}/size/${t.id}`,t)}updateThumbnail(t){return this.httpService.put(`${b}/thumbnail/${t.id}`,t)}delete(t){return this.httpService.delete(`${b}/${t}`)}search(t){return this.httpService.get(`${b}/list`,t)}searchNounProject(t){return this.httpService.get(`${b}/search/nounproject`,t)}render(t){return this.httpService.download(b+"/render",t)}getItemData(t){return this.httpService.getOut(t)}useItem(t){return this.httpService.post(`${b}/${t}/use`,{},!1)}}return t.\u0275fac=function(e){return new(e||t)(p.LFG(v.O))},t.\u0275prov=p.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var x=n(93893),w=n(69037);let y=(()=>{class t extends x._{constructor(t){super(t),this.dbService=t,this.name="items",this.columns={id:{type:"number",autoIncrement:!0},name:{type:"string",required:!0},category_id:{type:"number",defVal:0},description:{type:"string",defVal:""},status:{type:"string",defVal:"draft"},type:{type:"string",defVal:"gltf"},path:{type:"string",defVal:""},file:{type:"string",defVal:""},download_source_url:{type:"string",defVal:""},thumbnail:{type:"string",defVal:""},load_options:{type:"object",defVal:{useRoughnessMipmapper:!0,materialNeedsUpdate:!0}},settings:{type:"object",defVal:{}},size:{type:"object",defVal:{x:0,y:0,z:0}}},this.init()}}return t.\u0275fac=function(e){return new(e||t)(p.LFG(w.H))},t.\u0275prov=p.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var C=n(66139),O=n(26899),M=n(1855),P=n(28254),S=n(4887),k=n(63253),Z=n(89003),z=n(62303),T=n(86869),E=n(49335),A=n(99302),D=n(86820),q=n(409),I=n(28139),J=n(78441),L=(0,C.nN)("ItemEngine").uses(O.Z,M.ZP,P.Z,S.C,I.Z,Z.Z,J.O,z.Z,T.p,k.Z)({data:{},options:{},Mesh:{},Geometry:{},Material:{},Light:{},Composer:{},Shadows:{},inited:!1,constructor:function(t){var e=(0,d.Kn)(t)?t.data||t:{};e&&(0,d.Kn)(e)&&(this.data=e),this.Geometry=E.yw,this.Material=E.wE,this.Mesh=E.g,this.Light=E.y,this.Loader=new A.Z(this)},renew:function(t){this.data=(0,d.MP)({},t)},reset:function(t){if((0,d.Kn)(t)&&(this.data=(0,d.MP)({},t)),this.resetObjects(),this.resetLights(),this.data){var e=this.data;if((0,d.Kn)(e.scene)){var n=e.scene;this.updateSceneSettings(n),(0,d.Kn)(n.background)&&!(0,d.xb)(n.background)&&this.setBackground(n.floor),(0,d.Kn)(n.floor)&&!(0,d.xb)(n.floor)&&this.updateSceneFloorSetting(n.floor),(0,d.Kn)(n.size)&&!(0,d.xb)(n.size)&&this.updateSceneSettings(n.size)}(0,d.Kn)(e.shadow)&&this.updateShadowSettings(e.shadow),(0,d.Kn)(e.control)&&this.updateControlSettings(e.control),(0,d.Kn)(e.camera)&&this.updateMainCameraSettings(e.camera,!0)}this.setData(this.data)},startup:function(t){if(this.inited)return this;t&&(0,d.Kn)(t)&&(this.data=t),this.emit("startup",this.data),this.initScene(this.data.scene||{}),this.setMainCamera(this.data.camera||{}),this.createRenderer(this.data.renderer||{}),this.camera.updateProjectionMatrix(),this.setMainControl(this.data.control||{}),this.data.composer&&!(0,d.Jh)(this.data.composer)&&(this.composer=new D.Z(this,this.data.composer)),this.Shadows=new q.Z(this,this.data.shadow||this.data.shadows||{});var e=this;return this.setData(this.data),this.inited=!0,e.ready(),this.autoRenderStatus||setTimeout(function(){e.render()},500),this},setData:function(t){t.lights&&(0,d.kJ)(t.lights)&&this.addLights(t.lights),t.models&&(0,d.kJ)(t.models)&&this.addModels(t.models),t.meshes&&(0,d.kJ)(t.meshes)&&this.addMeshes(t.meshes),t.objects&&((0,d.kJ)(t.objects)||(0,d.Kn)(t.objects))&&this.addObjects(t.objects),t.grids&&(0,d.kJ)(t.grids)&&this.addGrids(t.grids),t.cameras&&(0,d.kJ)(t.cameras)&&this.addCameras(t.cameras),t.floor&&(0,d.kJ)(t.floor)&&this.addFloor(t.floor),t.controls&&(0,d.kJ)(t.controls)&&this.addControls(t.controls),this.emit("setdata",t)}}),j=n(28301),R=n(57845),Q=(0,C.nN)("ClientEditor").extends(R.Z)({transformMode:"basic",hasSelectedObject:!1,constructor:function(t,e){this.setup(t,e)},startup:function(){var t=this;this.on("pointerdown",function(e){t.poiterDowsStatus=!0;var n=t.engine.wrapper.getBoundingClientRect();if(t.onDownPosition.x=e.clientX-n.left,t.onDownPosition.y=e.clientY-n.top,!t.selected||"basic"!=t.transformMode||t.selected.isLight||t.currentTargetControl&&t.currentTargetControl==t.control.object)return;const i=new j.Vector2;i.x=t.onDownPosition.x/n.width*2-1,i.y=-t.onDownPosition.y/n.height*2+1;const o=t.selectObjectByPointer(i);o&&o==t.selected&&!o.isLight?(e.preventDefault(),t.engine.control.enabled=!1,t.control.enabled=!1,t.hasSelectedObject=!0,t.setObjectMovable(t.selected)):(t.engine.control.enabled=!0,t.control.enabled=!0,t.hasSelectedObject=!1)}),this.on("pointerup",function(e){if(t.poiterDowsStatus){if(t.hasSelectedObject)return this.emit({type:"object.changed",data:t.selected,mode:"translate"}),t.engine.control.enabled=!0,t.control.enabled=!0,t.hasSelectedObject=!1,void t.removeObjectMovable();var n=t.engine.wrapper.getBoundingClientRect();if(t.onUpPosition.x=e.clientX-n.left,t.onUpPosition.y=e.clientY-n.top,t.onUpPosition.x<0||t.onUpPosition.y<0)return;0===t.onDownPosition.distanceTo(t.onUpPosition)&&(t.pointer.x=t.onUpPosition.x/n.width*2-1,t.pointer.y=-t.onUpPosition.y/n.height*2+1,t.setCurrentObjectByPointer(t.pointer))}t.poiterDowsStatus=!1}),this.on("pointermove",function(e){if(t.hasSelectedObject){const n=new j.Vector2;return n.x=e.clientX,n.y=e.clientY,void t.checkObjectMovablePosition(n)}}),window.addEventListener("keydown",function(e){switch(e.keyCode){case 81:t.executeCommand("space");break;case 16:t.executeCommand("snap");break;case 46:t.deleteAttach()}}),this.ready(),this.setEngineData(),this.emit({type:"startup",data:(0,d.dg)()})},updateHelperByObject:function(t){if(void 0!==t){var e=this.helpers[t.id];void 0!==e&&!0!==e.isSkeletonHelper&&(t.position&&e.position.copy(t.position),t.rotation&&e.rotation.copy(t.rotation),t.scale&&e.scale.copy(t.scale),e.update())}},addObject:function(t){this.objects.push(t),this.setCurrentObject(t)},addLight:function(t){if((0,d.Kn)(t)&&t.isLight){var e=this.getHelper(t);if(e&&(e.position.copy(t.position),this.scene.add(e),e.visible=!1,e.children))for(let t=0;t<e.children.length;t++){const n=e.children[t];-1==this.pickers.indexOf(n)&&this.pickers.push(n)}t.target&&(t.target.position.y=this.engine.dropbyPositionY,this.scene.add(t.target)),this.lights.push(t)}},setCurrent:function(t){if(!t)return this.selected&&(this.selected.isTargetControlObject?this.detactLightTargetControl():this.currentLightt?this.unsetCurrentLight():this.unsetCurrentObject()),this.control.detach(),this.engine.refresh(),this;this.selected!==t&&(this.selected=t,t.isLight?this.setCurrentLight(t):this.setCurrentObject(t),this.engine.refresh())},setCurrentObject:function(t){this.currentLight&&this.unsetCurrentLight(),this.currentObject&&this.unsetCurrentObject(),this.currentObject=t,this.selected=t;var e=this.getHelper(t);return this.helper=e,this.scene.remove(e),this.scene.add(e),this.dispatchEvent({type:"object.set-current",object:t,mode:this.transformMode}),this.engine.refresh(),!1},setCurrentLight:function(t){if(t){if(this.currentLight&&this.unsetCurrentLight(),this.currentObject&&this.unsetCurrentObject(),this.currentLight=t,this.control.detach(),this.control.attach(t),this.selected=t,!t.targetControlObject){var e=this.getLightTargetControlObject(t);e&&(t.targetControlObject=e,this.scene.remove(e),this.scene.add(e))}this.dispatchEvent({type:"light.set-current",light:t,mode:this.control.mode})}else console.warn("L\u1ed7i kkho c\xf3 ligh")},unsetCurrentLight:function(){this.detachLight(),this.dispatchEvent({type:"light.unset-current",mode:this.control.mode})},unsetCurrentObject:function(){this.detachObject(),this.dispatchEvent({type:"object.unset-current",mode:this.control.mode})},selectObjectByPointer:function(t){this.raycaster.setFromCamera(t,this.engine.camera);const e=this.raycaster.intersectObjects(this.objects,!0);if(e.length>0){const t=this.closestObjectInScene(e[0].object);if(t)return t}const n=this.raycaster.intersectObjects(this.targets,!0);if(n.length){const t=this.closestLightTargetControlInScene(n[0].object);if(t)return t}const i=this.raycaster.intersectObjects(this.lights,!0);if(i.length>0){const t=this.closestLightInScene(i[0].object);if(t)return t}const o=this.raycaster.intersectObjects(this.pickers,!0);if(o.length>0){const t=this.closestLightInScene(o[0].object);if(t)return t}return null},setCurrentObjectByPointer:function(t){if(this.raycaster.setFromCamera(t,this.engine.camera),this.lightHelperStatus){const t=this.raycaster.intersectObjects(this.targets,!0);if(t.length){const e=this.closestLightTargetControlInScene(t[0].object);if(e)return this.transformMode="basic",void this.attachLightTargetControl(e)}this.currentLight&&this.currentTargetControl&&this.currentTargetControl.light==this.currentLight?(this.detactLightTargetControl(),this.transformMode="basic",this.control.attach(this.currentLight)):this.detactLightTargetControl();const e=this.raycaster.intersectObjects(this.lights,!0);if(e.length>0){const t=this.closestLightInScene(e[0].object);if(t)return void(t!=this.control.object&&(this.currentLight&&this.currentLight!=t&&this.setCurrent(null),this.setCurrent(t),this.transformMode="basic"))}const n=this.raycaster.intersectObjects(this.pickers,!0);if(n.length>0){const t=this.closestLightInScene(n[0].object);if(t)return void(t!=this.control.object&&(this.currentLight&&this.currentLight!=t&&this.setCurrent(null),this.setCurrent(t),this.transformMode="basic"))}}else{const t=this.raycaster.intersectObjects(this.objects,!0);if(t.length>0){const e=this.closestObjectInScene(t[0].object);if(e)return void(e!==this.selected&&(this.currentObject&&this.currentObject!=e&&this.setCurrent(null),this.transformMode="basic",this.setCurrent(e)))}}this.currentLight&&this.detachLight(),this.currentObject&&this.detachObject(),this.currentTargetControl&&this.scene.remove(this.currentTargetControl),this.transformMode="basic",this.control.detach(),this.setCurrent(null),this.select(null),this.selected=null},unselect:function(){this.transformMode="basic",this.control.detach(),this.setCurrent(null),this.select(null),this.selected=null},closestLightTargetControlInScene:function(t){if((0,d.Kn)(t)&&!t.isScene&&this.currentLight){var e=this.currentLight;for(let n=0;n<this.targets.length;n++){const i=this.targets[n];if(t==i&&i.light==e)return i}if(t.parent)return this.closestLightInScene(t.parent)}return null},setObjectMovable:function(t,e){this.hasDroppablePosition=!0;var n=(new j.Box3).setFromObject(t);const i=new j.Vector3;var o=n.getSize(i);this.itemSize=o,this.dropPreviewCustomObject=!0,this.itemShadowObject=t,this.areaObjects.map(function(e){e.position.y=t.position.y}),this.turnOffShadow(1e3),e&&this.checkObjectMovablePosition(e)},removeObjectMovable:function(){if(!this.hasDroppablePosition)return!1;this.itemShadowObject=null,this.hasDroppablePosition=!1;var t=this.dropPosY;this.areaObjects.map(function(e){e.position.y=t})},checkObjectMovablePosition:function(t){if(!this.hasDroppablePosition)return!1;var e=this.engine.wrapper.getBoundingClientRect(),n=t.x-e.left,i=t.y-e.top;if(n<0||i<0)return;t.x=n/e.width*2-1,t.y=-i/e.height*2+1,this.raycaster.setFromCamera(t,this.engine.camera);const o=this.raycaster.intersectObjects(this.areaObjects,!0);if(o.length>0){const t=this.closestAreaScene(o[0].object);if(t){if(this.itemShadowObject){let e={x:this.itemShadowObject.position.x,z:this.itemShadowObject.position.z},n={x:t.position.x,z:t.position.z};if((e.x!=n.x||e.z!=n.z)&&n.x>=-(this.sceneSize.width-this.itemSize.x)/2&&n.x<=(this.sceneSize.width-this.itemSize.x)/2&&n.z>=-(this.sceneSize.depth-this.itemSize.z)/2&&n.z<=(this.sceneSize.depth-this.itemSize.z)/2){let t={x:n.x,y:this.itemShadowObject.position.y,z:n.z};(0,d.MP)(this.itemShadowObject.position,n),this.emit({type:"object.position.move",position:t}),this.updateHelperByObject(this.itemShadowObject),this.turnOffShadow(1e3),this.refresh()}}}else this.turnOffShadow(1e3),this.refresh()}},isSelected:function(t){return t==this.selected||!(t.isScene||!t.parent)&&this.isSelected(t.parent)},attachObject:function(t){this.currentLight&&this.detachLight(),this.currentObject&&this.detachObject(),this.currentObject=t;var e=this.getHelper(t);return this.helper=e,this.control.attach(t),this.scene.remove(e),this.scene.add(e),!1},detachObject:function(){this.control.detach(),this.helper&&(this.helper.position.set(0,0,0),this.helper.rotation.set(0,0,0),this.helper.scale.set(1,1,1),this.scene.remove(this.helper)),this.currentObject=null,this.engine.refresh()},attachLight:function(t){if(t){this.currentObject&&this.detachObject(),this.currentLight&&this.detachLight(),this.currentLight=t,this.control.attach(t);var e=this.getLightTargetControlObject(t);e&&(this.scene.remove(e),this.scene.add(e))}else console.warn("L\u1ed7i kkho c\xf3 ligh")},detachLight:function(){this.control.detach();var t=this.getLightTargetControlObject(this.currentLight);t&&this.scene.remove(t),this.currentLight=null,this.selected=null},executeCommand:function(t){switch(this.control.object||this.selected&&(this.selected.isLight?this.attachLight(this.selected):this.attachObject(this.selected),this.transformMode=t),this.control.object&&this.control.object.isTargetControlObject&&(t="translate"),t){case"space":this.control.setSpace("local"===this.control.space?"world":"local");break;case"snap":this.control.setTranslationSnap(100),this.control.setRotationSnap(j.MathUtils.degToRad(15)),this.control.setScaleSnap(.25);break;case"unsnap":this.control.setTranslationSnap(null),this.control.setRotationSnap(null),this.control.setScaleSnap(null);break;case"translate":this.control.setMode("translate");break;case"rotate":this.control.setMode("rotate");break;case"scale":this.control.setMode("scale");break;case"upsize":this.control.setSize(this.control.size+.1);break;case"downsize":this.control.setSize(Math.max(this.control.size-.1,.1));break;case"toggle:x":this.control.showX=!this.control.showX;break;case"toggle:y":this.control.showY=!this.control.showY;break;case"toggle:z":this.control.showZ=!this.control.showZ;break;case"enable":this.control.enabled=!this.control.enabled}this.engine.refresh()},updateDropAreaAreas:function(t,e,n){var i=this;this.checkMovingEngine(),this.areaObjects.length&&this.areaObjects.map(function(t){i.moving.remove(t)});var o=-t.width/2,s=t.width/2,r=-t.depth/2,a=t.depth/2,c=t.width/101,l=t.depth/101,h=(l<c?l:c)/5;o+=c/2,s-=c/2,r+=l/2,a-=l/2;var p=n&&(0,d.hj)(e)?e:0;this.dropPosY=p;let g=o,u=r,m=this.engine.Mesh.get({geometry:{type:"box",width:c,height:h,depth:l},material:{type:"basic",params:{opacity:0},props:{transparent:!0,visible:!1}},props:{visible:!1}});for(;g<=s;){let t=u;for(;t<=a;){let e=m.clone(!0);e.position.x=g,e.position.y=p,e.position.z=t,this.areaObjects.push(e),t+=l}g+=c}this.areaObjects.map(function(t){i.moving.add(t)})}}),H=(0,C.nN)("ItemEditor").extends(Q).uses(T.p)({transformMode:"basic",hasSelectedObject:!1,allowCustom:!1,constructor:function(t,e){this.setup(t,e)},startup:function(){var t=this;this.on("pointerdown",function(e){t.poiterDowsStatus=!0;var n=t.engine.wrapper.getBoundingClientRect();if(t.onDownPosition.x=e.clientX-n.left,t.onDownPosition.y=e.clientY-n.top,!t.allowCustom||!t.selected||"basic"!=t.transformMode||t.selected.isLight||t.currentTargetControl&&t.currentTargetControl==t.control.object)return;const i=new j.Vector2;i.x=t.onDownPosition.x/n.width*2-1,i.y=-t.onDownPosition.y/n.height*2+1;const o=t.selectObjectByPointer(i);o&&o==t.selected&&!o.isLight?(e.preventDefault(),t.engine.control.enabled=!1,t.control.enabled=!1,t.hasSelectedObject=!0,t.setObjectMovable(t.selected)):(t.engine.control.enabled=!0,t.control.enabled=!0,t.hasSelectedObject=!1)}),this.on("pointerup",function(e){if(t.allowCustom){if(t.poiterDowsStatus){if(t.hasSelectedObject)return this.emit({type:"object.changed",data:t.selected,mode:"translate"}),t.engine.control.enabled=!0,t.control.enabled=!0,t.hasSelectedObject=!1,void t.removeObjectMovable();var n=t.engine.wrapper.getBoundingClientRect();if(t.onUpPosition.x=e.clientX-n.left,t.onUpPosition.y=e.clientY-n.top,t.onUpPosition.x<0||t.onUpPosition.y<0)return;0===t.onDownPosition.distanceTo(t.onUpPosition)&&(t.pointer.x=t.onUpPosition.x/n.width*2-1,t.pointer.y=-t.onUpPosition.y/n.height*2+1,t.setCurrentObjectByPointer(t.pointer))}t.poiterDowsStatus=!1}}),this.on("pointermove",function(e){if(t.allowCustom&&t.hasSelectedObject){const n=new j.Vector2;return n.x=e.clientX,n.y=e.clientY,void t.checkDObjectMovablePosition(n)}}),this.on("dbclick",function(e){var n=t.engine.wrapper.getBoundingClientRect();t.onDownPosition.x=e.clientX-n.left,t.onDownPosition.y=e.clientY-n.top;const i=new j.Vector2;i.x=t.onDownPosition.x/n.width*2-1,i.y=-t.onDownPosition.y/n.height*2+1;const o=t.selectMeshByPointer(i);if(o){const e=t.getMeshData(o);e&&t.emit({type:"attach:mesh",mesh:e})}}),this.ready(),this.emit({type:"startup",data:(0,d.dg)()})},addObject:function(t){this.objects.push(t)},getMeshData:function(t){var e=this.app.data.item.settings;for(let n=0;n<e.meshes.length;n++){const i=e.meshes[n];if(i.__ref__==t)return i}return null}}),N=n(47189);let F=(()=>{class t extends N.r{constructor(){super(),this.engineClass=L,this.editorClass=H,this.start()}set editor(t){this._editor=t,this.dispatchEvent({type:"seteditor",eventData:t})}get editor(){return this._editor}start(){var t=this;this.on("init",()=>this.addControls(this.engine.control)),this.on("engine.set",()=>{E.$o.setEngine(this.engine);const e=new(0,this.editorClass)(this,this.engine);function n(){if(!t.engine.control||!t.editor.control)return setTimeout(n,10);t.addControls(t.engine.control),t.addControls(t.editor.control)}this.editor=e,this.controls=[],this.editor.on("startup",()=>n(),!0),this.editor.on("attach:mesh",t=>this.emit({type:"editor.attach:mesh",mesh:t.mesh}))}),this.on("event.transfer",t=>{this.editor&&this.editor.emit(t.event)})}getForegrounds(){return[]}updateItemSize(){let t=this.engine.getObjectSize(this.data.appData.secret_key);null!=t&&((0,d.Kn)(this.data.item.size)||(this.data.item.size=this.data.item.size={}),(0,d.MP)(this.data.item.size,t))}captureScene(){return this.engine.capture()}parseItemData(t,e){var n={options:{},props:{},meshes:[]},i=["x","y","z"],o=e.object,s=t.settings||{};["castShadow","receiveShadow"].map(t=>{n.props[t]="object"==typeof s.props&&void 0!==s.props[t]?s.props[t]:o[t]}),["rotation","scale"].map(t=>{n.props[t]={},i.map("object"==typeof s.props&&"object"==typeof s.props[t]?e=>{n.props[t][e]=void 0!==s.props[t][e]?s.props[t][e]:o[t][e]}:e=>{n.props[t][e]=o[t][e]})}),s.options&&(0,d.MP)(n.options,s.options);const r=(t,e,i)=>{var o={ref:e,name:e.name,sid:d.W3.slug(e.name+" "+t,"_"),index:t,title:e.name,data:{},editable:[]};(0,d.Kn)(i)&&(0,d.bg)(o,i,["sid"]),n.meshes[t]=o,(0,d.kJ)(n.meshes[t].editable)||(n.meshes[t].editable=[])};if(s.meshes&&s.meshes.length)for(let a=0;a<e.meshes.length;a++){const t=e.meshes[a];let n=null;for(let e=0;e<s.meshes.length;e++){const i=s.meshes[e];t.name==i.name&&(n=i)}r(a,t,n)}else for(let a=0;a<e.meshes.length;a++)r(a,e.meshes[a],null);return n}addModelItem(t,e,n,i){var o=this;try{this.engine.addSettingModelItem(t,function(n){o.data.appData=n,o.data.item=t;var i=(0,d.MP)({},o.data.item.settings);(0,d.MP)(i,o.parseItemData(o.data.item,n));let s=(0,d.bg)({},i,["meshes"]);if(s.meshes=[],i.meshes&&i.meshes.length)for(let t=0;t<i.meshes.length;t++){const e=i.meshes[t],n=(0,d.bg)({},e,["ref"]);Object.defineProperty(n,"__ref__",{value:e.ref,configurable:!1,enumerable:!1,writable:!1}),s.meshes.push(n)}o.data.item.settings=s,o.updateItemSize(),o.engine.updateFloor();var r=o.engine.getSceneSize(),a=r.size.x,c=r.size.y,l=r.size.z,h=Math.tan((0,d.S3)(o.engine.camera.fov/2));o.engine.camera.position.z=1.5*(l/2+(a>c?a:c)/2/h),o.engine.camera.position.y=0,o.engine.camera.lookAt(0,0,0),o.engine.refresh(),"function"==typeof e&&e(n),o.dispatchEvent("model.added",n)},function(t){n&&"function"==typeof n&&n()},function(t){i&&"function"==typeof i&&i(t)})}catch(s){console.log(s),n&&"function"==typeof n&&n()}}removeModelItem(){this.data&&this.data.appData&&(this.engine.removeObject(this.data.appData.secret_key),this.emit("model.removed"))}updateInfo(t){(0,d.MP)(this.data.item,t)}updateSettings(t,e,n,i){(0,d.MP)(this.data.item.settings,t);var o={};(0,d.Kn)(e)?(e.props&&(o.props=this.data.item.settings.props),e.meshes&&(o.meshes=this.data.item.settings.meshes)):(0,d.jn)(e)&&e&&(o=this.data.item.settings),e&&this.engine.updateObjectSettings(this.data.appData.secret_key,o,n,i),this.updateItemSize()}updateMeshMaterial(t,e){if((0,d.hj)(t))for(let n=0;n<this.data.item.settings.meshes.length;n++){const i=this.data.item.settings.meshes[n];n==t&&((0,d.MP)(i.data.material,e),(0,d.Kn)(i.data)||(i.data={}),(0,d.Kn)(i.data.material)||(i.data.material={}),this.engine.updateMeshMaterial(this.data.appData.secret_key,i.name,e.type?i.data.material:e))}else if((0,d.HD)(t))for(let n=0;n<this.data.item.settings.meshes.length;n++){const i=this.data.item.settings.meshes[n];i.name==t&&((0,d.Kn)(i.data)||(i.data={}),(0,d.Kn)(i.data.material)||(i.data.material={}),(0,d.MP)(i.data.material,e),this.engine.updateMeshMaterial(this.data.appData.secret_key,i.name,e.type?i.data.material:e))}}updateEditable(t,e,n){if((0,d.hj)(t))for(let o=0;o<this.data.item.settings.meshes.length;o++){const s=this.data.item.settings.meshes[o];o==t&&((0,d.kJ)(s.editable)||(s.editable=[]),-1!=(i=s.editable.indexOf(e))&&0==n?s.editable.splice(i,1):-1==i&&n&&s.editable.push(e))}else if((0,d.HD)(t))for(let o=0;o<this.data.item.settings.meshes.length;o++){const s=this.data.item.settings.meshes[o];var i;s.name==t&&((0,d.kJ)(s.editable)||(s.editable=[]),-1!=(i=s.editable.indexOf(e))&&0==n?s.editable.splice(i,1):-1==i&&n&&s.editable.push(e))}}updateMeshTitle(t,e){if((0,d.hj)(t))for(let n=0;n<this.data.item.settings.meshes.length;n++){const i=this.data.item.settings.meshes[n];n==t&&(i.title=e)}else if((0,d.HD)(t))for(let n=0;n<this.data.item.settings.meshes.length;n++){const i=this.data.item.settings.meshes[n];i.name==t&&(i.title=e)}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=p.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Y="categories";let U=(()=>{class t{constructor(t){this.httpService=t}getAll(t){return this.httpService.get(Y+"/list",t)}get(t){return this.httpService.get(`${Y}/${t}`)}create(t){return this.httpService.post(Y+"/create",t)}update(t){return this.httpService.patch(`${Y}/update`,t)}delete(t){return this.httpService.delete(`${Y}/${t}`)}search(t){return this.httpService.get(`${Y}/list`,t)}searchNounProject(t){return this.httpService.get(`${Y}/search/nounproject`,t)}render(t){return this.httpService.download(Y+"/render",t)}getCategoryData(t){return this.httpService.getOut(t)}useCategory(t){return this.httpService.post(`${Y}/${t}/use`,{},!1)}}return t.\u0275fac=function(e){return new(e||t)(p.LFG(v.O))},t.\u0275prov=p.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var K=n(31788);let $=(()=>{class t extends K.V{constructor(){super()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=p.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var B=n(58252),V=n(66210),X=n(39540);let G=(()=>{class t extends X.O{constructor(){super(),this.app=null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=p.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var W=n(82280),tt=n(12746),et=n(79765),nt=n(14453),it=n(84514);const ot=["inputElement"];let st=(()=>{class t extends g{constructor(t,e,n){super(),this.storage=t,this.service=e,this.editor=n,this.clickSave=new p.vpe,this.isVisible=!1,this.percent=0,this.renderLoading=!0,this.downloadUrl="javascript:void(0);",this.downloadAvailable=!1,this.unsubscribe=new et.xQ,this.logo=(0,u.i)("urls.logo"),this.storage.subcribe("item",t=>{t&&t.download_source_url&&(this.downloadAvailable=!0,this.downloadUrl=t.download_source_url)},!0)}onInit(){}download(t){if(!this.downloadAvailable)return t.preventDefault(),!1}save(t){this.editor.emit("save.clicked")}handleOk(){this.isVisible=!1}handleCancel(){this.isVisible=!1}onClickUndo(){}onClickRedo(){}}return t.\u0275fac=function(e){return new(e||t)(p.Y36($),p.Y36(_),p.Y36(F))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-header"]],viewQuery:function(t,e){if(1&t&&p.Gf(ot,1),2&t){let t;p.iGM(t=p.CRH())&&(e.inputElement=t.first)}},outputs:{clickSave:"clickSave"},features:[p.qOj],decls:9,vars:1,consts:[[1,"group-first"],["href","/admin","target","_blank"],["alt","Cretip logo",1,"logo",3,"src"],[1,"group-center"],[1,"group-last"],["nz-button","","nzType","text",1,"btn","btn-primary","btn-icon",3,"click"],["src","/assets/icons/new-design/header/save.svg"]],template:function(t,e){1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"a",1),p._UZ(2,"img",2),p.qZA(),p._UZ(3,"div",3),p.qZA(),p.TgZ(4,"div",4),p.TgZ(5,"button",5),p.NdJ("click",function(t){return e.save(t)}),p._UZ(6,"img",6),p.TgZ(7,"span"),p._uU(8,"Save"),p.qZA(),p.qZA(),p.qZA()),2&t&&(p.xp6(2),p.s9C("src",e.logo,p.LSH))},directives:[nt.ix,it.w],styles:["[_nghost-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:100%;padding:0 24px}.group-first[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:576px}.group-center[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:220px;align-items:center}.group-center[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-right:8px}.group-center[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:last-child{margin-left:8px}.group-last[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-right:70px}.logo[_ngcontent-%COMP%]{width:46px;height:auto}.btn[_ngcontent-%COMP%]{height:28px;padding:4px 16px;line-height:1.3;border-radius:4px;cursor:pointer}.btn-ghost[_ngcontent-%COMP%]{background-color:#1b1818;border:1px solid #c6c6c6;color:#c6c6c6;border:none}.btn-ghost[_ngcontent-%COMP%]:hover{background-color:#262222;color:#fff}.btn-primary[_ngcontent-%COMP%]{background-color:#4a4ded;color:#fff;border:none}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#4a4dedb0}.btn-icon[_ngcontent-%COMP%]{display:flex;align-items:center}.btn-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .btn-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:14px}.btn-icon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:8px}.ant-avatar[_ngcontent-%COMP%]{cursor:pointer;margin-left:24px}"]}),t})();var rt=n(21464),at=n(25917);const ct="images",lt=["images","list","foreground","background"];let ht=(()=>{class t{constructor(t){this.httpService=t}getAll(t){return this.httpService.get(ct+"/list.json",t)}getImageFromUrl(t,e){return this.httpService.get(ct+"/list.json",e)}getImages(t,e){return(0,d.d3)(lt,t)?("image"==t&&(t="list"),this.httpService.get(ct+"/"+t+".json",e)):(0,at.of)({data:[],pageCount:0,total:0,page:1,count:0,message:"image list not found",status:0})}getBackgrounds(t){return this.httpService.get(ct+"/background.json",t)}getForegrounds(t){return this.httpService.get(ct+"/foreground.json",t)}get(t){return this.httpService.get(`${ct}/${t}.json`)}create(t){return this.httpService.post(ct+"/actions.json",t)}update(t){return this.httpService.patch(`${ct}/actions.json`,t)}delete(t){return this.httpService.delete(`${ct}/actions.json`)}search(t){return this.httpService.get(`${ct}/list.json`,t)}searchNounProject(t){return this.httpService.get(`${ct}/search/nounproject`,t)}render(t){return this.httpService.download("Images/render",t)}getImageData(t){return this.httpService.getOut(t)}useImage(t){return this.httpService.post(`${ct}/${t}/use`,{},!1)}}return t.\u0275fac=function(e){return new(e||t)(p.LFG(v.O))},t.\u0275prov=p.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),pt=(()=>{class t extends X.O{constructor(){super()}open(t,e,n){var i,o={};return(0,d.mf)(t)?(i=t,(0,d.Kn)(e)&&e?o=e:(0,d.mf)(e)&&(n=e)):((0,d.Kn)(t)&&((0,d.mf)((o=t).done)&&(i=o.done),(0,d.mf)(o.cancel)&&(n=o.cancel)),!(0,d.mf)(i)&&(0,d.mf)(e)&&(i=e)),this.emit({type:"open",config:o,callback:i,cancel:n}),this}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=p.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var dt=n(26214),gt=n(29374),ut=n(29790);function mt(t,e){if(1&t&&p._uU(0),2&t){const t=p.oxw();p.Oqu(t.title)}}function ft(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div",6),p.NdJ("click",function(){p.CHM(t);const n=e.$implicit;return p.oxw(2).selectImage(n.id)}),p.TgZ(1,"div",7),p._UZ(2,"img",8),p.qZA(),p.TgZ(3,"div",9),p.TgZ(4,"div",10),p.TgZ(5,"span"),p.TgZ(6,"strong"),p._uU(7),p.qZA(),p._uU(8),p.qZA(),p.qZA(),p.TgZ(9,"div",11),p._uU(10),p.qZA(),p.qZA(),p.TgZ(11,"div",12),p.O4$(),p.TgZ(12,"svg",13),p.TgZ(13,"title"),p._uU(14,"Check"),p.qZA(),p._UZ(15,"defs"),p.TgZ(16,"g",14),p._UZ(17,"path",15),p.qZA(),p.qZA(),p.qZA(),p.kcU(),p.TgZ(18,"a",16),p.O4$(),p.TgZ(19,"svg",13),p.TgZ(20,"title"),p._uU(21,"X\xf3a"),p.qZA(),p._UZ(22,"defs"),p.TgZ(23,"g",17),p.TgZ(24,"g",18),p._UZ(25,"path",19),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.kcU(),p.TgZ(26,"div",20),p.TgZ(27,"span"),p._uU(28),p.qZA(),p.qZA(),p.qZA()}if(2&t){const t=e.$implicit;p.ekj("selected",t.selected),p.xp6(2),p.s9C("src",t.thumbnail,p.LSH),p.s9C("alt",t.filename),p.xp6(5),p.Oqu(t.size),p.xp6(1),p.hij(" ",t.size_unit," "),p.xp6(2),p.hij(" ",t.filename," "),p.xp6(18),p.hij(" ",t.filename," ")}}function vt(t,e){if(1&t&&(p.TgZ(0,"div",4),p.YNc(1,ft,29,8,"div",5),p.qZA()),2&t){const t=p.oxw();p.xp6(1),p.Q6J("ngForOf",t.images)}}function bt(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"button",21),p.NdJ("click",function(){return p.CHM(t),p.oxw().handleOk()}),p._uU(1),p.ALo(2,"translate"),p.qZA(),p.TgZ(3,"button",22),p.NdJ("click",function(){return p.CHM(t),p.oxw().handleCancel()}),p._uU(4),p.ALo(5,"translate"),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("nzLoading",t.isConfirmLoading),p.xp6(1),p.Oqu(p.lcZ(2,3,"Choose")),p.xp6(3),p.Oqu(p.lcZ(5,5,"Cancel"))}}let _t=(()=>{class t extends g{constructor(t,e,n){super(),this.events=t,this.imageService=e,this.cd=n,this.title="Image Library",this.oldTitle="Image Library",this.url="",this.params={},this.lastUrl="",this.lastParams={},this.mode="single",this.images=[],this.isVisible=!1,this.isConfirmLoading=!1,this.onDone=null,this.onCancel=null,this.listType="list",this.oldListType="list",this.registerEventService(t,{open:t=>this.show(t.config,t.callback,t.cancel)})}onInit(){this.activeEventServiceRegistered(this.events)}onDestroy(){this.deactiveEventServiceRegistered(this.events)}show(t,e,n){this.onDone=null,this.onCancel=null,(0,d.Kn)(t)&&(t.title&&(this.title=t.title),t.url&&(this.url=t.url),t.mode&&(0,d.d3)(["single","simple","many","one"],String(t.mode).toLowerCase())&&(this.mode=t.mode),(0,d.Kn)(t.params)&&(0,d.MP)(this.params,t.params),this.listType=t.listType&&(0,d.d3)(lt,t.listType)?t.listType:"list","function"==typeof e?this.onDone=e:"function"==typeof t.done&&(this.onDone=t.done),"function"==typeof n?this.onCancel=n:"function"==typeof t.cancel&&(this.onCancel=t.cancel)),this.showModal()}showModal(){this.isVisible=!0,0==this.images.length?this.firstLoad():this.listType!=this.oldListType&&(this.images=[],this.firstLoad())}firstLoad(){this.imageService.getImages(this.listType,this.params).subscribe(t=>{t.status&&t.data&&t.data.length&&this.appendImageFiles(t.data)})}appendImageFiles(t){t.map(t=>{t.selected=!1,this.images.push(t),"hdr"==t.extension&&this.proccessHDRThumbnail(t)})}proccessHDRThumbnail(t){t.thumbnail=E.lY,this.app&&this.app.engine.Loader.LoadEnv({format:"hdr",file:t.source||t.url||t.file},function(e,n){var i=rt.Z.get2DMap(n,240,120);i&&(t.thumbnail=i)})}selectImage(t){"many"!=this.mode&&this.images.map((e,n,i)=>{e.selected=e.id==t})}handleOk(){let t=null;if("many"!=this.mode){if(this.images.map((e,n,i)=>{e.selected&&(t=e,e.selected=!1)}),!t)return window.alert("Vui l\xf2ng ch\u1ecdn \u1ea3nh")}else if(t=[],this.images.map((e,n,i)=>{e.selected&&(t.push(e),e.selected=!1)}),!t.length)return window.alert("Vui l\xf2ng ch\u1ecdn \u1ea3nh");this.isConfirmLoading=!0,setTimeout(()=>{"function"==typeof this.onDone&&this.onDone(t),this.isVisible=!1,this.oldListType=this.listType,this.isConfirmLoading=!1},1e3)}handleCancel(){this.isVisible=!1,this.oldListType=this.listType,"function"==typeof this.onCancel&&this.onCancel()}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(pt),p.Y36(ht),p.Y36(p.sBO))},t.\u0275cmp=p.Xpm({type:t,selectors:[["modal-image-library"]],inputs:{app:"app"},features:[p.qOj],decls:7,vars:5,consts:[[3,"nzVisible","nzTitle","nzContent","nzFooter","nzWidth","nzVisibleChange","nzOnCancel"],["modalTitle",""],["modalContent",""],["modalFooter",""],[1,"images","image-results"],["class","img-preview img-processing img-image-preview",3,"selected","click",4,"ngFor","ngForOf"],[1,"img-preview","img-processing","img-image-preview",3,"click"],[1,"img-image"],[3,"src","alt"],[1,"img-details"],[1,"img-size"],[1,"img-filename"],[1,"img-success-mark"],["width","54px","height","54px","viewBox","0 0 54 54","version","1.1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink",0,"xmlns","sketch","http://www.bohemiancoding.com/sketch/ns"],["id","Page-1","stroke","none","stroke-width","4","fill","none","fill-rule","evenodd",0,"sketch","type","MSPage"],["d","M23.5,31.8431458 L17.5852419,25.9283877 C16.0248253,24.3679711 13.4910294,24.366835 11.9289322,25.9289322 C10.3700136,27.4878508 10.3665912,30.0234455 11.9283877,31.5852419 L20.4147581,40.0716123 C20.5133999,40.1702541 20.6159315,40.2626649 20.7218615,40.3488435 C22.2835669,41.8725651 24.794234,41.8626202 26.3461564,40.3106978 L43.3106978,23.3461564 C44.8771021,21.7797521 44.8758057,19.2483887 43.3137085,17.6862915 C41.7547899,16.1273729 39.2176035,16.1255422 37.6538436,17.6893022 L23.5,31.8431458 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z","id","Oval-2","stroke-opacity","0.198794158","stroke","#ffffff","fill-opacity","0.816519475","fill","#00bc00",0,"sketch","type","MSShapeGroup"],["href","javascript:void(0);",1,"img-remove","btn-remove-image-file"],["id","Page-1","stroke","none","stroke-width","1","fill","none","fill-rule","evenodd",0,"sketch","type","MSPage"],["id","Check-+-Oval-2",0,"sketch","type","MSLayerGroup","stroke","#747474","stroke-opacity","0.198794158","fill","#FF0000","fill-opacity","0.816519475"],["d","M32.6568542,29 L38.3106978,23.3461564 C39.8771021,21.7797521 39.8758057,19.2483887 38.3137085,17.6862915 C36.7547899,16.1273729 34.2176035,16.1255422 32.6538436,17.6893022 L27,23.3431458 L21.3461564,17.6893022 C19.7823965,16.1255422 17.2452101,16.1273729 15.6862915,17.6862915 C14.1241943,19.2483887 14.1228979,21.7797521 15.6893022,23.3461564 L21.3431458,29 L15.6893022,34.6538436 C14.1228979,36.2202479 14.1241943,38.7516113 15.6862915,40.3137085 C17.2452101,41.8726271 19.7823965,41.8744578 21.3461564,40.3106978 L27,34.6568542 L32.6538436,40.3106978 C34.2176035,41.8744578 36.7547899,41.8726271 38.3137085,40.3137085 C39.8758057,38.7516113 39.8771021,36.2202479 38.3106978,34.6538436 L32.6568542,29 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z","id","Oval-2",0,"sketch","type","MSShapeGroup"],[1,"img-outer-filename"],["nz-button","","nzType","primary",3,"nzLoading","click"],["nz-button","","nzType","default",3,"click"]],template:function(t,e){if(1&t&&(p.TgZ(0,"nz-modal",0),p.NdJ("nzVisibleChange",function(t){return e.isVisible=t})("nzOnCancel",function(){return e.handleCancel()}),p.YNc(1,mt,1,1,"ng-template",null,1,p.W1O),p.YNc(3,vt,2,1,"ng-template",null,2,p.W1O),p.YNc(5,bt,6,7,"ng-template",null,3,p.W1O),p.qZA()),2&t){const t=p.MAs(2),n=p.MAs(4),i=p.MAs(6);p.Q6J("nzVisible",e.isVisible)("nzTitle",t)("nzContent",n)("nzFooter",i)("nzWidth",1200)}},directives:[dt.du,i.sg,nt.ix,gt.dQ,it.w],pipes:[ut.X$],styles:['.image-item[_ngcontent-%COMP%], gallery-image-item[_ngcontent-%COMP%]{display:inline-block;width:80px;margin:10px}.image-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], gallery-image-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80px;height:80px;-o-object-fit:cover;object-fit:cover}image-results[_ngcontent-%COMP%]{box-sizing:border-box}image-results[_ngcontent-%COMP%]   .image-list[_ngcontent-%COMP%]{max-height:450px;overflow-y:auto}.img-preview[_ngcontent-%COMP%]{position:relative;display:inline-block;vertical-align:top;margin:16px 14px;min-height:100px}.img-preview[_ngcontent-%COMP%]:hover{z-index:1000}.img-preview[_ngcontent-%COMP%]:hover   .img-details[_ngcontent-%COMP%]{opacity:1}.img-preview.img-file-preview[_ngcontent-%COMP%]   .img-image[_ngcontent-%COMP%]{border-radius:20px;background:#999;background:linear-gradient(to bottom,#eee,#ddd)}.img-preview.img-file-preview[_ngcontent-%COMP%]   .img-details[_ngcontent-%COMP%]{opacity:1}.img-preview.img-file-preview[_ngcontent-%COMP%], .img-preview.img-image-preview[_ngcontent-%COMP%]{background:#fff}.img-preview.img-image-preview[_ngcontent-%COMP%]   .img-details[_ngcontent-%COMP%]{transition:opacity .2s linear}.img-preview[_ngcontent-%COMP%]   .img-remove[_ngcontent-%COMP%]{font-size:14px;text-align:center;display:block;cursor:pointer;border:none}.img-preview[_ngcontent-%COMP%]   .img-remove[_ngcontent-%COMP%]:hover{text-decoration:underline}.img-preview[_ngcontent-%COMP%]:hover   .img-details[_ngcontent-%COMP%]{opacity:1}.img-preview[_ngcontent-%COMP%]   .img-details[_ngcontent-%COMP%]{cursor:pointer;z-index:20;position:absolute;top:0;left:0;opacity:0;font-size:13px;min-width:100%;max-width:100%;padding:2em 1em;text-align:center;color:#000000e6;line-height:150%}.img-preview[_ngcontent-%COMP%]   .img-details[_ngcontent-%COMP%]   .img-size[_ngcontent-%COMP%]{margin-bottom:1em;font-size:16px}.img-preview[_ngcontent-%COMP%]   .img-details[_ngcontent-%COMP%]   .img-filename[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%]{border:1px solid rgba(200,200,200,.8);background-color:#fffc}.img-preview[_ngcontent-%COMP%]   .img-details[_ngcontent-%COMP%]   .img-filename[_ngcontent-%COMP%]:not(:hover){overflow:hidden;text-overflow:ellipsis}.img-preview[_ngcontent-%COMP%]   .img-details[_ngcontent-%COMP%]   .img-filename[_ngcontent-%COMP%]:not(:hover)   span[_ngcontent-%COMP%]{border:1px solid transparent}.img-preview[_ngcontent-%COMP%]   .img-details[_ngcontent-%COMP%]   .img-size[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .img-preview[_ngcontent-%COMP%]   .img-details[_ngcontent-%COMP%]   .img-filename[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background-color:#fff6;padding:0 .4em;border-radius:3px}.img-preview[_ngcontent-%COMP%]:hover   .img-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{transform:scale(1.05);filter:blur(8px)}.img-preview[_ngcontent-%COMP%]   .img-image[_ngcontent-%COMP%]{border-radius:20px;overflow:hidden;width:120px;height:120px;position:relative;display:block;z-index:10}.img-preview[_ngcontent-%COMP%]   .img-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:block;-o-object-fit:cover;object-fit:cover;width:120px;height:120px}.img-preview.img-success[_ngcontent-%COMP%]   .img-success-mark[_ngcontent-%COMP%]{-webkit-animation:passing-through 3s cubic-bezier(.77,0,.175,1);animation:passing-through 3s cubic-bezier(.77,0,.175,1)}.img-preview.img-error[_ngcontent-%COMP%]   .img-error-mark[_ngcontent-%COMP%]{opacity:1;-webkit-animation:slide-in 3s cubic-bezier(.77,0,.175,1);animation:slide-in 3s cubic-bezier(.77,0,.175,1)}.img-preview.img-error[_ngcontent-%COMP%]   .img-error-message[_ngcontent-%COMP%]{display:block}.img-preview.img-error[_ngcontent-%COMP%]:hover   .img-error-message[_ngcontent-%COMP%]{opacity:1;pointer-events:auto}.img-preview[_ngcontent-%COMP%]   .img-error-mark[_ngcontent-%COMP%], .img-preview[_ngcontent-%COMP%]   .img-success-mark[_ngcontent-%COMP%]{pointer-events:none;opacity:0;z-index:500;position:absolute;display:block;top:60px;left:60px;margin-left:-27px;margin-top:-27px}.img-preview[_ngcontent-%COMP%]   .img-error-mark[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .img-preview[_ngcontent-%COMP%]   .img-success-mark[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{display:block;width:54px;height:54px}.img-preview.img-processing[_ngcontent-%COMP%]   .img-progress[_ngcontent-%COMP%]{opacity:1;transition:all .2s linear}.img-preview.img-complete[_ngcontent-%COMP%]   .img-progress[_ngcontent-%COMP%]{opacity:0;transition:opacity .4s ease-in}.img-preview[_ngcontent-%COMP%]:not(.img-processing)   .img-progress[_ngcontent-%COMP%]{-webkit-animation:pulse 6s ease infinite;animation:pulse 6s ease infinite}.img-preview[_ngcontent-%COMP%]   .img-progress[_ngcontent-%COMP%]{opacity:1;z-index:1000;pointer-events:none;position:absolute;height:16px;left:50%;top:50%;margin-top:-8px;width:80px;margin-left:-40px;background:rgba(255,255,255,.9);-webkit-transform:scale(1);border-radius:8px;overflow:hidden}.img-preview[_ngcontent-%COMP%]   .img-progress[_ngcontent-%COMP%]   .img-upload[_ngcontent-%COMP%]{background:#333;background:linear-gradient(to bottom,#666,#444);position:absolute;top:0;left:0;bottom:0;width:0;transition:width .3s ease-in-out}.img-preview[_ngcontent-%COMP%]   .img-error-message[_ngcontent-%COMP%]{pointer-events:none;z-index:1000;position:absolute;display:block;display:none;opacity:0;transition:opacity .3s ease;border-radius:8px;font-size:13px;bottom:130px;left:-10px;width:140px;background:#be2626;background:linear-gradient(to bottom,#be2626,#a92222);padding:.5em 1.2em;color:#fff}.img-preview[_ngcontent-%COMP%]   .img-error-message[_ngcontent-%COMP%]:after{content:"";position:absolute;top:-6px;left:64px;width:0;height:0;border-left:6px solid transparent;border-right:6px solid transparent;border-bottom:6px solid #be2626}.img-preview[_ngcontent-%COMP%]   .img-outer-filename[_ngcontent-%COMP%]{width:120px;overflow:hidden;word-wrap:break-word}.img-preview[_ngcontent-%COMP%]   .btn-remove-image-file[_ngcontent-%COMP%]{position:absolute;top:5px;right:5px;display:block;z-index:100;opacity:.3}.img-preview[_ngcontent-%COMP%]   .btn-remove-image-file[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px}.img-preview[_ngcontent-%COMP%]   .img-success-mark[_ngcontent-%COMP%]{cursor:pointer}.img-preview[_ngcontent-%COMP%]:hover   .btn-remove-image-file[_ngcontent-%COMP%]{opacity:.7}.img-preview[_ngcontent-%COMP%]:hover   .btn-remove-image-file[_ngcontent-%COMP%]:hover{opacity:1}.img-preview.selected[_ngcontent-%COMP%]   .img-success-mark[_ngcontent-%COMP%]{opacity:1;z-index:100;cursor:pointer}.img-preview.selected[_ngcontent-%COMP%]   .img-details[_ngcontent-%COMP%], .img-preview.selected[_ngcontent-%COMP%]:hover   .img-details[_ngcontent-%COMP%]{opacity:0}.img-preview[_ngcontent-%COMP%]   .img-details[_ngcontent-%COMP%]   .img-filename[_ngcontent-%COMP%]{white-space:nowrap}.img-preview[_ngcontent-%COMP%]   .img-details[_ngcontent-%COMP%]   .img-filename[_ngcontent-%COMP%]:hover{overflow:hidden;text-overflow:ellipsis}.img-preview[_ngcontent-%COMP%]   .img-details[_ngcontent-%COMP%]   .img-filename[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%]{background-color:#fff6;padding:0 .4em;border-radius:3px;border:1px solid transparent}.image-results[_ngcontent-%COMP%]{min-height:150px;background:#fff;color:#000;padding:20px 0;max-height:450px;overflow-y:auto}']}),t})();var xt=n(60945);let wt=(()=>{class t{constructor(){this.name="",this.value="",this.label="",this.placeholder="",this.valueType=null,this.config=null,this.attach=null,this.hasAttach=!1,this.old="",this.subcribe=new p.vpe,this.defaultValues={name:"",label:"",value:"",placeholder:""}}onChange(t){(0,d.Kn)(t)&&Object.prototype.hasOwnProperty.call(t,"value")&&(this.value=t.value),(0,d.Kn)(this.old)&&(0,d.Kn)(this.value)?JSON.stringify(this.old)!==JSON.stringify(this.value)&&this.emit():this.old!==this.value&&this.emit()}onAttachChange(t){this.subcribe.emit({name:t.name,value:t.value})}emit(){var t=(0,d.Kn)(this.value)?(0,d.MP)({},this.value):this.value;"function"==typeof this.onInpValChange&&this.onInpValChange(t),this.subcribe.emit({name:this.name,value:t,old:this.old}),this.old=t}set val(t){this.value=t,this.onChange({type:"change",value:t})}inpInit(){var t=this,e=["name","label","value","placeholder","valueType"];this.config&&(0,d.Kn)(this.config)&&!(0,d.xb)(this.config)&&(void 0!==t.configProps&&(0,d.kJ)(t.configProps)&&t.configProps.map(t=>-1==e.indexOf(t)?e.push(t):t),e.map(e=>{Object.prototype.hasOwnProperty.call(t,e)&&Object.prototype.hasOwnProperty.call(this.config,e)&&t[e]===this.defaultValues[e]&&(t[e]=this.config[e])}),this.label||(this.label=this.name),this.config.attach&&(0,d.Kn)(this.config.attach)&&!(0,d.xb)(this.config.attach))&&((0,d.Kn)(this.attach)||(this.attach={}),["name","label","value","placeholder","min","max","step"].map(t=>{Object.prototype.hasOwnProperty.call(this.attach,t)?Object.prototype.hasOwnProperty.call(this.config.attach,t)&&this.attach[t]===this.defaultValues[t]&&(this.attach[t]=this.config.attach[t]):Object.prototype.hasOwnProperty.call(this.config.attach,t)&&(this.attach[t]=this.config.attach[t])})),(0,d.xb)(this.attach)||(this.hasAttach=!0)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.Xpm({type:t,selectors:[["ng-component"]],inputs:{name:"name",value:"value",label:"label",placeholder:"placeholder",valueType:"valueType",config:"config",attach:"attach"},outputs:{subcribe:"subcribe"},decls:0,vars:0,template:function(t,e){},encapsulation:2}),t})();var yt=n(57674),Ct=n(3679);let Ot=(()=>{class t extends wt{constructor(){super()}ngOnInit(){this.inpInit(),this.old=this.value}onChangeValue(t){this.old!==this.value&&this.emit()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.Xpm({type:t,selectors:[["inp-text-group"]],features:[p.qOj],decls:6,vars:7,consts:[[1,"inner-box"],[1,"input-wrapper"],["nz-input","",3,"placeholder","ngModel","ngModelChange","input","change"]],template:function(t,e){1&t&&(p.TgZ(0,"div",0),p._uU(1),p.ALo(2,"translate"),p.qZA(),p.TgZ(3,"div",1),p.TgZ(4,"input",2),p.NdJ("ngModelChange",function(t){return e.value=t})("input",function(t){return e.onChangeValue(t)})("change",function(t){return e.onChangeValue(t)}),p.ALo(5,"translate"),p.qZA(),p.qZA()),2&t&&(p.xp6(1),p.Oqu(e.label?e.label:p.lcZ(2,3,e.name)),p.xp6(3),p.s9C("placeholder",e.placeholder?e.placeholder:p.lcZ(5,5,e.name)),p.Q6J("ngModel",e.value))},directives:[yt.Zp,Ct.Fj,Ct.JJ,Ct.On],pipes:[ut.X$],styles:["[_nghost-%COMP%]{display:block;margin-top:10px;margin-bottom:15px}"]}),t})();var Mt=n(16704);let Pt=(()=>{class t{constructor(){this.name="input",this.value="",this.label="",this.placeholder="",this.old="",this.subcribe=new p.vpe}parseValue(t){switch(this.valueType){case"number":return Number(t);case"boolean":return(0,d.jn)(t)?t:Boolean(t)}return t}onChange(t){(0,d.Kn)(t)&&Object.prototype.hasOwnProperty.call(t,"value")&&(this.value=t.value),(0,d.Kn)(this.old)&&(0,d.Kn)(this.value)?JSON.stringify(this.old)!==JSON.stringify(this.value)&&this.emit():this.old!==this.value&&this.emit()}emit(){var t=(0,d.Kn)(this.value)?(0,d.MP)({},this.value):this.value;this.subcribe.emit({name:this.name,value:t,old:this.old}),this.old=t}set val(t){this.value=t,this.onChange({type:"change",value:t})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.Xpm({type:t,selectors:[["ng-component"]],inputs:{name:"name",value:"value",label:"label",placeholder:"placeholder",valueType:"valueType"},outputs:{subcribe:"subcribe"},decls:0,vars:0,template:function(t,e){},encapsulation:2}),t})();var St=n(80269);function kt(t,e){if(1&t&&p._UZ(0,"nz-option",2),2&t){const t=e.$implicit;p.Q6J("nzValue",t.value)("nzLabel",t.label)}}let Zt=(()=>{class t extends Pt{constructor(t){super(),this.cd=t,this.fullwidth=!1,this._options=[]}ngOnChanges(t){t.options&&this.syncFromParent()}ngOnInit(){this.syncFromParent()}syncFromParent(){let t=!1;if((0,d.kJ)(this.options))this._options=[],this.options.map(t=>{(0,d.Kn)(t)?Object.prototype.hasOwnProperty.call(t,"value")&&Object.prototype.hasOwnProperty.call(t,"label")&&this._options.push(t):((0,d.HD)(t)||(0,d.hj)(t))&&this._options.push({value:t,label:t})});else if((0,d.Kn)(this.options)){let t=!1;this._options.splice(0);for(const e in this.options)if(Object.prototype.hasOwnProperty.call(this.options,e)){const n=this.options[e];(0,d.Kn)(n)?Object.prototype.hasOwnProperty.call(n,"value")&&Object.prototype.hasOwnProperty.call(n,"label")&&this._options.push(n):(0,d.HD)(n)&&(t=!0,this._options.push({value:e,label:n}))}t&&(this.value=String(this.value))}this._options.length&&(this._options.map(e=>{e.value==this.value&&(t=!0)}),t||(this.value=this._options[0].value))}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(p.sBO))},t.\u0275cmp=p.Xpm({type:t,selectors:[["inp-select"]],inputs:{fullwidth:"fullwidth",options:"options"},features:[p.qOj,p.TTD],decls:2,vars:4,consts:[[3,"ngModel","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],[3,"nzValue","nzLabel"]],template:function(t,e){1&t&&(p.TgZ(0,"nz-select",0),p.NdJ("ngModelChange",function(t){return e.value=t})("ngModelChange",function(t){return e.onChange(t)}),p.YNc(1,kt,1,2,"nz-option",1),p.qZA()),2&t&&(p.ekj("width-100",e.fullwidth),p.Q6J("ngModel",e.value),p.xp6(1),p.Q6J("ngForOf",e._options))},directives:[St.Vq,Ct.JJ,Ct.On,i.sg,St.Ip],styles:["nz-select.width-100[_ngcontent-%COMP%]{width:100%}"]}),t})(),zt=(()=>{class t extends g{constructor(){super(...arguments),this.config=null,this.subcribe=new p.vpe,this.editable=new p.vpe}parseValue(t){if((0,d.aX)(this.config,"valueType"))switch(this.config.valueType){case"number":return Number(t);case"boolean":return(0,d.jn)(t)?t:Boolean(t)}return t}onChange(t){(0,d.Kn)(t)&&Object.prototype.hasOwnProperty.call(t,"value")&&(this.config.value=t.value),this.subcribe.emit({value:this.parseValue(this.config.value),name:this.config.name,editable:this.config.editable})}onEditable(t){this.config.editable=!!t.value,this.editable.emit({name:this.config.name,status:this.config.editable})}valChange(t){this.onChange({value:t})}}return t.\u0275fac=function(e){return Tt(e||t)},t.\u0275cmp=p.Xpm({type:t,selectors:[["ng-component"]],inputs:{config:"config"},outputs:{subcribe:"subcribe",editable:"editable"},features:[p.qOj],decls:0,vars:0,template:function(t,e){},encapsulation:2}),t})();const Tt=p.n5z(zt);var Et=n(52079),At=n(48453);function Dt(t,e){1&t&&p._UZ(0,"i",3)}function qt(t,e){1&t&&p._UZ(0,"i",4)}let It=(()=>{class t extends Pt{constructor(){super()}ngOnInit(){}onChangeState(t){this.emit()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.Xpm({type:t,selectors:[["active-switch"]],features:[p.qOj],decls:5,vars:3,consts:[[3,"ngModel","nzCheckedChildren","nzUnCheckedChildren","ngModelChange"],["checkedTemplate",""],["unCheckedTemplate",""],["nz-icon","","nzType","check"],["nz-icon","","nzType","close"]],template:function(t,e){if(1&t&&(p.TgZ(0,"nz-switch",0),p.NdJ("ngModelChange",function(t){return e.value=t})("ngModelChange",function(t){return e.onChangeState(t)}),p.qZA(),p.YNc(1,Dt,1,0,"ng-template",null,1,p.W1O),p.YNc(3,qt,1,0,"ng-template",null,2,p.W1O)),2&t){const t=p.MAs(2),n=p.MAs(4);p.Q6J("ngModel",e.value)("nzCheckedChildren",t)("nzUnCheckedChildren",n)}},directives:[At.i,Ct.JJ,Ct.On,it.w,xt.Ls],styles:[""]}),t})();const Jt=function(){return{xs:8,sm:16,md:24,lg:32}};let Lt=(()=>{class t extends zt{constructor(){super()}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.Xpm({type:t,selectors:[["activate-checkbox"]],features:[p.qOj],decls:11,vars:11,consts:[["nz-row","",1,"input-group",3,"nzGutter"],["nz-col","",1,"gutter-row",3,"nzSpan"],[1,"inner-box"],[1,"inner-box","text-right"],["nz-checkbox","",3,"ngModel","ngModelChange"],[3,"name","value","valueChange","subcribe"]],template:function(t,e){1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"div",1),p.TgZ(2,"div",2),p._uU(3),p.ALo(4,"translate"),p.qZA(),p.qZA(),p.TgZ(5,"div",1),p.TgZ(6,"div",3),p.TgZ(7,"label",4),p.NdJ("ngModelChange",function(t){return e.config.value=t})("ngModelChange",function(t){return e.valChange(t)}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(8,"div",1),p.TgZ(9,"div",2),p.TgZ(10,"active-switch",5),p.NdJ("valueChange",function(t){return e.config.editable=t})("subcribe",function(t){return e.onEditable(t)}),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t&&(p.Q6J("nzGutter",p.DdM(10,Jt)),p.xp6(1),p.Q6J("nzSpan",14),p.xp6(2),p.Oqu(p.lcZ(4,8,e.config.name)),p.xp6(2),p.Q6J("nzSpan",5),p.xp6(2),p.Q6J("ngModel",e.config.value),p.xp6(1),p.Q6J("nzSpan",5),p.xp6(2),p.Q6J("name",e.config.name)("value",e.config.editable))},directives:[Mt.SK,Mt.t3,Et.Ie,Ct.JJ,Ct.On,It],pipes:[ut.X$],styles:[".input-group[_ngcontent-%COMP%]{margin:10px auto;border-top:1px solid #ababab;padding-top:10px;padding-bottom:10px}.text-right[_ngcontent-%COMP%]{text-align:right!important}"]}),t})(),jt=(()=>{class t extends Pt{constructor(t,e){super(),this.libraryService=t,this.cd=e,this.outputImage=E.lY,this.listType="list",this.modalCancelSelect=new p.vpe,this.onCloseLibrary=new p.vpe}ngOnInit(){this.value&&(this.image=this.value)}set image(t){if((0,d.HD)(t))this.outputImage=t;else if((0,d.Kn)(t))if(t.image){var e=rt.Z.get2DMap(t,100,100);e&&(this.outputImage=e)}else{var n=this;if(null!=t&&(0,d.Kn)(t)&&t.file){var i="";t.path?(i="/"==t.substr(t.path.length-1,1)?t.path:t.path+"/","/"==t.file.substr(0,1)?i+=t.file.substr(1):i+=t.file):i=t.file,"hdr"!=t.format&&"hdr"!=t.extension?(0,d.tg)(i,60,60,function(t){n.outputImage=t}):E.$o.LoadEnv({format:"hdr",file:i},(t,e)=>{var n=rt.Z.get2DMap(e,240,120);n&&(this.outputImage=n,this.cd.detectChanges())})}}}chooseTexture(){this.libraryService.open({title:this.name,mode:"simple",listType:this.listType},t=>{this.onSelectImage(t),this.onCloseLibrary.emit(!0)},()=>{this.modalCancelSelect.emit(!0),this.onCloseLibrary.emit(!0)})}onSelectImage(t){this.outputImage=t.thumbnail,this.value=t.source,this.subcribe.emit({name:this.name,value:this.value,old:this.old,file:t}),this.old=this.value,"hdr"==t.extension&&(this.image={file:t.source,format:"hdr"})}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(pt),p.Y36(p.sBO))},t.\u0275cmp=p.Xpm({type:t,selectors:[["inp-texture"]],inputs:{listType:"listType"},outputs:{modalCancelSelect:"modalCancelSelect",onCloseLibrary:"onCloseLibrary"},features:[p.qOj],decls:2,vars:1,consts:[[1,"output","output-texture",3,"click"],["alt","Texture",1,"thumb",3,"src"]],template:function(t,e){1&t&&(p.TgZ(0,"div",0),p.NdJ("click",function(){return e.chooseTexture()}),p._UZ(1,"img",1),p.qZA()),2&t&&(p.xp6(1),p.s9C("src",e.outputImage,p.LSH))},styles:[".output-texture[_ngcontent-%COMP%]{width:40px;height:40px;display:inline-block;border:.5px solid #dadada;border-radius:5px}.output-texture[_ngcontent-%COMP%]   img.thumb[_ngcontent-%COMP%]{width:38px;height:38px;border-radius:5px;cursor:pointer}"]}),t})();var Rt=n(34582),Qt=n(90343);function Ht(t,e){1&t&&p.GkF(0)}const Nt=function(){return{xs:8,sm:16,md:24,lg:32}},Ft=function(){return{marginLeft:"0px"}};function Yt(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div",3),p.TgZ(1,"div",4),p.TgZ(2,"nz-slider",5),p.NdJ("ngModelChange",function(e){return p.CHM(t),p.oxw().value=e})("ngModelChange",function(e){return p.CHM(t),p.oxw().onChange(e)}),p.qZA(),p.qZA(),p.TgZ(3,"div",4),p.TgZ(4,"div",6),p.TgZ(5,"nz-input-number",7),p.NdJ("ngModelChange",function(e){return p.CHM(t),p.oxw().value=e})("ngModelChange",function(e){return p.CHM(t),p.oxw().onChange(e)}),p.qZA(),p.qZA(),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("nzGutter",p.DdM(14,Nt)),p.xp6(1),p.Q6J("nzSpan",16),p.xp6(1),p.Q6J("name",t.name)("nzMin",t.min)("nzMax",t.max)("nzStep",t.step)("ngModel",t.value),p.xp6(1),p.Q6J("nzSpan",8),p.xp6(2),p.Q6J("name",t.name)("nzMin",t.min)("nzMax",t.max)("nzStep",t.step)("ngModel",t.value)("ngStyle",p.DdM(15,Ft))}}function Ut(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"nz-slider",5),p.NdJ("ngModelChange",function(e){return p.CHM(t),p.oxw().value=e})("ngModelChange",function(e){return p.CHM(t),p.oxw().onChange(e)}),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("name",t.name)("nzMin",t.min)("nzMax",t.max)("nzStep",t.step)("ngModel",t.value)}}let Kt=(()=>{class t extends Pt{constructor(){super(),this.step=1,this.max=1e16,this.min=-1e16,this.output=!1}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.Xpm({type:t,selectors:[["inp-range"]],inputs:{step:"step",max:"max",min:"min",output:"output"},features:[p.qOj],decls:5,vars:3,consts:[[4,"ngIf","ngIfThen","ngIfElse"],["thenTemplate",""],["elseTemplate",""],["nz-row","",3,"nzGutter"],["nz-col","",1,"gutter-row",3,"nzSpan"],[3,"name","nzMin","nzMax","nzStep","ngModel","ngModelChange"],[1,"inner-box"],[3,"name","nzMin","nzMax","nzStep","ngModel","ngStyle","ngModelChange"]],template:function(t,e){if(1&t&&(p.YNc(0,Ht,1,0,"ng-container",0),p.YNc(1,Yt,6,16,"ng-template",null,1,p.W1O),p.YNc(3,Ut,1,5,"ng-template",null,2,p.W1O)),2&t){const t=p.MAs(2),n=p.MAs(4);p.Q6J("ngIf",e.output)("ngIfThen",t)("ngIfElse",n)}},directives:[i.O5,Mt.SK,Mt.t3,Rt.jS,Ct.JJ,Ct.On,Qt._,i.PC],styles:[""]}),t})();function $t(t,e){1&t&&p._UZ(0,"div")}const Bt=function(){return{xs:8,sm:16,md:24,lg:32}};function Vt(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div",5),p.TgZ(1,"div",6),p.TgZ(2,"div",1),p.TgZ(3,"inp-texture",7),p.NdJ("valueChange",function(e){return p.CHM(t),p.oxw().config.value=e})("subcribe",function(e){return p.CHM(t),p.oxw().onChange(e)}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(4,"div",6),p.TgZ(5,"inp-range",8),p.NdJ("valueChange",function(e){return p.CHM(t),p.oxw().config.attach.value=e})("subcribe",function(e){return p.CHM(t),p.oxw().onAttachChange(e)}),p.qZA(),p.qZA(),p.TgZ(6,"div",6),p.TgZ(7,"div",1),p.TgZ(8,"active-switch",7),p.NdJ("valueChange",function(e){return p.CHM(t),p.oxw().config.editable=e})("subcribe",function(e){return p.CHM(t),p.oxw().onEditable(e)}),p.qZA(),p.qZA(),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("nzGutter",p.DdM(13,Bt)),p.xp6(1),p.Q6J("nzSpan",5),p.xp6(2),p.Q6J("name",t.config.name)("value",t.config.value),p.xp6(1),p.Q6J("nzSpan",14),p.xp6(1),p.Q6J("name",t.config.attach.name)("min",t.config.attach.min)("max",t.config.attach.max)("step",t.config.attach.step)("value",t.config.attach.value),p.xp6(1),p.Q6J("nzSpan",5),p.xp6(2),p.Q6J("name",t.config.name)("value",t.config.editable)}}function Xt(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div",5),p.TgZ(1,"div",6),p.TgZ(2,"div",1),p.TgZ(3,"inp-texture",7),p.NdJ("valueChange",function(e){return p.CHM(t),p.oxw().config.value=e})("subcribe",function(e){return p.CHM(t),p.oxw().onChange(e)}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(4,"div",6),p.TgZ(5,"div",1),p.TgZ(6,"active-switch",7),p.NdJ("valueChange",function(e){return p.CHM(t),p.oxw().config.editable=e})("subcribe",function(e){return p.CHM(t),p.oxw().onEditable(e)}),p.qZA(),p.qZA(),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("nzGutter",p.DdM(7,Bt)),p.xp6(1),p.Q6J("nzSpan",19),p.xp6(2),p.Q6J("name",t.config.name)("value",t.config.value),p.xp6(1),p.Q6J("nzSpan",5),p.xp6(2),p.Q6J("name",t.config.name)("value",t.config.editable)}}let Gt=(()=>{class t extends zt{constructor(){super(),this.oldAttachValue=null}ngOnInit(){this.config.attach&&(this.oldAttachValue=this.config.attach.value)}onAttachChange(t){this.oldAttachValue!=t.value&&(this.config.attach.value=t.value,this.subcribe.emit({name:this.config.attach.name,value:t.value,old:this.oldAttachValue}),this.oldAttachValue=t.value)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.Xpm({type:t,selectors:[["activate-texture"]],features:[p.qOj],decls:9,vars:6,consts:[[1,"input-group"],[1,"inner-box"],[4,"ngIf","ngIfThen","ngIfElse"],["attachBlock",""],["simpleBlock",""],["nz-row","",3,"nzGutter"],["nz-col","",1,"gutter-row",3,"nzSpan"],[3,"name","value","valueChange","subcribe"],[3,"name","min","max","step","value","valueChange","subcribe"]],template:function(t,e){if(1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"div",1),p._uU(2),p.ALo(3,"translate"),p.qZA(),p.YNc(4,$t,1,0,"div",2),p.YNc(5,Vt,9,14,"ng-template",null,3,p.W1O),p.YNc(7,Xt,7,8,"ng-template",null,4,p.W1O),p.qZA()),2&t){const t=p.MAs(6),n=p.MAs(8);p.xp6(2),p.Oqu(p.lcZ(3,4,e.config.name)),p.xp6(2),p.Q6J("ngIf",e.config.attach)("ngIfThen",t)("ngIfElse",n)}},directives:[i.O5,Mt.SK,Mt.t3,jt,Kt,It],pipes:[ut.X$],styles:[".input-group[_ngcontent-%COMP%]{margin:10px auto;border-top:1px solid #ababab;padding-top:10px;padding-bottom:10px}.text-right[_ngcontent-%COMP%]{text-align:right!important}.text-group[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]{margin-top:5px}"]}),t})();var Wt=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},te=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),ee=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,o=!1,s=void 0;try{for(var r,a=t[Symbol.iterator]();!(i=(r=a.next()).done)&&(n.push(r.value),!e||n.length!==e);i=!0);}catch(c){o=!0,s=c}finally{try{!i&&a.return&&a.return()}finally{if(o)throw s}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};String.prototype.startsWith=String.prototype.startsWith||function(t){return 0===this.indexOf(t)},String.prototype.padStart=String.prototype.padStart||function(t,e){for(var n=this;n.length<t;)n=e+n;return n};var ne={cb:"0f8ff",tqw:"aebd7",q:"-ffff",qmrn:"7fffd4",zr:"0ffff",bg:"5f5dc",bsq:"e4c4",bck:"---",nch:"ebcd",b:"--ff",bvt:"8a2be2",brwn:"a52a2a",brw:"deb887",ctb:"5f9ea0",hrt:"7fff-",chcT:"d2691e",cr:"7f50",rnw:"6495ed",crns:"8dc",crms:"dc143c",cn:"-ffff",Db:"--8b",Dcn:"-8b8b",Dgnr:"b8860b",Dgr:"a9a9a9",Dgrn:"-64-",Dkhk:"bdb76b",Dmgn:"8b-8b",Dvgr:"556b2f",Drng:"8c-",Drch:"9932cc",Dr:"8b--",Dsmn:"e9967a",Dsgr:"8fbc8f",DsTb:"483d8b",DsTg:"2f4f4f",Dtrq:"-ced1",Dvt:"94-d3",ppnk:"1493",pskb:"-bfff",mgr:"696969",grb:"1e90ff",rbrc:"b22222",rwht:"af0",stg:"228b22",chs:"-ff",gnsb:"dcdcdc",st:"8f8ff",g:"d7-",gnr:"daa520",gr:"808080",grn:"-8-0",grnw:"adff2f",hnw:"0fff0",htpn:"69b4",nnr:"cd5c5c",ng:"4b-82",vr:"0",khk:"0e68c",vnr:"e6e6fa",nrb:"0f5",wngr:"7cfc-",mnch:"acd",Lb:"add8e6",Lcr:"08080",Lcn:"e0ffff",Lgnr:"afad2",Lgr:"d3d3d3",Lgrn:"90ee90",Lpnk:"b6c1",Lsmn:"a07a",Lsgr:"20b2aa",Lskb:"87cefa",LsTg:"778899",Lstb:"b0c4de",Lw:"e0",m:"-ff-",mgrn:"32cd32",nn:"af0e6",mgnt:"-ff",mrn:"8--0",mqm:"66cdaa",mmb:"--cd",mmrc:"ba55d3",mmpr:"9370db",msg:"3cb371",mmsT:"7b68ee","":"-fa9a",mtr:"48d1cc",mmvt:"c71585",mnLb:"191970",ntc:"5fffa",mstr:"e4e1",mccs:"e4b5",vjw:"dead",nv:"--80",c:"df5e6",v:"808-0",vrb:"6b8e23",rng:"a5-",rngr:"45-",rch:"da70d6",pgnr:"eee8aa",pgrn:"98fb98",ptrq:"afeeee",pvtr:"db7093",ppwh:"efd5",pchp:"dab9",pr:"cd853f",pnk:"c0cb",pm:"dda0dd",pwrb:"b0e0e6",prp:"8-080",cc:"663399",r:"--",sbr:"bc8f8f",rb:"4169e1",sbrw:"8b4513",smn:"a8072",nbr:"4a460",sgrn:"2e8b57",ssh:"5ee",snn:"a0522d",svr:"c0c0c0",skb:"87ceeb",sTb:"6a5acd",sTgr:"708090",snw:"afa",n:"-ff7f",stb:"4682b4",tn:"d2b48c",t:"-8080",thst:"d8bfd8",tmT:"6347",trqs:"40e0d0",vt:"ee82ee",whT:"5deb3",wht:"",hts:"5f5f5",w:"-",wgrn:"9acd32"};function ie(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=e>0?t.toFixed(e).replace(/0+$/,"").replace(/\.$/,""):t.toString();return n||"0"}var oe=function(){function t(e,n,i,o){Wt(this,t);var s=this;if(void 0!==e)if(Array.isArray(e))this.rgba=e;else if(void 0===i){var r=e&&""+e;r&&function(e){if(e.startsWith("hsl")){var n=e.match(/([\-\d\.e]+)/g).map(Number),i=ee(n,4),o=i[0],r=i[1],a=i[2],c=i[3];void 0===c&&(c=1),s.hsla=[o/=360,r/=100,a/=100,c]}else if(e.startsWith("rgb")){var l=e.match(/([\-\d\.e]+)/g).map(Number),h=ee(l,4),p=h[3];void 0===p&&(p=1),s.rgba=[h[0],h[1],h[2],p]}else s.rgba=e.startsWith("#")?t.hexToRgb(e):t.nameToRgb(e)||t.hexToRgb(e)}(r.toLowerCase())}else this.rgba=[e,n,i,void 0===o?1:o]}return te(t,[{key:"printRGB",value:function(t){var e=(t?this.rgba:this.rgba.slice(0,3)).map(function(t,e){return ie(t,3===e?3:0)});return t?"rgba("+e+")":"rgb("+e+")"}},{key:"printHSL",value:function(t){var e=[360,100,100,1],n=["","%","%",""],i=(t?this.hsla:this.hsla.slice(0,3)).map(function(t,i){return ie(t*e[i],3===i?3:1)+n[i]});return t?"hsla("+i+")":"hsl("+i+")"}},{key:"printHex",value:function(t){var e=this.hex;return t?e:e.substring(0,7)}},{key:"rgba",get:function(){if(this._rgba)return this._rgba;if(!this._hsla)throw new Error("No color is set");return this._rgba=t.hslToRgb(this._hsla)},set:function(t){3===t.length&&(t[3]=1),this._rgba=t,this._hsla=null}},{key:"rgbString",get:function(){return this.printRGB()}},{key:"rgbaString",get:function(){return this.printRGB(!0)}},{key:"hsla",get:function(){if(this._hsla)return this._hsla;if(!this._rgba)throw new Error("No color is set");return this._hsla=t.rgbToHsl(this._rgba)},set:function(t){3===t.length&&(t[3]=1),this._hsla=t,this._rgba=null}},{key:"hslString",get:function(){return this.printHSL()}},{key:"hslaString",get:function(){return this.printHSL(!0)}},{key:"hex",get:function(){return"#"+this.rgba.map(function(t,e){return e<3?t.toString(16):Math.round(255*t).toString(16)}).map(function(t){return t.padStart(2,"0")}).join("")},set:function(e){this.rgba=t.hexToRgb(e)}}],[{key:"hexToRgb",value:function(t){var e=(t.startsWith("#")?t.slice(1):t).replace(/^(\w{3})$/,"$1F").replace(/^(\w)(\w)(\w)(\w)$/,"$1$1$2$2$3$3$4$4").replace(/^(\w{6})$/,"$1FF");if(!e.match(/^([0-9a-fA-F]{8})$/))throw new Error("Unknown hex color; "+t);var n=e.match(/^(\w\w)(\w\w)(\w\w)(\w\w)$/).slice(1).map(function(t){return parseInt(t,16)});return n[3]=n[3]/255,n}},{key:"nameToRgb",value:function(e){var n=e.toLowerCase().replace("at","T").replace(/[aeiouyldf]/g,"").replace("ght","L").replace("rk","D").slice(-5,4),i=ne[n];return void 0===i?i:t.hexToRgb(i.replace(/\-/g,"00").padStart(6,"f"))}},{key:"rgbToHsl",value:function(t){var e=ee(t,4),n=e[0],i=e[1],o=e[2],s=e[3];n/=255,i/=255,o/=255;var r=Math.max(n,i,o),a=Math.min(n,i,o),c=void 0,l=void 0,h=(r+a)/2;if(r===a)c=l=0;else{var p=r-a;switch(l=h>.5?p/(2-r-a):p/(r+a),r){case n:c=(i-o)/p+(i<o?6:0);break;case i:c=(o-n)/p+2;break;case o:c=(n-i)/p+4}c/=6}return[c,l,h,s]}},{key:"hslToRgb",value:function(t){var e=ee(t,4),n=e[0],i=e[1],o=e[2],s=e[3],r=void 0,a=void 0,c=void 0;if(0===i)r=a=c=o;else{var l=function(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t},h=o<.5?o*(1+i):o+i-o*i,p=2*o-h;r=l(p,h,n+1/3),a=l(p,h,n),c=l(p,h,n-1/3)}var d=[255*r,255*a,255*c].map(Math.round);return d[3]=s,d}}]),t}(),se=function(){function t(){Wt(this,t),this._events=[]}return te(t,[{key:"add",value:function(t,e,n){t.addEventListener(e,n,!1),this._events.push({target:t,type:e,handler:n})}},{key:"remove",value:function(e,n,i){this._events=this._events.filter(function(o){var s=!0;return e&&e!==o.target&&(s=!1),n&&n!==o.type&&(s=!1),i&&i!==o.handler&&(s=!1),s&&t._doRemove(o.target,o.type,o.handler),!s})}},{key:"destroy",value:function(){this._events.forEach(function(e){return t._doRemove(e.target,e.type,e.handler)}),this._events=[]}}],[{key:"_doRemove",value:function(t,e,n){t.removeEventListener(e,n,!1)}}]),t}();function re(t,e,n){var i=!1;function o(t,e,n){return Math.max(e,Math.min(t,n))}function s(t,s,r){if(r&&(i=!0),i){t.preventDefault();var a=e.getBoundingClientRect(),c=a.width,l=a.height,h=s.clientY,p=o(s.clientX-a.left,0,c),d=o(h-a.top,0,l);n(p/c,d/l)}}function r(t,e){1===(void 0===t.buttons?t.which:t.buttons)?s(t,t,e):i=!1}function a(t,e){1===t.touches.length?s(t,t.touches[0],e):i=!1}t.add(e,"mousedown",function(t){r(t,!0)}),t.add(e,"touchstart",function(t){a(t,!0)}),t.add(window,"mousemove",r),t.add(e,"touchmove",a),t.add(window,"mouseup",function(t){i=!1}),t.add(e,"touchend",function(t){i=!1}),t.add(e,"touchcancel",function(t){i=!1})}var ae="keydown",ce="mousedown",le="focusin";function he(t,e){return(e||document).querySelector(t)}function pe(t){t.preventDefault(),t.stopPropagation()}function de(t,e,n,i,o){t.add(e,ae,function(t){n.indexOf(t.key)>=0&&(o&&pe(t),i(t))})}var ge=document.createElement("style");ge.textContent=".picker_wrapper.no_alpha .picker_alpha{display:none}.picker_wrapper.no_editor .picker_editor{position:absolute;z-index:-1;opacity:0}.picker_wrapper.no_cancel .picker_cancel{display:none}.layout_default.picker_wrapper{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-flow:row wrap;-webkit-box-pack:justify;justify-content:space-between;-webkit-box-align:stretch;align-items:stretch;font-size:10px;width:25em;padding:.5em}.layout_default.picker_wrapper input,.layout_default.picker_wrapper button{font-size:1rem}.layout_default.picker_wrapper>*{margin:.5em}.layout_default.picker_wrapper::before{content:'';display:block;width:100%;height:0;-webkit-box-ordinal-group:2;order:1}.layout_default .picker_slider,.layout_default .picker_selector{padding:1em}.layout_default .picker_hue{width:100%}.layout_default .picker_sl{-webkit-box-flex:1;flex:1 1 auto}.layout_default .picker_sl::before{content:'';display:block;padding-bottom:100%}.layout_default .picker_editor{-webkit-box-ordinal-group:2;order:1;width:6.5rem}.layout_default .picker_editor input{width:100%;height:100%}.layout_default .picker_sample{-webkit-box-ordinal-group:2;order:1;-webkit-box-flex:1;flex:1 1 auto}.layout_default .picker_done,.layout_default .picker_cancel{-webkit-box-ordinal-group:2;order:1}.picker_wrapper{box-sizing:border-box;background:#f2f2f2;box-shadow:0 0 0 1px silver;cursor:default;font-family:sans-serif;color:#444;pointer-events:auto}.picker_wrapper:focus{outline:none}.picker_wrapper button,.picker_wrapper input{box-sizing:border-box;border:none;box-shadow:0 0 0 1px silver;outline:none}.picker_wrapper button:focus,.picker_wrapper button:active,.picker_wrapper input:focus,.picker_wrapper input:active{box-shadow:0 0 2px 1px dodgerblue}.picker_wrapper button{padding:.4em .6em;cursor:pointer;background-color:whitesmoke;background-image:-webkit-gradient(linear, left bottom, left top, from(gainsboro), to(transparent));background-image:linear-gradient(0deg, gainsboro, transparent)}.picker_wrapper button:active{background-image:-webkit-gradient(linear, left bottom, left top, from(transparent), to(gainsboro));background-image:linear-gradient(0deg, transparent, gainsboro)}.picker_wrapper button:hover{background-color:white}.picker_selector{position:absolute;z-index:1;display:block;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);border:2px solid white;border-radius:100%;box-shadow:0 0 3px 1px #67b9ff;background:currentColor;cursor:pointer}.picker_slider .picker_selector{border-radius:2px}.picker_hue{position:relative;background-image:-webkit-gradient(linear, left top, right top, from(red), color-stop(yellow), color-stop(lime), color-stop(cyan), color-stop(blue), color-stop(magenta), to(red));background-image:linear-gradient(90deg, red, yellow, lime, cyan, blue, magenta, red);box-shadow:0 0 0 1px silver}.picker_sl{position:relative;box-shadow:0 0 0 1px silver;background-image:-webkit-gradient(linear, left top, left bottom, from(white), color-stop(50%, rgba(255,255,255,0))),-webkit-gradient(linear, left bottom, left top, from(black), color-stop(50%, rgba(0,0,0,0))),-webkit-gradient(linear, left top, right top, from(gray), to(rgba(128,128,128,0)));background-image:linear-gradient(180deg, white, rgba(255,255,255,0) 50%),linear-gradient(0deg, black, rgba(0,0,0,0) 50%),linear-gradient(90deg, gray, rgba(128,128,128,0))}.picker_alpha,.picker_sample{position:relative;background:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='2' height='2'%3E%3Cpath d='M1,0H0V1H2V2H1' fill='lightgrey'/%3E%3C/svg%3E\") left top/contain white;box-shadow:0 0 0 1px silver}.picker_alpha .picker_selector,.picker_sample .picker_selector{background:none}.picker_editor input{font-family:monospace;padding:.2em .4em}.picker_sample::before{content:'';position:absolute;display:block;width:100%;height:100%;background:currentColor}.picker_arrow{position:absolute;z-index:-1}.picker_wrapper.popup{position:absolute;z-index:2;margin:1.5em}.picker_wrapper.popup,.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{background:#f2f2f2;box-shadow:0 0 10px 1px rgba(0,0,0,0.4)}.picker_wrapper.popup .picker_arrow{width:3em;height:3em;margin:0}.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{content:\"\";display:block;position:absolute;top:0;left:0;z-index:-99}.picker_wrapper.popup .picker_arrow::before{width:100%;height:100%;-webkit-transform:skew(45deg);transform:skew(45deg);-webkit-transform-origin:0 100%;transform-origin:0 100%}.picker_wrapper.popup .picker_arrow::after{width:150%;height:150%;box-shadow:none}.popup.popup_top{bottom:100%;left:0}.popup.popup_top .picker_arrow{bottom:0;left:0;-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}.popup.popup_bottom{top:100%;left:0}.popup.popup_bottom .picker_arrow{top:0;left:0;-webkit-transform:rotate(90deg) scale(1, -1);transform:rotate(90deg) scale(1, -1)}.popup.popup_left{top:0;right:100%}.popup.popup_left .picker_arrow{top:0;right:0;-webkit-transform:scale(-1, 1);transform:scale(-1, 1)}.popup.popup_right{top:0;left:100%}.popup.popup_right .picker_arrow{top:0;left:0}",document.documentElement.firstElementChild.appendChild(ge);var ue=function(){function t(e){Wt(this,t),this.settings={popup:"right",layout:"default",alpha:!0,editor:!0,editorFormat:"hex",cancelButton:!1,defaultColor:"#0cf"},this._events=new se,this.onChange=null,this.onDone=null,this.onOpen=null,this.onClose=null,this.setOptions(e)}return te(t,[{key:"setOptions",value:function(t){var e=this;if(t){var n=this.settings;if(t instanceof HTMLElement)n.parent=t;else{n.parent&&t.parent&&n.parent!==t.parent&&(this._events.remove(n.parent),this._popupInited=!1),function(t,e,n){for(var i in t)e[i]=t[i]}(t,n),t.onChange&&(this.onChange=t.onChange),t.onDone&&(this.onDone=t.onDone),t.onOpen&&(this.onOpen=t.onOpen),t.onClose&&(this.onClose=t.onClose);var i=t.color||t.colour;i&&this._setColor(i)}var o=n.parent;if(o&&n.popup&&!this._popupInited){var s=function(t){return e.openHandler(t)};this._events.add(o,"click",s),de(this._events,o,[" ","Spacebar","Enter"],s),this._popupInited=!0}else t.parent&&!n.popup&&this.show()}}},{key:"openHandler",value:function(t){if(this.show()){t&&t.preventDefault(),this.settings.parent.style.pointerEvents="none";var e=t&&t.type===ae?this._domEdit:this.domElement;setTimeout(function(){return e.focus()},100),this.onOpen&&this.onOpen(this.colour)}}},{key:"closeHandler",value:function(t){var e=t&&t.type,n=!1;t?e===ce||e===le?t.timeStamp>(this.__containedEvent||0)+100&&(n=!0):(pe(t),n=!0):n=!0,n&&this.hide()&&(this.settings.parent.style.pointerEvents="",e!==ce&&this.settings.parent.focus(),this.onClose&&this.onClose(this.colour))}},{key:"movePopup",value:function(t,e){this.closeHandler(),this.setOptions(t),e&&this.openHandler()}},{key:"setColor",value:function(t,e){this._setColor(t,{silent:e})}},{key:"_setColor",value:function(t,e){if("string"==typeof t&&(t=t.trim()),t){e=e||{};var n=void 0;try{n=new oe(t)}catch(o){if(e.failSilently)return;throw o}if(!this.settings.alpha){var i=n.hsla;i[3]=1,n.hsla=i}this.colour=this.color=n,this._setHSLA(null,null,null,null,e)}}},{key:"setColour",value:function(t,e){this.setColor(t,e)}},{key:"show",value:function(){if(!this.settings.parent)return!1;if(this.domElement){var t=this._toggleDOM(!0);return this._setPosition(),t}var e=function(t){var e=document.createElement("div");return e.innerHTML=t,e.firstElementChild}(this.settings.template||'<div class="picker_wrapper" tabindex="-1"><div class="picker_arrow"></div><div class="picker_hue picker_slider"><div class="picker_selector"></div></div><div class="picker_sl"><div class="picker_selector"></div></div><div class="picker_alpha picker_slider"><div class="picker_selector"></div></div><div class="picker_editor"><input aria-label="Type a color name or hex value"/></div><div class="picker_sample"></div><div class="picker_done"><button>Ok</button></div><div class="picker_cancel"><button>Cancel</button></div></div>');return this.domElement=e,this._domH=he(".picker_hue",e),this._domSL=he(".picker_sl",e),this._domA=he(".picker_alpha",e),this._domEdit=he(".picker_editor input",e),this._domSample=he(".picker_sample",e),this._domOkay=he(".picker_done button",e),this._domCancel=he(".picker_cancel button",e),e.classList.add("layout_"+this.settings.layout),this.settings.alpha||e.classList.add("no_alpha"),this.settings.editor||e.classList.add("no_editor"),this.settings.cancelButton||e.classList.add("no_cancel"),this._ifPopup(function(){return e.classList.add("popup")}),this._setPosition(),this.colour?this._updateUI():this._setColor(this.settings.defaultColor),this._bindEvents(),!0}},{key:"hide",value:function(){return this._toggleDOM(!1)}},{key:"destroy",value:function(){this._events.destroy(),this.domElement&&this.settings.parent.removeChild(this.domElement)}},{key:"_bindEvents",value:function(){var t=this,e=this,n=this.domElement,i=this._events;function o(t,e,n){i.add(t,e,n)}o(n,"click",function(t){return t.preventDefault()}),re(i,this._domH,function(t,n){return e._setHSLA(t)}),re(i,this._domSL,function(t,n){return e._setHSLA(null,t,1-n)}),this.settings.alpha&&re(i,this._domA,function(t,n){return e._setHSLA(null,null,null,1-n)});var s=this._domEdit;o(s,"input",function(t){e._setColor(this.value,{fromEditor:!0,failSilently:!0})}),o(s,"focus",function(t){var e=this;e.selectionStart===e.selectionEnd&&e.select()}),this._ifPopup(function(){var e=function(e){return t.closeHandler(e)};o(window,ce,e),o(window,le,e),de(i,n,["Esc","Escape"],e);var s=function(e){t.__containedEvent=e.timeStamp};o(n,ce,s),o(n,le,s),o(t._domCancel,"click",e)});var r=function(e){t._ifPopup(function(){return t.closeHandler(e)}),t.onDone&&t.onDone(t.colour)};o(this._domOkay,"click",r),de(i,n,["Enter"],r)}},{key:"_setPosition",value:function(){var t=this.settings.parent,e=this.domElement;t!==e.parentNode&&t.appendChild(e),this._ifPopup(function(n){"static"===getComputedStyle(t).position&&(t.style.position="relative");var i=!0===n?"popup_right":"popup_"+n;["popup_top","popup_bottom","popup_left","popup_right"].forEach(function(t){t===i?e.classList.add(t):e.classList.remove(t)}),e.classList.add(i)})}},{key:"_setHSLA",value:function(t,e,n,i,o){o=o||{};var s=this.colour,r=s.hsla;[t,e,n,i].forEach(function(t,e){(t||0===t)&&(r[e]=t)}),s.hsla=r,this._updateUI(o),this.onChange&&!o.silent&&this.onChange(s)}},{key:"_updateUI",value:function(t){if(this.domElement){t=t||{};var e=this.colour,n=e.hsla,i="hsl("+360*n[0]+", 100%, 50%)",o=e.hslString,s=e.hslaString,r=this._domSL,a=this._domA,c=he(".picker_selector",this._domH),l=he(".picker_selector",r),h=he(".picker_selector",a);m(0,c,n[0]),this._domSL.style.backgroundColor=this._domH.style.color=i,m(0,l,n[1]),f(0,l,1-n[2]),r.style.color=o,f(0,h,1-n[3]);var p=o,d=p.replace("hsl","hsla").replace(")",", 0)");if(this._domA.style.backgroundImage="linear-gradient("+[p,d]+"), url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='2' height='2'%3E%3Cpath d='M1,0H0V1H2V2H1' fill='lightgrey'/%3E%3C/svg%3E\")",!t.fromEditor){var g=this.settings.alpha,u=void 0;switch(this.settings.editorFormat){case"rgb":u=e.printRGB(g);break;case"hsl":u=e.printHSL(g);break;default:u=e.printHex(g)}this._domEdit.value=u}this._domSample.style.color=s}function m(t,e,n){e.style.left=100*n+"%"}function f(t,e,n){e.style.top=100*n+"%"}}},{key:"_ifPopup",value:function(t,e){this.settings.parent&&this.settings.popup?t&&t(this.settings.popup):e&&e()}},{key:"_toggleDOM",value:function(t){var e=this.domElement;if(!e)return!1;var n=t?"":"none",i=e.style.display!==n;return i&&(e.style.display=n),i}}],[{key:"StyleElement",get:function(){return ge}}]),t}();let me=(()=>{class t extends Pt{constructor(t){super(),this.elemRef=t,this.transparentBase64Image=E.lY}ngOnInit(){}ngAfterViewInit(){this.value=this.value&&(0,d.Kn)(this.value)?this.value.isColor?"#"+this.value.getHexString():"color"==this.value.$three?this.value.color:"#000":this.value;var t=this;new ue({parent:this.elemRef.nativeElement.querySelector(".output-color"),color:this.value,alpha:!1,editor:!0,layout:"default",popup:"bottom",editorFormat:"hex",cancelButton:!1,onChange:function(t){},onDone:function(e){var n=e.hex.substr(0,7);t.value=n,t.emit()},onOpen:function(t){},onClose:function(t){}})}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(p.SBq))},t.\u0275cmp=p.Xpm({type:t,selectors:[["inp-color"]],features:[p.qOj],decls:2,vars:4,consts:[[1,"output","output-color"],[1,"thumb",3,"src","alt"]],template:function(t,e){1&t&&(p.TgZ(0,"div",0),p._UZ(1,"img",1),p.qZA()),2&t&&(p.Udp("background",e.value),p.xp6(1),p.s9C("src",e.transparentBase64Image,p.LSH),p.s9C("alt",e.value))},styles:[".output-color[_ngcontent-%COMP%]{width:40px;height:40px;display:inline-block;border:.5px solid #dadada;border-radius:5px}.output-color[_ngcontent-%COMP%]   img.thumb[_ngcontent-%COMP%]{width:38px;height:38px;cursor:pointer}"]}),t})();function fe(t,e){1&t&&p._UZ(0,"div")}const ve=function(){return{xs:8,sm:16,md:24,lg:32}};function be(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div",5),p.TgZ(1,"div",6),p.TgZ(2,"div",1),p.TgZ(3,"inp-color",7),p.NdJ("valueChange",function(e){return p.CHM(t),p.oxw().config.value=e})("subcribe",function(e){return p.CHM(t),p.oxw().onChange(e)}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(4,"div",6),p.TgZ(5,"inp-range",8),p.NdJ("valueChange",function(e){return p.CHM(t),p.oxw().config.attach.value=e})("subcribe",function(e){return p.CHM(t),p.oxw().onAttachChange(e)}),p.qZA(),p.qZA(),p.TgZ(6,"div",6),p.TgZ(7,"div",1),p.TgZ(8,"active-switch",7),p.NdJ("valueChange",function(e){return p.CHM(t),p.oxw().config.editable=e})("subcribe",function(e){return p.CHM(t),p.oxw().onEditable(e)}),p.qZA(),p.qZA(),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("nzGutter",p.DdM(13,ve)),p.xp6(1),p.Q6J("nzSpan",5),p.xp6(2),p.Q6J("name",t.config.name)("value",t.config.value),p.xp6(1),p.Q6J("nzSpan",14),p.xp6(1),p.Q6J("name",t.config.attach.name)("min",t.config.attach.min)("max",t.config.attach.max)("step",t.config.attach.step)("value",t.config.attach.value),p.xp6(1),p.Q6J("nzSpan",5),p.xp6(2),p.Q6J("name",t.config.name)("value",t.config.editable)}}function _e(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div",5),p.TgZ(1,"div",6),p.TgZ(2,"div",1),p.TgZ(3,"inp-color",7),p.NdJ("valueChange",function(e){return p.CHM(t),p.oxw().config.value=e})("subcribe",function(e){return p.CHM(t),p.oxw().onChange(e)}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(4,"div",6),p.TgZ(5,"div",1),p.TgZ(6,"active-switch",7),p.NdJ("valueChange",function(e){return p.CHM(t),p.oxw().config.editable=e})("subcribe",function(e){return p.CHM(t),p.oxw().onEditable(e)}),p.qZA(),p.qZA(),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("nzGutter",p.DdM(7,ve)),p.xp6(1),p.Q6J("nzSpan",19),p.xp6(2),p.Q6J("name",t.config.name)("value",t.config.value),p.xp6(1),p.Q6J("nzSpan",5),p.xp6(2),p.Q6J("name",t.config.name)("value",t.config.editable)}}let xe=(()=>{class t extends zt{constructor(){super(),this.oldAttachValue=null}ngOnInit(){this.config.attach&&(this.oldAttachValue=this.config.attach.value)}onAttachChange(t){this.oldAttachValue!=t.value&&(this.subcribe.emit({name:this.config.attach.name,value:t.value,old:this.oldAttachValue}),this.oldAttachValue=t.value)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.Xpm({type:t,selectors:[["activate-color"]],features:[p.qOj],decls:9,vars:6,consts:[[1,"input-group"],[1,"inner-box"],[4,"ngIf","ngIfThen","ngIfElse"],["attachBlock",""],["simpleBlock",""],["nz-row","",3,"nzGutter"],["nz-col","",1,"gutter-row",3,"nzSpan"],[3,"name","value","valueChange","subcribe"],[3,"name","min","max","step","value","valueChange","subcribe"]],template:function(t,e){if(1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"div",1),p._uU(2),p.ALo(3,"translate"),p.qZA(),p.YNc(4,fe,1,0,"div",2),p.YNc(5,be,9,14,"ng-template",null,3,p.W1O),p.YNc(7,_e,7,8,"ng-template",null,4,p.W1O),p.qZA()),2&t){const t=p.MAs(6),n=p.MAs(8);p.xp6(2),p.Oqu(p.lcZ(3,4,e.config.name)),p.xp6(2),p.Q6J("ngIf",e.config.attach)("ngIfThen",t)("ngIfElse",n)}},directives:[i.O5,Mt.SK,Mt.t3,me,Kt,It],pipes:[ut.X$],styles:["inp-color[_ngcontent-%COMP%]{width:40px;height:40px}"]}),t})();const we=function(){return{xs:8,sm:16,md:24,lg:32}};let ye=(()=>{class t extends zt{constructor(){super()}ngOnInit(){}onSelect(t){this.config.value=t.value,this.onChange(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.Xpm({type:t,selectors:[["activate-select"]],features:[p.qOj],decls:11,vars:12,consts:[[1,"input-group","text-group"],["nz-row","",3,"nzGutter"],["nz-col","",1,"gutter-row",3,"nzSpan"],[1,"inner-box"],[3,"name","value","valueChange","subcribe"],[1,"input-wrapper"],[3,"name","value","options","valueChange","subcribe"]],template:function(t,e){1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"div",1),p.TgZ(2,"div",2),p.TgZ(3,"div",3),p._uU(4),p.ALo(5,"translate"),p.qZA(),p.qZA(),p.TgZ(6,"div",2),p.TgZ(7,"div",3),p.TgZ(8,"active-switch",4),p.NdJ("valueChange",function(t){return e.config.editable=t})("subcribe",function(t){return e.onEditable(t)}),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(9,"div",5),p.TgZ(10,"inp-select",6),p.NdJ("valueChange",function(t){return e.config.value=t})("subcribe",function(t){return e.onSelect(t)}),p.qZA(),p.qZA(),p.qZA()),2&t&&(p.xp6(1),p.Q6J("nzGutter",p.DdM(11,we)),p.xp6(1),p.Q6J("nzSpan",19),p.xp6(2),p.Oqu(p.lcZ(5,9,e.config.name)),p.xp6(2),p.Q6J("nzSpan",5),p.xp6(2),p.Q6J("name",e.config.name)("value",e.config.editable),p.xp6(2),p.Q6J("name",e.config.name)("value",e.config.value)("options",e.config.options))},directives:[Mt.SK,Mt.t3,It,Zt],pipes:[ut.X$],styles:[".input-group[_ngcontent-%COMP%]{margin:10px auto;border-top:1px solid #ababab;padding-top:10px;padding-bottom:10px}.text-right[_ngcontent-%COMP%]{text-align:right!important}.text-group[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]{margin-top:5px}"]}),t})();const Ce=function(){return{xs:8,sm:16,md:24,lg:32}},Oe=function(){return{marginLeft:"0px"}};let Me=(()=>{class t extends zt{constructor(){super()}ngOnInit(){}valChange(t){this.onChange({value:t})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.Xpm({type:t,selectors:[["activate-range"]],features:[p.qOj],decls:15,vars:25,consts:[[1,"input-group","text-group"],["nz-row","",3,"nzGutter"],["nz-col","",1,"gutter-row",3,"nzSpan"],[1,"inner-box"],[3,"name","value","valueChange","subcribe"],["nz-row","",1,"input-wrapper",3,"nzGutter"],[3,"name","nzMin","nzMax","nzStep","ngModel","ngModelChange"],[3,"name","nzMin","nzMax","nzStep","ngModel","ngStyle","ngModelChange"]],template:function(t,e){1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"div",1),p.TgZ(2,"div",2),p.TgZ(3,"div",3),p._uU(4),p.ALo(5,"translate"),p.qZA(),p.qZA(),p.TgZ(6,"div",2),p.TgZ(7,"div",3),p.TgZ(8,"active-switch",4),p.NdJ("valueChange",function(t){return e.config.editable=t})("subcribe",function(t){return e.onEditable(t)}),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(9,"div",5),p.TgZ(10,"div",2),p.TgZ(11,"nz-slider",6),p.NdJ("ngModelChange",function(t){return e.config.value=t})("ngModelChange",function(t){return e.valChange(t)}),p.qZA(),p.qZA(),p.TgZ(12,"div",2),p.TgZ(13,"div",3),p.TgZ(14,"nz-input-number",7),p.NdJ("ngModelChange",function(t){return e.config.value=t})("ngModelChange",function(t){return e.valChange(t)}),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t&&(p.xp6(1),p.Q6J("nzGutter",p.DdM(22,Ce)),p.xp6(1),p.Q6J("nzSpan",19),p.xp6(2),p.Oqu(p.lcZ(5,20,e.config.name)),p.xp6(2),p.Q6J("nzSpan",5),p.xp6(2),p.Q6J("name",e.config.name)("value",e.config.editable),p.xp6(1),p.Q6J("nzGutter",p.DdM(23,Ce)),p.xp6(1),p.Q6J("nzSpan",16),p.xp6(1),p.Q6J("name",e.config.name)("nzMin",e.config.min)("nzMax",e.config.max)("nzStep",e.config.step)("ngModel",e.config.value),p.xp6(1),p.Q6J("nzSpan",8),p.xp6(2),p.Q6J("name",e.config.name)("nzMin",e.config.min)("nzMax",e.config.max)("nzStep",e.config.step)("ngModel",e.config.value)("ngStyle",p.DdM(24,Oe)))},directives:[Mt.SK,Mt.t3,It,Rt.jS,Ct.JJ,Ct.On,Qt._,i.PC],pipes:[ut.X$],styles:[".input-group[_ngcontent-%COMP%]{margin:10px auto;border-top:1px solid #ababab;padding-top:10px;padding-bottom:10px}.text-right[_ngcontent-%COMP%]{text-align:right!important}.text-group[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]{margin-top:5px}"]}),t})();const Pe=function(){return{xs:8,sm:16,md:24,lg:32}};let Se=(()=>{class t extends zt{constructor(){super()}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.Xpm({type:t,selectors:[["activate-number"]],features:[p.qOj],decls:11,vars:15,consts:[["nz-row","",1,"input-group",3,"nzGutter"],["nz-col","",1,"gutter-row",3,"nzSpan"],[1,"inner-box"],[1,"inner-box","text-right"],[3,"name","nzMin","nzMax","nzStep","ngModel","ngModelChange"],[3,"name","value","valueChange","subcribe"]],template:function(t,e){1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"div",1),p.TgZ(2,"div",2),p._uU(3),p.ALo(4,"translate"),p.qZA(),p.qZA(),p.TgZ(5,"div",1),p.TgZ(6,"div",3),p.TgZ(7,"nz-input-number",4),p.NdJ("ngModelChange",function(t){return e.config.value=t})("ngModelChange",function(t){return e.valChange(t)}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(8,"div",1),p.TgZ(9,"div",2),p.TgZ(10,"active-switch",5),p.NdJ("valueChange",function(t){return e.config.editable=t})("subcribe",function(t){return e.onEditable(t)}),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t&&(p.Q6J("nzGutter",p.DdM(14,Pe)),p.xp6(1),p.Q6J("nzSpan",12),p.xp6(2),p.Oqu(p.lcZ(4,12,e.config.name)),p.xp6(2),p.Q6J("nzSpan",7),p.xp6(2),p.Q6J("name",e.config.name)("nzMin",e.config.min)("nzMax",e.config.max)("nzStep",e.config.step)("ngModel",e.config.value),p.xp6(1),p.Q6J("nzSpan",5),p.xp6(2),p.Q6J("name",e.config.name)("value",e.config.editable))},directives:[Mt.SK,Mt.t3,Qt._,Ct.JJ,Ct.On,It],pipes:[ut.X$],styles:[".input-group[_ngcontent-%COMP%]{margin:10px auto;border-top:1px solid #ababab;padding-top:10px;padding-bottom:10px}.text-right[_ngcontent-%COMP%]{text-align:right!important}"]}),t})();const ke=function(){return{xs:8,sm:16,md:24,lg:32}};let Ze=(()=>{class t extends zt{constructor(){super()}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.Xpm({type:t,selectors:[["activate-text"]],features:[p.qOj],decls:12,vars:14,consts:[[1,"input-group","text-group"],["nz-row","",3,"nzGutter"],["nz-col","",1,"gutter-row",3,"nzSpan"],[1,"inner-box"],[3,"name","value","valueChange","subcribe"],[1,"input-wrapper"],["nz-input","",3,"name","placeholder","ngModel","ngModelChange"]],template:function(t,e){1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"div",1),p.TgZ(2,"div",2),p.TgZ(3,"div",3),p._uU(4),p.ALo(5,"translate"),p.qZA(),p.qZA(),p.TgZ(6,"div",2),p.TgZ(7,"div",3),p.TgZ(8,"active-switch",4),p.NdJ("valueChange",function(t){return e.config.editable=t})("subcribe",function(t){return e.onEditable(t)}),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(9,"div",5),p.TgZ(10,"input",6),p.NdJ("ngModelChange",function(t){return e.config.value=t})("ngModelChange",function(t){return e.valChange(t)}),p.ALo(11,"translate"),p.qZA(),p.qZA(),p.qZA()),2&t&&(p.xp6(1),p.Q6J("nzGutter",p.DdM(13,ke)),p.xp6(1),p.Q6J("nzSpan",19),p.xp6(2),p.Oqu(p.lcZ(5,9,e.config.name)),p.xp6(2),p.Q6J("nzSpan",5),p.xp6(2),p.Q6J("name",e.config.name)("value",e.config.editable),p.xp6(2),p.s9C("placeholder",p.lcZ(11,11,"Enter "+e.config.name)),p.Q6J("name",e.config.name)("ngModel",e.config.value))},directives:[Mt.SK,Mt.t3,It,yt.Zp,Ct.Fj,Ct.JJ,Ct.On],pipes:[ut.X$],styles:[".input-group[_ngcontent-%COMP%]{margin:10px auto;border-top:1px solid #ababab;padding-top:10px;padding-bottom:10px}.text-right[_ngcontent-%COMP%]{text-align:right!important}.text-group[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]{margin-top:5px}"]}),t})();function ze(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div"),p.TgZ(1,"activate-checkbox",10),p.NdJ("subcribe",function(e){return p.CHM(t),p.oxw(2).onChangeHandle(e)})("editable",function(e){return p.CHM(t),p.oxw(2).toggleEditable(e)}),p.qZA(),p.qZA()}if(2&t){const t=p.oxw().$implicit;p.xp6(1),p.Q6J("config",t)}}function Te(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div"),p.TgZ(1,"activate-texture",10),p.NdJ("subcribe",function(e){return p.CHM(t),p.oxw(2).onChangeHandle(e)})("editable",function(e){return p.CHM(t),p.oxw(2).toggleEditable(e)}),p.qZA(),p.qZA()}if(2&t){const t=p.oxw().$implicit;p.xp6(1),p.Q6J("config",t)}}function Ee(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div"),p.TgZ(1,"activate-color",10),p.NdJ("subcribe",function(e){return p.CHM(t),p.oxw(2).onChangeHandle(e)})("editable",function(e){return p.CHM(t),p.oxw(2).toggleEditable(e)}),p.qZA(),p.qZA()}if(2&t){const t=p.oxw().$implicit;p.xp6(1),p.Q6J("config",t)}}function Ae(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div"),p.TgZ(1,"activate-select",10),p.NdJ("subcribe",function(e){return p.CHM(t),p.oxw(2).onChangeHandle(e)})("editable",function(e){return p.CHM(t),p.oxw(2).toggleEditable(e)}),p.qZA(),p.qZA()}if(2&t){const t=p.oxw().$implicit;p.xp6(1),p.Q6J("config",t)}}function De(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div"),p.TgZ(1,"activate-range",10),p.NdJ("subcribe",function(e){return p.CHM(t),p.oxw(2).onChangeHandle(e)})("editable",function(e){return p.CHM(t),p.oxw(2).toggleEditable(e)}),p.qZA(),p.qZA()}if(2&t){const t=p.oxw().$implicit;p.xp6(1),p.Q6J("config",t)}}function qe(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div"),p.TgZ(1,"activate-number",10),p.NdJ("subcribe",function(e){return p.CHM(t),p.oxw(2).onChangeHandle(e)})("editable",function(e){return p.CHM(t),p.oxw(2).toggleEditable(e)}),p.qZA(),p.qZA()}if(2&t){const t=p.oxw().$implicit;p.xp6(1),p.Q6J("config",t)}}function Ie(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div"),p.TgZ(1,"activate-text",10),p.NdJ("subcribe",function(e){return p.CHM(t),p.oxw(2).onChangeHandle(e)})("editable",function(e){return p.CHM(t),p.oxw(2).toggleEditable(e)}),p.qZA(),p.qZA()}if(2&t){const t=p.oxw().$implicit;p.xp6(1),p.Q6J("config",t)}}function Je(t,e){if(1&t&&(p.TgZ(0,"div",6),p.TgZ(1,"div",7),p.YNc(2,ze,2,1,"div",8),p.YNc(3,Te,2,1,"div",8),p.YNc(4,Ee,2,1,"div",8),p.YNc(5,Ae,2,1,"div",8),p.YNc(6,De,2,1,"div",8),p.YNc(7,qe,2,1,"div",8),p.YNc(8,Ie,2,1,"div",9),p.qZA(),p.qZA()),2&t){const t=e.$implicit;p.xp6(1),p.Q6J("ngSwitch",t.type),p.xp6(1),p.Q6J("ngSwitchCase","checkbox"),p.xp6(1),p.Q6J("ngSwitchCase","texture"),p.xp6(1),p.Q6J("ngSwitchCase","color"),p.xp6(1),p.Q6J("ngSwitchCase","select"),p.xp6(1),p.Q6J("ngSwitchCase","range"),p.xp6(1),p.Q6J("ngSwitchCase","number")}}const Le=function(){return{xs:8,sm:16,md:24,lg:32}};let je=(()=>{class t extends g{constructor(t){super(),this.itemEditor=t,this.isArray=!1,this.onUpdate=new p.vpe,this.updateEditable=new p.vpe,this.data={},this.inputs=[],this.types=[],this.type="basic",this.types.splice(0);for(const e in E.wE.config.options)Object.prototype.hasOwnProperty.call(E.wE.config.options,e)&&this.types.push({value:e,label:E.wE.config.options[e]})}onInit(){this.data=E.wE.getPropData(this.material),(0,d.MP)(this.data,this.settings),this.setType(this.data.type||this.settings.type||this.material.type)}update(t,e,n,i){this.onUpdate.emit({name:t,value:e,editable:n,index:i,isArray:this.isArray})}setType(t){var e=d.W3.replace(String(t).toLowerCase(),["mesh","material"],"");void 0!==E.wE.config.options[e]&&(this.type=e,this.inputs=E.wE.getMaterialInputs(e,this.material,this.data,this.editable))}changeType(t){this.setType(t.value),this.update("type",t.value)}toggleEditable(t){if(t.status)-1===this.editable.indexOf(t.name)&&(this.editable.push(t.name),this.activeEditavle(t.name));else{var e=this.editable.indexOf(t.name);-1!==e&&(this.editable.splice(e,1),this.deactiveEditavle(t.name))}this.updateEditable.emit({name:t.name,status:t.status,index:this.index,isArray:this.isArray})}activeEditavle(t){for(let e=0;e<this.inputs.length;e++){const n=this.inputs[e];n.name==t&&(n.editable=!0)}}deactiveEditavle(t){for(let e=0;e<this.inputs.length;e++){const n=this.inputs[e];n.name==t&&(n.editable=!1)}}onChangeHandle(t){this.data[t.name]=t.value,this.settings[t.name]=t.value,this.update(t.name,t.value,t.editable)}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(F))},t.\u0275cmp=p.Xpm({type:t,selectors:[["material-activate-inputs"]],inputs:{material:"material",settings:"settings",editable:"editable",index:"index",isArray:"isArray"},outputs:{onUpdate:"onUpdate",updateEditable:"updateEditable"},features:[p.qOj],decls:10,vars:10,consts:[["nz-row","",1,"input-group","type-group",3,"nzGutter"],["nz-col","",1,"gutter-row",3,"nzSpan"],[1,"inner-box"],["name","type","label","Material Type",3,"options","value","valueChange","subcribe"],[1,"material-inputs"],["class","ig",4,"ngFor","ngForOf"],[1,"ig"],[1,"input-item",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"config","subcribe","editable"]],template:function(t,e){1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"div",1),p.TgZ(2,"div",2),p._uU(3),p.ALo(4,"translate"),p.qZA(),p.qZA(),p.TgZ(5,"div",1),p.TgZ(6,"div",2),p.TgZ(7,"inp-select",3),p.NdJ("valueChange",function(t){return e.type=t})("subcribe",function(t){return e.changeType(t)}),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(8,"div",4),p.YNc(9,Je,9,7,"div",5),p.qZA()),2&t&&(p.Q6J("nzGutter",p.DdM(9,Le)),p.xp6(1),p.Q6J("nzSpan",12),p.xp6(2),p.Oqu(p.lcZ(4,7,"Material Type")),p.xp6(2),p.Q6J("nzSpan",12),p.xp6(2),p.Q6J("options",e.types)("value",e.type),p.xp6(2),p.Q6J("ngForOf",e.inputs))},directives:[Mt.SK,Mt.t3,Zt,i.sg,i.RF,i.n9,i.ED,Lt,Gt,xe,ye,Me,Se,Ze],pipes:[ut.X$],styles:[".input-group[_ngcontent-%COMP%]{margin:10px auto;border-top:1px solid #ababab;padding-top:10px;padding-bottom:10px}.text-right[_ngcontent-%COMP%]{text-align:right!important}.text-group[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]{margin-top:10px}"]}),t})();function Re(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div",1),p.TgZ(1,"div",2),p.TgZ(2,"h3"),p._uU(3),p.qZA(),p.TgZ(4,"div",3),p.NdJ("click",function(){return p.CHM(t),p.oxw().close()}),p._UZ(5,"i",4),p.qZA(),p.qZA(),p.TgZ(6,"div",5),p.TgZ(7,"div",6),p.TgZ(8,"inp-text-group",7),p.NdJ("valueChange",function(e){return p.CHM(t),p.oxw().mesh.title=e})("subcribe",function(e){return p.CHM(t),p.oxw().updateMeshTitle(e)}),p.qZA(),p.TgZ(9,"material-activate-inputs",8),p.NdJ("onUpdate",function(e){return p.CHM(t),p.oxw().updateMaterial(e)})("updateEditable",function(e){return p.CHM(t),p.oxw().updateEditable(e)}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(10,"div",9),p.TgZ(11,"h3"),p._uU(12),p.ALo(13,"translate"),p.qZA(),p.TgZ(14,"div",10),p.TgZ(15,"button",11),p.NdJ("click",function(){return p.CHM(t),p.oxw().onDone()}),p._uU(16),p.ALo(17,"translate"),p.qZA(),p.qZA(),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.xp6(3),p.Oqu(t.title),p.xp6(5),p.Q6J("value",t.mesh.title),p.xp6(1),p.Q6J("material",t.mesh.__ref__.material)("settings",t.mesh.data)("editable",t.mesh.editable)("isArray",!1),p.xp6(3),p.Oqu(p.lcZ(13,8,"Actions")),p.xp6(4),p.Oqu(p.lcZ(17,10,"Done"))}}let Qe=(()=>{class t extends g{constructor(t,e){super(),this.events=t,this.cd=e,this.title="Mesh",this.mesh=null,this.isShow=!1}onChangeSubEvents(){this.registerEventService(this.subEvents,{showmeshpanel:t=>this.showPanel(t.mesh),hidemeshpanel:t=>this.hidePanel()})}onInit(){}showPanel(t){this.isShow?(this.isShow=!1,this.mesh=null,setTimeout(()=>{this.asyncMeshSetting(t),this.isShow=!0},10)):(this.asyncMeshSetting(t),this.isShow=!0)}hidePanel(){}asyncMeshSetting(t){this.mesh=t,this.title=t.title||t.name||"Mesh",this.cd.detectChanges()}updateMaterial(t){this.mesh.data||(this.mesh.data={}),this.mesh.data.material||(this.mesh.data.material={}),this.mesh.data.material[t.name]=t.value;var e=this.subEvents.app,n={};n[t.name]=t.value,e.updateMeshMaterial(this.mesh.name,n),this.subEvents.emit({type:"panel.update:material",name:this.mesh.name,data:n})}updateEditable(t){this.subEvents.app.updateEditable(this.mesh.name,t.name,t.status);var e=this.mesh.editable.indexOf(t.name);t.status&&-1==e?this.mesh.editable.push(t.name):!t.status&&-1!=e&&this.mesh.editable.splice(e,1),this.subEvents.emit({type:"panel.update:editable",name:this.mesh.name,inpName:t.name,status:t.status})}updateMeshTitle(t){this.title=this.mesh.title=t.value,this.subEvents.app.updateMeshTitle(this.mesh.name,t.value),this.subEvents.emit({type:"panel.update:title",name:this.mesh.name,title:t.value})}close(){this.isShow=!1}onDone(){this.isShow=!1}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(G),p.Y36(p.sBO))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-panel-mesh-settings"]],features:[p.qOj],decls:1,vars:1,consts:[["class","panel inner-layout",4,"ngIf"],[1,"panel","inner-layout"],[1,"panel-header"],[1,"btn-close",3,"click"],["nz-icon","","nzType","close-circle","nzTheme","outline"],[1,"panel-body"],[1,"store"],["name","title","label","Mesh Title",3,"value","valueChange","subcribe"],["index","-1",3,"material","settings","editable","isArray","onUpdate","updateEditable"],[1,"panel-footer"],[1,"buttons"],["nz-button","","nzType","primary",3,"click"]],template:function(t,e){1&t&&p.YNc(0,Re,18,12,"div",0),2&t&&p.Q6J("ngIf",e.isShow)},directives:[i.O5,it.w,xt.Ls,Ot,je,nt.ix,gt.dQ],pipes:[ut.X$],styles:[".panel[_ngcontent-%COMP%]{max-width:380px;min-width:380px;width:380px;position:absolute;background:#20242d;transition:all .2s;top:56px;left:0;bottom:0;display:flex;flex:auto;flex-direction:column}.panel[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .panel[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .panel[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .panel[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], .panel[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{color:#fff}.panel-header[_ngcontent-%COMP%]{height:48px;display:flex;flex:none;width:100%;align-items:center;align-content:center}.panel-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff;font-size:18px;margin:0;padding-left:12px}.panel-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{cursor:pointer;margin-left:auto;font-size:24px;color:#fafafa;margin-right:12px;outline:none;border:none}.panel-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]:hover{color:#fff}.panel-body[_ngcontent-%COMP%]{display:flex;flex:none;height:calc(100% - 140px);width:100%;background-color:#363d4b;color:#fff;overflow-y:hidden}.panel-body[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .panel-body[_ngcontent-%COMP%]   .w100[_ngcontent-%COMP%]{width:100%}.panel-body[_ngcontent-%COMP%]   .ant-divider-horizontal.ant-divider-with-text[_ngcontent-%COMP%]{color:#fff}.panel-body[_ngcontent-%COMP%]   .store[_ngcontent-%COMP%]{position:relative;display:block;flex-wrap:wrap;height:100%!important;width:100%;padding:0 12px 0 16px;overflow-y:scroll}.panel-body[_ngcontent-%COMP%]   .store--expand[_ngcontent-%COMP%]{height:auto}.panel-body[_ngcontent-%COMP%]   .store[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px;background-color:transparent}.panel-body[_ngcontent-%COMP%]   .store[_ngcontent-%COMP%]::-webkit-scrollbar-track{box-shadow:none;background-color:transparent}.panel-body[_ngcontent-%COMP%]   .store[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;box-shadow:inset 0 0 6px #0000004d;background-color:#555}.panel-body[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{padding-top:15px;padding-bottom:20px}.panel-body[_ngcontent-%COMP%]   .geometry-inputs[_ngcontent-%COMP%], .panel-body[_ngcontent-%COMP%]   .material-inputs[_ngcontent-%COMP%], .panel-body[_ngcontent-%COMP%]   .prop-inputs[_ngcontent-%COMP%]{margin-bottom:10px}.panel-body[_ngcontent-%COMP%]   .geometry-inputs[_ngcontent-%COMP%], .panel-body[_ngcontent-%COMP%]   .material-inputs[_ngcontent-%COMP%], .panel-body[_ngcontent-%COMP%]   .prop-inputs[_ngcontent-%COMP%]{padding-top:15px;padding-bottom:15px}.panel-body[_ngcontent-%COMP%]   .geometry-inputs[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .panel-body[_ngcontent-%COMP%]   .material-inputs[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .panel-body[_ngcontent-%COMP%]   .prop-inputs[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:10px}.panel-body[_ngcontent-%COMP%]   .geometry-inputs[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%], .panel-body[_ngcontent-%COMP%]   .material-inputs[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%], .panel-body[_ngcontent-%COMP%]   .prop-inputs[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]{border-bottom:none!important}.panel-footer[_ngcontent-%COMP%]{height:44px;display:flex;flex:none;width:100%;align-items:center;align-content:center;margin-top:-20px;background:#20242d;z-index:100}.panel-footer[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff;font-size:18px;margin:0;padding-left:12px}.panel-footer[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{cursor:pointer;margin-left:auto;font-size:24px;color:#fafafa;margin-right:12px}.panel-footer[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]:hover{color:#fff}"]}),t})();var He=n(84828),Ne=n(64762),Fe=n(47070),Ye=n(32729),Ue=n(90641),Ke=n(96182),$e=n(46782),Be=n(70946),Ve=n(68178);const Xe=["*"];function Ge(t,e){if(1&t&&(p.ynx(0),p._UZ(1,"i",6),p.BQk()),2&t){const t=e.$implicit,n=p.oxw(2);p.xp6(1),p.Q6J("nzType",t||"right")("nzRotate",n.nzActive?90:0)}}function We(t,e){if(1&t&&(p.ynx(0),p.YNc(1,Ge,2,2,"ng-container",2),p.BQk()),2&t){const t=p.oxw();p.xp6(1),p.Q6J("nzStringTemplateOutlet",t.nzExpandedIcon)}}function tn(t,e){if(1&t&&(p.ynx(0),p._uU(1),p.BQk()),2&t){const t=p.oxw();p.xp6(1),p.Oqu(t.nzHeader)}}function en(t,e){if(1&t&&(p.ynx(0),p._uU(1),p.BQk()),2&t){const t=p.oxw(2);p.xp6(1),p.Oqu(t.nzExtra)}}function nn(t,e){if(1&t&&(p.TgZ(0,"div",7),p.YNc(1,en,2,1,"ng-container",2),p.qZA()),2&t){const t=p.oxw();p.xp6(1),p.Q6J("nzStringTemplateOutlet",t.nzExtra)}}const on="collapse";let sn=(()=>{class t{constructor(t,e,n,i){this.nzConfigService=t,this.cdr=e,this.elementRef=n,this.directionality=i,this._nzModuleName=on,this.nzAccordion=!1,this.nzBordered=!0,this.nzGhost=!1,this.nzExpandIconPosition="left",this.dir="ltr",this.listOfNzCollapsePanelComponent=[],this.destroy$=new et.xQ,this.elementRef.nativeElement.classList.add("ant-collapse"),this.nzConfigService.getConfigChangeEventForComponent(on).pipe((0,$e.R)(this.destroy$)).subscribe(()=>{this.cdr.markForCheck()})}ngOnInit(){var t;null===(t=this.directionality.change)||void 0===t||t.pipe((0,$e.R)(this.destroy$)).subscribe(t=>{this.dir=t,this.cdr.detectChanges()}),this.dir=this.directionality.value}addPanel(t){this.listOfNzCollapsePanelComponent.push(t)}removePanel(t){this.listOfNzCollapsePanelComponent.splice(this.listOfNzCollapsePanelComponent.indexOf(t),1)}click(t){this.nzAccordion&&!t.nzActive&&this.listOfNzCollapsePanelComponent.filter(e=>e!==t).forEach(t=>{t.nzActive&&(t.nzActive=!1,t.nzActiveChange.emit(t.nzActive),t.markForCheck())}),t.nzActive=!t.nzActive,t.nzActiveChange.emit(t.nzActive)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(Ye.jY),p.Y36(p.sBO),p.Y36(p.SBq),p.Y36(Be.Is,8))},t.\u0275cmp=p.Xpm({type:t,selectors:[["nz-collapse"]],hostVars:10,hostBindings:function(t,e){2&t&&p.ekj("ant-collapse-icon-position-left","left"===e.nzExpandIconPosition)("ant-collapse-icon-position-right","right"===e.nzExpandIconPosition)("ant-collapse-ghost",e.nzGhost)("ant-collapse-borderless",!e.nzBordered)("ant-collapse-rtl","rtl"===e.dir)},inputs:{nzAccordion:"nzAccordion",nzBordered:"nzBordered",nzGhost:"nzGhost",nzExpandIconPosition:"nzExpandIconPosition"},exportAs:["nzCollapse"],ngContentSelectors:Xe,decls:1,vars:0,template:function(t,e){1&t&&(p.F$t(),p.Hsn(0))},encapsulation:2,changeDetection:0}),(0,Ne.gn)([(0,Ye.oS)(),(0,Ke.yF)(),(0,Ne.w6)("design:type",Boolean)],t.prototype,"nzAccordion",void 0),(0,Ne.gn)([(0,Ye.oS)(),(0,Ke.yF)(),(0,Ne.w6)("design:type",Boolean)],t.prototype,"nzBordered",void 0),(0,Ne.gn)([(0,Ye.oS)(),(0,Ke.yF)(),(0,Ne.w6)("design:type",Boolean)],t.prototype,"nzGhost",void 0),t})();const rn="collapsePanel";let an=(()=>{class t{constructor(t,e,n,i,o){this.nzConfigService=t,this.cdr=e,this.nzCollapseComponent=n,this.elementRef=i,this.noAnimation=o,this._nzModuleName=rn,this.nzActive=!1,this.nzDisabled=!1,this.nzShowArrow=!0,this.nzActiveChange=new p.vpe,this.destroy$=new et.xQ,this.elementRef.nativeElement.classList.add("ant-collapse-item"),this.nzConfigService.getConfigChangeEventForComponent(rn).pipe((0,$e.R)(this.destroy$)).subscribe(()=>{this.cdr.markForCheck()})}clickHeader(){this.nzDisabled||this.nzCollapseComponent.click(this)}markForCheck(){this.cdr.markForCheck()}ngOnInit(){this.nzCollapseComponent.addPanel(this)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.nzCollapseComponent.removePanel(this)}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(Ye.jY),p.Y36(p.sBO),p.Y36(sn,1),p.Y36(p.SBq),p.Y36(Ue.P,8))},t.\u0275cmp=p.Xpm({type:t,selectors:[["nz-collapse-panel"]],hostVars:6,hostBindings:function(t,e){2&t&&p.ekj("ant-collapse-no-arrow",!e.nzShowArrow)("ant-collapse-item-active",e.nzActive)("ant-collapse-item-disabled",e.nzDisabled)},inputs:{nzActive:"nzActive",nzDisabled:"nzDisabled",nzShowArrow:"nzShowArrow",nzExtra:"nzExtra",nzHeader:"nzHeader",nzExpandedIcon:"nzExpandedIcon"},outputs:{nzActiveChange:"nzActiveChange"},exportAs:["nzCollapsePanel"],ngContentSelectors:Xe,decls:7,vars:8,consts:[["role","tab",1,"ant-collapse-header",3,"click"],[4,"ngIf"],[4,"nzStringTemplateOutlet"],["class","ant-collapse-extra",4,"ngIf"],[1,"ant-collapse-content"],[1,"ant-collapse-content-box"],["nz-icon","",1,"ant-collapse-arrow",3,"nzType","nzRotate"],[1,"ant-collapse-extra"]],template:function(t,e){1&t&&(p.F$t(),p.TgZ(0,"div",0),p.NdJ("click",function(){return e.clickHeader()}),p.YNc(1,We,2,1,"ng-container",1),p.YNc(2,tn,2,1,"ng-container",2),p.YNc(3,nn,2,1,"div",3),p.qZA(),p.TgZ(4,"div",4),p.TgZ(5,"div",5),p.Hsn(6),p.qZA(),p.qZA()),2&t&&(p.uIk("aria-expanded",e.nzActive),p.xp6(1),p.Q6J("ngIf",e.nzShowArrow),p.xp6(1),p.Q6J("nzStringTemplateOutlet",e.nzHeader),p.xp6(1),p.Q6J("ngIf",e.nzExtra),p.xp6(1),p.ekj("ant-collapse-content-active",e.nzActive),p.Q6J("@.disabled",null==e.noAnimation?null:e.noAnimation.nzNoAnimation)("@collapseMotion",e.nzActive?"expanded":"hidden"))},directives:[i.O5,Ve.f,xt.Ls],encapsulation:2,data:{animation:[Fe.J_]},changeDetection:0}),(0,Ne.gn)([(0,Ke.yF)(),(0,Ne.w6)("design:type",Object)],t.prototype,"nzActive",void 0),(0,Ne.gn)([(0,Ke.yF)(),(0,Ne.w6)("design:type",Object)],t.prototype,"nzDisabled",void 0),(0,Ne.gn)([(0,Ye.oS)(),(0,Ke.yF)(),(0,Ne.w6)("design:type",Boolean)],t.prototype,"nzShowArrow",void 0),t})(),cn=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=p.oAB({type:t}),t.\u0275inj=p.cJS({imports:[[Be.vT,i.ez,xt.PV,Ve.T,Ue.g]]}),t})(),ln=(()=>{class t extends g{constructor(t,e){super(),this.events=t,this.cd=e,this.index=0,this.onUpdate=new p.vpe,this.onUpdateTitle=new p.vpe,this.onUpdateEditable=new p.vpe}onChangeSubEvents(){}onInit(){}updateMaterialOfArray(t){void 0!==t.index&&void 0!==this.mesh.data.material[t.index]&&(this.mesh.data.material[t.index][t.name]=t.value)}updateMaterial(t){this.mesh.data.material[t.name]=t.value,this.onUpdate.emit({material:this.mesh.data.material,index:this.index,name:t.name,value:t.value})}updateMeshTitle(t){this.mesh.data.title=t.value,this.onUpdateTitle.emit({index:this.index,title:this.mesh.data.title})}updateEditable(t){this.onUpdateEditable.emit({index:this.index,name:t.name,status:t.status})}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(G),p.Y36(p.sBO))},t.\u0275cmp=p.Xpm({type:t,selectors:[["mesh-activate-inputs"]],inputs:{mesh:"mesh",index:"index"},outputs:{onUpdate:"onUpdate",onUpdateTitle:"onUpdateTitle",onUpdateEditable:"onUpdateEditable"},features:[p.qOj],decls:2,vars:5,consts:[["name","title","label","Mesh Title",3,"value","valueChange","subcribe"],["index","-1",3,"material","settings","editable","isArray","onUpdate","updateEditable"]],template:function(t,e){1&t&&(p.TgZ(0,"inp-text-group",0),p.NdJ("valueChange",function(t){return e.mesh.title=t})("subcribe",function(t){return e.updateMeshTitle(t)}),p.qZA(),p.TgZ(1,"material-activate-inputs",1),p.NdJ("onUpdate",function(t){return e.updateMaterial(t)})("updateEditable",function(t){return e.updateEditable(t)}),p.qZA()),2&t&&(p.Q6J("value",e.mesh.title),p.xp6(1),p.Q6J("material",e.mesh.__ref__.material)("settings",e.mesh.data.material)("editable",e.mesh.editable)("isArray",!1))},directives:[Ot,je],styles:[""]}),t})();function hn(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"nz-collapse-panel",5),p.TgZ(1,"mesh-activate-inputs",6),p.NdJ("onUpdate",function(e){return p.CHM(t),p.oxw(2).updateMesh(e)})("onUpdateTitle",function(e){return p.CHM(t),p.oxw(2).onUpdateTitle(e)})("onUpdateEditable",function(e){return p.CHM(t),p.oxw(2).updateEditable(e)}),p.qZA(),p.qZA()}if(2&t){const t=e.$implicit,n=p.oxw(2);p.Q6J("nzHeader",t.title?t.title:t.name)("nzActive",t.active)("nzDisabled",t.disabled),p.xp6(1),p.Q6J("mesh",t)("index",t.index)("moduleKey",n.moduleKey)}}function pn(t,e){if(1&t&&(p.TgZ(0,"div",2),p.TgZ(1,"div",3),p.TgZ(2,"nz-collapse"),p.YNc(3,hn,2,6,"nz-collapse-panel",4),p.qZA(),p.qZA(),p.qZA()),2&t){const t=p.oxw();p.xp6(3),p.Q6J("ngForOf",t.settings.meshes)}}let dn=(()=>{class t extends g{constructor(t,e,n,i){super(),this.storage=t,this.itemService=e,this.events=n,this.cd=i,this.settings={},this.settingOriginData={},this.formGroups=[],this.isShow=!0,this.modelDataSubcribe=t=>this.updateAppData(t),this.modelSettingSubcribe=t=>this.asyncSettings(t),this.setDefaultSettingData()}onChangeSubEvents(){this.app=this.subEvents.app,this.registerEventService(this.subEvents,{"panel.update:material":t=>{this.reload(this.app.data.item.settings)},"panel.update:title":t=>{this.reload(this.app.data.item.settings)},"panel.update:editable":t=>{this.reload(this.app.data.item.settings)}})}initOnce(){}onInit(){this.storage.subcribe("modelData",this.modelDataSubcribe,!0),this.storage.subcribe("modelSettings",this.modelSettingSubcribe,!0)}onDestroy(){this.storage.unsubcribe("modelData",this.modelDataSubcribe),this.storage.unsubcribe("modelSettings",this.modelSettingSubcribe)}reload(t){this.isShow=!1,this.asyncSettings(t),setTimeout(()=>{this.isShow=!0,this.cd.detectChanges()},10)}setDefaultSettingData(){this.settings.options={},this.settings.meshes=[]}asyncSettings(t){this.settingOriginData=t,this.settings=t,this.cd.detectChanges()}updateItemData(t){}updateAppData(t){}updateProps(t){(0,d.MP)(this.settings.props,t),this.app.updateSettings(this.settings,{props:!0})}updateMesh(t){if((0,d.Kn)(t)&&Object.prototype.hasOwnProperty.call(t,"index"))for(let e=0;e<this.settings.meshes.length;e++){const n=this.settings.meshes[e];let i=n.__ref__;if(n.index==t.index){(0,d.kJ)(i.material)?n.data.material=t.material:((0,d.Kn)(n.data.material)||(n.data.material={}),n.data.material[t.name]=t.value);const e={};e[t.name]=t.value,this.app.updateMeshMaterial(n.name,e)}}}updateEditable(t){if((0,d.Kn)(t)&&Object.prototype.hasOwnProperty.call(t,"index"))for(let e=0;e<this.settings.meshes.length;e++){const n=this.settings.meshes[e];n.index==t.index&&this.app.updateEditable(n.name,t.name,t.status)}}onUpdateTitle(t){if((0,d.Kn)(t)&&Object.prototype.hasOwnProperty.call(t,"index")){void 0!==this.settings.meshes[t.index]&&(this.settings.meshes[t.index].title=t.title);for(let e=0;e<this.settings.meshes.length;e++){const n=this.settings.meshes[e];n.index==t.index&&this.app.updateMeshTitle(n.name,t.title)}}}}return t.\u0275fac=function(e){return new(e||t)(p.Y36($),p.Y36(_),p.Y36(G),p.Y36(p.sBO))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-tab-meshes"]],features:[p.qOj],decls:5,vars:4,consts:[[1,"tab-inner"],["class","setting-form store",4,"ngIf"],[1,"setting-form","store"],[1,"gridlayout"],[3,"nzHeader","nzActive","nzDisabled",4,"ngFor","ngForOf"],[3,"nzHeader","nzActive","nzDisabled"],[3,"mesh","index","moduleKey","onUpdate","onUpdateTitle","onUpdateEditable"]],template:function(t,e){1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"h2"),p._uU(2),p.ALo(3,"translate"),p.qZA(),p.YNc(4,pn,4,1,"div",1),p.qZA()),2&t&&(p.xp6(2),p.Oqu(p.lcZ(3,2,"Meshes")),p.xp6(2),p.Q6J("ngIf",e.isShow))},directives:[i.O5,sn,i.sg,an,ln],pipes:[ut.X$],styles:["[_nghost-%COMP%]{color:#fff}[_nghost-%COMP%]   h1[_ngcontent-%COMP%], [_nghost-%COMP%]   h2[_ngcontent-%COMP%], [_nghost-%COMP%]   h3[_ngcontent-%COMP%], [_nghost-%COMP%]   h4[_ngcontent-%COMP%], [_nghost-%COMP%]   h5[_ngcontent-%COMP%], [_nghost-%COMP%]   h6[_ngcontent-%COMP%]{color:#fff}h2[_ngcontent-%COMP%]{line-height:1;color:#fff;font-size:15px;margin-bottom:12px;font-weight:600;padding:0 16px}label[_ngcontent-%COMP%]{color:#fff}.input-group[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:10px}.tab-scroll-y[_ngcontent-%COMP%]{height:calc(100%-30px);overflow-y:auto}.store[_ngcontent-%COMP%]{height:calc(100% - 30px)!important;padding-bottom:20px!important;overflow-x:hidden!important}"]}),t})();function gn(t,e){1&t&&p._UZ(0,"i",3)}function un(t,e){1&t&&p._UZ(0,"i",4)}let mn=(()=>{class t{constructor(){this.name="checked",this.value=!1,this.label="",this.old=!1,this.subcribe=new p.vpe}ngOnInit(){}onChangeState(t){this.emit()}emit(){this.subcribe.emit({name:this.name,value:this.value,old:this.old}),this.old=this.value}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.Xpm({type:t,selectors:[["inp-switch"]],inputs:{name:"name",value:"value",label:"label"},outputs:{subcribe:"subcribe"},decls:5,vars:3,consts:[[3,"ngModel","nzCheckedChildren","nzUnCheckedChildren","ngModelChange"],["checkedTemplate",""],["unCheckedTemplate",""],["nz-icon","","nzType","check"],["nz-icon","","nzType","close"]],template:function(t,e){if(1&t&&(p.TgZ(0,"nz-switch",0),p.NdJ("ngModelChange",function(t){return e.value=t})("ngModelChange",function(t){return e.onChangeState(t)}),p.qZA(),p.YNc(1,gn,1,0,"ng-template",null,1,p.W1O),p.YNc(3,un,1,0,"ng-template",null,2,p.W1O)),2&t){const t=p.MAs(2),n=p.MAs(4);p.Q6J("ngModel",e.value)("nzCheckedChildren",t)("nzUnCheckedChildren",n)}},directives:[At.i,Ct.JJ,Ct.On,it.w,xt.Ls],styles:[".input-group[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:10px}"]}),t})();const fn=function(){return{xs:8,sm:16,md:24,lg:32}};let vn=(()=>{class t extends wt{constructor(){super()}ngOnInit(){this.inpInit()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.Xpm({type:t,selectors:[["inp-switch-group"]],features:[p.qOj],decls:8,vars:9,consts:[["nz-row","",1,"input-group",3,"nzGutter"],["nz-col","",1,"gutter-row",3,"nzSpan"],[1,"inner-box"],[1,"inner-box","text-right"],[3,"name","value","valueChange","subcribe"]],template:function(t,e){1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"div",1),p.TgZ(2,"div",2),p._uU(3),p.ALo(4,"translate"),p.qZA(),p.qZA(),p.TgZ(5,"div",1),p.TgZ(6,"div",3),p.TgZ(7,"inp-switch",4),p.NdJ("valueChange",function(t){return e.value=t})("subcribe",function(t){return e.onChange(t)}),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t&&(p.Q6J("nzGutter",p.DdM(8,fn)),p.xp6(1),p.Q6J("nzSpan",18),p.xp6(2),p.Oqu(p.lcZ(4,6,e.label)),p.xp6(2),p.Q6J("nzSpan",6),p.xp6(2),p.Q6J("name",e.name)("value",e.value))},directives:[Mt.SK,Mt.t3,mn],pipes:[ut.X$],styles:["[_nghost-%COMP%]{display:block;margin-top:10px;margin-bottom:15px}.text-right[_ngcontent-%COMP%]{text-align:right}"]}),t})();const bn=function(){return{xs:8,sm:16,md:24,lg:32}};let _n=(()=>{class t extends Pt{constructor(){super(),this.formatterX=t=>`x: ${t}`,this.parserX=t=>t.replace("x: ",""),this.formatterY=t=>`y: ${t}`,this.parserY=t=>t.replace("y: ",""),this.formatterZ=t=>`z: ${t}`,this.parserZ=t=>t.replace("z: ","")}ngOnInit(){}updateVector(t,e){this.emit()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.Xpm({type:t,selectors:[["inp-vector3"]],features:[p.qOj],decls:10,vars:17,consts:[["nz-row","",3,"nzGutter"],["nz-col","",1,"gutter-row",3,"nzSpan"],[1,"inner-box"],["name","x",3,"ngModel","nzStep","nzFormatter","nzParser","ngModelChange"]],template:function(t,e){1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"div",1),p.TgZ(2,"div",2),p.TgZ(3,"nz-input-number",3),p.NdJ("ngModelChange",function(t){return e.value.x=t})("ngModelChange",function(t){return e.updateVector("x",t)}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(4,"div",1),p.TgZ(5,"div",2),p.TgZ(6,"nz-input-number",3),p.NdJ("ngModelChange",function(t){return e.value.y=t})("ngModelChange",function(t){return e.updateVector("y",t)}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(7,"div",1),p.TgZ(8,"div",2),p.TgZ(9,"nz-input-number",3),p.NdJ("ngModelChange",function(t){return e.value.z=t})("ngModelChange",function(t){return e.updateVector("z",t)}),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t&&(p.Q6J("nzGutter",p.DdM(16,bn)),p.xp6(1),p.Q6J("nzSpan",8),p.xp6(2),p.Q6J("ngModel",e.value.x)("nzStep",.001)("nzFormatter",e.formatterX)("nzParser",e.parserX),p.xp6(1),p.Q6J("nzSpan",8),p.xp6(2),p.Q6J("ngModel",e.value.y)("nzStep",.001)("nzFormatter",e.formatterY)("nzParser",e.parserY),p.xp6(1),p.Q6J("nzSpan",8),p.xp6(2),p.Q6J("ngModel",e.value.z)("nzStep",.001)("nzFormatter",e.formatterZ)("nzParser",e.parserZ))},directives:[Mt.SK,Mt.t3,Qt._,Ct.JJ,Ct.On],styles:[""]}),t})();function xn(t,e){1&t&&p.GkF(0)}const wn=function(){return{xs:8,sm:16,md:24,lg:32}};function yn(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div",4),p.TgZ(1,"div",5),p.TgZ(2,"div",6),p._uU(3),p.ALo(4,"translate"),p.qZA(),p.qZA(),p.TgZ(5,"div",5),p.TgZ(6,"div",7),p.TgZ(7,"button",8),p.NdJ("click",function(){return p.CHM(t),p.oxw().setCenter()}),p._uU(8,"Center"),p.qZA(),p.qZA(),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("nzGutter",p.DdM(7,wn)),p.xp6(1),p.Q6J("nzSpan",16),p.xp6(2),p.Oqu(p.lcZ(4,5,t.label)),p.xp6(2),p.Q6J("nzSpan",8),p.xp6(2),p.Q6J("nzSize","small")}}function Cn(t,e){if(1&t&&(p.TgZ(0,"div",6),p._uU(1),p.ALo(2,"translate"),p.qZA()),2&t){const t=p.oxw();p.xp6(1),p.Oqu(p.lcZ(2,1,t.label))}}let On=(()=>{class t extends wt{constructor(t){super(),this.cd=t,this.btnCenter=!1,this.canSync=!1}ngOnInit(){this.inpInit(),this.canSync=!0}setCenter(){this.value.x=0,this.value.z=0,this.emit(),this.cd.detectChanges()}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(p.sBO))},t.\u0275cmp=p.Xpm({type:t,selectors:[["inp-vector3-group"]],inputs:{btnCenter:"btnCenter"},features:[p.qOj],decls:6,vars:5,consts:[[4,"ngIf","ngIfThen","ngIfElse"],["centerTemplate",""],["labelTemplate",""],[3,"name","value","valueChange","subcribe"],["nz-row","",3,"nzGutter"],["nz-col","",1,"gutter-row",3,"nzSpan"],[1,"label"],[1,"text-right"],["nz-button","","nzType","default",3,"nzSize","click"]],template:function(t,e){if(1&t&&(p.YNc(0,xn,1,0,"ng-container",0),p.YNc(1,yn,9,8,"ng-template",null,1,p.W1O),p.YNc(3,Cn,3,3,"ng-template",null,2,p.W1O),p.TgZ(5,"inp-vector3",3),p.NdJ("valueChange",function(t){return e.value=t})("subcribe",function(t){return e.onChange(t)}),p.qZA()),2&t){const t=p.MAs(2),n=p.MAs(4);p.Q6J("ngIf",e.btnCenter)("ngIfThen",t)("ngIfElse",n),p.xp6(5),p.Q6J("name",e.name)("value",e.value)}},directives:[i.O5,_n,Mt.SK,Mt.t3,nt.ix,gt.dQ,it.w],pipes:[ut.X$],styles:["[_nghost-%COMP%]{display:block;margin-top:10px;margin-bottom:15px}.label[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:10px;padding-left:10px}.text-right[_ngcontent-%COMP%]{text-align:right}"]}),t})();const Mn=function(){return{xs:8,sm:16,md:24,lg:32}};let Pn=(()=>{class t extends wt{constructor(t){super(),this.cd=t,this.degreSymbol="\xb0",this._value={x:0,y:0,z:0},this.canSync=!1,this.formatterX=t=>`x: ${t} ${this.degreSymbol}`,this.parserX=t=>d.W3.replace(t,["x",":",this.degreSymbol," "],""),this.formatterY=t=>`y: ${t} ${this.degreSymbol}`,this.parserY=t=>d.W3.replace(t,["y",":",this.degreSymbol," "],""),this.formatterZ=t=>`z: ${t} ${this.degreSymbol}`,this.parserZ=t=>d.W3.replace(t,["z",":",this.degreSymbol," "],"")}ngOnInit(){this.inpInit(),this.syncFromParent(),this.canSync=!0,this.events&&this.events.on("props.rotation.change",t=>{t.value&&(this.value=t.value),this.syncFromParent()})}syncFromParent(){this._value={x:(0,d.DR)(this.value.x),y:(0,d.DR)(this.value.y),z:(0,d.DR)(this.value.z)},this.cd.detectChanges()}ngOnChanges(t){this.canSync&&t.value&&this.syncFromParent()}updateVector(t,e){this.canSync=!1,(0,d.MP)(this.value,{x:(0,d.S3)(this._value.x),y:(0,d.S3)(this._value.y),z:(0,d.S3)(this._value.z)}),this.emit(),this.canSync=!0}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(p.sBO))},t.\u0275cmp=p.Xpm({type:t,selectors:[["inp-rotation-group"]],inputs:{events:"events"},features:[p.qOj,p.TTD],decls:13,vars:20,consts:[[1,"label"],["nz-row","",3,"nzGutter"],["nz-col","",1,"gutter-row",3,"nzSpan"],[1,"inner-box"],["name","x",3,"ngModel","nzStep","nzFormatter","nzParser","ngModelChange"]],template:function(t,e){1&t&&(p.TgZ(0,"div",0),p._uU(1),p.ALo(2,"translate"),p.qZA(),p.TgZ(3,"div",1),p.TgZ(4,"div",2),p.TgZ(5,"div",3),p.TgZ(6,"nz-input-number",4),p.NdJ("ngModelChange",function(t){return e._value.x=t})("ngModelChange",function(t){return e.updateVector("x",t)}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(7,"div",2),p.TgZ(8,"div",3),p.TgZ(9,"nz-input-number",4),p.NdJ("ngModelChange",function(t){return e._value.y=t})("ngModelChange",function(t){return e.updateVector("y",t)}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(10,"div",2),p.TgZ(11,"div",3),p.TgZ(12,"nz-input-number",4),p.NdJ("ngModelChange",function(t){return e._value.z=t})("ngModelChange",function(t){return e.updateVector("z",t)}),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t&&(p.xp6(1),p.Oqu(p.lcZ(2,17,e.label)),p.xp6(2),p.Q6J("nzGutter",p.DdM(19,Mn)),p.xp6(1),p.Q6J("nzSpan",8),p.xp6(2),p.Q6J("ngModel",e._value.x)("nzStep",.01)("nzFormatter",e.formatterX)("nzParser",e.parserX),p.xp6(1),p.Q6J("nzSpan",8),p.xp6(2),p.Q6J("ngModel",e._value.y)("nzStep",.01)("nzFormatter",e.formatterY)("nzParser",e.parserY),p.xp6(1),p.Q6J("nzSpan",8),p.xp6(2),p.Q6J("ngModel",e._value.z)("nzStep",.01)("nzFormatter",e.formatterZ)("nzParser",e.parserZ))},directives:[Mt.SK,Mt.t3,Qt._,Ct.JJ,Ct.On],pipes:[ut.X$],styles:["[_nghost-%COMP%]{display:block;margin-top:10px;margin-bottom:15px}.label[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:10px;padding-left:10px}"]}),t})();function Sn(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div"),p.TgZ(1,"inp-switch-group",1),p.NdJ("valueChange",function(e){return p.CHM(t),p.oxw().props.castShadow=e})("subcribe",function(e){return p.CHM(t),p.oxw().onInputChange(e)}),p.qZA(),p.TgZ(2,"inp-switch-group",2),p.NdJ("valueChange",function(e){return p.CHM(t),p.oxw().props.receiveShadow=e})("subcribe",function(e){return p.CHM(t),p.oxw().onInputChange(e)}),p.qZA(),p.TgZ(3,"inp-vector3-group",3),p.NdJ("valueChange",function(e){return p.CHM(t),p.oxw().props.scale=e})("subcribe",function(e){return p.CHM(t),p.oxw().onInputChange(e)}),p.qZA(),p.TgZ(4,"inp-rotation-group",4),p.NdJ("valueChange",function(e){return p.CHM(t),p.oxw().props.rotation=e})("subcribe",function(e){return p.CHM(t),p.oxw().onInputChange(e)}),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.xp6(1),p.Q6J("value",t.props.castShadow),p.xp6(1),p.Q6J("value",t.props.receiveShadow),p.xp6(1),p.Q6J("value",t.props.scale),p.xp6(1),p.Q6J("value",t.props.rotation)("events",t.events)}}let kn=(()=>{class t{constructor(t,e){this.cd=t,this.eventService=e,this.props={},this.index=0,this.onUpdate=new p.vpe,this.events=null,this.events=this.eventService}ngOnInit(){setTimeout(()=>{this.eventService.emit({type:"props.rotation.change",value:this.props.rotation})},10),this.cd.detectChanges()}onInputChange(t){t&&(0,d.Kn)(t)&&t.name&&((0,d.Kn)(this.props[t.name])&&(0,d.Kn)(t.value)?(0,d.MP)(this.props[t.name],t.value):this.props[t.name]=t.value,this.emitUpdate())}emitUpdate(){this.onUpdate.emit(this.props)}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(p.sBO),p.Y36(X.O))},t.\u0275cmp=p.Xpm({type:t,selectors:[["object-prop"]],inputs:{props:"props",index:"index"},outputs:{onUpdate:"onUpdate"},decls:1,vars:1,consts:[[4,"ngIf"],["name","castShadow","label","Cast Shadow",3,"value","valueChange","subcribe"],["name","receiveShadow","label","Receive Shadow",3,"value","valueChange","subcribe"],["name","scale","label","Scale",3,"value","valueChange","subcribe"],["name","rotation","label","Rotation",3,"value","events","valueChange","subcribe"]],template:function(t,e){1&t&&p.YNc(0,Sn,5,5,"div",0),2&t&&p.Q6J("ngIf",e.props)},directives:[i.O5,vn,On,Pn],styles:[".input-group[_ngcontent-%COMP%]{margin:10px auto}"]}),t})(),Zn=(()=>{class t extends g{constructor(t,e,n){super(),this.storage=t,this.app=e,this.itemService=n,this.settings={},this.settingOriginData={},this.index=0,this.setDefaultSettingData(),this.storage.subcribe("modelSettings",t=>this.asyncSettings(t),!0)}onInit(){}onDestroy(){}setDefaultSettingData(){this.settings.props={castShadow:!1,receiveShadow:!1,rotation:{x:0,y:0,z:0},scale:{x:0,y:0,z:0}}}asyncSettings(t){this.settingOriginData=t,(0,d.bg)(this.settings,t,["meshes"])}updateProps(t){(0,d.MP)(this.settings.props,t),this.app.updateSettings(this.settings,{props:!0})}}return t.\u0275fac=function(e){return new(e||t)(p.Y36($),p.Y36(F),p.Y36(_))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-tab-properties"]],features:[p.qOj],decls:6,vars:5,consts:[[1,"tab-inner"],[1,"setting-form","store"],[3,"props","index","onUpdate"]],template:function(t,e){1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"h2"),p._uU(2),p.ALo(3,"translate"),p.qZA(),p.TgZ(4,"div",1),p.TgZ(5,"object-prop",2),p.NdJ("onUpdate",function(t){return e.updateProps(t)}),p.qZA(),p.qZA(),p.qZA()),2&t&&(p.xp6(2),p.Oqu(p.lcZ(3,3,"Properties")),p.xp6(3),p.Q6J("props",e.settings.props)("index",e.index))},directives:[kn],pipes:[ut.X$],styles:["[_nghost-%COMP%]{color:#fff}[_nghost-%COMP%]   h1[_ngcontent-%COMP%], [_nghost-%COMP%]   h2[_ngcontent-%COMP%], [_nghost-%COMP%]   h3[_ngcontent-%COMP%], [_nghost-%COMP%]   h4[_ngcontent-%COMP%], [_nghost-%COMP%]   h5[_ngcontent-%COMP%], [_nghost-%COMP%]   h6[_ngcontent-%COMP%]{color:#fff}[_nghost-%COMP%]   h2[_ngcontent-%COMP%]{padding-left:10px}.tab-inner[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{padding-left:10px}.store[_ngcontent-%COMP%]{height:calc(100% - 30px)!important;padding-bottom:20px!important;overflow-x:hidden!important}"]}),t})();function zn(t,e){1&t&&p._UZ(0,"img",5)}function Tn(t,e){1&t&&p._UZ(0,"img",6)}var En=(()=>{return(t=En||(En={}))[t.Meshes=0]="Meshes",t[t.Props=1]="Props",En;var t})();let An=(()=>{class t extends g{constructor(t){super(),this.cd=t,this.prevTab=En.Meshes,this.currentTab=En.Meshes}onInit(){}onChangeTab(t){this.currentTab=t.index,this.cd.detectChanges()}onClickSearch(t){console.log(t)}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(p.sBO))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-sidebar"]],features:[p.qOj],decls:9,vars:5,consts:[["nzTabPosition","top","nzType","line",1,"main-tab",3,"nzSelectedIndex","nzSelectChange"],[3,"nzTitle"],["iconMeshes",""],[3,"moduleKey"],["iconProps",""],["src","/assets/icons/new-design/tab-sub/model.svg","alt","Meshes"],["src","/assets/icons/new-design/tab-top/setting.svg","alt","Props"]],template:function(t,e){if(1&t&&(p.TgZ(0,"nz-tabset",0),p.NdJ("nzSelectChange",function(t){return e.onChangeTab(t)}),p.TgZ(1,"nz-tab",1),p.YNc(2,zn,1,0,"ng-template",null,2,p.W1O),p._UZ(4,"app-tab-meshes",3),p.qZA(),p.TgZ(5,"nz-tab",1),p.YNc(6,Tn,1,0,"ng-template",null,4,p.W1O),p._UZ(8,"app-tab-properties",3),p.qZA(),p.qZA()),2&t){const t=p.MAs(3),n=p.MAs(7);p.Q6J("nzSelectedIndex",e.currentTab),p.xp6(1),p.Q6J("nzTitle",t),p.xp6(3),p.Q6J("moduleKey",e.moduleKey),p.xp6(1),p.Q6J("nzTitle",n),p.xp6(3),p.Q6J("moduleKey",e.moduleKey)}},directives:[He.xH,He.xw,dn,Zn],styles:["img[_ngcontent-%COMP%]{height:24px}"],changeDetection:0}),t})();var Dn=n(60179);const qn={name:"foreground",url:"",position:{x:"center",y:"center"},repeat:"no",opacity:1,size:"contain"};let In=(()=>{class t extends g{constructor(t,e){super(),this.events=t,this.cd=e,this.data=null,this.index=0,this.update=new p.vpe,this.clickDelete=new p.vpe,this.zIndex=0,this.app=null,this.updateEvent=t=>{t.data.secret_key==this.data.secret_key&&(this.data=t.data,this.setStyle())}}onChangeSubEvents(){this.registerEventService(this.subEvents,"app.set",t=>this.setApp(t.app),!0)}onInit(){this.setStyle()}onDestroy(){this.app&&this.app.off("scene.foregrounds.updated",this.updateEvent)}setStyle(){let t=(0,d.MP)({},qn);this.data=(0,d.MP)(t,this.data),this.bgImageUrl="url("+this.data.url+")",this.zIndex=1+this.index,this.cd.detectChanges()}setApp(t){this.app=t,t.on("scene.foregrounds.updated",this.updateEvent)}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(B.v),p.Y36(p.sBO))},t.\u0275cmp=p.Xpm({type:t,selectors:[["foreground-layer-item"]],inputs:{data:"data",index:"index"},outputs:{update:"update",clickDelete:"clickDelete"},features:[p.qOj],decls:1,vars:10,consts:[[1,"foreground-item"]],template:function(t,e){1&t&&p._UZ(0,"div",0),2&t&&(p.Udp("background-image",e.bgImageUrl)("z-index",e.zIndex)("opacity",e.data.opacity),p.uIk("data-repeat",e.data.repeat)("data-bg-size",e.data.size)("data-pos-x",e.data.position.x)("data-pos-y",e.data.position.y))},styles:[".foreground-item[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0;z-index:100;background-position:center center;background-repeat:no-repeat}.foreground-item.repeat[_ngcontent-%COMP%], .foreground-item[data-repeat=repeat][_ngcontent-%COMP%], .foreground-item[data-repeat=auto][_ngcontent-%COMP%]{background-repeat:repeat}.foreground-item.repeat-x[_ngcontent-%COMP%], .foreground-item[data-repeat=x][_ngcontent-%COMP%], .foreground-item[data-repeat=repeat-x][_ngcontent-%COMP%]{background-repeat:repeat-x}.foreground-item.repeat-y[_ngcontent-%COMP%], .foreground-item[data-repeat=y][_ngcontent-%COMP%], .foreground-item[data-repeat=repeat-y][_ngcontent-%COMP%]{background-repeat:repeat-y}.foreground-item.repeat-no[_ngcontent-%COMP%], .foreground-item.no-repeat[_ngcontent-%COMP%], .foreground-item[data-repeat=no-repeat][_ngcontent-%COMP%], .foreground-item[data-repeat=no][_ngcontent-%COMP%]{background-repeat:no-repeat}.foreground-item.pos-x-left[_ngcontent-%COMP%], .foreground-item.pos-left[_ngcontent-%COMP%], .foreground-item[data-pos-x=left][_ngcontent-%COMP%]{background-position-x:left}.foreground-item.pos-x-center[_ngcontent-%COMP%], .foreground-item[data-pos-x=center][_ngcontent-%COMP%]{background-position-x:center}.foreground-item.pos-x-right[_ngcontent-%COMP%], .foreground-item.pos-right[_ngcontent-%COMP%], .foreground-item[data-pos-x=right][_ngcontent-%COMP%]{background-position-x:right}.foreground-item.pos-y-top[_ngcontent-%COMP%], .foreground-item.pos-top[_ngcontent-%COMP%], .foreground-item[data-pos-y=top][_ngcontent-%COMP%]{background-position-y:top}.foreground-item.pos-y-center[_ngcontent-%COMP%], .foreground-item[data-pos-y=center][_ngcontent-%COMP%]{background-position-y:center}.foreground-item.pos-y-bottom[_ngcontent-%COMP%], .foreground-item.pos-bottom[_ngcontent-%COMP%], .foreground-item[data-pos-y=bottom][_ngcontent-%COMP%]{background-position-y:bottom}.foreground-item.pos-left-top[_ngcontent-%COMP%], .foreground-item[data-pos=left-top][_ngcontent-%COMP%]{background-position:left top}.foreground-item.pos-left-center[_ngcontent-%COMP%], .foreground-item[data-pos=left-center][_ngcontent-%COMP%]{background-position:left center}.foreground-item.pos-left-bottom[_ngcontent-%COMP%], .foreground-item[data-pos=left-bottom][_ngcontent-%COMP%]{background-position:left bottom}.foreground-item.pos-center-top[_ngcontent-%COMP%], .foreground-item[data-pos=center-top][_ngcontent-%COMP%]{background-position:center top}.foreground-item.pos-center-center[_ngcontent-%COMP%], .foreground-item[data-pos=center-center][_ngcontent-%COMP%]{background-position:center center}.foreground-item.pos-center-bottom[_ngcontent-%COMP%], .foreground-item[data-pos=center-bottom][_ngcontent-%COMP%]{background-position:center bottom}.foreground-item.pos-right-top[_ngcontent-%COMP%], .foreground-item[data-pos=right-top][_ngcontent-%COMP%]{background-position:right top}.foreground-item.pos-right-center[_ngcontent-%COMP%], .foreground-item[data-pos=right-center][_ngcontent-%COMP%]{background-position:right center}.foreground-item.pos-right-bottom[_ngcontent-%COMP%], .foreground-item[data-pos=right-bottom][_ngcontent-%COMP%]{background-position:right bottom}.foreground-item.bg-size-contain[_ngcontent-%COMP%], .foreground-item[data-bg-size=contain][_ngcontent-%COMP%]{background-size:contain}.foreground-item.bg-size-cover[_ngcontent-%COMP%], .foreground-item[data-bg-size=cover][_ngcontent-%COMP%]{background-size:cover}.foreground-item.d-none[_ngcontent-%COMP%], .foreground-item.hide[_ngcontent-%COMP%]{display:none}"]}),t})();function Jn(t,e){if(1&t&&p._UZ(0,"foreground-layer-item",2),2&t){const t=e.$implicit,n=e.index,i=p.oxw();p.Q6J("moduleKey",i.moduleKey)("data",t)("index",n)}}let Ln=(()=>{class t extends g{constructor(t,e){super(),this._service=t,this.cd=e,this.app3D=null,this.foregrounds=[]}onInit(){const t=this._service.sub(this.moduleKey);t&&t!==this.service&&(this.service=t),this.app?this.setApp(this.app):this.service.on("app.set",t=>this.setApp(t.app),!0)}setApp(t){this.app3D=t;const e=()=>this.loadForegrounds();this.app3D.on({"scene.foregrounds.added":e,"scene.foregrounds.deleted":e,"scene.foregrounds.updated":e,"data.imported":e,"data.renew":e,"data.resetted":e}),e()}loadForegrounds(){this.foregrounds=this.app3D.getForegrounds(),this.cd.detectChanges()}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(B.v),p.Y36(p.sBO))},t.\u0275cmp=p.Xpm({type:t,selectors:[["foreground-layer"]],inputs:{app:"app"},features:[p.qOj],decls:2,vars:1,consts:[[1,"foregrounds"],[3,"moduleKey","data","index",4,"ngFor","ngForOf"],[3,"moduleKey","data","index"]],template:function(t,e){1&t&&(p.TgZ(0,"div",0),p.YNc(1,Jn,1,3,"foreground-layer-item",1),p.qZA()),2&t&&(p.xp6(1),p.Q6J("ngForOf",e.foregrounds))},directives:[i.sg,In],styles:[".foregrounds[_ngcontent-%COMP%]{position:relative;height:100%;width:100%}"]}),t})(),jn=(()=>{class t extends g{constructor(t){super(),this.service=t}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(B.v))},t.\u0275cmp=p.Xpm({type:t,selectors:[["droppable-layer"]],features:[p.qOj],decls:6,vars:0,consts:[[1,"message"],[1,"message-body"],[1,"message-title"],[1,"message-content"]],template:function(t,e){1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"div",1),p.TgZ(2,"H3",2),p._uU(3,"Drop Here"),p.qZA(),p.TgZ(4,"p",3),p._uU(5,"Th\u1ea3 v\xe0o \u0111\xe2y!"),p.qZA(),p.qZA(),p.qZA())},styles:['[_nghost-%COMP%]{position:absolute;z-index:1100;top:100%;left:50%;height:0;width:0;display:flex;align-content:center;align-items:center;background:rgba(255,255,255,.4);overflow:hidden;border-radius:50%;-webkit-animation-name:dragelementhover;-webkit-animation-duration:.15s;animation-name:dragelementhover;animation-duration:.15s}[_nghost-%COMP%]   .message[_ngcontent-%COMP%]{align-items:center;align-content:center;text-align:center;width:0px;height:0px;margin:auto;border-radius:50%;background:#fff;box-shadow:0 0 20px 20px #10b3d6;display:flex;overflow:hidden;transition:all .4s ease-in-out}[_nghost-%COMP%]   .message[_ngcontent-%COMP%]   .message-body[_ngcontent-%COMP%]{text-align:center;display:block;width:100%}[_nghost-%COMP%]   .message[_ngcontent-%COMP%]   .message-title[_ngcontent-%COMP%]{font-weight:700;font-size:25px;margin-bottom:20px}[_nghost-%COMP%]   .message[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]{margin-bottom:5px}.active[_nghost-%COMP%]{display:flex;border-radius:0;top:0;left:0;opacity:1;width:100%;height:100%}.active[_nghost-%COMP%]   .message[_ngcontent-%COMP%]{width:248px;height:248px}[_nghost-%COMP%]   .ctn-preloader[_ngcontent-%COMP%]{display:none}.is-loading[_nghost-%COMP%]{display:flex;border-radius:0;top:0;left:0;opacity:1;width:100%;height:100%}.is-loading[_nghost-%COMP%]   .message[_ngcontent-%COMP%]{display:none}.is-loading[_nghost-%COMP%]   .loading[_ngcontent-%COMP%]{display:flex;margin:auto}.is-loading[_nghost-%COMP%]   .ctn-preloader[_ngcontent-%COMP%]{padding-left:15px;padding-right:15px;display:block;margin:auto}.is-loading[_nghost-%COMP%]   .spinner[_ngcontent-%COMP%]{-webkit-animation:spinner 3s infinite linear;animation:spinner 3s infinite linear;border-radius:50%;border:3px solid #f1f6f8;border-left-color:#10b3d6;border-top-color:#10b3d6;margin:0 auto;position:absolute;left:-10px;right:-10px;bottom:-10px;top:-10px}.is-loading[_nghost-%COMP%]   .spinner[_ngcontent-%COMP%]:before{box-sizing:border-box;content:"";width:20px;height:20px;border:6px solid #fff;box-shadow:0 0 20px #042e3833;background:#10b3d6;position:absolute;right:22px;top:35px;border-radius:50%}@media (max-width: 576px){.is-loading[_nghost-%COMP%]   .spinner[_ngcontent-%COMP%]:before{top:18px}}.is-loading[_nghost-%COMP%]   .round_spinner[_ngcontent-%COMP%]{border-width:1px;border-color:#eef3f4;border-style:solid;border-radius:50%;background-color:#fdfdfd;box-shadow:0 0 100px #042e3824;width:248px;height:248px;display:flex;align-items:center;justify-content:center;position:relative}@media (max-width: 576px){.is-loading[_nghost-%COMP%]   .round_spinner[_ngcontent-%COMP%]{width:155px;height:155px}}.is-loading[_nghost-%COMP%]   .round_spinner[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:30px;font-weight:400;margin-bottom:0;color:#1d2746}.is-loading[_nghost-%COMP%]   .round_spinner[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:700}.is-loading[_nghost-%COMP%]   .head[_ngcontent-%COMP%]{color:#1d2746;display:block;font-size:26px;font-weight:700;letter-spacing:5.2px;text-transform:uppercase;text-align:center;font-family:"Roboto",sans-serif;margin:5% 0 1%;padding:0}@-webkit-keyframes dragelementhover{0%{top:100%;left:50%;opacity:0;width:0;height:0}50%{top:calc(50%-50px);left:calc(50%-50px);opacity:.4;width:100px;height:100px}to{top:0;left:50%;opacity:1;width:100%;height:100%}}@keyframes dragelementhover{0%{top:100%;left:50%;opacity:0;width:0;height:0}50%{top:calc(50%-50px);left:calc(50%-50px);opacity:.4;width:100px;height:100px}to{top:0;left:50%;opacity:1;width:100%;height:100%}}@-webkit-keyframes dropimgzoomout{0%{width:100%;height:50px}to{width:1%;height:1px}}@keyframes dropimgzoomout{0%{width:100%;height:50px}to{width:1%;height:1px}}@-webkit-keyframes dragelementout{0%{top:0;left:50%;opacity:1;width:100%;height:100%}to{top:100%;left:0;opacity:0;width:0;height:0}}@keyframes dragelementout{0%{top:0;left:50%;opacity:1;width:100%;height:100%}to{top:100%;left:50%;opacity:0;width:0;height:0}}@-webkit-keyframes spinner{to{transform:rotate(360deg)}}@keyframes spinner{to{transform:rotate(360deg)}}']}),t})(),Rn=(()=>{class t extends g{constructor(t,e){super(),this.events=t,this.cd=e,this.isActive=!1,this.isInited=!1}onChangeSubEvents(){this.registerEventService(this.subEvents,{"show:loading|dispatch":()=>{this.isActive=!0},"hide:loading|dispatch":()=>{this.isActive=!1}})}onInit(){}onDestroy(){}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(B.v),p.Y36(p.sBO))},t.\u0275cmp=p.Xpm({type:t,selectors:[["viewport-loading-layer"]],features:[p.qOj],decls:7,vars:2,consts:[[1,"loading-wrapper"],["id","ctn-preloader",1,"ctn-preloader"],[1,"round_spinner"],[1,"spinner"],[1,"text"],[1,"title"]],template:function(t,e){1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"div",1),p.TgZ(2,"div",2),p._UZ(3,"Div",3),p.TgZ(4,"Div",4),p.TgZ(5,"H4",5),p._uU(6,"\u0110ang T\u1ea3i..."),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t&&p.ekj("active",e.isActive)},styles:['.loading-wrapper[_ngcontent-%COMP%]{display:none;position:absolute;z-index:600;top:0;left:0;height:100%;width:100%;align-content:center;align-items:center;background:rgba(255,255,255,.4);overflow:hidden}.loading-wrapper[_ngcontent-%COMP%]   .loading[_ngcontent-%COMP%]{display:flex;margin:auto}.loading-wrapper[_ngcontent-%COMP%]   .ctn-preloader[_ngcontent-%COMP%]{padding-left:15px;padding-right:15px;display:block;margin:auto}.loading-wrapper[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{-webkit-animation:spinner 3s infinite linear;animation:spinner 3s infinite linear;border-radius:50%;border:3px solid #f1f6f8;border-left-color:#10b3d6;border-top-color:#10b3d6;margin:0 auto;position:absolute;left:-10px;right:-10px;bottom:-10px;top:-10px}.loading-wrapper[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]:before{box-sizing:border-box;content:"";width:20px;height:20px;border:6px solid #fff;box-shadow:0 0 20px #042e3833;background:#10b3d6;position:absolute;right:22px;top:35px;border-radius:50%}@media (max-width: 576px){.loading-wrapper[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]:before{top:18px}}.loading-wrapper[_ngcontent-%COMP%]   .round_spinner[_ngcontent-%COMP%]{border-width:1px;border-color:#eef3f4;border-style:solid;border-radius:50%;background-color:#fdfdfd;box-shadow:0 0 100px #042e3824;width:248px;height:248px;display:flex;align-items:center;justify-content:center;position:relative}@media (max-width: 576px){.loading-wrapper[_ngcontent-%COMP%]   .round_spinner[_ngcontent-%COMP%]{width:155px;height:155px}}.loading-wrapper[_ngcontent-%COMP%]   .round_spinner[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:30px;font-weight:400;margin-bottom:0;color:#1d2746}.loading-wrapper[_ngcontent-%COMP%]   .round_spinner[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:700}.loading-wrapper[_ngcontent-%COMP%]   .head[_ngcontent-%COMP%]{color:#1d2746;display:block;font-size:26px;font-weight:700;letter-spacing:5.2px;text-transform:uppercase;text-align:center;font-family:"Roboto",sans-serif;margin:5% 0 1%;padding:0}.loading-wrapper.active[_ngcontent-%COMP%]{display:flex}@-webkit-keyframes spinner{to{transform:rotate(360deg)}}@keyframes spinner{to{transform:rotate(360deg)}}']}),t})();var Qn=n(23894);function Hn(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div",1),p.TgZ(1,"div",2),p.TgZ(2,"inp-select",3),p.NdJ("valueChange",function(e){return p.CHM(t),p.oxw().currentFace=e})("subcribe",function(e){return p.CHM(t),p.oxw().changeFace(e.value)}),p.qZA(),p.qZA(),p._UZ(3,"div",4),p.qZA()}if(2&t){const t=p.oxw();p.xp6(2),p.Q6J("value",t.currentFace)("options",t.faceOptions)("fullwidth",!0)}}const Nn=[{value:"custom",label:"Custom"}];Qn.Ct.map(t=>Nn.push(t));let Fn=(()=>{class t extends g{constructor(t,e){super(),this.events=t,this.elemRef=e,this.isShow=!1,this.canvas=null,this.css="",this.faceOptions=Nn,this.currentFace="custom",this.registerEventService(window,"resize",t=>this.updateCanvasSize(t))}onChangeSubEvents(){this.registerEventService(this.subEvents,{"show|dispatch":t=>{this.isShow=!(0,d.aX)(t,"value")||t.value},"hide|dispatch":t=>this.isShow=!1})}onInit(){this.activeEventServiceRegistered(window)}onDestroy(){this.deactiveEventServiceRegistered(window)}changeFace(t){let e=t.toLowerCase();(0,M.ex)(e)&&this.subEvents.emit({type:"changeface",face:e})}ngAfterViewInit(){this.initCanvas()}updateCanvasSize(t){}initCanvas(){setTimeout(()=>{var t=this.elemRef.nativeElement.querySelector(".canvas-wrapper");t&&(t.innerHTML="",this.subEvents.setCanvasWrapper(t))},5)}setApp(t){this.initCanvas()}setCanvas(t){this.initCanvas()}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(W.n),p.Y36(p.SBq))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-vector-controls"]],features:[p.qOj],decls:1,vars:1,consts:[["class","fs",4,"ngIf"],[1,"fs"],[1,"face-selection"],["name","face",3,"value","options","fullwidth","valueChange","subcribe"],[1,"canvas-wrapper"]],template:function(t,e){1&t&&p.YNc(0,Hn,4,3,"div",0),2&t&&p.Q6J("ngIf",e.isShow)},directives:[i.O5,Zt],styles:[".canvas-wrapper[_ngcontent-%COMP%]{position:absolute;bottom:10px;right:10px;width:100px;height:100px;z-index:350}.face-selection[_ngcontent-%COMP%]{position:absolute;bottom:25px;left:25px;z-index:350;width:150px}.face-selection[_ngcontent-%COMP%]   inp-select[_ngcontent-%COMP%]{display:block;width:100%}.face-matrix[_ngcontent-%COMP%]{position:absolute;bottom:10px;left:10px;z-index:350;width:200px}.face-matrix[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;margin-left:-2.5px;margin-right:-2.5px;align-items:center;align-content:center}.face-matrix[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col[_ngcontent-%COMP%]{padding:2.5px;flex:0 0 25%;max-width:25%}.face-matrix[_ngcontent-%COMP%]   .face-item[_ngcontent-%COMP%]{height:25px;line-height:25px;background-color:#20242d;cursor:pointer;text-align:center;color:#fafafa;font-size:13px}.face-matrix[_ngcontent-%COMP%]   .face-item[_ngcontent-%COMP%]:hover{background-color:#345eca;color:#fff}.face-matrix[_ngcontent-%COMP%]   .face-item.active[_ngcontent-%COMP%], .face-matrix[_ngcontent-%COMP%]   .face-item[_ngcontent-%COMP%]:active{background-color:#1d47af}"]}),t})();function Yn(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"button",3),p.NdJ("click",function(){p.CHM(t);const n=e.$implicit;return p.oxw(2).onClick(n.key)}),p._uU(1),p.ALo(2,"translate"),p.qZA()}if(2&t){const t=e.$implicit;p.xp6(1),p.hij(" ",p.lcZ(2,1,t.text)," ")}}function Un(t,e){if(1&t&&(p.TgZ(0,"div",1),p.YNc(1,Yn,3,3,"button",2),p.qZA()),2&t){const t=p.oxw();p.xp6(1),p.Q6J("ngForOf",t.showBtns)}}let Kn=(()=>{class t extends g{constructor(t){super(),this.events=t,this.buttons=[{key:"saveView",text:"Save View"},{key:"saveThumbnail",text:"Save Thumbnail"},{key:"exportImage",text:"Export Image"}],this.showBtns=[],this.show=!1}onChangeSubEvents(){this.registerEventService(this.subEvents,{"show|dispatch":t=>this.showButtons(...t.buttons),"hide|dispatch":t=>this.hideButtons()})}onInit(){}showButtons(...t){if(0==t.length)return this.hideButtons();this.showBtns=[];let e=[],n=!1;for(let i=0;i<t.length;i++){const n=t[i];(0,d.kJ)(n)?n.map(t=>e.push(t)):e.push(n)}e.map(t=>{this.buttons.map(e=>{e.key==t&&(this.showBtns.push(e),n=!0)})}),this.show=n}hideButtons(){this.show=!1,this.showBtns=[]}onClick(t){this.subEvents.emit({type:"click",key:t})}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(V.B))},t.\u0275cmp=p.Xpm({type:t,selectors:[["viewport-editor-toolbar"]],features:[p.qOj],decls:1,vars:1,consts:[["class","menu",4,"ngIf"],[1,"menu"],["nz-button","",3,"click",4,"ngFor","ngForOf"],["nz-button","",3,"click"]],template:function(t,e){1&t&&p.YNc(0,Un,2,1,"div",0),2&t&&p.Q6J("ngIf",e.show)},directives:[i.O5,i.sg,nt.ix,gt.dQ,it.w],pipes:[ut.X$],styles:["[_nghost-%COMP%]{position:absolute;top:10px;left:10px;display:block}"]}),t})();function $n(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div",3),p.NdJ("click",function(){p.CHM(t);const n=e.$implicit;return p.oxw(2).onBtnClick(n.name)}),p._UZ(1,"i",4),p.qZA()}if(2&t){const t=e.$implicit;p.ekj("active",t.isActive),p.s9C("title",t.text),p.xp6(1),p.s9C("nzType",t.icon)}}function Bn(t,e){if(1&t&&(p.TgZ(0,"div",1),p.YNc(1,$n,2,4,"div",2),p.qZA()),2&t){const t=p.oxw();p.xp6(1),p.Q6J("ngForOf",t.buttons)}}let Vn=[{name:"translate",text:"Di chuy\u1ec3n",icon:"fullscreen",isActive:!1},{name:"rotate",text:"Xoay",icon:"transaction",isActive:!1},{name:"scale",text:"K\xe9o gi\xe3n",icon:"expand",isActive:!1},{name:"download",text:"T\u1ea3i t\xe0i nguy\xean",icon:"download",isActive:!1},{name:"edit",text:"Ch\u1ec9nh s\u1eeda",icon:"edit",isActive:!1},{name:"delete",text:"X\xf3a",icon:"delete",isActive:!1}],Xn=(()=>{class t extends g{constructor(t){super(),this.events=t,this.title="",this.currentMode="",this.show=!1,this.buttons=[],this.btnList={light:["translate","rotate","edit","delete"],object:["translate","rotate","scale","edit","download","delete"],mesh:["translate","rotate","scale","edit","delete"]},this.secret_key="",this.currentType=""}onChangeSubEvents(){this.registerEventService(this.subEvents,{show:t=>this.showMenu(t.data.secret_key,t.data.type,t.data.mode),hide:t=>this.reset(),"mode.change":t=>this.changeMode(t.mode)})}onInit(){}onDestroy(){}showMenu(t,e,n){this.reset(),this.secret_key=t,this.currentType=e,void 0!==this.btnList[e]&&(this.show=!0,n&&(0,d.d3)(["translate","rotate","scale"],n)&&(this.currentMode=n),this.setButtons())}changeMode(t){this.currentMode=t,this.setButtons()}setButtons(){this.buttons=Vn.slice(0).filter(t=>-1!==this.btnList[this.currentType].indexOf(t.name)).map(t=>{var e=(0,d.MP)({},t);return e.name==this.currentMode&&(e.isActive=!0),e})}reset(){this.show=!1,this.buttons=[],this.secret_key=""}onBtnClick(t){(0,d.d3)(["translate","rotate","scale"],t)?(this.currentMode=t,this.buttons.map(e=>e.isActive=e.name==t),this.subEvents.emit({type:"mode.select",mode:t})):this.subEvents.emit({type:"action",data:{action:t,type:this.currentType,secret_key:this.secret_key}})}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(Dn.Z))},t.\u0275cmp=p.Xpm({type:t,selectors:[["viewport-object-toolbar"]],features:[p.qOj],decls:1,vars:1,consts:[["class","menu-buttons",4,"ngIf"],[1,"menu-buttons"],["class","btn",3,"title","active","click",4,"ngFor","ngForOf"],[1,"btn",3,"title","click"],["nz-icon","","nzTheme","outline",3,"nzType"]],template:function(t,e){1&t&&p.YNc(0,Bn,2,1,"div",0),2&t&&p.Q6J("ngIf",e.show)},directives:[i.O5,i.sg,it.w,xt.Ls],styles:["[_nghost-%COMP%]{position:absolute;top:10px;right:10px;display:block}.menu-buttons[_ngcontent-%COMP%]{display:flex;align-items:center;align-content:center;border-radius:5px;overflow:hidden;background-color:#fff}.menu-buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{height:36px;width:36px;text-align:center;font-size:18px;line-height:36px;cursor:pointer}.menu-buttons[_ngcontent-%COMP%]   .btn.active[_ngcontent-%COMP%], .menu-buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{background:#ebebeb}"]}),t})(),Gn=(()=>{class t extends g{constructor(t,e){super(),this.elemRef=t,this.events=e,this.app3D=null,this.canvas3D=null,this.appStatus=!1,this.elementStatus=!1}onChangeSubEvents(){this.registerEventService(this.subEvents,"resetcanvas",()=>{let t=!0;const e=()=>{t||(t=!this.initCanvas()),t&&setTimeout(e,1e3)};e()})}initFirst(){this.registerEventService(window,"resize",t=>this.updateCanvasSize(t))}onInit(){let t={};t.canvas=this.canvas?this.setCanvas(this.canvas):this.subEvents.on("canvas.set",t=>this.setCanvas(t.canvas),!0),t.app=this.app?this.setApp(this.app):this.subEvents.on("app.set",t=>this.setApp(t.app),!0),t=null,this.activeEventServiceRegistered(window)}onDestroy(){this.deactiveEventServiceRegistered(window)}ngAfterViewInit(){this.elementStatus=!0,this.initCanvas()}updateCanvasSize(t){this.app3D&&this.app3D.engine.updateCanvasSize(t)}initCanvas(){if(this.app3D&&this.canvas3D&&this.elementStatus){var t=this.elemRef.nativeElement;return t.innerHTML="",this.app3D.engine.setWrapper(t),setTimeout(()=>{this.updateCanvasSize()},10),!0}return!1}setApp(t){this.app3D=t,this.canvas3D||(this.canvas3D=this.app3D.engine.getCanvas()),this.initCanvas()}setCanvas(t){this.canvas3D=t,this.initCanvas()}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(p.SBq),p.Y36(B.v))},t.\u0275cmp=p.Xpm({type:t,selectors:[["canvas-layer"]],inputs:{canvas:"canvas",app:"app"},features:[p.qOj],decls:0,vars:0,template:function(t,e){},styles:["[_nghost-%COMP%]{height:100%}"]}),t})();function Wn(t,e){if(1&t&&p._UZ(0,"canvas-layer",4),2&t){const t=p.oxw();p.Q6J("moduleKey",t.moduleKey)("app",t.app3D)("canvas",t.canvas)}}let ti=(()=>{class t extends g{constructor(t,e,n,i){super(),this.elemRef=t,this.events=e,this.toolbar=n,this.cd=i,this.app3D=null,this.canvas=null,this.droppable=!1,this.isLoad=!1,this.appTem=null,this.hasChangeApp=!1}onChangeSubEvents(){this.registerEventService(this.subEvents,"app.set|dispatch",t=>this.appTem=t.app)}onInit(){const t=this.toolbar.sub(this.moduleKey);t!=this.subToolbar&&(this.subToolbar=t),this.hasChangeApp=!1,this.app?this.setApp(this.app):this.app3D||(this.appTem?this.setApp(this.appTem):this.subEvents.on("app.set",t=>this.setApp(t.app),!0)),this.hasChangeApp||this.activeEventServiceRegistered(this.app3D),this.hasChangeApp=!1,this.cd.detectChanges()}onDestroy(){this.deactiveEventServiceRegistered(this.app3D)}initCanvas(){this.canvas=this.app3D.engine.getCanvas()}setApp(t){if(t==this.app3D)return this.initCanvas();this.app3D&&(this.deactiveEventServiceRegistered(this.app3D),this.deregisterAllEventService(this.app3D)),this.app3D=t,this.registerEventService(this.app3D,{"viewport.pointer.check":t=>this.checkPointerPosition(t.event,t.handle,t.showDroppableLayer),"viewport.droppable.show":()=>this.droppable=!0,"viewport.droppable.hide":()=>{this.droppable=!1,this.isLoad=!1},"viewport.show:loading":()=>{this.isLoad=!0,this.subEvents.emit("show:loading")},"viewport.hide:loading":()=>{this.isLoad=!1,this.subEvents.emit("hide:loading")},"viewport.droppable.loading":()=>{this.isLoad=!0,this.subEvents.emit("show:loading")},"control.mode.change":t=>this.subToolbar.changeMode(t.node),init:()=>this.subEvents.emit("resetcanvas")}),this.activeEventServiceRegistered(this.app3D),this.hasChangeApp=!0,this.initCanvas()}transferEvent(t){this.app3D&&this.app3D.transferEventListenner(t)}checkPointerPosition(t,e,n){var i=this.elemRef.nativeElement.getBoundingClientRect(),o=t.clientX,s=t.clientY;let r={x:o-i.x,y:o-i.y,isHover:s>i.y&&s<i.y+i.height&&o>i.x&&o<i.x+i.width,rect:i};n&&(r.isHover&&!this.droppable||!r.isHover&&this.droppable)&&(this.droppable=!this.droppable),"function"==typeof e&&e(r),this.app3D.emit({type:"viewport.pointer.emit",pointer:r},!1)}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(p.SBq),p.Y36(B.v),p.Y36(Dn.Z),p.Y36(p.sBO))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-viewport"]],inputs:{app:"app"},features:[p.qOj],decls:9,vars:9,consts:[[3,"moduleKey","app","canvas",4,"ngIf"],[1,"frame"],[3,"moduleKey"],[1,"mask-layer",3,"contextmenu","pointerdown","pointermove","pointerup","wheel","touchstart","touchend","touchmove","keydown","dbclick"],[3,"moduleKey","app","canvas"]],template:function(t,e){1&t&&(p.YNc(0,Wn,1,3,"canvas-layer",0),p.TgZ(1,"div",1),p._UZ(2,"foreground-layer",2),p.qZA(),p._UZ(3,"droppable-layer",2),p._UZ(4,"viewport-loading-layer",2),p.TgZ(5,"div",3),p.NdJ("contextmenu",function(t){return e.transferEvent(t)})("pointerdown",function(t){return e.transferEvent(t)})("pointermove",function(t){return e.transferEvent(t)})("pointerup",function(t){return e.transferEvent(t)})("wheel",function(t){return e.transferEvent(t)})("touchstart",function(t){return e.transferEvent(t)})("touchend",function(t){return e.transferEvent(t)})("touchmove",function(t){return e.transferEvent(t)})("keydown",function(t){return e.transferEvent(t)})("dbclick",function(t){return e.transferEvent(t)}),p.qZA(),p._UZ(6,"app-vector-controls",2),p._UZ(7,"viewport-editor-toolbar",2),p._UZ(8,"viewport-object-toolbar",2)),2&t&&(p.Q6J("ngIf",e.canvas),p.xp6(2),p.Q6J("moduleKey",e.moduleKey),p.xp6(1),p.ekj("active1",e.droppable),p.Q6J("moduleKey",e.moduleKey),p.xp6(1),p.Q6J("moduleKey",e.moduleKey),p.xp6(2),p.Q6J("moduleKey",e.moduleKey),p.xp6(1),p.Q6J("moduleKey",e.moduleKey),p.xp6(1),p.Q6J("moduleKey",e.moduleKey))},directives:[i.O5,Ln,jn,Rn,Fn,Kn,Xn,Gn],styles:["[_nghost-%COMP%]{display:block;height:100%;position:relative}.frame[_ngcontent-%COMP%]{display:block;height:100%;position:relative}foreground-layer[_ngcontent-%COMP%], mask-layer[_ngcontent-%COMP%], .mask-layer[_ngcontent-%COMP%], canvas-layer[_ngcontent-%COMP%], viewport-loading-layer[_ngcontent-%COMP%], .loading-layer[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0}canvas-layer[_ngcontent-%COMP%]{overflow:hidden;z-index:100;height:100%}foreground-layer[_ngcontent-%COMP%]{z-index:111}mask-layer[_ngcontent-%COMP%], .mask-layer[_ngcontent-%COMP%]{z-index:250}viewport-object-toolbar[_ngcontent-%COMP%], .object-toolbar[_ngcontent-%COMP%], viewport-editor-toolbar[_ngcontent-%COMP%], .editor-toolbar[_ngcontent-%COMP%]{z-index:280}droppable-layer[_ngcontent-%COMP%]{position:absolute;z-index:320;top:100%;left:50%;height:0;width:0}"]}),t})();function ei(t,e){1&t&&p.GkF(0)}function ni(t,e){1&t&&(p.TgZ(0,"h3"),p._uU(1,"Vui l\xf2ng ch\u1edd gi\xe2y l\xe1t"),p.qZA())}function ii(t,e){1&t&&p.GkF(0)}function oi(t,e){1&t&&(p.TgZ(0,"div",5),p._uU(1," Item Not Found "),p.qZA())}function si(t,e){if(1&t&&(p.TgZ(0,"nz-layout",6),p.TgZ(1,"nz-sider",7),p._UZ(2,"app-sidebar",0),p.qZA(),p.TgZ(3,"nz-content"),p.TgZ(4,"section",8),p._UZ(5,"app-viewport",0),p.qZA(),p.qZA(),p.qZA()),2&t){const t=p.oxw(2);p.xp6(2),p.Q6J("moduleKey",t.moduleKey),p.xp6(3),p.Q6J("moduleKey",t.moduleKey)}}function ri(t,e){if(1&t&&(p.YNc(0,ii,1,0,"ng-container",1),p.YNc(1,oi,2,0,"ng-template",null,4,p.W1O),p.YNc(3,si,6,2,"ng-template",null,3,p.W1O)),2&t){const t=p.MAs(2),e=p.MAs(4),n=p.oxw();p.Q6J("ngIf","notfound"==n.mode)("ngIfThen",t)("ngIfElse",e)}}let ai=(()=>{class t extends g{constructor(t,e,n,i,o,s,r,a,c){super(),this.activatedRoute=t,this.itemService=e,this.itemEditor=n,this.categoryService=i,this.storage=o,this.viewportService=s,this.editorToolbar=r,this.events=a,this.vectorControls=c,this.id=0,this.secret_id="",this.mode="create",this.isLoading=!0,this.app=null,this.subEventService=null,this.wsKey="itemWorkspace",this.subEditorToolbar=null,this.subViewport=null,this.subEventService=a.sub(this.wsKey),this.subEditorToolbar=r.sub(this.wsKey),this.subViewport=s.sub(this.wsKey),this.vectorControls=c.sub(this.workspaceKey),this.app=n,this.subEventService.app=n,this.storage.assign({item:{},modelData:null,modelSettings:{}}),this.storage.assign("editorMode",this.mode,t=>this.mode=t),this.registerEventService(n,{"model.added":()=>{this.storage.modelSettings=n.data.item.settings},"save.clicked":t=>this.onClickSave(t),"editor.attach:mesh":t=>this.subEventService.emit({type:"showmeshpanel",mesh:t.mesh})}),this.subViewport.emit({type:"app.set",app:this.itemEditor},!0),this.itemEditor.setOptions(h),this.itemEditor.init()}ngAfterViewInit(){this.app.updateCanvasSize()}onInit(){if(this.moduleKey=this.wsKey,this.activeEventServiceRegistered(this.itemEditor),this.secret_id=this.activatedRoute.snapshot.paramMap.get("secret_id"),this.secret_id){if(this.secret_id==(0,u.i)("data.item.secret_id")){var t=(0,u.i)("data.item");this.storage.editorMode="update",this.id=t.id,this.storage.item=t,this.isLoading=!1,this.setItemData(t),this.vectorControls.emit({type:"show",value:!0},null,!0)}}else this.storage.editorMode="notfound",this.isLoading=!1;this.subEditorToolbar.show({saveThumbnail:t=>this.saveThumbnail()})}onDestroy(){this.deactiveEventServiceRegistered(this.itemEditor),this.itemEditor.removeModelItem(),this.subEditorToolbar.hide(),this.vectorControls.emit({type:"show",value:!1},null,!0)}showLoading(){if(!this.isFocus)return!1;this.viewportService.emit("show:loading",null,!0),this.subEventService.emit("show:sidebar-lock")}hideLoading(){if(!this.isFocus)return!1;this.viewportService.emit("hide:loading",!0,!0),this.subEventService.emit("hide:sidebar-lock")}onClickSave(t){if(!this.isFocus)return;let e=this.itemEditor.data.item;"update"==this.mode?this.itemService.update(e).subscribe(t=>console.log(t)):this.itemService.create(e).subscribe(t=>{t.data&&(e.id=t.data.id,this.storage.editorMode="update")},t=>{console.log(t)})}saveThumbnail(){if(!this.isFocus)return!1;this.app.editor.unselect(),this.showLoading(),setTimeout(()=>{this.app.capture(t=>{this.app.data.item.thumbnail=t,this.itemService.updateThumbnail(this.app.data.item).subscribe(t=>{console.log("Update Th\xe0nh c\xf4ng")})})},1e3)}setItemData(t){!this.isFocus||this.itemEditor.addModelItem(t,t=>{this.storage.modelData=t,f("model-item.complete",[t])},()=>{f("model-item.error",[])},t=>{f("model-item.progress",[t])})}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(l.gz),p.Y36(_),p.Y36(F),p.Y36(U),p.Y36($),p.Y36(B.v),p.Y36(V.B),p.Y36(G),p.Y36(W.n))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-workspace"]],features:[p.qOj],decls:11,vars:6,consts:[[3,"moduleKey"],[4,"ngIf","ngIfThen","ngIfElse"],["loadingTemplate",""],["editorTemplate",""],["notFoundTemplate",""],[1,"not-found"],[1,"inner-layout"],["nzWidth","380px","nzTheme","dark"],["id","content"]],template:function(t,e){if(1&t&&(p.TgZ(0,"nz-layout"),p.TgZ(1,"nz-header"),p._UZ(2,"app-header",0),p.qZA(),p.TgZ(3,"nz-content"),p.YNc(4,ei,1,0,"ng-container",1),p.YNc(5,ni,2,0,"ng-template",null,2,p.W1O),p.YNc(7,ri,5,3,"ng-template",null,3,p.W1O),p.qZA(),p.qZA(),p._UZ(9,"modal-image-library",0),p._UZ(10,"app-panel-mesh-settings",0)),2&t){const t=p.MAs(6),n=p.MAs(8);p.xp6(2),p.Q6J("moduleKey",e.moduleKey),p.xp6(2),p.Q6J("ngIf",e.isLoading)("ngIfThen",t)("ngIfElse",n),p.xp6(5),p.Q6J("moduleKey",e.moduleKey),p.xp6(1),p.Q6J("moduleKey",e.moduleKey)}},directives:[tt.hw,tt.E8,st,tt.OK,i.O5,_t,Qe,tt.t7,An,ti],styles:['html,body{width:100vw;height:100vh;margin:0;font-family:Roboto,"Helvetica Neue",sans-serif;overflow:hidden}html *,body *{-webkit-user-select:none;-moz-user-select:none;user-select:none}.ant-layout-header{display:flex;align-items:center;justify-content:space-between;height:56px;padding:8px 0;line-height:56px;background-color:#000;z-index:100}.inner-layout{height:100%}.inner-layout .ant-input-affix-wrapper{padding:2px 12px;border-radius:5px}.inner-layout .ant-tabs{height:100%}.inner-layout .ant-tabs-top .ant-tabs-nav{margin:0}.inner-layout .ant-tabs-top .ant-tabs-nav:before{border:none}.inner-layout .ant-tabs-nav-wrap{background-color:#20242d}.inner-layout .ant-tabs-nav-more{background-color:#20242d!important}.inner-layout .ant-tabs-nav-more .anticon{color:#fff;font-size:24px}.inner-layout .ant-tabs-tabpane{padding-left:0!important}.inner-layout .ant-tabs-content-holder{background-color:#363d4b}.inner-layout .ant-tabs-content{height:100%;padding-left:0!important}.inner-layout .ant-tabs-tab{padding:12px 24px!important;margin:0!important;font-size:13px;font-weight:500;color:#fff;text-align:center!important;background-color:#20242d}.inner-layout .ant-tabs-tab-btn{text-align:center;font-weight:400;width:100%}.inner-layout .ant-tabs-tab-btn div{margin-top:4px}.inner-layout .ant-tabs-tab-disabled{display:none}.inner-layout .ant-tabs-tab-active{background-color:#363d4b}.inner-layout .ant-tabs-tab-active :after,.inner-layout .ant-tabs-tab-active :before{content:"";position:absolute;width:8px;height:8px;z-index:100}.inner-layout .ant-tabs-tab-active :after{background:radial-gradient(circle closest-side,transparent 0,transparent 50%,#363d4b 0) "200% 200%/400% 400%";bottom:0;right:-8px;transform:scaleX(-1)}.inner-layout .ant-tabs-tab-active :before{background:radial-gradient(circle closest-side,transparent 0,transparent 50%,#363d4b 0) "200% 200%/400% 400%";bottom:0;left:-8px}.inner-layout .ant-tabs .ant-tabs-tab:hover{background-color:#2a2f3b}.inner-layout .ant-tabs .ant-tabs-tab:hover :after,.inner-layout .ant-tabs .ant-tabs-tab:hover :before{content:"";position:absolute;width:8px;height:8px;z-index:100}.inner-layout .ant-tabs .ant-tabs-tab:hover :after{background:radial-gradient(circle closest-side,transparent 0,transparent 50%,#363d4b 0) "200% 200%/400% 400%";bottom:0;right:-8px;transform:scaleX(-1)}.inner-layout .ant-tabs .ant-tabs-tab:hover :before{background:radial-gradient(circle closest-side,transparent 0,transparent 50%,#363d4b 0) "200% 200%/400% 400%";bottom:0;left:-8px}.inner-layout .ant-tabs .tab-inner{padding:24px 4px 0 0!important;height:100%}.inner-layout .ant-tabs .tab-inner .block{margin-bottom:24px;padding:0 16px}.inner-layout .ant-tabs .tab-inner .store{position:relative;display:block;flex-wrap:wrap;height:calc(100% - 88px);width:100%;padding:0 12px 0 16px;overflow-y:scroll}.inner-layout .ant-tabs .tab-inner .store--expand{height:auto}.inner-layout .ant-tabs .tab-inner .store .gridlayout{width:100%;height:100%;position:relative}.inner-layout .ant-tabs .tab-inner .store .gridlayout .loading{text-align:center;width:100%}.inner-layout .ant-tabs .tab-inner .store .gridlayout .loading .spinner{--animation-duration: 1s;width:var(--size);height:var(--size);display:flex;justify-content:center;align-items:center;grid-gap:4px;gap:4px;margin:0 auto}.inner-layout .ant-tabs .tab-inner .store .gridlayout .loading .spinner .spinner-item{height:40%;background-color:var(--clr-spinner);width:calc(var(--size) / 13);-webkit-animation:spinner5 var(--animation-duration) ease-in-out infinite;animation:spinner5 var(--animation-duration) ease-in-out infinite}@-webkit-keyframes spinner5{25%{transform:scaleY(2)}50%{transform:scaleY(1)}}@keyframes spinner5{25%{transform:scaleY(2)}50%{transform:scaleY(1)}}.inner-layout .ant-tabs .tab-inner .store .gridlayout .loading .spinner .spinner-item:nth-child(1){--clr-spinner: var(--clr1)}.inner-layout .ant-tabs .tab-inner .store .gridlayout .loading .spinner .spinner-item:nth-child(2){--clr-spinner: var(--clr3);-webkit-animation-delay:calc(var(--animation-duration) / 10);animation-delay:calc(var(--animation-duration) / 10)}.inner-layout .ant-tabs .tab-inner .store .gridlayout .loading .spinner .spinner-item:nth-child(3){--clr-spinner: var(--clr5);-webkit-animation-delay:calc(var(--animation-duration) / 10 * 2);animation-delay:calc(var(--animation-duration) / 10 * 2)}.inner-layout .ant-tabs .tab-inner .store .gridlayout .loading .spinner .spinner-item:nth-child(4){--clr-spinner: var(--clr4);-webkit-animation-delay:calc(var(--animation-duration) / 10 * 3);animation-delay:calc(var(--animation-duration) / 10 * 3)}.inner-layout .ant-tabs .tab-inner .store .gridlayout .loading .spinner .spinner-item:nth-child(5){--clr-spinner: var(--clr2);-webkit-animation-delay:calc(var(--animation-duration) / 10 * 4);animation-delay:calc(var(--animation-duration) / 10 * 4)}.inner-layout .ant-tabs .tab-inner .store .item{display:inline-block;width:31.5%;opacity:1;background-color:#485164}.inner-layout .ant-tabs .tab-inner .store .item-box{height:100%;display:flex;align-items:center;transition:.5s ease;border:0 solid transparent;position:relative;background:#f6f6f6;cursor:pointer;width:100%;justify-content:center;-webkit-user-select:none;-moz-user-select:none;user-select:none;background:unset}.inner-layout .ant-tabs .tab-inner .store .item-box:hover{background:rgba(0,0,0,.2);box-shadow:0 0 11px #21212133}.inner-layout .ant-tabs .tab-inner .store .item-box img{width:100%;max-width:100%;max-height:100%}.inner-layout .ant-tabs .tab-inner .store::-webkit-scrollbar{width:6px;background-color:transparent}.inner-layout .ant-tabs .tab-inner .store::-webkit-scrollbar-track{box-shadow:none;background-color:transparent}.inner-layout .ant-tabs .tab-inner .store::-webkit-scrollbar-thumb{border-radius:10px;box-shadow:inset 0 0 6px #0000004d;background-color:#555}.inner-layout .ant-tabs .tab-inner ngx-gridlayout::-webkit-scrollbar{width:6px;background-color:transparent}.inner-layout .ant-tabs .tab-inner ngx-gridlayout::-webkit-scrollbar-track{box-shadow:none;background-color:transparent}.inner-layout .ant-tabs .tab-inner ngx-gridlayout::-webkit-scrollbar-thumb{border-radius:10px;box-shadow:inset 0 0 6px #0000004d;background-color:#555}.inner-layout .ant-tabs-ink-bar{background-color:#fff;border-right-width:2px;display:none!important}.inner-layout .sub-tab .ant-tabs-tab{padding:4px 2px!important;margin-right:8px!important;background-color:transparent;border:1px solid #495164;border-radius:4px;width:84px}.inner-layout .sub-tab .ant-tabs-tab-active{background-color:#495164}.inner-layout .sub-tab .ant-tabs-tab-active :before,.inner-layout .sub-tab .ant-tabs-tab-active :after{visibility:hidden}.inner-layout .sub-tab .ant-tabs-tab-btn{text-align:center;font-weight:400;width:100%}.inner-layout .sub-tab .ant-tabs-tab-btn img{max-height:15px;width:100%}.inner-layout .sub-tab .ant-tabs-tab-btn div{margin-top:2px;line-height:1;font-size:13px;font-weight:500;color:#fff;text-align:center!important}.inner-layout .sub-tab .ant-tabs-nav-wrap{background-color:transparent;padding-left:16px;padding-right:16px}.tab-inner.height-50 .ant-tabs-content,.tab-inner.height-50 .ant-tabs,.tab-background.height-50 .ant-tabs-content,.tab-background.height-50 .ant-tabs{height:50%!important}.collection{margin-bottom:8px}.collection__title{color:#fff;font-weight:700}.ant-list-header{padding-top:0;padding-bottom:0}.ant-popover-inner-content{padding:16px 0!important}.tag-select__trigger{display:none!important}.ant-tabs-nav-list{width:100%!important}.notice-icon .ant-tabs-nav .ant-tabs-tab{width:100%!important;margin-right:0}.ant-layout-content{height:calc(100vh - 56px)}.pcr-app{position:absolute!important;top:48px!important;border-radius:4px;width:100%!important}.pcr-app .pcr-interaction input{font-weight:.95em;font-weight:500;color:#282828}\n',".material-inputs .input-group{margin:10px auto;border-top:1px solid #ababab;padding-top:10px;padding-bottom:10px}.material-inputs .text-right{text-align:right!important}.material-inputs .text-group .input-wrapper{margin-top:5px}dragging-item .model-item{position:absolute;width:120px;padding-left:10px;padding-right:10px;padding-top:10px}dragging-item .model-item img{max-width:100%;width:100%;height:100%;-o-object-fit:cover;object-fit:cover}.ant-layout-sider-dark .ant-radio-wrapper,.panel .ant-radio-wrapper{color:#fff}\n","#toolview{position:absolute;right:40px;bottom:40px}#toolview .toolview-inner button{padding:2px;height:30px;text-align:center;text-decoration:none;color:#3f4652;border:1px solid transparent;border-radius:5px;background-color:transparent;transition:background-color .1s ease,width .1s ease,opacity .1s ease;font-size:1em;outline:none;box-sizing:border-box;line-height:18px;background-color:#fff;border:1px solid #ecedee;cursor:pointer;min-width:80px;font-weight:700}#toolview .toolview-inner button:hover{background-color:#fffeee}.dragging :host #toolview{display:none}:host :root{--design-zoom: 1}#content{height:100%}app-viewport{height:100%}.not-found{height:100%;display:flex;align-items:center;align-content:center;justify-content:center;justify-items:center;font-size:60px}\n"],encapsulation:2}),t})();n(71398);const ci=[{path:"",children:[{path:":secret_id/edit",component:ai}]}];let li=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=p.oAB({type:t}),t.\u0275inj=p.cJS({imports:[[l.Bz.forChild(ci)],l.Bz]}),t})();var hi=n(91604),pi=n(80521),di=n(39490),gi=n(75319),ui=n(20945),mi=n(61927);function fi(t,e){for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function vi(t,e){const n=e?"":"none";fi(t.style,{touchAction:e?"":"none",webkitUserDrag:e?"":"none",webkitTapHighlightColor:e?"":"transparent",userSelect:n,msUserSelect:n,webkitUserSelect:n,MozUserSelect:n})}function bi(t,e){const n=t.style;n.position=e?"":"fixed",n.top=n.opacity=e?"":"0",n.left=e?"":"-999em"}function _i(t){const e=t.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(t)*e}function xi(t,e){return t.getPropertyValue(e).split(",").map(t=>t.trim())}function wi(t){const e=t.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}}function yi(t,e,n){const{top:i,bottom:o,left:s,right:r}=t;return n>=i&&n<=o&&e>=s&&e<=r}function Ci(t,e,n){t.top+=e,t.bottom=t.top+t.height,t.left+=n,t.right=t.left+t.width}function Oi(t,e,n,i){const{top:o,right:s,bottom:r,left:a,width:c,height:l}=t,h=c*e,p=l*e;return i>o-p&&i<r+p&&n>a-h&&n<s+h}n(67574),n(66682),n(39761),n(88002),n(15257),n(68307),n(43190);class Mi{constructor(t,e){this._document=t,this._viewportRuler=e,this.positions=new Map}clear(){this.positions.clear()}cache(t){this.clear(),this.positions.set(this._document,{scrollPosition:this._viewportRuler.getViewportScrollPosition()}),t.forEach(t=>{this.positions.set(t,{scrollPosition:{top:t.scrollTop,left:t.scrollLeft},clientRect:wi(t)})})}handleScroll(t){const e=t.target,n=this.positions.get(e);if(!n)return null;const i=e===this._document?e.documentElement:e,o=n.scrollPosition;let s,r;if(e===this._document){const t=this._viewportRuler.getViewportScrollPosition();s=t.top,r=t.left}else s=e.scrollTop,r=e.scrollLeft;const a=o.top-s,c=o.left-r;return this.positions.forEach((t,n)=>{t.clientRect&&e!==n&&i.contains(n)&&Ci(t.clientRect,a,c)}),o.top=s,o.left=r,{top:a,left:c}}}function Pi(t){const e=t.cloneNode(!0),n=e.querySelectorAll("[id]"),i=t.nodeName.toLowerCase();e.removeAttribute("id");for(let o=0;o<n.length;o++)n[o].removeAttribute("id");return"canvas"===i?zi(t,e):("input"===i||"select"===i||"textarea"===i)&&Zi(t,e),Si("canvas",t,e,zi),Si("input, textarea, select",t,e,Zi),e}function Si(t,e,n,i){const o=e.querySelectorAll(t);if(o.length){const e=n.querySelectorAll(t);for(let t=0;t<o.length;t++)i(o[t],e[t])}}let ki=0;function Zi(t,e){"file"!==e.type&&(e.value=t.value),"radio"===e.type&&e.name&&(e.name=`mat-clone-${e.name}-${ki++}`)}function zi(t,e){const n=e.getContext("2d");if(n)try{n.drawImage(t,0,0)}catch(i){}}const Ti=(0,pi.i$)({passive:!0}),Ei=(0,pi.i$)({passive:!1});class Ai{constructor(t,e,n,i,o,s){this._config=e,this._document=n,this._ngZone=i,this._viewportRuler=o,this._dragDropRegistry=s,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._moveEvents=new et.xQ,this._pointerMoveSubscription=gi.w.EMPTY,this._pointerUpSubscription=gi.w.EMPTY,this._scrollSubscription=gi.w.EMPTY,this._resizeSubscription=gi.w.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new et.xQ,this.started=new et.xQ,this.released=new et.xQ,this.ended=new et.xQ,this.entered=new et.xQ,this.exited=new et.xQ,this.dropped=new et.xQ,this.moved=this._moveEvents,this._pointerDown=t=>{if(this.beforeStarted.next(),this._handles.length){const e=this._handles.find(e=>{const n=t.target;return!!n&&(n===e||e.contains(n))});e&&!this._disabledHandles.has(e)&&!this.disabled&&this._initializeDragSequence(e,t)}else this.disabled||this._initializeDragSequence(this._rootElement,t)},this._pointerMove=t=>{const e=this._getPointerPositionOnPage(t);if(!this._hasStartedDragging){if(Math.abs(e.x-this._pickupPositionOnPage.x)+Math.abs(e.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){const e=Date.now()>=this._dragStartTime+this._getDragStartDelay(t),n=this._dropContainer;if(!e)return void this._endDragSequence(t);(!n||!n.isDragging()&&!n.isReceiving())&&(t.preventDefault(),this._hasStartedDragging=!0,this._ngZone.run(()=>this._startDragSequence(t)))}return}this._boundaryElement&&(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=(this._preview||this._rootElement).getBoundingClientRect()),t.preventDefault();const n=this._getConstrainedPointerPosition(e);if(this._hasMoved=!0,this._lastKnownPointerPosition=e,this._updatePointerDirectionDelta(n),this._dropContainer)this._updateActiveDropContainer(n,e);else{const t=this._activeTransform;t.x=n.x-this._pickupPositionOnPage.x+this._passiveTransform.x,t.y=n.y-this._pickupPositionOnPage.y+this._passiveTransform.y,this._applyRootElementTransform(t.x,t.y),"undefined"!=typeof SVGElement&&this._rootElement instanceof SVGElement&&this._rootElement.setAttribute("transform",`translate(${t.x} ${t.y})`)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:n,event:t,distance:this._getDragDistance(n),delta:this._pointerDirectionDelta})})},this._pointerUp=t=>{this._endDragSequence(t)},this.withRootElement(t).withParent(e.parentDragRef||null),this._parentPositions=new Mi(n,o),s.registerDragItem(this)}get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(t){const e=(0,di.Ig)(t);e!==this._disabled&&(this._disabled=e,this._toggleNativeDragInteractions(),this._handles.forEach(t=>vi(t,e)))}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(t){this._handles=t.map(t=>(0,di.fI)(t)),this._handles.forEach(t=>vi(t,this.disabled)),this._toggleNativeDragInteractions();const e=new Set;return this._disabledHandles.forEach(t=>{this._handles.indexOf(t)>-1&&e.add(t)}),this._disabledHandles=e,this}withPreviewTemplate(t){return this._previewTemplate=t,this}withPlaceholderTemplate(t){return this._placeholderTemplate=t,this}withRootElement(t){const e=(0,di.fI)(t);return e!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{e.addEventListener("mousedown",this._pointerDown,Ei),e.addEventListener("touchstart",this._pointerDown,Ti)}),this._initialTransform=void 0,this._rootElement=e),"undefined"!=typeof SVGElement&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(t){return this._boundaryElement=t?(0,di.fI)(t):null,this._resizeSubscription.unsubscribe(),t&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(t){return this._parentDragRef=t,this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&Ii(this._rootElement),Ii(this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeSubscriptions(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(t){!this._disabledHandles.has(t)&&this._handles.indexOf(t)>-1&&(this._disabledHandles.add(t),vi(t,!0))}enableHandle(t){this._disabledHandles.has(t)&&(this._disabledHandles.delete(t),vi(t,this.disabled))}withDirection(t){return this._direction=t,this}_withDropContainer(t){this._dropContainer=t}getFreeDragPosition(){const t=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:t.x,y:t.y}}setFreeDragPosition(t){return this._activeTransform={x:0,y:0},this._passiveTransform.x=t.x,this._passiveTransform.y=t.y,this._dropContainer||this._applyRootElementTransform(t.x,t.y),this}_sortFromLastPointerPosition(){const t=this._lastKnownPointerPosition;t&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(t),t)}_removeSubscriptions(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe()}_destroyPreview(){this._preview&&Ii(this._preview),this._previewRef&&this._previewRef.destroy(),this._preview=this._previewRef=null}_destroyPlaceholder(){this._placeholder&&Ii(this._placeholder),this._placeholderRef&&this._placeholderRef.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(t){!this._dragDropRegistry.isDragging(this)||(this._removeSubscriptions(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging&&(this.released.next({source:this}),this._dropContainer?(this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(t),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)})):(this._passiveTransform.x=this._activeTransform.x,this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(this._getPointerPositionOnPage(t))})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this))))}_startDragSequence(t){Ji(t)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const e=this._dropContainer;if(e){const t=this._rootElement,n=t.parentNode,i=this._preview=this._createPreviewElement(),o=this._placeholder=this._createPlaceholderElement(),s=this._anchor=this._anchor||this._document.createComment(""),r=this._getShadowRoot();n.insertBefore(s,t),bi(t,!1),this._document.body.appendChild(n.replaceChild(o,t)),function(t,e){return e||t.fullscreenElement||t.webkitFullscreenElement||t.mozFullScreenElement||t.msFullscreenElement||t.body}(this._document,r).appendChild(i),this.started.next({source:this}),e.start(),this._initialContainer=e,this._initialIndex=e.getItemIndex(this)}else this.started.next({source:this}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(e?e.getScrollableParents():[])}_initializeDragSequence(t,e){this._parentDragRef&&e.stopPropagation();const n=this.isDragging(),i=Ji(e),o=!i&&0!==e.button,s=this._rootElement,r=!i&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now();if(e.target&&e.target.draggable&&"mousedown"===e.type&&e.preventDefault(),n||o||r)return;this._handles.length&&(this._rootElementTapHighlight=s.style.webkitTapHighlightColor||"",s.style.webkitTapHighlightColor="transparent"),this._hasStartedDragging=this._hasMoved=!1,this._removeSubscriptions(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scroll.subscribe(t=>{this._updateOnScroll(t)}),this._boundaryElement&&(this._boundaryRect=wi(this._boundaryElement));const a=this._previewTemplate;this._pickupPositionInElement=a&&a.template&&!a.matchSize?{x:0,y:0}:this._getPointerPositionInElement(t,e);const c=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(e);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:c.x,y:c.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,e)}_cleanupDragArtifacts(t){bi(this._rootElement,!0),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._boundaryRect=this._previewRect=void 0,this._ngZone.run(()=>{const e=this._dropContainer,n=e.getItemIndex(this),i=this._getPointerPositionOnPage(t),o=this._getDragDistance(this._getPointerPositionOnPage(t)),s=e._isOverContainer(i.x,i.y);this.ended.next({source:this,distance:o}),this.dropped.next({item:this,currentIndex:n,previousIndex:this._initialIndex,container:e,previousContainer:this._initialContainer,isPointerOverContainer:s,distance:o}),e.drop(this,n,this._initialIndex,this._initialContainer,s,o),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:t,y:e},{x:n,y:i}){let o=this._initialContainer._getSiblingContainerFromPosition(this,t,e);!o&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(t,e)&&(o=this._initialContainer),o&&o!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=o,this._dropContainer.enter(this,t,e,o===this._initialContainer&&o.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:o,currentIndex:o.getItemIndex(this)})}),this._dropContainer._startScrollingIfNecessary(n,i),this._dropContainer._sortItem(this,t,e,this._pointerDirectionDelta),this._preview.style.transform=Di(t-this._pickupPositionInElement.x,e-this._pickupPositionInElement.y)}_createPreviewElement(){const t=this._previewTemplate,e=this.previewClass,n=t?t.template:null;let i;if(n&&t){const e=t.matchSize?this._rootElement.getBoundingClientRect():null,o=t.viewContainer.createEmbeddedView(n,t.context);o.detectChanges(),i=Li(o,this._document),this._previewRef=o,t.matchSize?ji(i,e):i.style.transform=Di(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else{const t=this._rootElement;i=Pi(t),ji(i,t.getBoundingClientRect())}return fi(i.style,{pointerEvents:"none",margin:"0",position:"fixed",top:"0",left:"0",zIndex:`${this._config.zIndex||1e3}`}),vi(i,!1),i.classList.add("cdk-drag-preview"),i.setAttribute("dir",this._direction),e&&(Array.isArray(e)?e.forEach(t=>i.classList.add(t)):i.classList.add(e)),i}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const t=this._placeholder.getBoundingClientRect();this._preview.classList.add("cdk-drag-animating"),this._preview.style.transform=Di(t.left,t.top);const e=function(t){const e=getComputedStyle(t),n=xi(e,"transition-property"),i=n.find(t=>"transform"===t||"all"===t);if(!i)return 0;const o=n.indexOf(i),s=xi(e,"transition-duration"),r=xi(e,"transition-delay");return _i(s[o])+_i(r[o])}(this._preview);return 0===e?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(t=>{const n=e=>{(!e||e.target===this._preview&&"transform"===e.propertyName)&&(this._preview.removeEventListener("transitionend",n),t(),clearTimeout(i))},i=setTimeout(n,1.5*e);this._preview.addEventListener("transitionend",n)}))}_createPlaceholderElement(){const t=this._placeholderTemplate,e=t?t.template:null;let n;return e?(this._placeholderRef=t.viewContainer.createEmbeddedView(e,t.context),this._placeholderRef.detectChanges(),n=Li(this._placeholderRef,this._document)):n=Pi(this._rootElement),n.classList.add("cdk-drag-placeholder"),n}_getPointerPositionInElement(t,e){const n=this._rootElement.getBoundingClientRect(),i=t===this._rootElement?null:t,o=i?i.getBoundingClientRect():n,s=Ji(e)?e.targetTouches[0]:e,r=this._getViewportScrollPosition();return{x:o.left-n.left+(s.pageX-o.left-r.left),y:o.top-n.top+(s.pageY-o.top-r.top)}}_getPointerPositionOnPage(t){const e=this._getViewportScrollPosition(),n=Ji(t)?t.touches[0]||t.changedTouches[0]||{pageX:0,pageY:0}:t,i=n.pageX-e.left,o=n.pageY-e.top;if(this._ownerSVGElement){const t=this._ownerSVGElement.getScreenCTM();if(t){const e=this._ownerSVGElement.createSVGPoint();return e.x=i,e.y=o,e.matrixTransform(t.inverse())}}return{x:i,y:o}}_getConstrainedPointerPosition(t){const e=this._dropContainer?this._dropContainer.lockAxis:null;let{x:n,y:i}=this.constrainPosition?this.constrainPosition(t,this):t;if("x"===this.lockAxis||"x"===e?i=this._pickupPositionOnPage.y:("y"===this.lockAxis||"y"===e)&&(n=this._pickupPositionOnPage.x),this._boundaryRect){const{x:t,y:e}=this._pickupPositionInElement,o=this._boundaryRect,s=this._previewRect,r=o.top+e,a=o.bottom-(s.height-e);n=qi(n,o.left+t,o.right-(s.width-t)),i=qi(i,r,a)}return{x:n,y:i}}_updatePointerDirectionDelta(t){const{x:e,y:n}=t,i=this._pointerDirectionDelta,o=this._pointerPositionAtLastDirectionChange,s=Math.abs(e-o.x),r=Math.abs(n-o.y);return s>this._config.pointerDirectionChangeThreshold&&(i.x=e>o.x?1:-1,o.x=e),r>this._config.pointerDirectionChangeThreshold&&(i.y=n>o.y?1:-1,o.y=n),i}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const t=this._handles.length>0||!this.isDragging();t!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=t,vi(this._rootElement,t))}_removeRootElementListeners(t){t.removeEventListener("mousedown",this._pointerDown,Ei),t.removeEventListener("touchstart",this._pointerDown,Ti)}_applyRootElementTransform(t,e){const n=Di(t,e);null==this._initialTransform&&(this._initialTransform=this._rootElement.style.transform||""),this._rootElement.style.transform=this._initialTransform?n+" "+this._initialTransform:n}_getDragDistance(t){const e=this._pickupPositionOnPage;return e?{x:t.x-e.x,y:t.y-e.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:t,y:e}=this._passiveTransform;if(0===t&&0===e||this.isDragging()||!this._boundaryElement)return;const n=this._boundaryElement.getBoundingClientRect(),i=this._rootElement.getBoundingClientRect();if(0===n.width&&0===n.height||0===i.width&&0===i.height)return;const o=n.left-i.left,s=i.right-n.right,r=n.top-i.top,a=i.bottom-n.bottom;n.width>i.width?(o>0&&(t+=o),s>0&&(t-=s)):t=0,n.height>i.height?(r>0&&(e+=r),a>0&&(e-=a)):e=0,(t!==this._passiveTransform.x||e!==this._passiveTransform.y)&&this.setFreeDragPosition({y:e,x:t})}_getDragStartDelay(t){const e=this.dragStartDelay;return"number"==typeof e?e:Ji(t)?e.touch:e?e.mouse:0}_updateOnScroll(t){const e=this._parentPositions.handleScroll(t);if(e){const n=t.target;this._boundaryRect&&(n===this._document||n!==this._boundaryElement&&n.contains(this._boundaryElement))&&Ci(this._boundaryRect,e.top,e.left),this._pickupPositionOnPage.x+=e.left,this._pickupPositionOnPage.y+=e.top,this._dropContainer||(this._activeTransform.x-=e.left,this._activeTransform.y-=e.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){const t=this._parentPositions.positions.get(this._document);return t?t.scrollPosition:this._viewportRuler.getViewportScrollPosition()}_getShadowRoot(){return void 0===this._cachedShadowRoot&&(this._cachedShadowRoot=(0,pi.kV)(this._rootElement)),this._cachedShadowRoot}}function Di(t,e){return`translate3d(${Math.round(t)}px, ${Math.round(e)}px, 0)`}function qi(t,e,n){return Math.max(e,Math.min(n,t))}function Ii(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function Ji(t){return"t"===t.type[0]}function Li(t,e){const n=t.rootNodes;if(1===n.length&&n[0].nodeType===e.ELEMENT_NODE)return n[0];const i=e.createElement("div");return n.forEach(t=>i.appendChild(t)),i}function ji(t,e){t.style.width=`${e.width}px`,t.style.height=`${e.height}px`,t.style.transform=Di(e.left,e.top)}function Ri(t,e){return Math.max(0,Math.min(e,t))}class Qi{constructor(t,e,n,i,o){this._dragDropRegistry=e,this._ngZone=i,this._viewportRuler=o,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.autoScrollStep=2,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.beforeStarted=new et.xQ,this.entered=new et.xQ,this.exited=new et.xQ,this.dropped=new et.xQ,this.sorted=new et.xQ,this._isDragging=!1,this._itemPositions=[],this._previousSwap={drag:null,delta:0,overlaps:!1},this._draggables=[],this._siblings=[],this._orientation="vertical",this._activeSiblings=new Set,this._direction="ltr",this._viewportScrollSubscription=gi.w.EMPTY,this._verticalScrollDirection=0,this._horizontalScrollDirection=0,this._stopScrollTimers=new et.xQ,this._cachedShadowRoot=null,this._startScrollInterval=()=>{this._stopScrolling(),(0,ui.F)(0,mi.Z).pipe((0,$e.R)(this._stopScrollTimers)).subscribe(()=>{const t=this._scrollNode,e=this.autoScrollStep;1===this._verticalScrollDirection?Ni(t,-e):2===this._verticalScrollDirection&&Ni(t,e),1===this._horizontalScrollDirection?Fi(t,-e):2===this._horizontalScrollDirection&&Fi(t,e)})},this.element=(0,di.fI)(t),this._document=n,this.withScrollableParents([this.element]),e.registerDropContainer(this),this._parentPositions=new Mi(n,o)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(t,e,n,i){let o;this._draggingStarted(),null==i?(o=this.sortingDisabled?this._draggables.indexOf(t):-1,-1===o&&(o=this._getItemIndexFromPointerPosition(t,e,n))):o=i;const s=this._activeDraggables,r=s.indexOf(t),a=t.getPlaceholderElement();let c=s[o];if(c===t&&(c=s[o+1]),r>-1&&s.splice(r,1),c&&!this._dragDropRegistry.isDragging(c)){const e=c.getRootElement();e.parentElement.insertBefore(a,e),s.splice(o,0,t)}else if(this._shouldEnterAsFirstChild(e,n)){const e=s[0].getRootElement();e.parentNode.insertBefore(a,e),s.unshift(t)}else(0,di.fI)(this.element).appendChild(a),s.push(t);a.style.transform="",this._cacheItemPositions(),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:t,container:this,currentIndex:this.getItemIndex(t)})}exit(t){this._reset(),this.exited.next({item:t,container:this})}drop(t,e,n,i,o,s){this._reset(),this.dropped.next({item:t,currentIndex:e,previousIndex:n,container:this,previousContainer:i,isPointerOverContainer:o,distance:s})}withItems(t){const e=this._draggables;return this._draggables=t,t.forEach(t=>t._withDropContainer(this)),this.isDragging()&&(e.filter(t=>t.isDragging()).every(e=>-1===t.indexOf(e))?this._reset():this._cacheItems()),this}withDirection(t){return this._direction=t,this}connectedTo(t){return this._siblings=t.slice(),this}withOrientation(t){return this._orientation=t,this}withScrollableParents(t){const e=(0,di.fI)(this.element);return this._scrollableElements=-1===t.indexOf(e)?[e,...t]:t.slice(),this}getScrollableParents(){return this._scrollableElements}getItemIndex(t){return this._isDragging?Hi("horizontal"===this._orientation&&"rtl"===this._direction?this._itemPositions.slice().reverse():this._itemPositions,e=>e.drag===t):this._draggables.indexOf(t)}isReceiving(){return this._activeSiblings.size>0}_sortItem(t,e,n,i){if(this.sortingDisabled||!this._clientRect||!Oi(this._clientRect,.05,e,n))return;const o=this._itemPositions,s=this._getItemIndexFromPointerPosition(t,e,n,i);if(-1===s&&o.length>0)return;const r="horizontal"===this._orientation,a=Hi(o,e=>e.drag===t),c=o[s],l=c.clientRect,h=a>s?1:-1,p=this._getItemOffsetPx(o[a].clientRect,l,h),d=this._getSiblingOffsetPx(a,o,h),g=o.slice();(function(t,e,n){const i=Ri(e,t.length-1),o=Ri(n,t.length-1);if(i===o)return;const s=t[i],r=o<i?-1:1;for(let a=i;a!==o;a+=r)t[a]=t[a+r];t[o]=s})(o,a,s),this.sorted.next({previousIndex:a,currentIndex:s,container:this,item:t}),o.forEach((e,n)=>{if(g[n]===e)return;const i=e.drag===t,o=i?p:d,s=i?t.getPlaceholderElement():e.drag.getRootElement();e.offset+=o,r?(s.style.transform=`translate3d(${Math.round(e.offset)}px, 0, 0)`,Ci(e.clientRect,0,o)):(s.style.transform=`translate3d(0, ${Math.round(e.offset)}px, 0)`,Ci(e.clientRect,o,0))}),this._previousSwap.overlaps=yi(l,e,n),this._previousSwap.drag=c.drag,this._previousSwap.delta=r?i.x:i.y}_startScrollingIfNecessary(t,e){if(this.autoScrollDisabled)return;let n,i=0,o=0;if(this._parentPositions.positions.forEach((s,r)=>{r===this._document||!s.clientRect||n||Oi(s.clientRect,.05,t,e)&&([i,o]=function(t,e,n,i){const o=Yi(e,i),s=Ui(e,n);let r=0,a=0;if(o){const e=t.scrollTop;1===o?e>0&&(r=1):t.scrollHeight-e>t.clientHeight&&(r=2)}if(s){const e=t.scrollLeft;1===s?e>0&&(a=1):t.scrollWidth-e>t.clientWidth&&(a=2)}return[r,a]}(r,s.clientRect,t,e),(i||o)&&(n=r))}),!i&&!o){const{width:s,height:r}=this._viewportRuler.getViewportSize(),a={width:s,height:r,top:0,right:s,bottom:r,left:0};i=Yi(a,e),o=Ui(a,t),n=window}n&&(i!==this._verticalScrollDirection||o!==this._horizontalScrollDirection||n!==this._scrollNode)&&(this._verticalScrollDirection=i,this._horizontalScrollDirection=o,this._scrollNode=n,(i||o)&&n?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){const t=(0,di.fI)(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=t.msScrollSnapType||t.scrollSnapType||"",t.scrollSnapType=t.msScrollSnapType="none",this._cacheItems(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){const t=(0,di.fI)(this.element);this._parentPositions.cache(this._scrollableElements),this._clientRect=this._parentPositions.positions.get(t).clientRect}_cacheItemPositions(){const t="horizontal"===this._orientation;this._itemPositions=this._activeDraggables.map(t=>{const e=t.getVisibleElement();return{drag:t,offset:0,clientRect:wi(e)}}).sort((e,n)=>t?e.clientRect.left-n.clientRect.left:e.clientRect.top-n.clientRect.top)}_reset(){this._isDragging=!1;const t=(0,di.fI)(this.element).style;t.scrollSnapType=t.msScrollSnapType=this._initialScrollSnap,this._activeDraggables.forEach(t=>{const e=t.getRootElement();e&&(e.style.transform="")}),this._siblings.forEach(t=>t._stopReceiving(this)),this._activeDraggables=[],this._itemPositions=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1,this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_getSiblingOffsetPx(t,e,n){const i="horizontal"===this._orientation,o=e[t].clientRect,s=e[t+-1*n];let r=o[i?"width":"height"]*n;if(s){const t=i?"left":"top",e=i?"right":"bottom";-1===n?r-=s.clientRect[t]-o[e]:r+=o[t]-s.clientRect[e]}return r}_getItemOffsetPx(t,e,n){const i="horizontal"===this._orientation;let o=i?e.left-t.left:e.top-t.top;return-1===n&&(o+=i?e.width-t.width:e.height-t.height),o}_shouldEnterAsFirstChild(t,e){if(!this._activeDraggables.length)return!1;const n=this._itemPositions,i="horizontal"===this._orientation;if(n[0].drag!==this._activeDraggables[0]){const o=n[n.length-1].clientRect;return i?t>=o.right:e>=o.bottom}{const o=n[0].clientRect;return i?t<=o.left:e<=o.top}}_getItemIndexFromPointerPosition(t,e,n,i){const o="horizontal"===this._orientation,s=Hi(this._itemPositions,({drag:s,clientRect:r},a,c)=>{if(s===t)return c.length<2;if(i){const t=o?i.x:i.y;if(s===this._previousSwap.drag&&this._previousSwap.overlaps&&t===this._previousSwap.delta)return!1}return o?e>=Math.floor(r.left)&&e<Math.floor(r.right):n>=Math.floor(r.top)&&n<Math.floor(r.bottom)});return-1!==s&&this.sortPredicate(s,t,this)?s:-1}_cacheItems(){this._activeDraggables=this._draggables.slice(),this._cacheItemPositions(),this._cacheParentPositions()}_isOverContainer(t,e){return null!=this._clientRect&&yi(this._clientRect,t,e)}_getSiblingContainerFromPosition(t,e,n){return this._siblings.find(i=>i._canReceive(t,e,n))}_canReceive(t,e,n){if(!this._clientRect||!yi(this._clientRect,e,n)||!this.enterPredicate(t,this))return!1;const i=this._getShadowRoot().elementFromPoint(e,n);if(!i)return!1;const o=(0,di.fI)(this.element);return i===o||o.contains(i)}_startReceiving(t,e){const n=this._activeSiblings;!n.has(t)&&e.every(t=>this.enterPredicate(t,this)||this._draggables.indexOf(t)>-1)&&(n.add(t),this._cacheParentPositions(),this._listenToScrollEvents())}_stopReceiving(t){this._activeSiblings.delete(t),this._viewportScrollSubscription.unsubscribe()}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scroll.subscribe(t=>{if(this.isDragging()){const e=this._parentPositions.handleScroll(t);e&&(this._itemPositions.forEach(({clientRect:t})=>{Ci(t,e.top,e.left)}),this._itemPositions.forEach(({drag:t})=>{this._dragDropRegistry.isDragging(t)&&t._sortFromLastPointerPosition()}))}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const t=(0,pi.kV)((0,di.fI)(this.element));this._cachedShadowRoot=t||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){const t=this._activeDraggables.filter(t=>t.isDragging());this._siblings.forEach(e=>e._startReceiving(this,t))}}function Hi(t,e){for(let n=0;n<t.length;n++)if(e(t[n],n,t))return n;return-1}function Ni(t,e){t===window?t.scrollBy(0,e):t.scrollTop+=e}function Fi(t,e){t===window?t.scrollBy(e,0):t.scrollLeft+=e}function Yi(t,e){const{top:n,bottom:i,height:o}=t,s=.05*o;return e>=n-s&&e<=n+s?1:e>=i-s&&e<=i+s?2:0}function Ui(t,e){const{left:n,right:i,width:o}=t,s=.05*o;return e>=n-s&&e<=n+s?1:e>=i-s&&e<=i+s?2:0}const Ki=(0,pi.i$)({passive:!1,capture:!0});let $i=(()=>{class t{constructor(t,e){this._ngZone=t,this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=[],this._globalListeners=new Map,this._draggingPredicate=t=>t.isDragging(),this.pointerMove=new et.xQ,this.pointerUp=new et.xQ,this.scroll=new et.xQ,this._preventDefaultWhileDragging=t=>{this._activeDragInstances.length>0&&t.preventDefault()},this._persistentTouchmoveListener=t=>{this._activeDragInstances.length>0&&(this._activeDragInstances.some(this._draggingPredicate)&&t.preventDefault(),this.pointerMove.next(t))},this._document=e}registerDropContainer(t){this._dropInstances.has(t)||this._dropInstances.add(t)}registerDragItem(t){this._dragInstances.add(t),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,Ki)})}removeDropContainer(t){this._dropInstances.delete(t)}removeDragItem(t){this._dragInstances.delete(t),this.stopDragging(t),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,Ki)}startDragging(t,e){if(!(this._activeDragInstances.indexOf(t)>-1)&&(this._activeDragInstances.push(t),1===this._activeDragInstances.length)){const t=e.type.startsWith("touch");this._globalListeners.set(t?"touchend":"mouseup",{handler:t=>this.pointerUp.next(t),options:!0}).set("scroll",{handler:t=>this.scroll.next(t),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:Ki}),t||this._globalListeners.set("mousemove",{handler:t=>this.pointerMove.next(t),options:Ki}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((t,e)=>{this._document.addEventListener(e,t.handler,t.options)})})}}stopDragging(t){const e=this._activeDragInstances.indexOf(t);e>-1&&(this._activeDragInstances.splice(e,1),0===this._activeDragInstances.length&&this._clearGlobalListeners())}isDragging(t){return this._activeDragInstances.indexOf(t)>-1}ngOnDestroy(){this._dragInstances.forEach(t=>this.removeDragItem(t)),this._dropInstances.forEach(t=>this.removeDropContainer(t)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((t,e)=>{this._document.removeEventListener(e,t.handler,t.options)}),this._globalListeners.clear()}}return t.\u0275fac=function(e){return new(e||t)(p.LFG(p.R0b),p.LFG(i.K0))},t.\u0275prov=(0,p.Yz7)({factory:function(){return new t((0,p.LFG)(p.R0b),(0,p.LFG)(i.K0))},token:t,providedIn:"root"}),t})();const Bi={dragStartThreshold:5,pointerDirectionChangeThreshold:5};let Vi=(()=>{class t{constructor(t,e,n,i){this._document=t,this._ngZone=e,this._viewportRuler=n,this._dragDropRegistry=i}createDrag(t,e=Bi){return new Ai(t,e,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(t){return new Qi(t,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}}return t.\u0275fac=function(e){return new(e||t)(p.LFG(i.K0),p.LFG(p.R0b),p.LFG(hi.rL),p.LFG($i))},t.\u0275prov=(0,p.Yz7)({factory:function(){return new t((0,p.LFG)(i.K0),(0,p.LFG)(p.R0b),(0,p.LFG)(hi.rL),(0,p.LFG)($i))},token:t,providedIn:"root"}),t})(),Xi=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=p.oAB({type:t}),t.\u0275inj=p.cJS({providers:[Vi],imports:[hi.ZD]}),t})();const Gi={},Wi=((0,s.ZF)("itemStore"),[]),to=[_,U,F,$,y,G];let eo=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=p.oAB({type:t}),t.\u0275inj=p.cJS({providers:[...to],imports:[[Xi,c.AuthModule,i.ez,a.D,r.m,li,s.Aw.forFeature("itemStore",Gi),o.sQ.forFeature(Wi),cn]]}),t})()}}]);