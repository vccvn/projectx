{"version":3,"sources":["webpack:///src/app/_store/project/model.ts","webpack:///src/app/project-page/_store/index.ts","webpack:///src/app/project-page/header/header.component.ts","webpack:///src/app/project-page/header/header.component.html","webpack:///src/app/_3D/services/project-editor.service.ts","webpack:///src/app/project-page/project-routing.module.ts","webpack:///src/app/_store/project/index.ts","webpack:///src/app/project-page/workspace/workspace.component.ts","webpack:///src/app/project-page/workspace/workspace.component.html","webpack:///src/app/project-page/project.module.ts","webpack:///src/app/project-page/_store/effects.ts","webpack:///src/app/_store/project/table.ts","webpack:///src/app/project-page/_store/services.ts","webpack:///src/app/_store/project/service.ts","webpack:///src/app/project-page/_store/reducers.ts"],"names":["EProjectStatus","HeaderComponent","storage","cd","clickSave","isVisible","percent","renderLoading","downloadUrl","downloadAvailable","mode","isInited","logo","link","subcribe","data","download_source_url","detectChanges","event","preventDefault","emit","onClickUndo","onClickRedo","save","ProjectEditorService","engineClass","editorClass","ENTRIES_COMPONENTS","COMPONENTS","routes","path","children","component","redirectTo","ProjectRoutingModule","forChild","_id","WorkspaceComponent","elemRef","activatedRoute","router","editor","events","geoService","toolbar","confirmService","panelModelService","panelLightService","editorToolbar","viewportService","vectorControls","categoryService","itemService","projectService","templateService","id","editMode","isLoading","app","urlPath","projects","templates","project","template","defaultThumbnail","lockSidebar","isLockEventListenner","workspaceKey","downloadBtn","target","href","download","engineEvent","e","tasks","hideLoading","showLoading","appinit","engine","setControlEngine","detachLight","appBeforeInit","on","subEventService","sub","moduleKey","assign","type","subscribe","val","registerEventService","updateProps","updateTargetProps","show","secret_key","doAction","action","onDetach","showLight","beforeinit","init","dropModelItem","importTemplate","document","activeEventServiceRegistered","value","saveView","saveCurrentCameraPosition","saveThumbnail","exportImage","preload","deactiveEventServiceRegistered","hide","off","isFocus","snapshot","paramMap","get","loadProject","editorMode","setProjectData","secret_id","lazyLoadProject","setTimeout","update","rs","create","error","preData","scene","objects","length","setProject","unselect","capture","image","thumbnail","updateThumbnail","attr","el","click","open","d","key","close","closeAllPanel","name","updateLightDataAndScene","title","showDeleteConfirm","success","deleteLight","ed","getEditObjectData","obj","getObject","object","updateModelMeshMaterial","props","updateObjectSettingDataAndScene","model","createElement","setAttribute","body","appendChild","remove","showConfirm","content","item","dat","size","updateSceneSizeAndFloorAndGridNyChildren","floor","above","position","y","sceneData","getRealSceneSize","x","z","fov","camera","tan","Math","ds","dz","far","near","updateCameraSetting","settings","custom","updateCanvasSize","ProjectModule","forFeature","effects","ProjectTableService","dbService","columns","autoIncrement","required","category_id","defVal","description","status","allow_custom","renderer","composer","shadow","control","lights","meshes","services","API_CUSTOMERS_URL","ProjectService","httpService","params","post","put","query","url","getOut","ProjectId","reducers","selectContainerState"],"mappings":"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","file":"project-page-project-module-es5.js","sourcesContent":["export enum EProjectStatus {\r\n    draft = 'draft',\r\n    published = 'published',\r\n}\r\n\r\n\r\nexport interface ProjectModel {\r\n\r\n    id: number,\r\n    name: string,\r\n    category_id?: number,\r\n    description?: string,\r\n    status?: string,\r\n    allow_custom?:boolean,\r\n    thumbnail?: string\r\n    renderer?: any\r\n    scene?:any\r\n    \r\n    composer?: {\r\n        [x: string]: any\r\n    }\r\n    \r\n    shadow?: any\r\n    camera?:any\r\n    control?:any\r\n    lights?: any[],\r\n    // objects\r\n    objects?: any[]\r\n    // objects\r\n    meshes?: any[]\r\n    [x: string]: any\r\n\r\n\r\n}\r\n","export * from './reducers';\r\n// export * from './actions';\r\nexport * from './effects';\r\n// export * from './selectors';\r\nexport * from './services';\r\n// export * from './item';\r\n// export * from './category';\r\n","import { Component, ChangeDetectorRef, ElementRef, ViewChild, OnInit, Input, Output, EventEmitter } from '@angular/core';\r\nimport { AppEditorStorageService } from '@app/_3D/services/app-editor-storage.service';\r\nimport { getConfig } from '@app/_core/config';\r\nimport { BaseComponent } from '@app/_shared/components/base/base.component';\r\nimport { Subject, Observable } from 'rxjs';\r\n\r\n@Component({\r\n    selector: 'app-header',\r\n    templateUrl: './header.component.html',\r\n    styleUrls: ['./header.component.scss'],\r\n})\r\nexport class HeaderComponent extends BaseComponent implements OnInit {\r\n    @ViewChild('inputElement', { static: false }) inputElement?: ElementRef;\r\n\r\n    @Output() clickSave = new EventEmitter<any>();\r\n\r\n    renderData$: Observable<Blob>;\r\n    renderLoading$: Observable<boolean>;\r\n\r\n    isVisible = false;\r\n    data: any;\r\n    percent = 0;\r\n    renderLoading = true;\r\n\r\n    downloadUrl: string = 'javascript:void(0);';\r\n    downloadAvailable: boolean = false;\r\n\r\n\r\n    mode: string = 'list';\r\n\r\n    isInited: boolean = false;\r\n    \r\n    \r\n    logo = getConfig('urls.logo_url');\r\n    link = getConfig('urls.logo_link');\r\n\r\n    constructor(\r\n        private storage: AppEditorStorageService,\r\n        private cd: ChangeDetectorRef\r\n    ) {\r\n        super();\r\n\r\n    }\r\n\r\n    initFirst() {\r\n        if (!this.isInited) {\r\n            this.storage.subcribe('project', (data) => {\r\n                if (data && data.download_source_url) {\r\n                    this.downloadAvailable = true;\r\n                    this.downloadUrl = data.download_source_url;\r\n                }\r\n            }, true);\r\n            this.storage.subcribe('editorMode', mode => {\r\n                this.mode = mode;\r\n                this.cd.detectChanges();\r\n            }, true);\r\n            // window['hdStorage'] = this.storage;\r\n            this.isInited = true;\r\n        }\r\n\r\n    }\r\n\r\n    download(event: Event) {\r\n        if (!this.downloadAvailable) {\r\n            event.preventDefault();\r\n            return false;\r\n        }\r\n    }\r\n\r\n    save(event) {\r\n        // console.log(this.editor.data);\r\n        this.clickSave.emit(true);\r\n    }\r\n\r\n    handleOk(): void {\r\n        this.isVisible = false;\r\n    }\r\n\r\n    handleCancel(): void {\r\n        this.isVisible = false;\r\n    }\r\n\r\n    onClickUndo() {\r\n        // this.editor.historyManager.undo();\r\n    }\r\n    onClickRedo() {\r\n        // this.editor.historyManager.redo();\r\n    }\r\n}","<div class=\"group-first\">\r\n\t<a href=\"{link}\" target=\"_blank\">\r\n\t\t<img class=\"logo\" src=\"{{logo}}\" alt=\"Cretip logo\" />\r\n\t</a>\r\n\t\r\n\t<div class=\"group-center\">\r\n\t\t<button class=\"btn btn-ghost btn-icon\" nz-button nzType=\"text\" (click)=\"onClickUndo()\">\r\n\t\t\t<img src=\"/assets/icons/new-design/header/undo.svg\" />\r\n\t\t</button>\r\n\t\t<button class=\"btn btn-ghost btn-icon mr-auto\" nz-button nzType=\"text\" (click)=\"onClickRedo()\">\r\n\t\t\t<img src=\"/assets/icons/new-design/header/redo.svg\" />\r\n\t\t</button>\r\n\t\t<button class=\"btn btn-ghost btn-icon hidden invisble\" nz-button nzType=\"text\" (click)=\"save($event)\">\r\n\t\t\t<img src=\"/assets/icons/new-design/header/save.svg\" />\r\n\t\t\t<span>Save</span>\r\n\t\t</button>\r\n\t</div>\r\n\r\n\t\r\n</div>\r\n\r\n<div class=\"group-last\">\r\n\t\r\n\t<button class=\"btn btn-primary btn-icon\" nz-button nzType=\"text\" (click)=\"save($event)\">\r\n\t\t<img src=\"/assets/icons/new-design/header/save.svg\" />\r\n\t\t<span>Save</span>\r\n\t</button>\r\n","import { Injectable } from '@angular/core';\nimport ClientEditorEngine from '../engines/client-editor.engine';\nimport ProjectEditor from '../libs/project-editor';\nimport { AppEditorService } from './app-editor.service';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class ProjectEditorService extends AppEditorService {\n    engineClass = ClientEditorEngine;\n    editorClass = ProjectEditor;\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nimport { WorkspaceComponent } from './workspace/workspace.component';\nimport { HeaderComponent } from './header/header.component';\n\n\n\nexport const ENTRIES_COMPONENTS = [];\n\n\nexport const COMPONENTS = [\n  WorkspaceComponent,\n  HeaderComponent\n  \n];\n\nconst routes: Routes = [\n  {\n    path: '',\n    children: [\n      {\n        path: ':id/edit',\n        component: WorkspaceComponent,\n      },\n      {\n        path: ':id/create',\n        component: WorkspaceComponent,\n      },\n      {\n        path: ':id/update',\n        component: WorkspaceComponent,\n      },\n      {\n        path: '**',\n        redirectTo: '0/update',\n      },\n    ],\n  },\n];\n\n@NgModule({\n  imports: [\n    RouterModule.forChild(routes)\n  ],\n  exports: [RouterModule],\n})\nexport class ProjectRoutingModule { }\n","export * from './model';\r\nexport * from './service';\r\n","import { Component, NgZone, OnInit, ChangeDetectorRef, ViewEncapsulation, ElementRef, AfterViewInit, OnDestroy } from '@angular/core';\r\nimport { ActivatedRoute, Router, NavigationEnd } from '@angular/router';\r\nimport { TransparentBase64Image } from '@app/_3D/libs/three.libs';\r\nimport { AppEditorEventService } from '@app/_3D/services/app-editor-event.service';\r\nimport { assignValue, assignWithout, copyByList, degreeToRadians, inArray, isBoolean, isEmpty, Str } from '@app/_core/helpers/utils';\r\nimport { MeshGeometryService } from '@app/_shared/components/panels/mesh-geometry/mesh-geometry.service';\r\nimport { PanelLightService } from '@app/_shared/components/panels/panel-light/panel-light.service';\r\nimport { PanelModelObjectService } from '@app/_shared/components/panels/panel-model-object/panel-model-object.service';\r\nimport { EditorToolbarService } from '@app/_shared/components/viewport/editor-toolbar/editor-toolbar.service';\r\nimport { VectorControlsService } from '@app/_shared/components/viewport/vector-controls/vector-controls.service';\r\nimport { ViewportService } from '@app/_shared/components/viewport/viewport.service';\r\nimport { AppEditorStorageService } from '@app/_3D/services/app-editor-storage.service';\r\nimport { ModalConfirmService } from '@app/_shared/services/modal-confirm.service';\r\nimport { CategoryService } from '@app/_store/category';\r\nimport { ItemService, ItemTableService } from '@app/_store/item';\r\nimport { ProjectModel, ProjectService } from '@app/_store/project';\r\nimport { getBlankAppData } from '@app/_3D/store/data.type';\r\nimport { TemplateModel, TemplateService } from '@app/_store/template';\r\nimport { ClientEditToolbarService } from '@app/_shared/components/viewport/client-edit-toolbar/client-edit-toolbar.service';\r\nimport { BaseComponent } from '@app/_shared/components/base/base.component';\r\nimport { ProjectEditorService } from '@app/_3D/services/project-editor.service';\r\nimport { A } from '@app/_core/helpers/html-elements';\r\nimport { runTask } from '@app/_core/tasks';\r\nimport { getConfig } from '@app/_core/config';\r\n\r\nlet _id = 0;\r\n\r\n@Component({\r\n    selector: 'app-workspace',\r\n    templateUrl: './workspace.component.html',\r\n    styleUrls: ['../../../styles/design/_index.scss', './workspace.component.scss'],\r\n    encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class WorkspaceComponent extends BaseComponent implements OnInit, AfterViewInit, OnDestroy {\r\n    isInited: boolean = false;\r\n    id: number = 0;\r\n    mode: string = 'create';\r\n    editMode : string = 'update';\r\n    isLoading: boolean = true;\r\n    app: ProjectEditorService = null;\r\n    urlPath: string = null;\r\n    projects: ProjectModel[] = [];\r\n    templates: TemplateModel[] = [];\r\n    project: ProjectModel = null;\r\n    template: TemplateModel = null;\r\n    defaultThumbnail: string = TransparentBase64Image;\r\n    lockSidebar: boolean = false;\r\n    isLockEventListenner: boolean = true;\r\n    workspaceKey: string = \"projectWorkspace\";\r\n    subEventService: AppEditorEventService;\r\n    downloadBtn = A(\".download\", {target: \"_blank\", href: \"\", download: \"screenshot.png\"});\r\n\r\n    engineEvent: any = {\r\n        \"load.success\": e => e.tasks == 0 && this.hideLoading(),\r\n        \"load.fail\": e => e.tasks == 0 && this.hideLoading(),\r\n        \"object.load.starting\": () => this.showLoading(),\r\n        \"object.load.completed\": () => {\r\n            this.hideLoading()\r\n            runTask('loading.complete');\r\n        },\r\n        \"loadmore.progress\": e => runTask(\"loading.progress\", [e.percent])\r\n    };\r\n    appinit: (e) => any = e => {\r\n        this.app.engine.setControlEngine(this.vectorControls.engine);\r\n        this.app.editor.detachLight();\r\n    };\r\n\r\n    appBeforeInit: (e) => any = e => {\r\n        this.app.engine.on(this.engineEvent);\r\n    }\r\n\r\n    constructor(\r\n        public cd: ChangeDetectorRef, \r\n        public elemRef: ElementRef, \r\n        public activatedRoute: ActivatedRoute, \r\n        public router: Router, \r\n        public editor: ProjectEditorService, \r\n        public events: AppEditorEventService, \r\n        public storage: AppEditorStorageService, \r\n        public geoService: MeshGeometryService, \r\n        public toolbar: ClientEditToolbarService, \r\n        public confirmService: ModalConfirmService, \r\n        public panelModelService: PanelModelObjectService, \r\n        public panelLightService: PanelLightService, \r\n        public editorToolbar: EditorToolbarService, \r\n        public viewportService: ViewportService, \r\n        public vectorControls: VectorControlsService, \r\n        public categoryService: CategoryService, \r\n        public itemService: ItemService, \r\n        public projectService: ProjectService, \r\n        public templateService: TemplateService\r\n        \r\n    ) {\r\n        super();\r\n        this.subEventService = this.events.sub(this.workspaceKey);\r\n        this.editor.events = this.subEventService;\r\n        this.app = this.editor;\r\n        this.toolbar = toolbar.sub(this.workspaceKey);\r\n        this.viewportService = viewportService.sub(this.workspaceKey);\r\n        this.vectorControls = vectorControls.sub(this.workspaceKey);\r\n        this.editorToolbar = editorToolbar.sub(this.workspaceKey)\r\n\r\n\r\n        \r\n        \r\n        // window['projectWorkspace'] = this;\r\n    }\r\n\r\n    initOnce() {\r\n        // this.events = this.events.sub(this.workspaceKey);\r\n        this.moduleKey = this.workspaceKey;\r\n        this.storage.assign('project', this.project, project => this.project = project);\r\n        this.storage.assign('mode', this.mode, mode => this.mode = mode);\r\n        this.storage.assign('editMode', this.editMode, mode => this.editMode = mode);\r\n        // window['wpStorage'] = this.storage;\r\n\r\n\r\n        this.viewportService.emit({\r\n            type: 'app.set',\r\n            app: this.app\r\n        }, true)\r\n        // quan ly khac\r\n\r\n        this.router.events.subscribe((val) => {\r\n            // see also \r\n            // console.log(val instanceof NavigationEnd)\r\n\r\n        });\r\n\r\n        \r\n        this.registerEventService(this.app, {\r\n            \"editor.update.mesh.props\": e => this.geoService.updateProps(e.data),\r\n            \"editor.update.model.props\": e => this.panelModelService.updateProps(e.data),\r\n            \"editor.update.light.props\": e => this.panelLightService.updateProps(e.data),\r\n            \"editor.update.light.props.target\": e => this.panelLightService.updateTargetProps(e.data),\r\n            \"editor.attach:object\": e => this.toolbar.show(\"object\", e.secret_key),\r\n            \"editor.attach:mesh\": e => this.toolbar.show(\"mesh\", e.secret_key),\r\n            \"editor.attach:light\": e => this.toolbar.show(\"light\", e.secret_key),\r\n            \"editor.delete:light\": e => this.doAction({ action: \"delete\", type: \"light\", secret_key: e.secret_key }),\r\n            \"editor.delete:object\": e => this.doAction({ action: \"delete\", type: \"object\", secret_key: e.secret_key }),\r\n            \"editor.detach\": e => this.onDetach(),\r\n            \"light.showform\": e => this.showLight(e.data),\r\n            beforeinit: this.appBeforeInit,\r\n            init: this.appinit\r\n\r\n        })\r\n        this.registerEventService(this.events, {\r\n            \"modelitem.drop.confirm\": e => this.dropModelItem(e.data),\r\n            \"template.import\": e => this.importTemplate(e.template),\r\n            \"app.loading.show\": e => this.showLoading(),\r\n            \"app.loading.hide\": e => this.hideLoading()\r\n        })\r\n\r\n        this.registerEventService(this.toolbar, {\r\n            \"mode.select\": e => this.app.emit({ type: \"toolbar.change:mode\", mode: e.mode }),\r\n            \"action\": e => this.doAction(e.data)\r\n        });\r\n\r\n\r\n        this.registerEventService(document, {\r\n            'pointerup': e => this.events.emit(e),\r\n            'pointermove': e => this.events.emit(e)\r\n        })\r\n\r\n        this.registerEventService(document, {\r\n            'pointerup': e => this.subEventService.emit(e),\r\n            'pointermove': e => this.subEventService.emit(e)\r\n        });\r\n\r\n\r\n        // this.checkDemoData()\r\n    }\r\n\r\n    onInit() {\r\n        this.isLockEventListenner = false;\r\n        this.activeEventServiceRegistered(this.app);\r\n        // this.activeEventServiceRegistered(this.app.engine);\r\n        this.activeEventServiceRegistered(this.events);\r\n        this.activeEventServiceRegistered(this.toolbar);\r\n        this.activeEventServiceRegistered(document);\r\n\r\n        if (this.app.engine) {\r\n            this.app.engine.on(this.engineEvent);\r\n        }\r\n        this.vectorControls.emit({\r\n            type: \"show\",\r\n            value: true\r\n        }, null, true);\r\n\r\n        this.editorToolbar.show({\r\n            saveView: e => this.app.saveCurrentCameraPosition(),\r\n            saveThumbnail: e => this.saveThumbnail(),\r\n            exportImage: e => this.exportImage()\r\n        })\r\n\r\n\r\n        this.preload();\r\n\r\n\r\n        this.cd.detectChanges();\r\n    }\r\n\r\n    onDestroy() {\r\n        this.isLockEventListenner = true;\r\n        this.deactiveEventServiceRegistered(this.app);\r\n        // this.activeEventServiceRegistered(this.app.engine);\r\n        this.deactiveEventServiceRegistered(this.events);\r\n        this.deactiveEventServiceRegistered(this.toolbar);\r\n        this.deactiveEventServiceRegistered(document);\r\n\r\n        this.vectorControls.emit({\r\n            type: \"show\",\r\n            value: false\r\n        }, null, true);\r\n\r\n        this.editorToolbar.hide();\r\n\r\n\r\n        if (this.app.engine) {\r\n            this.app.engine.off(this.engineEvent);\r\n        }\r\n    }\r\n\r\n    showLoading() {\r\n        if (!this.isFocus) return false;\r\n        this.viewportService.emit(\"show:loading\", null, true);\r\n        this.events.emit(\"show:sidebar-lock\");\r\n    }\r\n    hideLoading() {\r\n        if (!this.isFocus) return false;\r\n        this.viewportService.emit(\"hide:loading\", true, true);\r\n        this.events.emit(\"hide:sidebar-lock\");\r\n    }\r\n\r\n    initUpdate() {\r\n        if (!this.isFocus) return false;\r\n        this.id = +this.activatedRoute.snapshot.paramMap.get(\"id\");\r\n        if (this.id > 0) {\r\n            this.loadProject(this.id);\r\n\r\n        }\r\n        else {\r\n            this.storage.editorMode = 'notfound';\r\n            this.cd.detectChanges();\r\n        }\r\n    }\r\n    initCreate() {\r\n        if (!this.isFocus) return false;\r\n        this.storage.mode = 'create';\r\n        let data = getBlankAppData();\r\n        this.setProjectData(data);\r\n        // console.log(\"create\", data);\r\n        this.isLoading = false;\r\n        this.cd.detectChanges();\r\n    }\r\n\r\n    preload() {\r\n        if (!this.isFocus) return false;\r\n        this.secret_id = this.activatedRoute.snapshot.paramMap.get(\"id\");\r\n        if (this.secret_id == getConfig('data.project.secret_id')) {\r\n            let data = getConfig('data.project');\r\n            this.storage.project = data;\r\n            this.lazyLoadProject(data.data);\r\n            this.isLoading = false;\r\n            this.storage.mode = 'update';\r\n            this.storage.editMode = getConfig('mode')\r\n            this.cd.detectChanges();\r\n\r\n        } else {\r\n            this.storage.mode = 'notfound';\r\n            this.isLoading = false;\r\n        }\r\n\r\n    }\r\n\r\n    importTemplate(template: TemplateModel) {\r\n        if (!this.isFocus) return false;\r\n        this.showLoading();\r\n        setTimeout(() => this.app.importTemplate(template.data), 100);\r\n\r\n    }\r\n\r\n    clickSave(event) {\r\n        if (!this.isFocus) return false;\r\n        if (this.mode == \"update\") {\r\n            this.project.data = this.app.data;\r\n            this.projectService.update(this.project).subscribe(rs => {\r\n                // lam gi do\r\n            });\r\n        } else if (this.mode == \"create\") {\r\n            this.project.data = this.app.data;\r\n            this.projectService.create(this.project).subscribe(rs => {\r\n                this.id = rs.data.id;\r\n                this.mode = \"update\";\r\n                this.app.data.id = this.id;\r\n\r\n            });\r\n\r\n        }\r\n    }\r\n\r\n\r\n\r\n\r\n    loadProject(id: number) {\r\n        if (!this.isFocus) return false;\r\n        this.showLoading();\r\n        // var project = this.projectTable.find(id);\r\n        // if (project && !isEmpty(project)) {\r\n        //     this.storage.editorMode = 'update';\r\n        //     this.storage.project = project;\r\n        //     this.isLoading = false;\r\n        //     this.hideLoading();\r\n        //     this.lazyLoadProject(project as ProjectModel);\r\n        //     this.cd.detectChanges();\r\n        // } else {\r\n            this.projectService.get(this.id).subscribe(data => {\r\n                this.storage.project = data;\r\n                this.isLoading = false;\r\n                this.hideLoading();\r\n                this.lazyLoadProject(data);\r\n                this.storage.mode = 'update';\r\n                this.cd.detectChanges();\r\n            }, error => {\r\n                this.storage.mode = 'notfound';\r\n                this.hideLoading();\r\n                this.cd.detectChanges();\r\n            });\r\n        // }\r\n\r\n    }\r\n\r\n    lazyLoadProject(project) {\r\n        let preData = assignWithout({}, project, ['objects', 'meshes', 'models', 'scene']);\r\n        preData.scene = assignWithout({}, project.scene, ['foregrounds', 'background']);\r\n        this.setProjectData(preData);\r\n        runTask('loading.progress', [20]);\r\n        setTimeout(() => {\r\n            if (!project.objects || !project.objects.length) {\r\n                setTimeout(() => {\r\n                    runTask('loading.progress', [50]);\r\n                    setTimeout(() => {\r\n                        runTask('loading.progress', [100]);\r\n                        setTimeout(() => {\r\n                            runTask('loading.complete', [project]);\r\n                        }, 1000);\r\n                    }, 1000);\r\n                }, 500);\r\n            }\r\n            else {\r\n                this.showLoading();\r\n            }\r\n\r\n        }, 11);\r\n        setTimeout(() => {\r\n            this.setProjectData(project);\r\n        }, 25);\r\n    }\r\n\r\n\r\n\r\n\r\n    setProjectData(data: ProjectModel) {\r\n        if (!this.isFocus) return false;\r\n        this.app.setProject(data);\r\n    }\r\n\r\n\r\n    saveThumbnail() {\r\n        if (!this.isFocus) return false;\r\n        this.app.editor.unselect();\r\n        this.showLoading();\r\n        setTimeout(() => {\r\n            this.app.capture(image => {\r\n                this.project.thumbnail = image;\r\n                this.projectService.updateThumbnail({\r\n                    id: this.project.id,\r\n                    thumbnail: this.project.thumbnail\r\n                } as ProjectModel).subscribe(rs => {\r\n                    this.hideLoading();\r\n                }, e => {\r\n                    this.hideLoading();\r\n                });\r\n            });\r\n\r\n        }, 1000);\r\n    }\r\n\r\n    \r\n    exportImage() {\r\n        if (!this.isFocus) return false;\r\n        this.app.editor.unselect();\r\n        this.showLoading();\r\n        setTimeout(() => {\r\n            this.app.capture(image => {\r\n                this.downloadBtn.attr(\"href\", image); \r\n                this.downloadBtn.el.click();\r\n                this.hideLoading();\r\n            });\r\n            \r\n        }, 2000);\r\n        \r\n    }\r\n\r\n    \r\n\r\n\r\n\r\n    onMeshAttach(data) {\r\n        if (!this.isFocus) return false;\r\n        this.geoService.open(data, e => {\r\n            let d: any = {};\r\n            if (inArray(['props', 'geometry', 'material'], e.key)) {\r\n                d[e.key] = e.data[e.key];\r\n                switch (e.key) {\r\n                    case \"props\":\r\n\r\n                        break;\r\n                    case \"geometry\":\r\n\r\n                        break;\r\n\r\n                    case \"material\":\r\n\r\n                        break;\r\n\r\n\r\n                    default:\r\n                        break;\r\n                }\r\n                this.events.emit({\r\n                    type: \"mesh.setting.update\",\r\n                    secret_key: data.secret_key,\r\n                    data: d\r\n                });\r\n            }\r\n\r\n        });\r\n    }\r\n\r\n    closeAllPanel() {\r\n        if (!this.isFocus) return false;\r\n        // this.toolbar.hide();\r\n        this.geoService.close();\r\n        this.panelModelService.close();\r\n        this.panelLightService.close();\r\n    }\r\n\r\n    onDetach() {\r\n        if (!this.isFocus) return false;\r\n        this.toolbar.hide();\r\n        this.closeAllPanel();\r\n\r\n    }\r\n\r\n    showLight(data) {\r\n        if (!this.isFocus) return false;\r\n        this.panelLightService.open(data, e => {\r\n            let update: any = {};\r\n            // if(e.type==\"params\"){\r\n            update[e.type] = {};\r\n            update[e.type][e.name] = e.value;\r\n\r\n            // }\r\n            this.app.updateLightDataAndScene(e.secret_key, update);\r\n        })\r\n    }\r\n\r\n    doAction(data) {\r\n        if (!this.isFocus) return false;\r\n        if (data.action == \"delete\") {\r\n            var title = inArray(['object', 'mesh'], data.type) ? \"Are you sure delete this object?\" : \"Are you sure delete this light?\";\r\n            this.confirmService.showDeleteConfirm(title, () => {\r\n                if (inArray(['object', 'mesh'], data.type)) {\r\n                    this.app.emit({\r\n                        type: \"toolbar.delete:object\",\r\n                        secret_key: data.secret_key,\r\n                        success: () => this.onDetach()\r\n                    })\r\n                }\r\n                else if (data.type == \"light\") {\r\n                    this.app.deleteLight(data.secret_key, () => this.onDetach());\r\n                }\r\n            })\r\n        }\r\n        else if (data.action == \"edit\") {\r\n            let ed = this.app.getEditObjectData(data.secret_key);\r\n            if (ed != null) {\r\n                if (ed.type == \"mesh\") {\r\n                    this.closeAllPanel();\r\n                    this.geoService.open(ed, e => {\r\n                        let d: any = {};\r\n                        if (inArray(['props', 'geometry', 'material'], e.key)) {\r\n                            d[e.key] = e.data[e.key];\r\n                            switch (e.key) {\r\n                                case \"props\":\r\n\r\n                                    break;\r\n                                case \"geometry\":\r\n\r\n                                    break;\r\n\r\n                                case \"material\":\r\n\r\n                                    break;\r\n\r\n\r\n                                default:\r\n                                    break;\r\n                            }\r\n                            this.events.emit({\r\n                                type: \"mesh.setting.update\",\r\n                                secret_key: data.secret_key,\r\n                                data: d\r\n                            });\r\n                        }\r\n\r\n                    });\r\n                } else if (ed.type == \"model\") {\r\n                    this.closeAllPanel();\r\n                    let obj = this.app.engine.getObject(data.secret_key).object;\r\n                    ed.object = obj;\r\n\r\n                    this.panelModelService.open(ed, e => {\r\n                        if (e.type == \"material\") {\r\n                            this.app.updateModelMeshMaterial(e.secret_key, e.name, e.data);\r\n                        }\r\n                        else if (e.type == \"props\") {\r\n                            let props: any = {};\r\n                            props[e.key] = e.data[e.key];\r\n                            this.app.updateObjectSettingDataAndScene(e.secret_key, { props: props }, { props: true })\r\n                        }\r\n\r\n                    });\r\n                }\r\n                else if (ed.type == \"light\") {\r\n                    this.showLight(ed.data);\r\n                }\r\n            }\r\n        }\r\n        else if (data.action == 'download') {\r\n            let model = this.app.getObject(data.secret_key);\r\n\r\n\r\n            if (model.type == \"model\" && model.data.download_source_url != \"\") {\r\n                const link = document.createElement('a');\r\n                link.setAttribute('target', '_blank');\r\n                link.setAttribute('href', model.data.download_source_url);\r\n                link.setAttribute('download', model.data.name + \".zip\");\r\n                document.body.appendChild(link);\r\n                link.click();\r\n                link.remove();\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    dropModelItem(data) {\r\n        if (!this.isFocus) return false;\r\n        this.confirmService.showConfirm({\r\n            title: \"Drop Item confirm\",\r\n            content: \"Item's size is bigger than size of Scene. Do you want to continue?\"\r\n        }, d => {\r\n            this.showLoading();\r\n            this.events.emit({\r\n                type: 'item.dropped',\r\n                item: data.item,\r\n                success: (dat) => {\r\n                    this.events.emit('viewport.droppable.hide');\r\n                    var size = data.item.size;\r\n                    this.app.updateSceneSizeAndFloorAndGridNyChildren(2);\r\n                    // this.app.updateSceneSizeSetting()\r\n                    if (this.app.data.scene.floor.above) {\r\n                        data.position.y = this.app.data.scene.floor.props.position.y + size.y / 2;\r\n                    } else {\r\n                        data.position.y = size.y / 2;\r\n                    }\r\n                    this.app.updateObjectSettingDataAndScene(dat.secret_key, {\r\n                        props: {\r\n                            position: data.position\r\n                        }\r\n                    }, { props: true })\r\n\r\n\r\n                    var sceneData = this.app.getRealSceneSize();\r\n                    var x = sceneData.size.x;\r\n                    var y = sceneData.size.y;\r\n                    var z = sceneData.size.z;\r\n                    var fov = this.app.engine.camera.fov;\r\n                    var tan = Math.tan(degreeToRadians(fov / 2));\r\n                    var ds = (z / 2) + ((x > y ? x : y) / 2) / tan;\r\n                    var dz = ds * 1.5;\r\n                    var far = this.app.engine.camera.far > dz ? this.app.engine.camera.far : dz;\r\n                    var near = this.app.engine.camera.near;\r\n                    if (z >= 50) {\r\n                        near = 1;\r\n                    }\r\n                    else if (z > 20) {\r\n                        near = 0.5;\r\n                    }\r\n                    else if (z > 10) {\r\n                        near = 0.1;\r\n                    }\r\n                    if (near < this.app.engine.camera.near) near = this.app.engine.camera.near;\r\n\r\n\r\n                    this.app.updateCameraSetting({\r\n                        far: far,\r\n                        near: near,\r\n                        position: {\r\n                            z: ds * 1.5,\r\n                            y: y / 2,\r\n                            x: 0\r\n                        },\r\n                        settings: {\r\n                            position: {\r\n                                type: \"custom\",\r\n                                custom: {\r\n                                    z: ds * 1.5,\r\n                                    y: y / 2,\r\n                                    x: 0\r\n                                }\r\n                            }\r\n                        }\r\n                    }, true);\r\n\r\n                }\r\n            })\r\n        }, () => {\r\n            this.events.emit('viewport.droppable.hide');\r\n        });\r\n    }\r\n\r\n    nzCollapsedChange(event) {\r\n        if (!this.isFocus) return false;\r\n        this.app.updateCanvasSize();\r\n    }\r\n\r\n\r\n    ngAfterViewInit(): void {\r\n        if (!this.isFocus) return;\r\n        this.app.updateCanvasSize();\r\n    }\r\n\r\n}\r\n","<ng-container *ngIf=\"__show__; then thenTemplate; else elseTemplate\"></ng-container>\r\n<ng-template #thenTemplate>\r\n\r\n    <nz-layout>\r\n        <nz-header>\r\n            <app-header (clickSave)=\"clickSave($event)\"></app-header>\r\n        </nz-header>\r\n        <nz-content>\r\n            <ng-container *ngIf=\"isLoading; then loadingTemplate; else editorTemplate\"></ng-container>\r\n            <ng-template #loadingTemplate>\r\n                <div class=\"alert\">\r\n                    <h3>Vui lng ch giy lt</h3>\r\n                </div>\r\n            </ng-template>\r\n            <ng-template #editorTemplate>\r\n                <ng-container *ngIf=\"mode=='notfound'; then notFoundTemplate; else editorTemplate\"></ng-container>\r\n                <ng-template #notFoundTemplate>\r\n                    <div class=\"alert not-found\">\r\n                        template Not Found\r\n                    </div>\r\n                </ng-template>\r\n                <ng-template #editorTemplate>\r\n                    <nz-layout class=\"inner-layout\">\r\n                        <nz-sider nzWidth=\"380px\" nzTheme=\"dark\" (nzCollapsedChange)=\"nzCollapsedChange($event)\">\r\n                            <app-project-sidebar></app-project-sidebar>\r\n                        </nz-sider>\r\n                        <nz-content class=\"nz-layout-content\">\r\n                            <section id=\"content\">\r\n                                <app-client-viewport></app-client-viewport>\r\n                            </section>\r\n                        </nz-content>\r\n                    </nz-layout>\r\n                </ng-template>\r\n            </ng-template>\r\n        </nz-content>\r\n    </nz-layout>\r\n    <dragging-item></dragging-item>\r\n    <dragging-geometry></dragging-geometry>\r\n    <modal-image-library [app]=\"app\"></modal-image-library>\r\n    <panel-mesh-geometry></panel-mesh-geometry>\r\n    <panel-model-object></panel-model-object>\r\n    <panel-light></panel-light>\r\n    <app-panel-mesh-customize></app-panel-mesh-customize>\r\n    <app-sidebar-lock></app-sidebar-lock>\r\n\r\n</ng-template>\r\n<ng-template #elseTemplate>\r\n\r\n</ng-template>","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\n\nimport { SharedModule } from '../_shared/shared.module';\nimport { AppUIModule } from '../app-ui.module';\nimport { AuthModule } from '../auth/auth.module';\n\nimport { ProjectRoutingModule, COMPONENTS, ENTRIES_COMPONENTS } from './project-routing.module';\nimport { DragDropModule } from '@angular/cdk/drag-drop';\nimport { reducers, effects, services } from './_store';\nimport { NzCollapseModule } from 'ng-zorro-antd/collapse';\n\n@NgModule({\n  declarations: [...COMPONENTS, ...ENTRIES_COMPONENTS],\n  imports: [\n    DragDropModule,\n    AuthModule,\n    CommonModule,\n    AppUIModule,\n    SharedModule,\n    ProjectRoutingModule,\n    StoreModule.forFeature('projectStore', reducers),\n    EffectsModule.forFeature(effects),\n    NzCollapseModule,\n  ],\n  entryComponents: ENTRIES_COMPONENTS,\n  providers: [...services],\n})\nexport class ProjectModule {}\n","// import { CollectionEffects } from './collection/effects';\r\n\r\nexport const effects: any[] = [\r\n  // CollectionEffects,\r\n  \r\n];\r\n","import { Injectable } from '@angular/core';\nimport { DbTableColumns } from '@app/_core/helpers/local-db';\nimport { LostDbTableService } from '@app/_core/services/lost-db-table.service';\nimport { LostDbService } from '@app/_core/services/lost-db.service';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class ProjectTableService extends LostDbTableService {\n    name: string = 'projects';\n    columns: DbTableColumns = {\n        id: {\n            type: \"number\",\n            autoIncrement: true\n        },\n        name: {\n            type: \"string\",\n            required: true,\n        },\n        category_id: {\n            type: \"number\",\n            defVal: 0\n        },\n        description: {\n            type: \"string\",\n            defVal: \"\"\n        },\n        status: {\n            type: \"string\",\n            defVal: \"draft\"\n        },\n        allow_custom: {\n            type: \"boolean\",\n            defVal: false\n        },\n        thumbnail: {\n            type: \"string\",\n            defVal: \"\"\n        },\n        renderer: {\n            type: \"object\",\n            defVal: {}\n        },\n        scene: {\n            type: \"object\",\n            defVal: {}\n        },\n\n        composer: {\n            type: \"object\",\n            defVal: {}\n        },\n        shadow: {\n            type: \"object\",\n            defVal: {}\n        },\n        camera: {\n            type: \"object\",\n            defVal: {}\n        },\n        control: {\n            type: \"object\",\n            defVal: {}\n        },\n        lights: {\n            type: \"array\",\n            defVal: []\n        },\n        // objects\n        objects: {\n            type: \"array\",\n            defVal: []\n        },\n        // objects\n        meshes: {\n            type: \"array\",\n            defVal: []\n        }\n\n    }\n    constructor(private dbService: LostDbService) {\n        super(dbService);\n        this.init();\n    }\n}\n","import { CategoryService } from \"@app/_store/category\";\r\nimport { ProjectService } from \"@app/_store/project\";\r\nimport { ProjectTableService } from \"@app/_store/project/table\";\r\n\r\nexport const services = [\r\n  ProjectService,\r\n  CategoryService,\r\n  ProjectTableService,\r\n];\r\n","import { Injectable } from '@angular/core';\r\nimport { HttpService } from '@app/_core/services/http.service';\r\nimport { Observable } from 'rxjs';\r\nimport { CategoryResultsModel } from '../category';\r\n\r\nimport { ProjectModel } from './model';\r\nimport { ProjectResultModel, ProjectResultsModel } from './results.model';\r\n\r\nconst API_CUSTOMERS_URL = 'projects';\r\n\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class ProjectService {\r\n    results: ProjectResultsModel;\r\n\r\n    constructor(private httpService: HttpService) { }\r\n\r\n\r\n    getAll(params: {}): Observable<ProjectResultsModel> {\r\n        return this.httpService.get(API_CUSTOMERS_URL + \"/list\", params);\r\n    }\r\n\r\n    // get(key): Observable<ProjectResultModel> {\r\n    //   return this.httpService.get(`${API_CUSTOMERS_URL}/${key}.json`);\r\n    // }\r\n\r\n    get(key): Observable<ProjectModel> {\r\n        return this.httpService.get(`${API_CUSTOMERS_URL}/detail/${key}`);\r\n    }\r\n\r\n    getByCategories(params: {}): Observable<CategoryResultsModel> {\r\n        return this.httpService.get(API_CUSTOMERS_URL + \"/categories\", params);\r\n    }\r\n    create(model: ProjectModel): Observable<ProjectResultModel> {\r\n        return this.httpService.post(API_CUSTOMERS_URL + \"/create\", model);\r\n    }\r\n\r\n    update(model: ProjectModel): Observable<ProjectResultModel> {\r\n        const key = model.id;\r\n        // return this.httpService.patch(`${API_CUSTOMERS_URL}/${key}.json`, model);\r\n        // return this.httpService.patch(`${API_CUSTOMERS_URL}/actions.json`, model);\r\n        return this.httpService.put(`${API_CUSTOMERS_URL}/update/${key}`, model);\r\n    }\r\n\r\n\r\n    updateThumbnail(model: ProjectModel): Observable<ProjectResultModel> {\r\n        const key = model.id;\r\n        // return this.httpService.patch(`${API_CUSTOMERS_URL}/${key}.json`, model);\r\n        // return this.httpService.patch(`${API_CUSTOMERS_URL}/actions.json`, model);\r\n        return this.httpService.put(`${API_CUSTOMERS_URL}/thumbnail/${key}`, model);\r\n    }\r\n\r\n\r\n\r\n    delete(key): Observable<ProjectResultModel> {\r\n        // return this.httpService.delete(`${API_CUSTOMERS_URL}/${key}`);\r\n        return this.httpService.delete(`${API_CUSTOMERS_URL}/delete/${key}`);\r\n    }\r\n\r\n    search(query: { tag?: string; key?: string; collectionCode?: string }) {\r\n        return this.httpService.get(`${API_CUSTOMERS_URL}/list`, query);\r\n    }\r\n\r\n\r\n    searchNounProject(query: { tag?: string; key?: string; collectionCode?: string }) {\r\n        return this.httpService.get(`${API_CUSTOMERS_URL}/search/nounproject`, query);\r\n    }\r\n\r\n    render(params) {\r\n        return this.httpService.download(`projects/render`, params);\r\n    }\r\n\r\n    getProjectData(url) {\r\n        return this.httpService.getOut(url);\r\n    }\r\n\r\n    useProject(ProjectId): Observable<ProjectResultModel> {\r\n        return this.httpService.post(`${API_CUSTOMERS_URL}/${ProjectId}/use`, {}, false);\r\n    }\r\n}\r\n","import { ActionReducerMap, createFeatureSelector } from '@ngrx/store';\r\nexport interface ItemState {\r\n}\r\n\r\nexport const reducers: ActionReducerMap<ItemState> = {\r\n};\r\n\r\nexport const selectContainerState = createFeatureSelector<ItemState>('itemStore');\r\n"]}