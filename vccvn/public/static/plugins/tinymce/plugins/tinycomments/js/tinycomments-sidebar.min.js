/* Tiny Comments plugin
*
* Copyright 2010-2020 Tiny Technologies Inc. All rights reserved.
*
* Version: 2.1.4-104
*/
!function(b){"use strict";var _=function(){},d=function(t,r){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t(r.apply(null,n))}},sn=function(n){return function(){return n}},fn=function(n){return n};function g(r){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=o.concat(n);return r.apply(null,t)}}var n,e,t,r,u=function(n){return function(){throw new Error(n)}},m=sn(!1),i=sn(!0),y=sn("dismiss.popups"),p=sn("reposition.popups"),o=function(){return c},c=(n=function(n){return n.isNone()},r={fold:function(n,e){return n()},is:m,isSome:m,isNone:i,getOr:t=function(n){return n},getOrThunk:e=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:sn(null),getOrUndefined:sn(void 0),or:t,orThunk:e,map:o,each:_,bind:o,exists:m,forall:i,filter:o,equals:n,equals_:n,toArray:function(){return[]},toString:sn("none()")},Object.freeze&&Object.freeze(r),r),a=function(t){var n=sn(t),e=function(){return o},r=function(n){return n(t)},o={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:i,isNone:m,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return a(n(t))},each:function(n){n(t)},bind:r,exists:r,forall:r,filter:function(n){return n(t)?o:c},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(m,function(n){return e(t,n)})}};return o},ln={some:a,none:o,from:function(n){return null==n?c:a(n)}},s=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:sn(n)}},w={fromHtml:function(n,e){var t=(e||b.document).createElement("div");if(t.innerHTML=n,!t.hasChildNodes()||1<t.childNodes.length)throw b.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return s(t.childNodes[0])},fromTag:function(n,e){var t=(e||b.document).createElement(n);return s(t)},fromText:function(n,e){var t=(e||b.document).createTextNode(n);return s(t)},fromDom:s,fromPoint:function(n,e,t){var r=n.dom();return ln.from(r.elementFromPoint(e,t)).map(s)}},f=function(n){var e,t,r,o,i,u,c,a=w.fromDom(n.target),s=function(){n.stopPropagation()},f=function(){n.preventDefault()},l=d(f,s);return e=a,t=n.clientX,r=n.clientY,o=s,i=f,u=l,c=n,{target:sn(e),x:sn(t),y:sn(r),stop:o,prevent:i,kill:u,raw:sn(c)}},l=function(n,e,t,r,o){var i,u,c=(i=t,u=r,function(n){i(n)&&u(f(n))});return n.dom().addEventListener(e,c,o),{unbind:g(v,n,e,c,o)}},v=function(n,e,t,r){n.dom().removeEventListener(e,t,r)},h=sn(!0),x=function(n,e,t){return l(n,e,h,t,!1)},O=function(n,e,t){return l(n,e,h,t,!0)},S=function(e){return function(n){return function(n){if(null===n)return"null";var e=typeof n;return"object"===e&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===e&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":e}(n)===e}},E=S("string"),C=S("object"),k=S("array"),T=S("boolean"),M=S("function"),D=S("number"),N=function(n){if(null===n)return"null";if(void 0===n)return"undefined";var e=typeof n;return"object"===e&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===e&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":e},A=function(n){return{eq:n}},F=A(function(n,e){return n===e}),R=function(o){return A(function(n,e){if(n.length!==e.length)return!1;for(var t=n.length,r=0;r<t;r++)if(!o.eq(n[r],e[r]))return!1;return!0})},B=function(n,r){return t=R(n),o=function(n){return e=n,t=r,Array.prototype.slice.call(e).sort(t);var e,t},A(function(n,e){return t.eq(o(n),o(e))});var t,o},I=A(function(n,e){if(n===e)return!0;var c,t=N(n);return t===N(e)&&(-1!==["undefined","boolean","number","string","function","xml","null"].indexOf(t)?n===e:"array"===t?R(I).eq(n,e):"object"===t&&(c=I,A(function(n,e){var t=Object.keys(n),r=Object.keys(e);if(!B(F).eq(t,r))return!1;for(var o=t.length,i=0;i<o;i++){var u=t[i];if(!c.eq(n[u],e[u]))return!1}return!0})).eq(n,e))}),H=Array.prototype.slice,P=Array.prototype.indexOf,j=Array.prototype.push,L=function(n,e){return t=n,r=e,-1<P.call(t,r);var t,r},V=function(n,e){for(var t=0,r=n.length;t<r;t++){if(e(n[t],t))return!0}return!1},W=function(n,e){for(var t=n.length,r=new Array(t),o=0;o<t;o++){var i=n[o];r[o]=e(i,o)}return r},U=function(n,e){for(var t=0,r=n.length;t<r;t++){e(n[t],t)}},z=function(n,e){for(var t=[],r=0,o=n.length;r<o;r++){var i=n[r];e(i,r)&&t.push(i)}return t},q=function(n,e,t){return function(n,e){for(var t=n.length-1;0<=t;t--)e(n[t],t)}(n,function(n){t=e(t,n)}),t},G=function(n,e,t){return U(n,function(n){t=e(t,n)}),t},Y=function(n,e){for(var t=0,r=n.length;t<r;t++){var o=n[t];if(e(o,t))return ln.some(o)}return ln.none()},K=function(n,e){for(var t=0,r=n.length;t<r;t++){if(e(n[t],t))return ln.some(t)}return ln.none()},X=function(n){for(var e=[],t=0,r=n.length;t<r;++t){if(!k(n[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+n);j.apply(e,n[t])}return e},J=function(n,e){return X(W(n,e))},Q=function(n,e){for(var t=0,r=n.length;t<r;++t){if(!0!==e(n[t],t))return!1}return!0},$=function(n){var e=H.call(n,0);return e.reverse(),e},Z=function(n,e){return z(n,function(n){return!L(e,n)})},nn=function(n){return[n]},en=function(n){return 0===n.length?ln.none():ln.some(n[0])},tn=(M(Array.from)&&Array.from,function(n,e){for(var t=0;t<n.length;t++){var r=e(n[t],t);if(r.isSome())return r}return ln.none()}),rn=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(e.length!==t.length)throw new Error('Wrong number of arguments to struct. Expected "['+e.length+']", got '+t.length+" arguments");var r={};return U(e,function(n,e){r[n]=sn(t[e])}),r}},on=Object.keys,un=Object.hasOwnProperty,cn=function(n,e){for(var t=on(n),r=0,o=t.length;r<o;r++){var i=t[r];e(n[i],i)}},an=function(n,t){return dn(n,function(n,e){return{k:e,v:t(n,e)}})},dn=function(n,r){var o={};return cn(n,function(n,e){var t=r(n,e);o[t.k]=t.v}),o},mn=function(n,t){var r=[];return cn(n,function(n,e){r.push(t(n,e))}),r},gn=function(n,e){return pn(n,e)?ln.from(n[e]):ln.none()},pn=function(n,e){return un.call(n,e)},vn=function(n,e){return pn(n,e)&&void 0!==n[e]&&null!==n[e]},hn=function(n){return n.slice(0).sort()},bn=function(e,n){if(!k(n))throw new Error("The "+e+" fields must be an array. Was: "+n+".");U(n,function(n){if(!E(n))throw new Error("The value "+n+" in the "+e+" fields was not a string.")})},yn=function(o,i){var t,u=o.concat(i);if(0===u.length)throw new Error("You must specify at least one required or optional field.");return bn("required",o),bn("optional",i),t=hn(u),Y(t,function(n,e){return e<t.length-1&&n===t[e+1]}).each(function(n){throw new Error("The field: "+n+" occurs more than once in the combined fields: ["+t.join(", ")+"].")}),function(e){var t=on(e);Q(o,function(n){return L(t,n)})||function(n,e){throw new Error("All required keys ("+hn(n).join(", ")+") were not specified. Specified keys were: "+hn(e).join(", ")+".")}(o,t);var n=z(t,function(n){return!L(u,n)});0<n.length&&function(n){throw new Error("Unsupported keys for object: "+hn(n).join(", "))}(n);var r={};return U(o,function(n){r[n]=sn(e[n])}),U(i,function(n){r[n]=sn(Object.prototype.hasOwnProperty.call(e,n)?ln.some(e[n]):ln.none())}),r}},_n=function(n,e,t){return 0!=(n.compareDocumentPosition(e)&t)},wn=function(n,e){return _n(n,e,b.Node.DOCUMENT_POSITION_CONTAINED_BY)},xn=function(){return(xn=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}).apply(this,arguments)};function On(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]])}return t}function Sn(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;var r=Array(n),o=0;for(e=0;e<t;e++)for(var i=arguments[e],u=0,c=i.length;u<c;u++,o++)r[o]=i[u];return r}var En,Cn,kn,Tn=function(n){var e=n,t=function(){return e};return{get:t,set:function(n){e=n},clone:function(){return Tn(t())}}},Mn=function(){return Dn(0,0)},Dn=function(n,e){return{major:n,minor:e}},Nn={nu:Dn,detect:function(n,e){var t=String(e).toLowerCase();return 0===n.length?Mn():function(n,e){var t=function(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(r.test(e))return r}}(n,e);if(!t)return{major:0,minor:0};var r=function(n){return Number(e.replace(t,"$"+n))};return Dn(r(1),r(2))}(n,t)},unknown:Mn},An="Firefox",Fn=function(n,e){return function(){return e===n}},Rn=function(n){var e=n.current;return{current:e,version:n.version,isEdge:Fn("Edge",e),isChrome:Fn("Chrome",e),isIE:Fn("IE",e),isOpera:Fn("Opera",e),isFirefox:Fn(An,e),isSafari:Fn("Safari",e)}},Bn={unknown:function(){return Rn({current:void 0,version:Nn.unknown()})},nu:Rn,edge:sn("Edge"),chrome:sn("Chrome"),ie:sn("IE"),opera:sn("Opera"),firefox:sn(An),safari:sn("Safari")},In="Windows",Hn="Android",Pn="Solaris",jn="FreeBSD",Ln="ChromeOS",Vn=function(n,e){return function(){return e===n}},Wn=function(n){var e=n.current;return{current:e,version:n.version,isWindows:Vn(In,e),isiOS:Vn("iOS",e),isAndroid:Vn(Hn,e),isOSX:Vn("OSX",e),isLinux:Vn("Linux",e),isSolaris:Vn(Pn,e),isFreeBSD:Vn(jn,e),isChromeOS:Vn(Ln,e)}},Un={unknown:function(){return Wn({current:void 0,version:Nn.unknown()})},nu:Wn,windows:sn(In),ios:sn("iOS"),android:sn(Hn),linux:sn("Linux"),osx:sn("OSX"),solaris:sn(Pn),freebsd:sn(jn),chromeos:sn(Ln)},zn=function(n,e){var t=String(e).toLowerCase();return Y(n,function(n){return n.search(t)})},qn=function(n,t){return zn(n,t).map(function(n){var e=Nn.detect(n.versionRegexes,t);return{current:n.name,version:e}})},Gn=function(n,t){return zn(n,t).map(function(n){var e=Nn.detect(n.versionRegexes,t);return{current:n.name,version:e}})},Yn=function(n,e){return-1!==n.indexOf(e)},Kn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Xn=function(e){return function(n){return Yn(n,e)}},Jn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return Yn(n,"edge/")&&Yn(n,"chrome")&&Yn(n,"safari")&&Yn(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Kn],search:function(n){return Yn(n,"chrome")&&!Yn(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return Yn(n,"msie")||Yn(n,"trident")}},{name:"Opera",versionRegexes:[Kn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Xn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Xn("firefox")},{name:"Safari",versionRegexes:[Kn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(Yn(n,"safari")||Yn(n,"mobile/"))&&Yn(n,"applewebkit")}}],Qn=[{name:"Windows",search:Xn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return Yn(n,"iphone")||Yn(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Xn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Xn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Xn("linux"),versionRegexes:[]},{name:"Solaris",search:Xn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Xn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Xn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],$n={browsers:sn(Jn),oses:sn(Qn)},Zn=Tn(function(n,e){var t,r,o,i,u,c,a,s,f,l,d,m,g=$n.browsers(),p=$n.oses(),v=qn(g,n).fold(Bn.unknown,Bn.nu),h=Gn(p,n).fold(Un.unknown,Un.nu);return{browser:v,os:h,deviceType:(r=v,o=n,i=e,u=(t=h).isiOS()&&!0===/ipad/i.test(o),c=t.isiOS()&&!u,a=t.isiOS()||t.isAndroid(),s=a||i("(pointer:coarse)"),f=u||!c&&a&&i("(min-device-width:768px)"),l=c||a&&!f,d=r.isSafari()&&t.isiOS()&&!1===/safari/i.test(o),m=!l&&!f&&!d,{isiPad:sn(u),isiPhone:sn(c),isTablet:sn(f),isPhone:sn(l),isTouch:sn(s),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:sn(d),isDesktop:sn(m)})}}(b.navigator.userAgent,function(n){return b.window.matchMedia(n).matches})),ne=function(){return Zn.get()},ee=(b.Node.ATTRIBUTE_NODE,b.Node.CDATA_SECTION_NODE,b.Node.COMMENT_NODE,b.Node.DOCUMENT_NODE),te=(b.Node.DOCUMENT_TYPE_NODE,b.Node.DOCUMENT_FRAGMENT_NODE,b.Node.ELEMENT_NODE),re=b.Node.TEXT_NODE,oe=(b.Node.PROCESSING_INSTRUCTION_NODE,b.Node.ENTITY_REFERENCE_NODE,b.Node.ENTITY_NODE,b.Node.NOTATION_NODE,te),ie=ee,ue=function(n,e){var t=n.dom();if(t.nodeType!==oe)return!1;var r=t;if(void 0!==r.matches)return r.matches(e);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(e);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(e);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},ce=function(n){return n.nodeType!==oe&&n.nodeType!==ie||0===n.childElementCount},ae=function(n,e){return n.dom()===e.dom()},se=(ne().browser.isIE(),function(n){return w.fromDom(n.dom().ownerDocument)}),fe=function(n){return w.fromDom(n.dom().ownerDocument.defaultView)},le=function(n){return ln.from(n.dom().parentNode).map(w.fromDom)},de=function(n){return W(n.dom().childNodes,w.fromDom)},me=function(n,e){var t=n.dom().childNodes;return ln.from(t[e]).map(w.fromDom)},ge=function(n){return me(n,0)},pe=(rn("element","offset"),function(e,t){le(e).each(function(n){n.dom().insertBefore(t.dom(),e.dom())})}),ve=function(e,t){ge(e).fold(function(){he(e,t)},function(n){e.dom().insertBefore(t.dom(),n.dom())})},he=function(n,e){n.dom().appendChild(e.dom())},be={},ye={exports:be};Cn=be,kn=ye,En=void 0,function(n){"object"==typeof Cn&&void 0!==kn?kn.exports=n():"function"==typeof En&&En.amd?En([],n):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=n()}(function(){return function i(u,c,a){function s(e,n){if(!c[e]){if(!u[e]){var t=!1;if(!n&&t)return t(e,!0);if(f)return f(e,!0);var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}var o=c[e]={exports:{}};u[e][0].call(o.exports,function(n){return s(u[e][1][n]||n)},o,o.exports,i,u,c,a)}return c[e].exports}for(var f=!1,n=0;n<a.length;n++)s(a[n]);return s}({1:[function(n,e,t){var r,o,i=e.exports={};function u(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function a(e){if(r===setTimeout)return setTimeout(e,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(n){try{return r.call(null,e,0)}catch(n){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:u}catch(n){r=u}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(n){o=c}}();var s,f=[],l=!1,d=-1;function m(){l&&s&&(l=!1,s.length?f=s.concat(f):d=-1,f.length&&g())}function g(){if(!l){var n=a(m);l=!0;for(var e=f.length;e;){for(s=f,f=[];++d<e;)s&&s[d].run();d=-1,e=f.length}s=null,l=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(n){try{return o.call(null,e)}catch(n){return o.call(this,e)}}}(n)}}function p(n,e){this.fun=n,this.array=e}function v(){}i.nextTick=function(n){var e=new Array(arguments.length-1);if(1<arguments.length)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];f.push(new p(n,e)),1!==f.length||l||a(g)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(n){return[]},i.binding=function(n){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(n){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(n,l,e){(function(t){!function(n){var e=setTimeout;function r(){}function i(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(n,this)}function o(t,r){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,i._immediateFn(function(){var n=1===t._state?r.onFulfilled:r.onRejected;if(null!==n){var e;try{e=n(t._value)}catch(n){return void c(r.promise,n)}u(r.promise,e)}else(1===t._state?u:c)(r.promise,t._value)})):t._deferreds.push(r)}function u(e,n){try{if(n===e)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then;if(n instanceof i)return e._state=3,e._value=n,void a(e);if("function"==typeof t)return void f((r=t,o=n,function(){r.apply(o,arguments)}),e)}e._state=1,e._value=n,a(e)}catch(n){c(e,n)}var r,o}function c(n,e){n._state=2,n._value=e,a(n)}function a(n){2===n._state&&0===n._deferreds.length&&i._immediateFn(function(){n._handled||i._unhandledRejectionFn(n._value)});for(var e=0,t=n._deferreds.length;e<t;e++)o(n,n._deferreds[e]);n._deferreds=null}function s(n,e,t){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof e?e:null,this.promise=t}function f(n,e){var t=!1;try{n(function(n){t||(t=!0,u(e,n))},function(n){t||(t=!0,c(e,n))})}catch(n){if(t)return;t=!0,c(e,n)}}i.prototype.catch=function(n){return this.then(null,n)},i.prototype.then=function(n,e){var t=new this.constructor(r);return o(this,new s(n,e,t)),t},i.all=function(n){var c=Array.prototype.slice.call(n);return new i(function(r,o){if(0===c.length)return r([]);var i=c.length;function u(e,n){try{if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then;if("function"==typeof t)return void t.call(n,function(n){u(e,n)},o)}c[e]=n,0==--i&&r(c)}catch(n){o(n)}}for(var n=0;n<c.length;n++)u(n,c[n])})},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i(function(n){n(e)})},i.reject=function(t){return new i(function(n,e){e(t)})},i.race=function(o){return new i(function(n,e){for(var t=0,r=o.length;t<r;t++)o[t].then(n,e)})},i._immediateFn="function"==typeof t?function(n){t(n)}:function(n){e(n,0)},i._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},i._setImmediateFn=function(n){i._immediateFn=n},i._setUnhandledRejectionFn=function(n){i._unhandledRejectionFn=n},void 0!==l&&l.exports?l.exports=i:n.Promise||(n.Promise=i)}(this)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(a,n,s){(function(n,e){var r=a("process/browser.js").nextTick,t=Function.prototype.apply,o=Array.prototype.slice,i={},u=0;function c(n,e){this._id=n,this._clearFn=e}s.setTimeout=function(){return new c(t.call(setTimeout,window,arguments),clearTimeout)},s.setInterval=function(){return new c(t.call(setInterval,window,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(n){n.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},s.enroll=function(n,e){clearTimeout(n._idleTimeoutId),n._idleTimeout=e},s.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},s._unrefActive=s.active=function(n){clearTimeout(n._idleTimeoutId);var e=n._idleTimeout;0<=e&&(n._idleTimeoutId=setTimeout(function(){n._onTimeout&&n._onTimeout()},e))},s.setImmediate="function"==typeof n?n:function(n){var e=u++,t=!(arguments.length<2)&&o.call(arguments,1);return i[e]=!0,r(function(){i[e]&&(t?n.apply(null,t):n.call(null),s.clearImmediate(e))}),e},s.clearImmediate="function"==typeof e?e:function(n){delete i[n]}}).call(this,a("timers").setImmediate,a("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,e,t){var r=n("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")();e.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)});var _e,we,xe=ye.exports.boltExport,Oe=function(n){var t=ln.none(),e=[],r=function(n){o()?u(n):e.push(n)},o=function(){return t.isSome()},i=function(n){U(n,u)},u=function(e){t.each(function(n){b.setTimeout(function(){e(n)},0)})};return n(function(n){t=ln.some(n),i(e),e=[]}),{get:r,map:function(t){return Oe(function(e){r(function(n){e(t(n))})})},isReady:o}},Se={nu:Oe,pure:function(e){return Oe(function(n){n(e)})}},Ee=function(n){b.setTimeout(function(){throw n},0)},Ce=function(t){var n=function(n){t().then(n,Ee)};return{map:function(n){return Ce(function(){return t().then(n)})},bind:function(e){return Ce(function(){return t().then(function(n){return e(n).toPromise()})})},anonBind:function(n){return Ce(function(){return t().then(function(){return n.toPromise()})})},toLazy:function(){return Se.nu(n)},toCached:function(){var n=null;return Ce(function(){return null===n&&(n=t()),n})},toPromise:t,get:n}},ke=function(n){return Ce(function(){return new xe(n)})},Te=function(n){return Ce(function(){return xe.resolve(n)})},Me=(void 0!==b.window?b.window:Function("return this;")(),function(n){return n.dom().nodeName.toLowerCase()}),De=function(e){return function(n){return n.dom().nodeType===e}},Ne=De(te),Ae=De(re),Fe=function(n,e,t){if(!(E(t)||T(t)||D(t)))throw b.console.error("Invalid call to Attr.set. Key ",e,":: Value ",t,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,t+"")},Re=function(n,e,t){Fe(n.dom(),e,t)},Be=function(n,e){var t=n.dom();cn(e,function(n,e){Fe(t,e,n)})},Ie=function(n,e){var t=n.dom().getAttribute(e);return null===t?void 0:t},He=function(n,e){var t=n.dom();return!(!t||!t.hasAttribute)&&t.hasAttribute(e)},Pe=function(n,e){n.dom().removeAttribute(e)},je=function(t){var r,o=!1;return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return o||(o=!0,r=t.apply(null,n)),r}},Le=function(n){var e=Ae(n)?n.dom().parentNode:n.dom();return null!=e&&e.ownerDocument.body.contains(e)},Ve=(je(function(){return Ve(w.fromDom(b.document))}),function(n){var e=n.dom().body;if(null==e)throw new Error("Body is not available yet");return w.fromDom(e)}),We=(Tn(ln.none()),"_tinycomments_sidebar"),Ue=function(n){(0,tinymce[We])(n)};(we=_e||(_e={}))[we.Modern=0]="Modern",we[we.Silver=1]="Silver";var ze,qe,Ge=function(t){return{is:function(n){return t===n},isValue:i,isError:m,getOr:sn(t),getOrThunk:sn(t),getOrDie:sn(t),or:function(n){return Ge(t)},orThunk:function(n){return Ge(t)},fold:function(n,e){return e(t)},map:function(n){return Ge(n(t))},mapError:function(n){return Ge(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOption:function(){return ln.some(t)}}},Ye=function(t){return{is:m,isValue:m,isError:i,getOr:fn,getOrThunk:function(n){return n()},getOrDie:function(){return u(String(t))()},or:function(n){return n},orThunk:function(n){return n()},fold:function(n,e){return n(t)},map:function(n){return Ye(t)},mapError:function(n){return Ye(n(t))},each:_,bind:function(n){return Ye(t)},exists:m,forall:i,toOption:ln.none}},Ke={value:Ge,error:Ye,fromOption:function(n,e){return n.fold(function(){return Ye(e)},Ge)}},Xe=function(i){return xn(xn({},i),{toCached:function(){return Xe(i.toCached())},bindFuture:function(e){return Xe(i.bind(function(n){return n.fold(function(n){return Te(Ke.error(n))},function(n){return e(n)})}))},bindResult:function(e){return Xe(i.map(function(n){return n.bind(e)}))},mapResult:function(e){return Xe(i.map(function(n){return n.map(e)}))},mapError:function(e){return Xe(i.map(function(n){return n.mapError(e)}))},foldResult:function(e,t){return i.map(function(n){return n.fold(e,t)})},withTimeout:function(n,o){return Xe(ke(function(e){var t=!1,r=b.setTimeout(function(){t=!0,e(Ke.error(o()))},n);i.get(function(n){t||(b.clearTimeout(r),e(n))})}))}})},Je=function(n){return Xe(ke(n))},Qe=function(n){return Xe(Te(Ke.value(n)))},$e={nu:Je,wrap:Xe,pure:Qe,value:Qe,error:function(n){return Xe(Te(Ke.error(n)))},fromResult:function(n){return Xe(Te(n))},fromFuture:function(n){return Xe(n.map(Ke.value))},fromPromise:function(n){return Je(function(e){n.then(function(n){e(Ke.value(n))},function(n){e(Ke.error(n))})})}},Ze=function(n,e){var t=Ie(n,e);return void 0===t||""===t?[]:t.split(" ")},nt=function(n){return void 0!==n.dom().classList},et=function(n,e){return o=e,i=Ze(t=n,r="class").concat([o]),Re(t,r,i.join(" ")),!0;var t,r,o,i},tt=function(n,e){return o=e,0<(i=z(Ze(t=n,r="class"),function(n){return n!==o})).length?Re(t,r,i.join(" ")):Pe(t,r),!1;var t,r,o,i},rt=function(n,e){nt(n)?n.dom().classList.add(e):et(n,e)},ot=function(n){0===(nt(n)?n.dom().classList:Ze(n,"class")).length&&Pe(n,"class")},it=function(n,e){nt(n)?n.dom().classList.remove(e):tt(n,e);ot(n)},ut=function(n,e){return nt(n)&&n.dom().classList.contains(e)},ct=function(n,e){return t=e,o=void 0===(r=n)?b.document:r.dom(),ce(o)?[]:W(o.querySelectorAll(t),w.fromDom);var t,r,o},at=sn("tox-comment--active"),st=(sn("data-mce-annotation-uid"),sn("data-mce-annotation"),sn("tinycomments"));function ft(e,u,o,c){var t=function(n,e){o.notificationManager.open({text:n,type:"error"}),e&&console.error(n,e)},r=function(n,e){return{view:{type:"splash"},grabFocus:function(){return 1===n||e}}},i=function(n,i){u.set(n),u.get().fold(function(){return $e.pure({response:ze.Change,update:r(i,c.hasFocus())})},function(n){return e.lookup({conversationUid:n}).foldResult(function(n){return Ke.value({response:ze.Change,update:r(i,c.hasFocus())})},function(e){var n,t,r,o=u.get().forall(function(n){return n!==e.conversation.uid});return Ke.value(o?{response:ze.NoChange}:{response:ze.Change,update:(n=i,t=c.hasFocus(),r=e.conversation,{view:{type:"comments",conversation:r},grabFocus:function(){return t||L([1,3,4],n)}})})})}).get(function(n){return n.fold(function(n){t("An error occurred reading the conversation. See the Console for details.",n)},function(n){n.response===ze.Change&&c.update(n.update)})})},a=function(n){var e="."+at(),t=w.fromDom(n.getBody()),r=ct(t,e);U(r,function(n){it(n,at())})};return{refreshSidebar:i,refreshView:function(n){n.fold(function(){a(o),i(ln.none(),0)},function(n){var e,t=n.uid,r=n.nodes;e=r,a(o),U(e,function(n){rt(n,at())}),i(ln.some(t),0)})},setReadonly:function(n){c.setReadonly(n)},showError:t}}(qe=ze||(ze={}))[qe.Change=0]="Change",qe[qe.NoChange=1]="NoChange";var lt,dt,mt=function(u){if(!k(u))throw new Error("cases must be an array");if(0===u.length)throw new Error("there must be at least one case");var c=[],t={};return U(u,function(n,r){var e=on(n);if(1!==e.length)throw new Error("one and only one name per case");var o=e[0],i=n[o];if(void 0!==t[o])throw new Error("duplicate key detected:"+o);if("cata"===o)throw new Error("cannot have a case named cata (sorry)");if(!k(i))throw new Error("case arguments must be an array");c.push(o),t[o]=function(){var n=arguments.length;if(n!==i.length)throw new Error("Wrong number of arguments to case "+o+". Expected "+i.length+" ("+i+"), got "+n);for(var t=new Array(n),e=0;e<t.length;e++)t[e]=arguments[e];return{fold:function(){if(arguments.length!==u.length)throw new Error("Wrong number of arguments to fold. Expected "+u.length+", got "+arguments.length);return arguments[r].apply(null,t)},match:function(n){var e=on(n);if(c.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+c.join(",")+"\nActual: "+e.join(","));if(!Q(c,function(n){return L(e,n)}))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+c.join(", "));return n[o].apply(null,t)},log:function(n){b.console.log(n,{constructors:c,constructor:o,params:t})}}}}),t},gt=Object.prototype.hasOwnProperty,pt=function(u){return function(){for(var n=new Array(arguments.length),e=0;e<n.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var t={},r=0;r<n.length;r++){var o=n[r];for(var i in o)gt.call(o,i)&&(t[i]=u(t[i],o[i]))}return t}},vt=pt(function(n,e){return C(n)&&C(e)?vt(n,e):e}),ht=pt(function(n,e){return e});(dt=lt||(lt={}))[dt.Error=0]="Error",dt[dt.Value=1]="Value";var bt,yt=function(n,e,t){return n.stype===lt.Error?e(n.serror):t(n.svalue)},_t=function(n){return{stype:lt.Value,svalue:n}},wt=function(n){return{stype:lt.Error,serror:n}},xt=function(n){return n.fold(wt,_t)},Ot=function(n){return yt(n,Ke.error,Ke.value)},St=_t,Et=function(n){var e=[],t=[];return U(n,function(n){yt(n,function(n){return t.push(n)},function(n){return e.push(n)})}),{values:e,errors:t}},Ct=wt,kt=function(n,e){return n.stype===lt.Value?e(n.svalue):n},Tt=function(n,e){return n.stype===lt.Error?e(n.serror):n},Mt=function(n,e){return n.stype===lt.Value?{stype:lt.Value,svalue:e(n.svalue)}:n},Dt=function(n,e){return n.stype===lt.Error?{stype:lt.Error,serror:e(n.serror)}:n},Nt=mt([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),At=function(n){return Nt.defaultedThunk(sn(n))},Ft=Nt.strict,Rt=Nt.asOption,Bt=Nt.defaultedThunk,It=(Nt.asDefaultedOptionThunk,Nt.mergeWithThunk),Ht=function(n,e){var t;return(t={})[n]=e,t},Pt=(mt([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(n,e){return Ht(n,e)}),jt=function(n){return e={},U(n,function(n){e[n.key]=n.value}),e;var e},Lt=function(n,e){var t,r,o,i,u,c=(t=[],r=[],U(n,function(n){n.fold(function(n){t.push(n)},function(n){r.push(n)})}),{errors:t,values:r});return 0<c.errors.length?(u=c.errors,Ke.error(X(u))):(i=e,0===(o=c.values).length?Ke.value(i):Ke.value(vt(i,ht.apply(void 0,o))))},Vt=function(n){return d(Ct,X)(n)},Wt=function(n,e){var t,r,o=Et(n);return 0<o.errors.length?Vt(o.errors):(t=o.values,r=e,0<t.length?St(vt(r,ht.apply(void 0,t))):St(r))},Ut=function(n){var e=Et(n);return 0<e.errors.length?Vt(e.errors):St(e.values)},zt=function(n){return C(n)&&100<on(n).length?" removed due to size":JSON.stringify(n,null,2)},qt=function(n,e){return Ct([{path:n,getErrorInfo:e}])},Gt=mt([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),Yt=function(t,r,o){return gn(r,o).fold(function(){return n=o,e=r,qt(t,function(){return'Could not find valid *strict* value for "'+n+'" in '+zt(e)});var n,e},St)},Kt=function(n,e,t){var r=gn(n,e).fold(function(){return t(n)},fn);return St(r)},Xt=function(c,a,n,s){return n.fold(function(o,t,n,r){var i=function(n){var e=r.extract(c.concat([o]),s,n);return Mt(e,function(n){return Ht(t,s(n))})},u=function(n){return n.fold(function(){var n=Ht(t,s(ln.none()));return St(n)},function(n){var e=r.extract(c.concat([o]),s,n);return Mt(e,function(n){return Ht(t,s(ln.some(n)))})})};return n.fold(function(){return kt(Yt(c,a,o),i)},function(n){return kt(Kt(a,o,n),i)},function(){return kt(St(gn(a,o)),u)},function(n){return kt((t=n,r=gn(e=a,o).map(function(n){return!0===n?t(e):n}),St(r)),u);var e,t,r},function(n){var e=n(a),t=Mt(Kt(a,o,sn({})),function(n){return vt(e,n)});return kt(t,i)})},function(n,e){var t=e(a);return St(Ht(n,s(t)))})},Jt=function(r){return{extract:function(t,n,e){return Tt(r(e,n),function(n){return e=n,qt(t,function(){return e});var e})},toString:function(){return"val"}}},Qt=function(n){var a=$t(n),s=q(n,function(e,n){return n.fold(function(n){return vt(e,Pt(n,!0))},sn(e))},{});return{extract:function(n,e,t){var r,o,i,u=T(t)?[]:(o=on(r=t),z(o,function(n){return vn(r,n)})),c=z(u,function(n){return!vn(s,n)});return 0===c.length?a.extract(n,e,t):(i=c,qt(n,function(){return"There are unsupported fields: ["+i.join(", ")+"] specified"}))},toString:a.toString}},$t=function(c){return{extract:function(n,e,t){return r=n,o=t,i=e,u=W(c,function(n){return Xt(r,o,n,i)}),Wt(u,{});var r,o,i,u},toString:function(){return"obj{\n"+W(c,function(n){return n.fold(function(n,e,t,r){return n+" -> "+r.toString()},function(n,e){return"state("+n+")"})}).join("\n")+"}"}}},Zt=function(t,i){var u=function(n,e){return(o=Jt(t),{extract:function(t,r,n){var e=W(n,function(n,e){return o.extract(t.concat(["["+e+"]"]),r,n)});return Ut(e)},toString:function(){return"array("+o.toString()+")"}}).extract(n,fn,e);var o};return{extract:function(t,r,o){var n=on(o),e=u(t,n);return kt(e,function(n){var e=W(n,function(n){return Gt.field(n,n,Ft(),i)});return $t(e).extract(t,r,o)})},toString:function(){return"setOf("+i.toString()+")"}}},nr=sn(Jt(St)),er=Gt.state,tr=Gt.field,rr=function(t,e,r,o,i){return gn(o,i).fold(function(){return n=o,e=i,qt(t,function(){return'The chosen schema: "'+e+'" did not exist in branches: '+zt(n)});var n,e},function(n){return n.extract(t.concat(["branch: "+i]),e,r)})},or=function(o,i){return{extract:function(e,t,r){return gn(r,o).fold(function(){return n=o,qt(e,function(){return'Choice schema did not contain choice key: "'+n+'"'});var n},function(n){return rr(e,t,r,i,n)})},toString:function(){return"chooseOn("+o+"). Possible values: "+on(i)}}},ir=Jt(St),ur=function(e){return Jt(function(n){return e(n).fold(Ct,St)})},cr=function(e,n){return Zt(function(n){return xt(e(n))},n)},ar=function(n,e,t){return Ot((r=n,o=fn,i=t,u=e.extract([r],o,i),Dt(u,function(n){return{input:i,errors:n}})));var r,o,i,u},sr=function(n){return n.fold(function(n){throw new Error(lr(n))},fn)},fr=function(n,e,t){return sr(ar(n,e,t))},lr=function(n){return"Errors: \n"+(e=n.errors,t=10<e.length?e.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):e,W(t,function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()})).join("\n")+"\n\nInput object: "+zt(n.input);var e,t},dr=function(n,e){return or(n,an(e,$t))},mr=sn(ir),gr=function(t,r){return Jt(function(n){var e=typeof n;return t(n)?St(n):Ct("Expected type: "+r+" but got: "+e)})},pr=gr(T,"boolean"),vr=gr(M,"function"),hr=function(n){return tr(n,n,Ft(),nr())},br=function(n,e){return tr(n,n,Ft(),e)},yr=function(n){return br(n,vr)},_r=function(n,e){return tr(n,n,Ft(),$t(e))},wr=function(n){return tr(n,n,Rt(),nr())},xr=function(n,e){return tr(n,n,Rt(),e)},Or=function(n,e){return xr(n,$t(e))},Sr=function(n,e){return xr(n,Qt(e))},Er=function(n,e){return tr(n,n,At(e),nr())},Cr=function(n,e,t){return tr(n,n,At(e),t)},kr=function(n,e){return er(n,e)},Tr={init:function(){return Mr({readState:function(){return"No State required"}})}},Mr=function(n){return n},Dr=function(n,e,t){return e(n).orThunk(function(){return t(n)?ln.none():function(n,e,t){for(var r=n.dom(),o=M(t)?t:sn(!1);r.parentNode;){r=r.parentNode;var i=w.fromDom(r),u=e(i);if(u.isSome())return u;if(o(i))break}return ln.none()}(n,e,t)})},Nr=function(n,e){return ae(n.element(),e.event().target())},Ar=function(n){if(!vn(n,"can")&&!vn(n,"abort")&&!vn(n,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(n,null,2)+" does not have can, abort, or run!");return fr("Extracting event.handler",Qt([Er("can",sn(!0)),Er("abort",sn(!1)),Er("run",_)]),n)},Fr=function(t){var e,r,o,i,n=(e=t,r=function(n){return n.can},function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return G(e,function(n,e){return n&&r(e).apply(void 0,t)},!0)}),u=(o=t,i=function(n){return n.abort},function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return G(o,function(n,e){return n||i(e).apply(void 0,t)},!1)});return Ar({can:n,abort:u,run:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];U(t,function(n){n.run.apply(void 0,e)})}})},Rr=sn("touchstart"),Br=sn("touchmove"),Ir=sn("touchend"),Hr=sn("mousedown"),Pr=sn("mouseover"),jr=sn("keydown"),Lr=sn("keyup"),Vr=sn("input"),Wr=sn("click"),Ur=sn("transitionend"),zr={tap:sn("alloy.tap")},qr=sn("alloy.focus"),Gr=sn("alloy.blur.post"),Yr=sn("alloy.paste.post"),Kr=sn("alloy.receive"),Xr=sn("alloy.execute"),Jr=sn("alloy.focus.item"),Qr=zr.tap,$r=sn("alloy.longpress"),Zr=sn("alloy.sandbox.close"),no=sn("alloy.system.init"),eo=sn("alloy.system.attached"),to=sn("alloy.system.detached"),ro=sn("alloy.system.dismissRequested"),oo=sn("alloy.system.repositionRequested"),io=sn("alloy.focusmanager.shifted"),uo=sn("alloy.highlight"),co=sn("alloy.dehighlight"),ao=function(n,e){mo(n,n.element(),e,{})},so=function(n,e,t){mo(n,n.element(),e,t)},fo=function(n){ao(n,Xr())},lo=function(n,e,t){mo(n,e,t,{})},mo=function(n,e,t,r){var o=xn({target:e},r);n.getSystem().triggerEvent(t,e,an(o,sn))},go=function(n){return jt(n)},po=function(n,e){return{key:n,value:Ar({run:e})}},vo=function(n){return function(t){return{key:n,value:Ar({run:function(n,e){Nr(n,e)&&t(n,e)}})}}},ho=function(n){return po(n,function(n,e){e.cut()})},bo=vo(eo()),yo=vo(to()),_o=vo(no()),wo=(bt=Xr(),function(n){return po(bt,n)}),xo=function(n){return W(n,function(n){return r=e="/*",o=(t=n).length-e.length,""!==r&&(t.length<r.length||t.substr(o,o+r.length)!==r)?n:n.substring(0,n.length-"/*".length);var e,t,r,o})},Oo=function(n,e){var t=n.toString(),r=t.indexOf(")")+1,o=t.indexOf("("),i=t.substring(o+1,r-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:e,parameters:xo(i)}},n},So=function(n){return{classes:void 0!==n.classes?n.classes:[],attributes:void 0!==n.attributes?n.attributes:{},styles:void 0!==n.styles?n.styles:{}}},Eo=function(t,r,o){return _o(function(n,e){o(n,t,r)})},Co=function(o,i,u){var n,e,t,r,c,a;return n=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];var r=[t].concat(n);return t.config({name:sn(o)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+o+". Using API: "+u)},function(n){var e=Array.prototype.slice.call(r,1);return i.apply(void 0,[t,n.config,n.state].concat(e))})},e=u,t=i.toString(),r=t.indexOf(")")+1,c=t.indexOf("("),a=t.substring(c+1,r-1).split(/,\s*/),n.toFunctionAnnotation=function(){return{name:e,parameters:xo(a.slice(0,1).concat(a.slice(3)))}},n},ko=function(n){return{key:n,value:void 0}},To=function(t,n,r,o,e,i,u){var c=function(n){return vn(n,r)?n[r]():ln.none()},a=an(e,function(n,e){return Co(r,n,e)}),s=an(i,function(n,e){return Oo(n,e)}),f=xn(xn(xn({},s),a),{revoke:g(ko,r),config:function(n){var e=fr(r+"-config",t,n);return{key:r,value:{config:e,me:f,configAsRaw:je(function(){return fr(r+"-config",t,n)}),initialConfig:n,state:u}}},schema:function(){return n},exhibit:function(n,t){return c(n).bind(function(e){return gn(o,"exhibit").map(function(n){return n(t,e.config,e.state)})}).getOr(So({}))},name:function(){return r},handlers:function(n){return c(n).map(function(n){return gn(o,"events").getOr(function(){return{}})(n.config,n.state)}).getOr({})}});return f},Mo=function(n){return jt(n)},Do=Qt([hr("fields"),hr("name"),Er("active",{}),Er("apis",{}),Er("state",Tr),Er("extra",{})]),No=function(n){var e,t,r,o,i,u,c,a,s=fr("Creating behaviour: "+n.name,Do,n);return e=s.fields,t=s.name,r=s.active,o=s.apis,i=s.extra,u=s.state,c=Qt(e),a=Or(t,[Sr("config",e)]),To(c,a,t,r,o,i,u)},Ao=Qt([hr("branchKey"),hr("branches"),hr("name"),Er("active",{}),Er("apis",{}),Er("state",Tr),Er("extra",{})]),Fo=sn(void 0),Ro=function(n,e){var t,r;return{key:n,value:{config:{},me:(t=n,r=go(e),No({fields:[hr("enabled")],name:t,active:{events:sn(r)}})),configAsRaw:sn({}),initialConfig:{},state:Tr}}};function Bo(n,e,t,r,o){return n(t,r)?ln.some(t):M(o)&&o(t)?ln.none():e(t,r,o)}var Io,Ho,Po=function(n,e,t){for(var r=n.dom(),o=M(t)?t:sn(!1);r.parentNode;){r=r.parentNode;var i=w.fromDom(r);if(e(i))return ln.some(i);if(o(i))break}return ln.none()},jo=function(n,e,t){return Bo(function(n,e){return e(n)},Po,n,e,t)},Lo=function(n,e,t){return jo(n,e,t).isSome()},Vo=function(n){n.dom().focus()},Wo=function(n){var e=void 0!==n?n.dom():b.document;return ln.from(e.activeElement).map(w.fromDom)},Uo=function(e){return Wo(se(e)).filter(function(n){return e.dom().contains(n.dom())})},zo=function(e,n){U(n,function(n){he(e,n)})},qo=function(n){n.dom().textContent="",U(de(n),function(n){Go(n)})},Go=function(n){var e=n.dom();null!==e.parentNode&&e.parentNode.removeChild(e)},Yo=function(n){return n.dom().innerHTML},Ko=function(n,e){var t,r,o=se(n).dom(),i=w.fromDom(o.createDocumentFragment()),u=(t=e,(r=(o||b.document).createElement("div")).innerHTML=t,de(w.fromDom(r)));zo(i,u),qo(n),he(n,i)},Xo=function(n){return e=n,t=!1,w.fromDom(e.dom().cloneNode(t));var e,t},Jo=function(n){var e,t,r,o=Xo(n);return e=o,t=w.fromTag("div"),r=w.fromDom(e.dom().cloneNode(!0)),he(t,r),Yo(t)},Qo=function(n){return Jo(n)},$o="unknown";(Ho=Io||(Io={}))[Ho.STOP=0]="STOP",Ho[Ho.NORMAL=1]="NORMAL",Ho[Ho.LOGGING=2]="LOGGING";var Zo=Tn({}),ni=function(e,n,t){var r,o,i,u;switch(gn(Zo.get(),e).orThunk(function(){var n=on(Zo.get());return tn(n,function(n){return-1<e.indexOf(n)?ln.some(Zo.get()[n]):ln.none()})}).getOr(Io.NORMAL)){case Io.NORMAL:return t(ri());case Io.LOGGING:var c=(r=e,o=n,i=[],u=(new Date).getTime(),{logEventCut:function(n,e,t){i.push({outcome:"cut",target:e,purpose:t})},logEventStopped:function(n,e,t){i.push({outcome:"stopped",target:e,purpose:t})},logNoParent:function(n,e,t){i.push({outcome:"no-parent",target:e,purpose:t})},logEventNoHandlers:function(n,e){i.push({outcome:"no-handlers-left",target:e})},logEventResponse:function(n,e,t){i.push({outcome:"response",purpose:t,target:e})},write:function(){var n=(new Date).getTime();L(["mousemove","mouseover","mouseout",no()],r)||b.console.log(r,{event:r,time:n-u,target:o.dom(),sequence:W(i,function(n){return L(["cut","stopped","response"],n.outcome)?"{"+n.purpose+"} "+n.outcome+" at ("+Qo(n.target)+")":n.outcome})})}}),a=t(c);return c.write(),a;case Io.STOP:return!0}},ei=["alloy/data/Fields","alloy/debugging/Debugging"],ti=function(n,e,t){return ni(n,e,t)},ri=sn({logEventCut:_,logEventStopped:_,logNoParent:_,logEventNoHandlers:_,logEventResponse:_,write:_}),oi=function(n,e){return t=g.apply(void 0,[n.handler].concat(e)),r=n.purpose(),{cHandler:t,purpose:sn(r)};var t,r},ii=function(n){return n.cHandler},ui=function(n,e,t){return Po(n,function(n){return ue(n,e)},t)},ci=function(n,e){return t=e,o=void 0===(r=n)?b.document:r.dom(),ce(o)?ln.none():ln.from(o.querySelector(t)).map(w.fromDom);var t,r,o},ai=function(n,e,t){return Bo(ue,ui,n,e,t)};var si=function(n){var e=n.raw();return void 0===e.touches||1!==e.touches.length?ln.none():ln.some(e.touches[0])},fi=function(t){var r,o,i,u=Tn(ln.none()),c=Tn(!1),a=(r=function(n){t.triggerEvent($r(),n),c.set(!0)},o=400,i=null,{cancel:function(){null!==i&&(b.clearTimeout(i),i=null)},schedule:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];i=b.setTimeout(function(){r.apply(null,n),i=null},o)}}),s=jt([{key:Rr(),value:function(t){return si(t).each(function(n){a.cancel();var e={x:sn(n.clientX),y:sn(n.clientY),target:t.target};a.schedule(t),c.set(!1),u.set(ln.some(e))}),ln.none()}},{key:Br(),value:function(n){return a.cancel(),si(n).each(function(i){u.get().each(function(n){var e,t,r,o;e=i,t=n,r=Math.abs(e.clientX-t.x()),o=Math.abs(e.clientY-t.y()),(5<r||5<o)&&u.set(ln.none())})}),ln.none()}},{key:Ir(),value:function(e){a.cancel();return u.get().filter(function(n){return ae(n.target(),e.target())}).map(function(n){return c.get()?(e.prevent(),!1):t.triggerEvent(Qr(),e)})}}]);return{fireIfReady:function(e,n){return gn(s,n).bind(function(n){return n(e)})}}},li=function(n){var e,t;return 8===n.raw().which&&!L(["input","textarea"],Me(n.target()))&&(e=n.target(),!ai(e,'[contenteditable="true"]',t).isSome())},di=ne().browser.isFirefox(),mi=Qt([yr("triggerEvent"),Er("stopBackspace",!0)]),gi=function(e,n){var t,r,o,i,u=fr("Getting GUI events settings",mi,n),c=fi(u),a=W(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(n){return x(e,n,function(e){c.fireIfReady(e,n).each(function(n){n&&e.kill()}),u.triggerEvent(n,e)&&e.kill()})}),s=Tn(ln.none()),f=x(e,"paste",function(e){c.fireIfReady(e,"paste").each(function(n){n&&e.kill()}),u.triggerEvent("paste",e)&&e.kill(),s.set(ln.some(b.setTimeout(function(){u.triggerEvent(Yr(),e)},0)))}),l=x(e,"keydown",function(n){u.triggerEvent("keydown",n)?n.kill():!0===u.stopBackspace&&li(n)&&n.prevent()}),d=(t=e,r=function(n){u.triggerEvent("focusin",n)&&n.kill()},di?O(t,"focus",r):x(t,"focusin",r)),m=Tn(ln.none()),g=(o=e,i=function(n){u.triggerEvent("focusout",n)&&n.kill(),m.set(ln.some(b.setTimeout(function(){u.triggerEvent(Gr(),n)},0)))},di?O(o,"blur",i):x(o,"focusout",i));return{unbind:function(){U(a,function(n){n.unbind()}),l.unbind(),d.unbind(),g.unbind(),f.unbind(),s.get().each(b.clearTimeout),m.get().each(b.clearTimeout)}}},pi=function(n,e){var t=gn(n,"target").map(function(n){return n()}).getOr(e);return Tn(t)},vi=mt([{stopped:[]},{resume:["element"]},{complete:[]}]),hi=function(n,r,e,t,o,i){var u,c,a,s,f=n(r,t),l=(u=e,c=o,a=Tn(!1),s=Tn(!1),{stop:function(){a.set(!0)},cut:function(){s.set(!0)},isStopped:a.get,isCut:s.get,event:sn(u),setSource:c.set,getSource:c.get});return f.fold(function(){return i.logEventNoHandlers(r,t),vi.complete()},function(e){var t=e.descHandler();return ii(t)(l),l.isStopped()?(i.logEventStopped(r,e.element(),t.purpose()),vi.stopped()):l.isCut()?(i.logEventCut(r,e.element(),t.purpose()),vi.complete()):le(e.element()).fold(function(){return i.logNoParent(r,e.element(),t.purpose()),vi.complete()},function(n){return i.logEventResponse(r,e.element(),t.purpose()),vi.resume(n)})})},bi=function(e,t,r,n,o,i){return hi(e,t,r,n,o,i).fold(function(){return!0},function(n){return bi(e,t,r,n,o,i)},function(){return!1})},yi=function(n,e,t){var r,o,i=(r=e,o=Tn(!1),{stop:function(){o.set(!0)},cut:_,isStopped:o.get,isCut:sn(!1),event:sn(r),setSource:u("Cannot set source of a broadcasted event"),getSource:u("Cannot get source of a broadcasted event")});return U(n,function(n){var e=n.descHandler();ii(e)(i)}),i.isStopped()},_i=function(n,e,t,r,o){var i=pi(t,r);return bi(n,e,t,r,i,o)},wi=0,xi=function(n){var e=(new Date).getTime();return n+"_"+Math.floor(1e9*Math.random())+ ++wi+String(e)},Oi=sn("alloy-id-"),Si=sn("data-alloy-id"),Ei=Oi(),Ci=Si(),ki=function(n,e){Object.defineProperty(n.dom(),Ci,{value:e,writable:!0})},Ti=function(n){var e=Ne(n)?n.dom()[Ci]:null;return ln.from(e)},Mi=function(n){return xi(n)},Di=rn("element","descHandler"),Ni=function(n,e){return{id:sn(n),descHandler:sn(e)}};function Ai(){var i={};return{registerId:function(r,o,n){cn(n,function(n,e){var t=void 0!==i[e]?i[e]:{};t[o]=oi(n,r),i[e]=t})},unregisterId:function(t){cn(i,function(n,e){n.hasOwnProperty(t)&&delete n[t]})},filterByType:function(n){return gn(i,n).map(function(n){return mn(n,function(n,e){return Ni(e,n)})}).getOr([])},find:function(n,e,t){var o=gn(i,e);return Dr(t,function(n){return t=o,Ti(r=n).fold(function(){return ln.none()},function(e){return t.bind(function(n){return gn(n,e)}).map(function(n){return Di(r,n)})});var t,r},n)}}}function Fi(){var r=Ai(),o={},i=function(r){var n=r.element();return Ti(n).fold(function(){return n="uid-",e=r.element(),t=xi(Ei+n),ki(e,t),t;var n,e,t},function(n){return n})},u=function(n){Ti(n.element()).each(function(n){delete o[n],r.unregisterId(n)})};return{find:function(n,e,t){return r.find(n,e,t)},filter:function(n){return r.filterByType(n)},register:function(n){var e=i(n);vn(o,e)&&function(n,e){var t=o[e];if(t!==n)throw new Error('The tagId "'+e+'" is already used by: '+Qo(t.element())+"\nCannot use it for: "+Qo(n.element())+"\nThe conflicting element is"+(Le(t.element())?" ":" not ")+"already in the DOM");u(n)}(n,e);var t=[n];r.registerId(t,e,n.events()),o[e]=n},unregister:u,getById:function(n){return gn(o,n)}}}var Ri,Bi,Ii=go([(Ri=qr(),Bi=function(n,e){var t,r,o=e.event().originator(),i=e.event().target();return r=i,!(ae(t=o,n.element())&&!ae(t,r))||(b.console.warn(qr()+" did not get interpreted by the desired target. \nOriginator: "+Qo(o)+"\nTarget: "+Qo(i)+"\nCheck the "+qr()+" event handlers"),!1)},{key:Ri,value:Ar({can:Bi})})]),Hi=Object.freeze({__proto__:null,events:Ii}),Pi=fn,ji=function(e){var n=function(n){return function(){throw new Error("The component must be in a context to send: "+n+(e?"\n"+Qo(e().element())+" is not in context.":""))}};return{debugInfo:sn("fake"),triggerEvent:n("triggerEvent"),triggerFocus:n("triggerFocus"),triggerEscape:n("triggerEscape"),build:n("build"),addToWorld:n("addToWorld"),removeFromWorld:n("removeFromWorld"),addToGui:n("addToGui"),removeFromGui:n("removeFromGui"),getByUid:n("getByUid"),getByDom:n("getByDom"),broadcast:n("broadcast"),broadcastOn:n("broadcastOn"),broadcastEvent:n("broadcastEvent"),isConnected:sn(!1)}},Li=ji(),Vi=xi("alloy-premade"),Wi=function(n){return Pt(Vi,n)},Ui=function(r){return n=function(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return r.apply(void 0,[n.getApis()].concat([n].concat(e)))},e=r.toString(),t=e.indexOf(")")+1,o=e.indexOf("("),i=e.substring(o+1,t-1).split(/,\s*/),n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:xo(i.slice(1))}},n;var n,e,t,o,i},zi=function(n,o){var i={};return cn(n,function(n,r){cn(n,function(n,e){var t=gn(i,e).getOr([]);i[e]=t.concat([o(r,n)])})}),i},qi=function(u,c,n,a){try{var e=(t=n,r=function(n,e){var t=n[c](),r=e[c](),o=a.indexOf(t),i=a.indexOf(r);if(-1===o)throw new Error("The ordering for "+u+" does not have an entry for "+t+".\nOrder specified: "+JSON.stringify(a,null,2));if(-1===i)throw new Error("The ordering for "+u+" does not have an entry for "+r+".\nOrder specified: "+JSON.stringify(a,null,2));return o<i?-1:i<o?1:0},(o=H.call(t,0)).sort(r),o);return Ke.value(e)}catch(n){return Ke.error([n])}var t,r,o},Gi=function(n,e){return{name:sn(n),handler:sn(e)}},Yi=function(n,e,t){var r,o,i=xn(xn({},t),(r=n,o={},U(e,function(n){o[n.name()]=n.handlers(r)}),o));return zi(i,Gi)},Ki=function(n){var e,i=M(e=n)?{can:sn(!0),abort:sn(!1),run:e}:e;return function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var o=[n,e].concat(t);i.abort.apply(void 0,o)?e.stop():i.can.apply(void 0,o)&&i.run.apply(void 0,o)}},Xi=function(n,e,t){var r,o,i=e[t];return i?qi("Event: "+t,"name",n,i).map(function(n){var e=W(n,function(n){return n.handler()});return Fr(e)}):(r=t,o=n,Ke.error(["The event ("+r+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(W(o,function(n){return n.name()}),null,2)]))},Ji=function(n,i){var e=mn(n,function(r,o){return(1===r.length?Ke.value(r[0].handler()):Xi(r,i,o)).map(function(n){var e=Ki(n),t=1<r.length?z(i[o],function(e){return V(r,function(n){return n.name()===e})}).join(" > "):r[0].name();return Pt(o,{handler:e,purpose:sn(t)})})});return Lt(e,{})},Qi=function(n){return ar("custom.definition",$t([tr("dom","dom",Ft(),$t([hr("tag"),Er("styles",{}),Er("classes",[]),Er("attributes",{}),wr("value"),wr("innerHtml")])),hr("components"),hr("uid"),Er("events",{}),Er("apis",{}),tr("eventOrder","eventOrder",(e={"alloy.execute":["disabling","alloy.base.behaviour","toggling","typeaheadevents"],"alloy.focus":["alloy.base.behaviour","focusing","keying"],"alloy.system.init":["alloy.base.behaviour","disabling","toggling","representing"],input:["alloy.base.behaviour","representing","streaming","invalidating"],"alloy.system.detached":["alloy.base.behaviour","representing","item-events","tooltipping"],mousedown:["focusing","alloy.base.behaviour","item-type-events"],touchstart:["focusing","alloy.base.behaviour","item-type-events"],mouseover:["item-type-events","tooltipping"]},Nt.mergeWithThunk(sn(e))),mr()),wr("domModification")]),n);var e},$i=function(e,n){U(n,function(n){rt(e,n)})},Zi=function(e,n){U(n,function(n){it(e,n)})},nu=function(n){return void 0!==n.style&&M(n.style.getPropertyValue)},eu=function(n,e,t){if(!E(t))throw b.console.error("Invalid call to CSS.set. Property ",e,":: Value ",t,":: Element ",n),new Error("CSS value must be a string: "+t);nu(n)&&n.style.setProperty(e,t)},tu=function(n,e){nu(n)&&n.style.removeProperty(e)},ru=function(n,e,t){var r=n.dom();eu(r,e,t)},ou=function(n,e){var t=n.dom();cn(e,function(n,e){eu(t,e,n)})},iu=function(n,e){var t=n.dom(),r=b.window.getComputedStyle(t).getPropertyValue(e),o=""!==r||Le(n)?r:uu(t,e);return null===o?void 0:o},uu=function(n,e){return nu(n)?n.style.getPropertyValue(e):""},cu=function(n,e){var t=n.dom(),r=uu(t,e);return ln.from(r).filter(function(n){return 0<n.length})},au=function(n,e){var t=n.dom();tu(t,e),He(n,"style")&&""===Ie(n,"style").replace(/^\s+|\s+$/g,"")&&Pe(n,"style")},su=function(n){return n.dom().value},fu=function(n,e){if(void 0===e)throw new Error("Value.set was undefined");n.dom().value=e},lu=function(n,e){return t=n,o=W(r=e,function(n){return Or(n.name(),[hr("config"),Er("state",Tr)])}),i=ar("component.behaviours",$t(o),t.behaviours).fold(function(n){throw new Error(lr(n)+"\nComplete spec:\n"+JSON.stringify(t,null,2))},function(n){return n}),{list:r,data:an(i,function(n){var e=n.map(function(n){return{config:n.config,state:n.state.init(n.config)}});return function(){return e}})};var t,r,o,i},du=function(n){var e,t,r=(e=gn(n,"behaviours").getOr({}),t=z(on(e),function(n){return void 0!==e[n]}),W(t,function(n){return e[n].me}));return lu(n,r)},mu=function(n,e,t){var r,o,i,u=xn(xn({},(r=n).dom),{uid:r.uid,domChildren:W(r.components,function(n){return n.element()})}),c=n.domModification.fold(function(){return So({})},So),a={"alloy.base.modification":c},s=0<e.length?function(e,n,t,r){var o=xn({},n);U(t,function(n){o[n.name()]=n.exhibit(e,r)});var i=zi(o,function(n,e){return{name:n,modification:e}}),u=function(n){return q(n,function(n,e){return xn(xn({},e.modification),n)},{})},c=q(i.classes,function(n,e){return e.modification.concat(n)},[]),a=u(i.attributes),s=u(i.styles);return So({classes:c,attributes:a,styles:s})}(t,a,e,u):c;return i=s,xn(xn({},o=u),{attributes:xn(xn({},o.attributes),i.attributes),styles:xn(xn({},o.styles),i.styles),classes:o.classes.concat(i.classes)})},gu=function(n,e,t){var r,o,i,u,c,a,s={"alloy.base.behaviour":(r=n,r.events)};return(o=t,i=n.eventOrder,u=e,c=s,a=Yi(o,u,c),Ji(a,i)).getOrDie()},pu=function(t){var n=function(){return f},r=Tn(Li),e=sr(Qi(t)),o=du(t),i=o.list,u=o.data,c=function(n){var e=w.fromTag(n.tag);Be(e,n.attributes),$i(e,n.classes),ou(e,n.styles),n.innerHtml.each(function(n){return Ko(e,n)});var t=n.domChildren;return zo(e,t),n.value.each(function(n){fu(e,n)}),n.uid,ki(e,n.uid),e}(mu(e,i,u)),a=gu(e,i,u),s=Tn(e.components),f={getSystem:r.get,config:function(n){var e=u;return(M(e[n.name()])?e[n.name()]:function(){throw new Error("Could not find "+n.name()+" in "+JSON.stringify(t,null,2))})()},hasConfigured:function(n){return M(u[n.name()])},spec:sn(t),readState:function(n){return u[n]().map(function(n){return n.state.readState()}).getOr("not enabled")},getApis:function(){return e.apis},connect:function(n){r.set(n)},disconnect:function(){r.set(ji(n))},element:sn(c),syncComponents:function(){var n=de(c),e=J(n,function(n){return r.get().getByDom(n).fold(function(){return[]},function(n){return[n]})});s.set(e)},components:s.get,events:sn(a)};return f},vu=function(n){var e,t=Pi(n),r=t.events,o=On(t,["events"]),i=(e=gn(o,"components").getOr([]),W(e,yu)),u=xn(xn({},o),{events:xn(xn({},Hi),r),components:i});return Ke.value(pu(u))},hu=function(n){var e=fr("external.component",Qt([hr("element"),wr("uid")]),n),t=Tn(ji());e.uid.each(function(n){ki(e.element,n)});var r={getSystem:t.get,config:ln.none,hasConfigured:sn(!1),connect:function(n){t.set(n)},disconnect:function(){t.set(ji(function(){return r}))},getApis:function(){return{}},element:sn(e.element),spec:sn(n),readState:sn("No state"),syncComponents:_,components:sn([]),events:sn({})};return Wi(r)},bu=Mi,yu=function(e){return(n=e,gn(n,Vi)).fold(function(){var n=e.hasOwnProperty("uid")?e:xn({uid:bu("")},e);return vu(n).getOrDie()},function(n){return n});var n},_u=Wi,wu=function(r,n){return e=r,t={},o=W(n,function(n){return e=n.name(),t="Cannot configure "+n.name()+" for "+r,tr(e,e,Rt(),Jt(function(n){return Ct("The field: "+e+" is forbidden. "+t)}));var e,t}).concat([kr("dump",fn)]),Cr(e,t,$t(o));var e,t,o},xu=function(n){return n.dump},Ou=function(n,e){return xn(xn({},n.dump),Mo(e))},Su=wu,Eu=Ou,Cu=sn([hr("menu"),hr("selectedMenu")]),ku=sn([hr("item"),hr("selectedItem")]),Tu=(sn($t(ku().concat(Cu()))),sn($t(ku()))),Mu=_r("initSize",[hr("numColumns"),hr("numRows")]),Du=function(){return _r("markers",[hr("backgroundMenu")].concat(Cu()).concat(ku()))},Nu=function(n,e,t){!function(){var n=new Error;if(void 0===n.stack)return;var e=n.stack.split("\n");Y(e,function(e){return 0<e.indexOf("alloy")&&!V(ei,function(n){return-1<e.indexOf(n)})}).getOr($o)}();return tr(e,e,t,ur(function(t){return Ke.value(function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(void 0,n)})}))},Au=function(n){return Nu(0,n,At(_))},Fu=function(n){return Nu(0,n,At(ln.none))},Ru=function(n){return Nu(0,n,Ft())},Bu=function(n){return Nu(0,n,Ft())},Iu=function(n,e){return kr(n,sn(e))},Hu=function(n){return kr(n,fn)},Pu=sn(Mu),ju="placeholder",Lu=mt([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Vu=function(n){return pn(n,"uiType")},Wu=function(n,e,t,r){return Vu(t)&&t.uiType===ju?(i=t,u=r,(o=n).exists(function(n){return n!==i.owner})?Lu.single(!0,sn(i)):gn(u,i.name).fold(function(){throw new Error("Unknown placeholder component: "+i.name+"\nKnown: ["+on(u)+"]\nNamespace: "+o.getOr("none")+"\nSpec: "+JSON.stringify(i,null,2))},function(n){return n.replace()})):Lu.single(!1,sn(t));var o,i,u},Uu=function(i,u,c,a){return Wu(i,0,c,a).fold(function(n,e){var t=Vu(c)?e(u,c.config,c.validated):e(u),r=gn(t,"components").getOr([]),o=J(r,function(n){return Uu(i,u,n,a)});return[xn(xn({},t),{components:o})]},function(n,e){if(Vu(c)){var t=e(u,c.config,c.validated);return c.validated.preprocess.getOr(fn)(t)}return e(u)})},zu=function(e,t,n,r){var o,i,u,c=an(r,function(n,e){return r=n,o=!1,{name:sn(t=e),required:function(){return r.fold(function(n,e){return n},function(n,e){return n})},used:function(){return o},replace:function(){if(o)throw new Error("Trying to use the same placeholder more than once: "+t);return o=!0,r}};var t,r,o}),a=(o=e,i=t,u=c,J(n,function(n){return Uu(o,i,n,u)}));return cn(c,function(n){if(!1===n.used()&&n.required())throw new Error("Placeholder: "+n.name()+" was not found in components list\nNamespace: "+e.getOr("none")+"\nComponents: "+JSON.stringify(t.components,null,2))}),a},qu=Lu.single,Gu=Lu.multiple,Yu=sn(ju),Ku=mt([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),Xu=Er("factory",{sketch:fn}),Ju=Er("schema",[]),Qu=hr("name"),$u=tr("pname","pname",Bt(function(n){return"<alloy."+xi(n.name)+">"}),mr()),Zu=kr("schema",function(){return[wr("preprocess")]}),nc=Er("defaults",sn({})),ec=Er("overrides",sn({})),tc=$t([Xu,Ju,Qu,$u,nc,ec]),rc=$t([Xu,Ju,Qu,nc,ec]),oc=$t([Xu,Ju,Qu,$u,nc,ec]),ic=$t([Xu,Zu,Qu,hr("unit"),$u,nc,ec]),uc=function(n){var e=function(n){return n.name};return n.fold(e,e,e,e)},cc=function(t,r){return function(n){var e=fr("Converting part type",r,n);return t(e)}},ac=cc(Ku.required,tc),sc=cc(Ku.external,rc),fc=cc(Ku.optional,oc),lc=cc(Ku.group,ic),dc=sn("entirety"),mc=function(n,e,t,r){return vt(e.defaults(n,t,r),t,{uid:n.partUids[e.name]},e.overrides(n,t,r))},gc=function(o,n){var i={};return U(n,function(n){var e;(e=n,e.fold(ln.some,ln.none,ln.some,ln.some)).each(function(t){var r=pc(o,t.pname);i[t.name]=function(n){var e=fr("Part: "+t.name+" in "+o,$t(t.schema),n);return xn(xn({},r),{config:n,validated:e})}})}),i},pc=function(n,e){return{uiType:Yu(),owner:n,name:e}},vc=function(n,e,t){return r=e,i={},o={},U(t,function(n){n.fold(function(r){i[r.pname]=qu(!0,function(n,e,t){return r.factory.sketch(mc(n,r,e,t))})},function(n){var e=r.parts[n.name];o[n.name]=sn(n.factory.sketch(mc(r,n,e[dc()]),e))},function(r){i[r.pname]=qu(!1,function(n,e,t){return r.factory.sketch(mc(n,r,e,t))})},function(o){i[o.pname]=Gu(!0,function(e,n,t){var r=e[o.name];return W(r,function(n){return o.factory.sketch(vt(o.defaults(e,n,t),n,o.overrides(e,n)))})})})}),{internals:sn(i),externals:sn(o)};var r,i,o},hc=function(n,e,t){return zu(ln.some(n),e,e.components,t)},bc=function(e,n){var t=W(n,uc);return jt(W(t,function(n){return{key:n,value:e+"-"+n}}))},yc=function(e){return tr("partUids","partUids",It(function(n){return bc(n.uid,e)}),mr())},_c=function(n,e,t,r,o){var i,u,c=(u=o,(0<(i=r).length?[_r("parts",i)]:[]).concat([hr("uid"),Er("dom",{}),Er("components",[]),Hu("originalSpec"),Er("debug.sketcher",{})]).concat(u));return fr(n+" [SpecSchema]",Qt(c.concat(e)),t)},wc=function(n,e,t,r,o){var i=xc(o),u=J(t,function(n){return n.fold(ln.none,ln.some,ln.none,ln.none).map(function(n){return _r(n.name,n.schema.concat([Hu(dc())]))}).toArray()}),c=yc(t),a=_c(n,e,i,u,[c]),s=vc(0,a,t);return r(a,hc(n,a,s.internals()),i,s.externals())},xc=function(n){return pn(n,"uid")?n:xn(xn({},n),{uid:Mi("uid")})};var Oc=Qt([hr("name"),hr("factory"),hr("configFields"),Er("apis",{}),Er("extraApis",{})]),Sc=Qt([hr("name"),hr("factory"),hr("configFields"),hr("partFields"),Er("apis",{}),Er("extraApis",{})]),Ec=function(n){var i=fr("Sketcher for "+n.name,Oc,n),e=an(i.apis,Ui),t=an(i.extraApis,function(n,e){return Oo(n,e)});return xn(xn({name:sn(i.name),configFields:sn(i.configFields),sketch:function(n){return e=i.name,t=i.configFields,r=i.factory,o=xc(n),r(_c(e,t,o,[],[]),o);var e,t,r,o}},e),t)},Cc=function(n){var e=fr("Sketcher for "+n.name,Sc,n),t=gc(e.name,e.partFields),r=an(e.apis,Ui),o=an(e.extraApis,function(n,e){return Oo(n,e)});return xn(xn({name:sn(e.name),partFields:sn(e.partFields),configFields:sn(e.configFields),sketch:function(n){return wc(e.name,e.configFields,e.partFields,e.factory,n)},parts:sn(t)},r),o)},kc=(Ec({name:"Container",factory:function(n){var e=n.dom,t=e.attributes,r=On(e,["attributes"]);return{uid:n.uid,dom:xn({tag:"div",attributes:xn({role:"presentation"},t)},r),components:n.components,behaviours:xu(n.containerBehaviours),events:n.events,domModification:n.domModification,eventOrder:n.eventOrder}},configFields:[Er("components",[]),wu("containerBehaviours",[]),Er("events",{}),Er("domModification",{}),Er("eventOrder",{})]}),function(n){ao(n,to());var e=n.components();U(e,kc)}),Tc=function(n){var e=n.components();U(e,Tc),ao(n,eo())},Mc=function(n,e){he(n.element(),e.element())},Dc=function(e,n){var t,r=e.components();U((t=e).components(),function(n){return Go(n.element())}),qo(t.element()),t.syncComponents();var o=Z(r,n);U(o,function(n){kc(n),e.getSystem().removeFromWorld(n)}),U(n,function(n){n.getSystem().isConnected()?Mc(e,n):(e.getSystem().addToWorld(n),Mc(e,n),Le(e.element())&&Tc(n)),e.syncComponents()})},Nc=function(n,e){Ac(n,e,he)},Ac=function(n,e,t){n.getSystem().addToWorld(e),t(n.element(),e.element()),Le(n.element())&&Tc(e),n.syncComponents()},Fc=function(n){kc(n),Go(n.element()),n.getSystem().removeFromWorld(n)},Rc=function(e){var n=le(e.element()).bind(function(n){return e.getSystem().getByDom(n).toOption()});Fc(e),n.each(function(n){n.syncComponents()})},Bc=function(n){var e=n.components();U(e,Fc),qo(n.element()),n.syncComponents()},Ic=function(t){var r=function(e){return le(t.element()).fold(function(){return!0},function(n){return ae(e,n)})},o=Fi(),s=function(n,e){return o.find(r,n,e)},n=gi(t.element(),{triggerEvent:function(u,c){return ti(u,c.target(),function(n){return e=s,t=u,o=n,i=(r=c).target(),_i(e,t,r,i,o);var e,t,r,o,i})}}),i={debugInfo:sn("real"),triggerEvent:function(e,t,r){ti(e,t,function(n){return _i(s,e,r,t,n)})},triggerFocus:function(c,a){Ti(c).fold(function(){Vo(c)},function(n){ti(qr(),c,function(n){var e,t,r,o,i,u;return e=s,t=qr(),r={originator:sn(a),kill:_,prevent:_,target:sn(c)},i=n,u=pi(r,o=c),hi(e,t,r,o,u,i),!1})})},triggerEscape:function(n,e){i.triggerEvent("keydown",n.element(),e.event())},getByUid:function(n){return g(n)},getByDom:function(n){return p(n)},build:yu,addToGui:function(n){c(n)},removeFromGui:function(n){a(n)},addToWorld:function(n){e(n)},removeFromWorld:function(n){u(n)},broadcast:function(n){l(n)},broadcastOn:function(n,e){d(n,e)},broadcastEvent:function(n,e){m(n,e)},isConnected:sn(!0)},e=function(n){n.connect(i),Ae(n.element())||(o.register(n),U(n.components(),e),i.triggerEvent(no(),n.element(),{target:sn(n.element())}))},u=function(n){Ae(n.element())||(U(n.components(),u),o.unregister(n)),n.disconnect()},c=function(n){Nc(t,n)},a=function(n){Rc(n)},f=function(t){var n=o.filter(Kr());U(n,function(n){var e=n.descHandler();ii(e)(t)})},l=function(n){f({universal:sn(!0),data:sn(n)})},d=function(n,e){f({universal:sn(!1),channels:sn(n),data:sn(e)})},m=function(n,e){var t=o.filter(n);return yi(t,e)},g=function(n){return o.getById(n).fold(function(){return Ke.error(new Error('Could not find component with uid: "'+n+'" in system.'))},Ke.value)},p=function(n){var e=Ti(n).getOr("not found");return g(e)};return e(t),{root:sn(t),element:t.element,destroy:function(){n.unbind(),Go(t.element())},add:c,remove:a,getByUid:g,getByDom:p,addToWorld:e,removeFromWorld:u,broadcast:l,broadcastOn:d,broadcastEvent:m}},Hc=function(n){var e=void 0!==n.uid&&vn(n,"uid")?n.uid:Mi("memento");return{get:function(n){return n.getSystem().getByUid(e).getOrDie()},getOpt:function(n){return n.getSystem().getByUid(e).toOption()},asSpec:function(){return xn(xn({},n),{uid:e})}}},Pc=Object.freeze({__proto__:null,exhibit:function(n,e){return So({classes:[],styles:e.useFixed()?{}:{position:"relative"}})}}),jc=function(t,r){return{left:sn(t),top:sn(r),translate:function(n,e){return jc(t+n,r+e)}}},Lc=jc,Vc=function(n,e){return void 0!==n?n:void 0!==e?e:0},Wc=function(n){var e=n.dom().ownerDocument,t=e.body,r=e.defaultView,o=e.documentElement;if(t===n.dom())return Lc(t.offsetLeft,t.offsetTop);var i=Vc(r.pageYOffset,o.scrollTop),u=Vc(r.pageXOffset,o.scrollLeft),c=Vc(o.clientTop,t.clientTop),a=Vc(o.clientLeft,t.clientLeft);return Uc(n).translate(u-a,i-c)},Uc=function(n){var e,t=n.dom(),r=t.ownerDocument.body;return r===t?Lc(r.offsetLeft,r.offsetTop):Le(n)?(e=t.getBoundingClientRect(),Lc(e.left,e.top)):Lc(0,0)};function zc(r,o){var n=function(n){var e=o(n);if(e<=0||null===e){var t=iu(n,r);return parseFloat(t)||0}return e},i=function(o,n){return G(n,function(n,e){var t=iu(o,e),r=void 0===t?0:parseInt(t,10);return isNaN(r)?n:n+r},0)};return{set:function(n,e){if(!D(e)&&!e.match(/^[0-9]+$/))throw new Error(r+".set accepts only positive integer values. Value was "+e);var t=n.dom();nu(t)&&(t.style[r]=e+"px")},get:n,getOuter:n,aggregate:i,max:function(n,e,t){var r=i(n,t);return r<e?e-r:0}}}var qc,Gc,Yc=zc("height",function(n){var e=n.dom();return Le(n)?e.getBoundingClientRect().height:e.offsetHeight}),Kc=function(n){return Yc.getOuter(n)},Xc=zc("width",function(n){return n.dom().offsetWidth}),Jc=function(n){return Xc.getOuter(n)},Qc=(ne().browser.isSafari(),function(n){var e=void 0!==n?n.dom():b.document,t=e.body.scrollLeft||e.documentElement.scrollLeft,r=e.body.scrollTop||e.documentElement.scrollTop;return Lc(t,r)}),$c=function(n,e,t,r){return{x:sn(n),y:sn(e),width:sn(t),height:sn(r),right:sn(n+t),bottom:sn(e+r)}},Zc=function(n){var e,t,r=void 0===n?b.window:n,o=r.document,i=Qc(w.fromDom(o));return(e=r,t=void 0===e?b.window:e,ln.from(t.visualViewport)).fold(function(){var n=r.document.documentElement,e=n.clientWidth,t=n.clientHeight;return $c(i.left(),i.top(),e,t)},function(n){return $c(Math.max(n.pageLeft,i.left()),Math.max(n.pageTop,i.top()),n.width,n.height)})},na=function(r,n){return r.view(n).fold(sn([]),function(n){var e=r.owner(n),t=na(r,e);return[n].concat(t)})},ea=Object.freeze({__proto__:null,view:function(n){return(n.dom()===b.document?ln.none():ln.from(n.dom().defaultView.frameElement)).map(w.fromDom)},owner:function(n){return se(n)}}),ta=function(r){var n,e,t,o,i=w.fromDom(b.document),u=Qc(i);return(n=r,t=(e=ea).owner(n),o=na(e,t),ln.some(o)).fold(g(Wc,r),function(n){var e=Uc(r),t=q(n,function(n,e){var t=Uc(e);return{left:n.left+t.left(),top:n.top+t.top()}},{left:0,top:0});return Lc(t.left+e.left()+u.left(),t.top+e.top()+u.top())})},ra=rn("point","width","height"),oa=rn("x","y","width","height"),ia=function(n,e,t,r){return{x:sn(n),y:sn(e),width:sn(t),height:sn(r),right:sn(n+t),bottom:sn(e+r)}},ua=function(n){var e=Wc(n),t=Jc(n),r=Kc(n);return ia(e.left(),e.top(),t,r)},ca=function(){return Zc(b.window)},aa=function(n,t){var r=se(t),e=Wo(r).bind(function(e){var o,i,n=function(n){return ae(e,n)};return n(t)?ln.some(t):(o=n,(i=function(n){for(var e=0;e<n.childNodes.length;e++){var t=w.fromDom(n.childNodes[e]);if(o(t))return ln.some(t);var r=i(n.childNodes[e]);if(r.isSome())return r}return ln.none()})(t.dom()))}),o=n(t);return e.each(function(e){Wo(r).filter(function(n){return ae(n,e)}).fold(function(){Vo(e)},_)}),o},sa=mt([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),fa=sa.southeast,la=sa.southwest,da=sa.northeast,ma=sa.northwest,ga=sa.south,pa=sa.north,va=sa.east,ha=sa.west,ba=rn("position","left","top","right","bottom"),ya=function(n,e){var t,r,o,i=function(n){return n+"px"};t=n,r={position:ln.some(e.position()),left:e.left().map(i),top:e.top().map(i),right:e.right().map(i),bottom:e.bottom().map(i)},o=t.dom(),cn(r,function(n,e){n.fold(function(){tu(o,e)},function(n){eu(o,e,n)})})},_a=mt([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),wa=function(n,e,t,r,o,i){var u,c,a,s,f,l,d,m,g,p=e.x()-t,v=e.y()-r,h=o-(p+e.width()),b=i-(v+e.height()),y=ln.some(p),_=ln.some(v),w=ln.some(h),x=ln.some(b),O=ln.none();return u=e.direction(),c=function(){return ba(n,y,_,O,O)},a=function(){return ba(n,O,_,w,O)},s=function(){return ba(n,y,O,O,x)},f=function(){return ba(n,O,O,w,x)},l=function(){return ba(n,y,_,O,O)},d=function(){return ba(n,y,O,O,x)},m=function(){return ba(n,y,_,O,O)},g=function(){return ba(n,O,_,w,O)},u.fold(c,a,s,f,l,d,m,g)},xa=function(n,e){var t=g(ta,e),r=n.fold(t,t,function(){var n=Qc();return ta(e).translate(-n.left(),-n.top())}),o=Jc(e),i=Kc(e);return ia(r.left(),r.top(),o,i)},Oa=function(n,e,t){var r=Lc(e,t);return n.fold(sn(r),sn(r),function(){var n=Qc();return r.translate(-n.left(),-n.top())})},Sa=(_a.none,_a.relative),Ea=_a.fixed,Ca=rn("anchorBox","origin"),ka=function(n,e,t,r){var o=n+e;return r<o?t:o<t?r:o},Ta=function(n,e,t){return Math.min(Math.max(n,e),t)},Ma=function(e,t){return function(n,e){for(var t={},r=0,o=n.length;r<o;r++){var i=n[r];t[String(i)]=e(i,r)}return t}(["left","right","top","bottom"],function(n){return gn(t,n).map(function(n){return function(n,e){switch(e){case 1:return n.x();case 0:return n.x()+n.width();case 2:return n.y();case 3:return n.y()+n.height()}}(e,n)})})},Da=yn(["x","y","width","height","maxHeight","maxWidth","direction","classes","label","candidateYforTest"],[]),Na=mt([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),Aa=function(n,e,t,r){var o,i,u,c,a,s,f,l,d,m,g,p,v,h,b,y,_,w,x,O,S,E,C,k,T,M,D,N,A,F,R,B,I,H=n.x(),P=n.y(),j=n.bubble().offset(),L=j.left(),V=j.top(),W=(o=r,i=n.boundsRestriction(),u=j,a=(c=function(e,t){var r="top"===e||"bottom"===e?u.top():u.left();return gn(i,e).bind(fn).bind(function(n){return"left"===e||"top"===e?t<=n?ln.some(n):ln.none():n<=t?ln.some(n):ln.none()}).map(function(n){return n+r}).getOr(t)})("left",o.x()),s=c("top",o.y()),f=c("right",o.right()),l=c("bottom",o.bottom()),ia(a,s,f-a,l-s)),U=W.y(),z=W.bottom(),q=W.x(),G=W.right(),Y=P+V,K=(d=H+L,m=Y,g=e,p=t,h=(v=W).x(),b=v.y(),y=v.width(),_=v.height(),x=b<=m,O=(w=h<=d)&&x,S=d+g<=h+y&&m+p<=b+_,E=Math.abs(Math.min(g,w?h+y-d:h-(d+g))),C=Math.abs(Math.min(p,x?b+_-m:b-(m+p))),k=Math.max(v.x(),v.right()-g),T=Math.max(v.y(),v.bottom()-p),{originInBounds:O,sizeInBounds:S,limitX:Ta(d,v.x(),k),limitY:Ta(m,v.y(),T),deltaW:E,deltaH:C}),X=K.originInBounds,J=K.sizeInBounds,Q=K.limitX,$=K.limitY,Z=K.deltaW,nn=K.deltaH,en=sn($+nn-U),tn=sn(z-$),rn=(M=n.direction(),N=D=tn,A=en,M.fold(D,D,A,A,D,A,N,N)),on=sn(Q+Z-q),un=sn(G-Q),cn=(F=n.direction(),B=R=un,I=on,F.fold(R,I,R,I,B,B,R,I)),an=Da({x:Q,y:$,width:Z,height:nn,maxHeight:rn,maxWidth:cn,direction:n.direction(),classes:{on:n.bubble().classesOn(),off:n.bubble().classesOff()},label:n.label(),candidateYforTest:Y});return X&&J?Na.fit(an):Na.nofit(an,Z,nn)},Fa=function(n,e,t,r){au(e,"max-height"),au(e,"max-width");var o,i,u,c,a,s,f,l,d,m={width:sn(Jc(o=e)),height:sn(Kc(o))};return i=r.preference(),u=n,c=m,a=t,s=r.bounds(),f=c.width(),l=c.height(),d=function(n,r,o,i){var e=n(u,c,a);return Aa(e,f,l,s).fold(Na.fit,function(n,e,t){return i<t||o<e?Na.nofit(n,e,t):Na.nofit(r,o,i)})},G(i,function(n,e){var t=g(d,e);return n.fold(Na.fit,t)},Na.nofit(Da({x:u.x(),y:u.y(),width:c.width(),height:c.height(),maxHeight:c.height(),maxWidth:c.width(),direction:fa(),classes:{on:[],off:[]},label:"none",candidateYforTest:u.y()}),-1,-1)).fold(fn,fn)},Ra=function(n,e,t){var r,o;ya(n,(r=t.origin(),o=e,r.fold(function(){return ba("absolute",ln.some(o.x()),ln.some(o.y()),ln.none(),ln.none())},function(n,e,t,r){return wa("absolute",o,n,e,t,r)},function(n,e,t,r){return wa("fixed",o,n,e,t,r)})))},Ba=function(n,e){var t,r,o;t=n,r=Math.floor(e),o=Yc.max(t,r,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]),ru(t,"max-height",o+"px")},Ia=sn(function(n,e){Ba(n,e),ou(n,{"overflow-x":"hidden","overflow-y":"auto"})}),Ha=yn(["bounds","origin","preference","maxHeightFunction","maxWidthFunction"],[]),Pa=function(n,e,t){return void 0===n[e]?t:n[e]},ja=function(n,e,t,r,o,i){var u,c,a=Pa(i,"maxHeightFunction",Ia()),s=Pa(i,"maxWidthFunction",_),f=n.anchorBox(),l=n.origin(),d=Ha({bounds:(u=l,c=o,c.fold(function(){return u.fold(ca,ca,ia)},function(t){return u.fold(t,t,function(){var n=t(),e=Oa(u,n.x(),n.y());return ia(e.left(),e.top(),n.width(),n.height())})})),origin:l,preference:r,maxHeightFunction:a,maxWidthFunction:s});La(f,e,t,d)},La=function(n,e,t,r){var o,i,u,c,a,s,f=Fa(n,e,t,r);Ra(e,f,r),o=e,i=f.classes(),Zi(o,i.off),$i(o,i.on),u=e,c=f,r.maxHeightFunction()(u,c.maxHeight()),a=e,s=f,r.maxWidthFunction()(a,s.maxWidth())},Va=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],Wa=function(){return e=n=0,t={},o=function(n){return gn(t,n).getOr([])},r=function(n,e,t){var r=Z(Va,t);return{offset:function(){return Lc(n,e)},classesOn:function(){return J(t,o)},classesOff:function(){return J(r,o)}}},{southeast:function(){return r(-n,e,["top","alignLeft"])},southwest:function(){return r(n,e,["top","alignRight"])},south:function(){return r(-n/2,e,["top","alignCentre"])},northeast:function(){return r(-n,-e,["bottom","alignLeft"])},northwest:function(){return r(n,-e,["bottom","alignRight"])},north:function(){return r(-n/2,-e,["bottom","alignCentre"])},east:function(){return r(n,-e/2,["valignCentre","left"])},west:function(){return r(-n,-e/2,["valignCentre","right"])},innerNorthwest:function(){return r(-n,e,["top","alignRight"])},innerNortheast:function(){return r(n,e,["top","alignLeft"])},innerNorth:function(){return r(-n/2,e,["top","alignCentre"])},innerSouthwest:function(){return r(-n,-e,["bottom","alignRight"])},innerSoutheast:function(){return r(n,-e,["bottom","alignLeft"])},innerSouth:function(){return r(-n/2,-e,["bottom","alignCentre"])},innerWest:function(){return r(n,-e/2,["valignCentre","right"])},innerEast:function(){return r(-n,-e/2,["valignCentre","left"])}};var n,e,t,o,r},Ua=rn("x","y","bubble","direction","boundsRestriction","label"),za=function(n){return n.x()},qa=function(n,e){return n.x()+n.width()/2-e.width()/2},Ga=function(n,e){return n.x()+n.width()-e.width()},Ya=function(n,e){return n.y()-e.height()},Ka=function(n){return n.y()+n.height()},Xa=function(n,e){return n.y()+n.height()/2-e.height()/2},Ja=function(n,e,t){return Ua(za(n),Ka(n),t.southeast(),fa(),Ma(n,{left:1,top:3}),"layout-se")},Qa=function(n,e,t){return Ua(Ga(n,e),Ka(n),t.southwest(),la(),Ma(n,{right:0,top:3}),"layout-sw")},$a=function(n,e,t){return Ua(za(n),Ya(n,e),t.northeast(),da(),Ma(n,{left:1,bottom:2}),"layout-ne")},Za=function(n,e,t){return Ua(Ga(n,e),Ya(n,e),t.northwest(),ma(),Ma(n,{right:0,bottom:2}),"layout-nw")},ns=function(n,e,t){return Ua(qa(n,e),Ya(n,e),t.north(),pa(),Ma(n,{bottom:2}),"layout-n")},es=function(n,e,t){return Ua(qa(n,e),Ka(n),t.south(),ga(),Ma(n,{top:3}),"layout-s")},ts=function(n,e,t){return Ua((r=n).x()+r.width(),Xa(n,e),t.east(),va(),Ma(n,{left:0}),"layout-e");var r},rs=function(n,e,t){return Ua((r=e,n.x()-r.width()),Xa(n,e),t.west(),ha(),Ma(n,{right:1}),"layout-w");var r},os=function(){return[Ja,Qa,$a,Za,es,ns,ts,rs]},is=function(){return[Qa,Ja,Za,$a,es,ns,ts,rs]},us=function(){return[$a,Za,Ja,Qa,ns,es]},cs=function(){return[Ja,Qa,$a,Za,es,ns]},as=function(){return[Qa,Ja,Za,$a,es,ns]},ss=function(n){return n},fs=function(e,t){return function(n){return"rtl"===ls(n)?t:e}},ls=function(n){return"rtl"===iu(n,"direction")?"rtl":"ltr"};(Gc=qc||(qc={})).TopToBottom="toptobottom",Gc.BottomToTop="bottomtotop";var ds=function(n){return Lo(n,function(n){return Ne(n)&&Ie(n,"data-alloy-vertical-dir")===qc.BottomToTop})},ms=function(){return Or("layouts",[hr("onLtr"),hr("onRtl"),wr("onBottomLtr"),wr("onBottomRtl")])},gs=function(e,n,t,r,o,i,u){var c=u.map(ds).getOr(!1),a=n.layouts.map(function(n){return n.onLtr(e)}),s=n.layouts.map(function(n){return n.onRtl(e)}),f=c?n.layouts.bind(function(n){return n.onBottomLtr.map(function(n){return n(e)})}).or(a).getOr(o):a.getOr(t),l=c?n.layouts.bind(function(n){return n.onBottomRtl.map(function(n){return n(e)})}).or(s).getOr(i):s.getOr(r);return fs(f,l)(e)},ps=[hr("hotspot"),wr("bubble"),Er("overrides",{}),ms(),Iu("placement",function(n,e,t){var r=e.hotspot,o=xa(t,r.element()),i=gs(n.element(),e,cs(),as(),us(),[Za,$a,Qa,Ja,ns,es],ln.some(e.hotspot.element()));return ln.some(ss({anchorBox:o,bubble:e.bubble.getOr(Wa()),overrides:e.overrides,layouts:i,placer:ln.none()}))})],vs=[hr("x"),hr("y"),Er("height",0),Er("width",0),Er("bubble",Wa()),Er("overrides",{}),ms(),Iu("placement",function(n,e,t){var r=Oa(t,e.x,e.y),o=ia(r.left(),r.top(),e.width,e.height),i=gs(n.element(),e,os(),is(),os(),is(),ln.none());return ln.some(ss({anchorBox:o,bubble:e.bubble,overrides:e.overrides,layouts:i,placer:ln.none()}))})],hs={create:rn("start","soffset","finish","foffset")},bs=mt([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),ys=(bs.before,bs.on,bs.after,function(n){return n.fold(fn,fn,fn)}),_s=mt([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),ws={domRange:_s.domRange,relative:_s.relative,exact:_s.exact,exactFromRange:function(n){return _s.exact(n.start(),n.soffset(),n.finish(),n.foffset())},getWin:function(n){var e=n.match({domRange:function(n){return w.fromDom(n.startContainer)},relative:function(n,e){return ys(n)},exact:function(n,e,t,r){return n}});return fe(e)},range:hs.create},xs=function(n,e,t){var r,o,i=n.document.createRange();return r=i,e.fold(function(n){r.setStartBefore(n.dom())},function(n,e){r.setStart(n.dom(),e)},function(n){r.setStartAfter(n.dom())}),o=i,t.fold(function(n){o.setEndBefore(n.dom())},function(n,e){o.setEnd(n.dom(),e)},function(n){o.setEndAfter(n.dom())}),i},Os=function(n,e,t,r,o){var i=n.document.createRange();return i.setStart(e.dom(),t),i.setEnd(r.dom(),o),i},Ss=function(n){return{left:sn(n.left),top:sn(n.top),right:sn(n.right),bottom:sn(n.bottom),width:sn(n.width),height:sn(n.height)}},Es=mt([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Cs=function(n,e,t){return e(w.fromDom(t.startContainer),t.startOffset,w.fromDom(t.endContainer),t.endOffset)},ks=function(n,e){var o,t,r,i=(o=n,e.match({domRange:function(n){return{ltr:sn(n),rtl:ln.none}},relative:function(n,e){return{ltr:je(function(){return xs(o,n,e)}),rtl:je(function(){return ln.some(xs(o,e,n))})}},exact:function(n,e,t,r){return{ltr:je(function(){return Os(o,n,e,t,r)}),rtl:je(function(){return ln.some(Os(o,t,r,n,e))})}}}));return(r=(t=i).ltr()).collapsed?t.rtl().filter(function(n){return!1===n.collapsed}).map(function(n){return Es.rtl(w.fromDom(n.endContainer),n.endOffset,w.fromDom(n.startContainer),n.startOffset)}).getOrThunk(function(){return Cs(0,Es.ltr,r)}):Cs(0,Es.ltr,r)};Es.ltr,Es.rtl;var Ts,Ms,Ds,Ns,As,Fs,Rs,Bs=(Ts=Ae,Ms="text",{get:function(n){if(!Ts(n))throw new Error("Can only get "+Ms+" value of a "+Ms+" node");return Ds(n).getOr("")},getOption:Ds=function(n){return Ts(n)?ln.from(n.dom().nodeValue):ln.none()},set:function(n,e){if(!Ts(n))throw new Error("Can only set raw "+Ms+" value of a "+Ms+" node");n.dom().nodeValue=e}}),Is=function(n,e,t,r){var o,i,u,c,a,s=(i=e,u=t,c=r,(a=se(o=n).dom().createRange()).setStart(o.dom(),i),a.setEnd(u.dom(),c),a),f=ae(n,t)&&e===r;return s.collapsed&&!f},Hs=function(n){var e=w.fromDom(n.anchorNode),t=w.fromDom(n.focusNode);return Is(e,n.anchorOffset,t,n.focusOffset)?ln.some(hs.create(e,n.anchorOffset,t,n.focusOffset)):function(n){if(0<n.rangeCount){var e=n.getRangeAt(0),t=n.getRangeAt(n.rangeCount-1);return ln.some(hs.create(w.fromDom(e.startContainer),e.startOffset,w.fromDom(t.endContainer),t.endOffset))}return ln.none()}(n)},Ps=function(n,e){var i,t,r,o,u=ks(i=n,e).match({ltr:function(n,e,t,r){var o=i.document.createRange();return o.setStart(n.dom(),e),o.setEnd(t.dom(),r),o},rtl:function(n,e,t,r){var o=i.document.createRange();return o.setStart(t.dom(),r),o.setEnd(n.dom(),e),o}});return r=(t=u).getClientRects(),0<(o=0<r.length?r[0]:t.getBoundingClientRect()).width||0<o.height?ln.some(o).map(Ss):ln.none()},js=rn("element","offset"),Ls=function(n,e){var t=de(n);if(0===t.length)return js(n,e);if(e<t.length)return js(t[e],0);var r,o=t[t.length-1],i=Ae(o)?(r=o,Bs.get(r)).length:de(o).length;return js(o,i)},Vs=mt([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),Ws=function(n){return n.fold(fn,function(n,e,t){return n.translate(-e,-t)})},Us=function(n){return n.fold(fn,fn)},zs=function(n){return G(n,function(n,e){return n.translate(e.left(),e.top())},Lc(0,0))},qs=function(n){var e=W(n,Us);return zs(e)},Gs=Vs.screen,Ys=Vs.absolute,Ks=function(n,e,t){var r,o,i,u=se(n.element()),c=Qc(u),a=(r=n,o=t,i=fe(o.root).dom(),ln.from(i.frameElement).map(w.fromDom).filter(function(n){var e=se(n),t=se(r.element());return ae(e,t)}).map(Wc)).getOr(c);return Ys(a,c.left(),c.top())},Xs=function(n,e,t,r){var o=n,i=e,u=t,c=r;n<0&&(o=0,u=t+n),e<0&&(i=0,c=r+e);var a=Gs(Lc(o,i));return ln.some(ra(a,u,c))},Js=function(n,f,l,d,m){return n.map(function(n){var e,t,r,o=[f,n.point()],i=(e=function(){return qs(o)},t=function(){return qs(o)},r=function(){return n=W(o,Ws),zs(n);var n},d.fold(e,t,r)),u=oa(i.left(),i.top(),n.width(),n.height()),c=l.showAbove?us():cs(),a=(l.showAbove,as()),s=gs(m,l,c,a,c,a,ln.none());return ss({anchorBox:u,bubble:l.bubble.getOr(Wa()),overrides:l.overrides,layouts:s,placer:ln.none()})})},Qs=rn("element","offset"),$s=function(n,e){return Ae(n)?Qs(n,e):Ls(n,e)},Zs=function(e,n){return n.getSelection.getOrThunk(function(){return function(){return n=e,ln.from(n.getSelection()).filter(function(n){return 0<n.rangeCount}).bind(Hs);var n}})().map(function(n){var e=$s(n.start(),n.soffset()),t=$s(n.finish(),n.foffset());return ws.range(e.element(),e.offset(),t.element(),t.offset())})},nf=[wr("getSelection"),hr("root"),wr("bubble"),ms(),Er("overrides",{}),Er("showAbove",!1),Iu("placement",function(n,e,t){var r=fe(e.root).dom(),o=Ks(n,0,e),i=Zs(r,e).bind(function(n){return Ps(r,ws.exactFromRange(n)).orThunk(function(){var e=w.fromText("\ufeff");return pe(n.start(),e),Ps(r,ws.exact(e,0,e,1)).map(function(n){return Go(e),n})}).bind(function(n){return Xs(n.left(),n.top(),n.width(),n.height())})}),u=Zs(r,e).bind(function(n){return Ne(n.start())?ln.some(n.start()):le(n.start())}).getOr(n.element());return Js(i,o,e,t,u)})],ef=[hr("node"),hr("root"),wr("bubble"),ms(),Er("overrides",{}),Er("showAbove",!1),Iu("placement",function(o,i,u){var c=Ks(o,0,i);return i.node.bind(function(n){var e=n.dom().getBoundingClientRect(),t=Xs(e.left,e.top,e.width,e.height),r=i.node.getOr(o.element());return Js(t,c,i,u,r)})})],tf=function(n){return n.x()+n.width()},rf=function(n,e){return n.x()-e.width()},of=function(n,e){return n.y()-e.height()+n.height()},uf=function(n){return n.y()},cf=function(n,e,t){return Ua(tf(n),uf(n),t.southeast(),fa(),Ma(n,{left:0,top:2}),"link-layout-se")},af=function(n,e,t){return Ua(rf(n,e),uf(n),t.southwest(),la(),Ma(n,{right:1,top:2}),"link-layout-sw")},sf=function(n,e,t){return Ua(tf(n),of(n,e),t.northeast(),da(),Ma(n,{left:0,bottom:3}),"link-layout-ne")},ff=function(n,e,t){return Ua(rf(n,e),of(n,e),t.northwest(),ma(),Ma(n,{right:1,bottom:3}),"link-layout-nw")},lf=function(){return[cf,af,sf,ff]},df=function(){return[af,cf,ff,sf]},mf=[hr("item"),ms(),Er("overrides",{}),Iu("placement",function(n,e,t){var r=xa(t,e.item.element()),o=gs(n.element(),e,lf(),df(),lf(),df(),ln.none());return ln.some(ss({anchorBox:r,bubble:Wa(),overrides:e.overrides,layouts:o,placer:ln.none()}))})],gf=dr("anchor",{selection:nf,node:ef,hotspot:ps,submenu:mf,makeshift:vs}),pf=function(n,e,t,r,o){var i,u=(i=t.anchorBox,Ca(i,e));ja(u,o.element(),t.bubble,t.layouts,r,t.overrides)},vf=function(n,e,t,r,o,i){var u=i.map(ua);return hf(n,e,t,r,o,u)},hf=function(a,s,n,e,f,l){var d=fr("positioning anchor.info",gf,e);aa(function(){ru(f.element(),"position","fixed");var n=cu(f.element(),"visibility");ru(f.element(),"visibility","hidden");var e,t,r,o,i=s.useFixed()?(o=b.document.documentElement,Ea(0,0,o.clientWidth,o.clientHeight)):(t=Wc((e=a).element()),r=e.element().dom().getBoundingClientRect(),Sa(t.left(),t.top(),r.width,r.height)),u=d.placement,c=l.map(sn).or(s.getBounds);u(a,d,i).each(function(n){n.placer.getOr(pf)(a,i,n,c,f)}),n.fold(function(){au(f.element(),"visibility")},function(n){ru(f.element(),"visibility",n)}),cu(f.element(),"left").isNone()&&cu(f.element(),"top").isNone()&&cu(f.element(),"right").isNone()&&cu(f.element(),"bottom").isNone()&&cu(f.element(),"position").is("fixed")&&au(f.element(),"position")},f.element())},bf=Object.freeze({__proto__:null,position:function(n,e,t,r,o){vf(n,e,t,r,o,ln.none())},positionWithin:vf,positionWithinBounds:hf,getMode:function(n,e,t){return e.useFixed()?"fixed":"absolute"}}),yf=[Er("useFixed",m),wr("getBounds")],_f=No({fields:yf,name:"positioning",active:Pc,apis:bf}),wf=function(n,e,t,r){var o=n.getSystem().build(r);Ac(n,o,t)},xf=function(n,e,t,r){var o=Of(n);Y(o,function(n){return ae(r.element(),n.element())}).each(Rc)},Of=function(n,e){return n.components()},Sf=function(e,n,t,o,r){var i=Of(e);return ln.from(i[o]).map(function(n){return xf(e,0,0,n),r.each(function(n){wf(e,0,function(n,e){var t,r;r=e,me(t=n,o).fold(function(){he(t,r)},function(n){pe(n,r)})},n)}),n})},Ef=No({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(n,e,t,r){wf(n,0,he,r)},prepend:function(n,e,t,r){wf(n,0,ve,r)},remove:xf,replaceAt:Sf,replaceBy:function(e,n,t,r,o){var i=Of(e);return K(i,r).bind(function(n){return Sf(e,0,0,n,o)})},set:function(e,n,t,r){aa(function(){var n=W(r,e.getSystem().build);Dc(e,n)},e.element())},contents:Of})}),Cf=function(n){var e,t=n.dom();return!((e=t).offsetWidth<=0&&e.offsetHeight<=0)},kf=Object.freeze({__proto__:null,getCurrent:function(n,e,t){return e.find(n)}}),Tf=[hr("find")],Mf=No({fields:Tf,name:"composing",apis:kf}),Df=function(n,e){e.ignore||(Vo(n.element()),e.onFocus(n))},Nf=Object.freeze({__proto__:null,focus:Df,blur:function(n,e){e.ignore||n.element().dom().blur()},isFocused:function(n){return e=n.element(),t=se(e).dom(),e.dom()===t.activeElement;var e,t}}),Af=Object.freeze({__proto__:null,exhibit:function(n,e){var t=e.ignore?{}:{attributes:{tabindex:"-1"}};return So(t)},events:function(t){return go([po(qr(),function(n,e){Df(n,t),e.stop()})].concat(t.stopMousedown?[po(Hr(),function(n,e){e.event().prevent()})]:[]))}}),Ff=[Au("onFocus"),Er("stopMousedown",!1),Er("ignore",!1)],Rf=No({fields:Ff,name:"focusing",active:Af,apis:Nf}),Bf=function(n,e,t){e.store.manager.onLoad(n,e,t)},If=function(n,e,t){e.store.manager.onUnload(n,e,t)},Hf=Object.freeze({__proto__:null,onLoad:Bf,onUnload:If,setValue:function(n,e,t,r){e.store.manager.setValue(n,e,t,r)},getValue:function(n,e,t){return e.store.manager.getValue(n,e,t)},getState:function(n,e,t){return t}}),Pf=Object.freeze({__proto__:null,events:function(t,r){var n=t.resetOnDom?[bo(function(n,e){Bf(n,t,r)}),yo(function(n,e){If(n,t,r)})]:[Eo(t,r,Bf)];return go(n)}}),jf=function(){var n=Tn(null);return Mr({set:n.set,get:n.get,isNotSet:function(){return null===n.get()},clear:function(){n.set(null)},readState:function(){return{mode:"memory",value:n.get()}}})},Lf=function(){var i=Tn({}),u=Tn({});return Mr({readState:function(){return{mode:"dataset",dataByValue:i.get(),dataByText:u.get()}},lookup:function(n){return gn(i.get(),n).orThunk(function(){return gn(u.get(),n)})},update:function(n){var e=i.get(),t=u.get(),r={},o={};U(n,function(e){r[e.value]=e,gn(e,"meta").each(function(n){gn(n,"text").each(function(n){o[n]=e})})}),i.set(xn(xn({},e),r)),u.set(xn(xn({},t),o))},clear:function(){i.set({}),u.set({})}})},Vf=Object.freeze({__proto__:null,memory:jf,dataset:Lf,manual:function(){return Mr({readState:function(){}})},init:function(n){return n.store.manager.state(n)}}),Wf=function(n,e,t,r){var o=e.store;t.update([r]),o.setValue(n,r),e.onSetValue(n,r)},Uf=[wr("initialValue"),hr("getFallbackEntry"),hr("getDataKey"),hr("setValue"),Iu("manager",{setValue:Wf,getValue:function(n,e,t){var r=e.store,o=r.getDataKey(n);return t.lookup(o).fold(function(){return r.getFallbackEntry(o)},function(n){return n})},onLoad:function(e,t,r){t.store.initialValue.each(function(n){Wf(e,t,r,n)})},onUnload:function(n,e,t){t.clear()},state:Lf})],zf=[hr("getValue"),Er("setValue",_),wr("initialValue"),Iu("manager",{setValue:function(n,e,t,r){e.store.setValue(n,r),e.onSetValue(n,r)},getValue:function(n,e,t){return e.store.getValue(n)},onLoad:function(e,t,n){t.store.initialValue.each(function(n){t.store.setValue(e,n)})},onUnload:_,state:Tr.init})],qf=[wr("initialValue"),Iu("manager",{setValue:function(n,e,t,r){t.set(r),e.onSetValue(n,r)},getValue:function(n,e,t){return t.get()},onLoad:function(n,e,t){e.store.initialValue.each(function(n){t.isNotSet()&&t.set(n)})},onUnload:function(n,e,t){t.clear()},state:jf})],Gf=[Cr("store",{mode:"memory"},dr("mode",{memory:qf,manual:zf,dataset:Uf})),Au("onSetValue"),Er("resetOnDom",!1)],Yf=No({fields:Gf,name:"representing",active:Pf,apis:Hf,extra:{setValueFrom:function(n,e){var t=Yf.getValue(e);Yf.setValue(n,t)}},state:Vf}),Kf=Object.freeze({__proto__:null,exhibit:function(n,e){return So({attributes:jt([{key:e.tabAttr,value:"true"}])})}}),Xf=[Er("tabAttr","data-alloy-tabstop")],Jf=No({fields:Xf,name:"tabstopping",active:Kf}),Qf=function(n,e,t,r){return gn(e.routes,r.start).bind(function(n){return gn(n,r.destination)})},$f=function(n,e,t,r){return Qf(0,e,0,r).bind(function(e){return e.transition.map(function(n){return{transition:n,route:e}})})},Zf=function(t,r,n){var e,o,i;(e=t,o=r,i=n,nl(e,o).bind(function(n){return $f(e,o,i,n)})).each(function(n){var e=n.transition;it(t.element(),e.transitionClass),Pe(t.element(),r.destinationAttr)})},nl=function(n,e,t){var r=n.element();return He(r,e.destinationAttr)?ln.some({start:Ie(n.element(),e.stateAttr),destination:Ie(n.element(),e.destinationAttr)}):ln.none()},el=function(n,e,t,r){Zf(n,e,t),He(n.element(),e.stateAttr)&&Ie(n.element(),e.stateAttr)!==r&&e.onFinish(n,r),Re(n.element(),e.stateAttr,r)},tl=Object.freeze({__proto__:null,findRoute:Qf,disableTransition:Zf,getCurrentRoute:nl,jumpTo:el,progressTo:function(t,r,o,i){var n,e;e=r,He((n=t).element(),e.destinationAttr)&&(Re(n.element(),e.stateAttr,Ie(n.element(),e.destinationAttr)),Pe(n.element(),e.destinationAttr));var u,c,a=(u=r,c=i,{start:Ie(t.element(),u.stateAttr),destination:c});$f(t,r,o,a).fold(function(){el(t,r,o,i)},function(n){Zf(t,r,o);var e=n.transition;rt(t.element(),e.transitionClass),Re(t.element(),r.destinationAttr,i)})},getState:function(n,e,t){var r=n.element();return He(r,e.stateAttr)?ln.some(Ie(r,e.stateAttr)):ln.none()}}),rl=Object.freeze({__proto__:null,events:function(o,i){return go([po(Ur(),function(t,n){var r=n.event().raw();nl(t,o).each(function(e){Qf(0,o,0,e).each(function(n){n.transition.each(function(n){r.propertyName===n.property&&(el(t,o,i,e.destination),o.onTransition(t,e))})})})}),bo(function(n,e){el(n,o,i,o.initialState)})])}}),ol=[Er("destinationAttr","data-transitioning-destination"),Er("stateAttr","data-transitioning-state"),hr("initialState"),Au("onTransition"),Au("onFinish"),br("routes",cr(Ke.value,cr(Ke.value,Qt([Sr("transition",[hr("property"),hr("transitionClass")])]))))],il=No({fields:ol,name:"transitioning",active:rl,apis:tl,extra:{createRoutes:function(n){var r={};return cn(n,function(n,e){var t=e.split("<->");r[t[0]]=Pt(t[1],n),r[t[1]]=Pt(t[0],n)}),r},createBistate:function(n,e,t){return jt([{key:n,value:Pt(e,t)},{key:e,value:Pt(n,t)}])},createTristate:function(n,e,t,r){return jt([{key:n,value:jt([{key:e,value:r},{key:t,value:r}])},{key:e,value:jt([{key:n,value:r},{key:t,value:r}])},{key:t,value:jt([{key:n,value:r},{key:e,value:r}])}])}}}),ul=ne().os.isOSX()?"":"Ctrl",cl=an({tc_menu_name:"TinyComments",tc_announce_sidebar_available:"Comment. Sidebar available. Press "+ul+" + Alt + M to switch to sidebar",tc_items_addcomment:"Add comment",tc_items_showcomments:"Show comments",tc_items_deleteall:"Delete all conversations",tc_edit_buttons_save:"Save",tc_edit_buttons_cancel:"Cancel",tc_reply_buttons_save:"Save",tc_reply_buttons_clear:"Clear",tc_reply_placeholders:"Say something ...",tc_kebab_deleteconversation:"Delete conversation",tc_kebab_delete:"Delete",tc_kebab_edit:"Edit",tc_edit_problem_comment:"An error occurred editing this comment. See the Console for details.",tc_edit_unauthorised_comment:"You are not allowed to edit this comment",tc_delete_buttons_cancel:"Cancel",tc_delete_buttons_proceed:"Delete",tc_create_problem:"An error occurred while creating a comment. See the Console for details",tc_reply_problem:"An error occurred while replying to a comment. See the Console for details",tc_delete_prompts_conversation:"Delete this conversation?",tc_delete_prompts_conversation_detail_sing:"1 comment will be deleted. You can't undo this action.",tc_delete_prompts_conversation_detail_pl:"{0} comments will be deleted. You can't undo this action.",tc_delete_prompts_all:"Delete all conversations in the content? This cannot be undone",tc_delete_prompts_comment:"Are you sure you want to delete this comment?",tc_delete_problem_all:"An error occurred deleting all the conversations. See the Console for details.",tc_delete_problem_conversation:"An error occurred deleting the conversation. See the Console for details.",tc_delete_problem_comment:"An error occurred deleting the comment. See the Console for details.",tc_delete_unauthorised_all:"You are not allowed to delete all the conversations",tc_delete_unauthorised_conversation:"You are not allowed to delete this conversation",tc_delete_unauthorised_comment:"You are not allowed to delete this comment",tc_date_less_than_a_minute_ago:"a moment ago",tc_date_1_minute_ago:"1 minute ago",tc_date_x_minutes_ago:"{0} minutes ago",tc_date_1_hour_ago:"1 hour ago",tc_date_x_hours_ago:"{0} hours ago",tc_date_1_day_ago:"1 day ago",tc_date_x_days_ago:"{0} days ago",tc_date_1_week_ago:"1 week ago",tc_date_x_weeks_ago:"{0} weeks ago",tc_date_1_month_ago:"1 month ago",tc_date_x_months_ago:"{0} months ago",tc_date_1_year_ago:"1 year ago",tc_date_x_years_ago:"{0} years ago",tc_date_comment_edited:" (edited)",tc_comment_buttons_showmore:"SHOW MORE",tc_comment_buttons_showless:"SHOW LESS"},fn),al=function(n,e,t){var r=e.aria;r.update(n,r,t.get())},sl=function(e,n,t){n.toggleClass.each(function(n){t.get()?rt(e.element(),n):it(e.element(),n)})},fl=function(n,e,t){ml(n,e,t,!t.get())},ll=function(n,e,t){t.set(!0),sl(n,e,t),al(n,e,t)},dl=function(n,e,t){t.set(!1),sl(n,e,t),al(n,e,t)},ml=function(n,e,t,r){(r?ll:dl)(n,e,t)},gl=function(n,e,t){ml(n,e,t,e.selected)},pl=Object.freeze({__proto__:null,onLoad:gl,toggle:fl,isOn:function(n,e,t){return t.get()},on:ll,off:dl,set:ml}),vl=Object.freeze({__proto__:null,exhibit:function(){return So({})},events:function(n,e){var t,r,o,i=(t=n,r=e,o=fl,wo(function(n){o(n,t,r)})),u=Eo(n,e,gl);return go(X([n.toggleOnExecute?[i]:[],[u]]))}}),hl=function(n,e,t){Re(n.element(),"aria-expanded",t)},bl=[Er("selected",!1),wr("toggleClass"),Er("toggleOnExecute",!0),Cr("aria",{mode:"none"},dr("mode",{pressed:[Er("syncWithExpanded",!1),Iu("update",function(n,e,t){Re(n.element(),"aria-pressed",t),e.syncWithExpanded&&hl(n,e,t)})],checked:[Iu("update",function(n,e,t){Re(n.element(),"aria-checked",t)})],expanded:[Iu("update",hl)],selected:[Iu("update",function(n,e,t){Re(n.element(),"aria-selected",t)})],none:[Iu("update",_)]}))],yl=No({fields:bl,name:"toggling",active:vl,apis:pl,state:(Ns=!1,{init:function(){var e=Tn(Ns);return{get:function(){return e.get()},set:function(n){return e.set(n)},clear:function(){return e.set(Ns)},readState:function(){return e.get()}}}})}),_l=function(){var n=function(n,e){e.stop(),fo(n)};return[po(Wr(),n),po(Qr(),n),ho(Rr()),ho(Hr())]},wl=function(n){return go(X([n.map(function(t){return wo(function(n,e){t(n),e.stop()})}).toArray(),_l()]))},xl=function(n,e,t){var r=$(n.slice(0,e)),o=$(n.slice(e+1));return Y(r.concat(o),t)},Ol=function(n,e,t){var r=$(n.slice(0,e));return Y(r,t)},Sl=function(n,e,t){var r=n.slice(0,e),o=n.slice(e+1);return Y(o.concat(r),t)},El=function(n,e,t){var r=n.slice(e+1);return Y(r,t)},Cl=function(t){return function(n){var e=n.raw();return L(t,e.which)}},kl=function(n){return function(e){return Q(n,function(n){return n(e)})}},Tl=function(n){return!0===n.raw().shiftKey},Ml=function(n){return!0===n.raw().ctrlKey},Dl=(As=Tl,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return!As.apply(null,n)}),Nl=function(n,e){return{matches:n,classification:e}},Al=function(n){for(var e=[],t=function(n){e.push(n)},r=0;r<n.length;r++)n[r].each(t);return e},Fl=function(t,r,n,o){var e=ct(t.element(),"."+r.highlightClass);U(e,function(e){V(o,function(n){return n.element()===e})||(it(e,r.highlightClass),t.getSystem().getByDom(e).each(function(n){r.onDehighlight(t,n),ao(n,co())}))})},Rl=function(n,e,t,r){Fl(n,e,0,[r]),Bl(n,e,t,r)||(rt(r.element(),e.highlightClass),e.onHighlight(n,r),ao(r,uo()))},Bl=function(n,e,t,r){return ut(r.element(),e.highlightClass)},Il=function(n,e,t,r){var o=ct(n.element(),"."+e.itemClass);return ln.from(o[r]).fold(function(){return Ke.error("No element found with index "+r)},n.getSystem().getByDom)},Hl=function(e,n,t){return ci(e.element(),"."+n.itemClass).bind(function(n){return e.getSystem().getByDom(n).toOption()})},Pl=function(e,n,t){var r=ct(e.element(),"."+n.itemClass);return(0<r.length?ln.some(r[r.length-1]):ln.none()).bind(function(n){return e.getSystem().getByDom(n).toOption()})},jl=function(t,e,n,r){var o=ct(t.element(),"."+e.itemClass);return K(o,function(n){return ut(n,e.highlightClass)}).bind(function(n){var e=ka(n,r,0,o.length-1);return t.getSystem().getByDom(o[e]).toOption()})},Ll=function(e,n,t){var r=ct(e.element(),"."+n.itemClass);return Al(W(r,function(n){return e.getSystem().getByDom(n).toOption()}))},Vl=Object.freeze({__proto__:null,dehighlightAll:function(n,e,t){return Fl(n,e,0,[])},dehighlight:function(n,e,t,r){Bl(n,e,t,r)&&(it(r.element(),e.highlightClass),e.onDehighlight(n,r),ao(r,co()))},highlight:Rl,highlightFirst:function(e,t,r){Hl(e,t).each(function(n){Rl(e,t,r,n)})},highlightLast:function(e,t,r){Pl(e,t).each(function(n){Rl(e,t,r,n)})},highlightAt:function(e,t,r,n){Il(e,t,r,n).fold(function(n){throw new Error(n)},function(n){Rl(e,t,r,n)})},highlightBy:function(e,t,r,n){var o=Ll(e,t);Y(o,n).each(function(n){Rl(e,t,r,n)})},isHighlighted:Bl,getHighlighted:function(e,n,t){return ci(e.element(),"."+n.highlightClass).bind(function(n){return e.getSystem().getByDom(n).toOption()})},getFirst:Hl,getLast:Pl,getPrevious:function(n,e,t){return jl(n,e,0,-1)},getNext:function(n,e,t){return jl(n,e,0,1)},getCandidates:Ll}),Wl=[hr("highlightClass"),hr("itemClass"),Au("onHighlight"),Au("onDehighlight")],Ul=No({fields:Wl,name:"highlighting",apis:Vl}),zl=function(n,e,t){e.exists(function(e){return t.exists(function(n){return ae(n,e)})})||so(n,io(),{prevFocus:e,newFocus:t})},ql=function(){var o=function(n){return Uo(n.element())};return{get:o,set:function(n,e){var t=o(n);n.getSystem().triggerFocus(e,n.element());var r=o(n);zl(n,t,r)}}};(Rs=Fs||(Fs={})).OnFocusMode="onFocus",Rs.OnEnterOrSpaceMode="onEnterOrSpace",Rs.OnApiMode="onApi";var Gl,Yl,Kl,Xl,Jl,Ql,$l,Zl,nd,ed,td,rd,od,id,ud=function(n,e,t,r,c){var a=function(e,t,n,r,o){var i,u,c=n(e,t,r,o);return(i=c,u=t.event(),Y(i,function(n){return n.matches(u)}).map(function(n){return n.classification})).bind(function(n){return n(e,t,r,o)})},o={schema:function(){return n.concat([Er("focusManager",ql()),Cr("focusInside","onFocus",ur(function(n){return L(["onFocus","onEnterOrSpace","onApi"],n)?Ke.value(n):Ke.error("Invalid value for focusInside")})),Iu("handler",o),Iu("state",e),Iu("sendFocusIn",c)])},processKey:a,toEvents:function(i,u){var n=i.focusInside!==Fs.OnFocusMode?ln.none():c(i).map(function(t){return po(qr(),function(n,e){t(n,i,u),e.stop()})});return go(n.toArray().concat([po(jr(),function(r,o){a(r,o,t,i,u).fold(function(){var e,t,n;e=r,t=o,n=Cl([32].concat([13]))(t.event()),i.focusInside===Fs.OnEnterOrSpaceMode&&n&&Nr(e,t)&&c(i).each(function(n){n(e,i,u),t.stop()})},function(n){o.stop()})}),po(Lr(),function(n,e){a(n,e,r,i,u).each(function(n){e.stop()})})]))}};return o},cd=function(n){var e=[wr("onEscape"),wr("onEnter"),Er("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),Er("firstTabstop",0),Er("useTabstopAt",sn(!0)),wr("visibilitySelector")].concat([n]),c=function(n,e){var t,r=n.visibilitySelector.bind(function(n){return ai(e,n)}).getOr(e);return t=r,0<Yc.get(t)},t=function(e,t,n){var r,o,i,u;(r=e,o=t,i=ct(r.element(),o.selector),u=z(i,function(n){return c(o,n)}),ln.from(u[o.firstTabstop])).each(function(n){t.focusManager.set(e,n)})},a=function(e,n,t,r,o){return o(n,t,function(n){return c(e=r,t=n)&&e.useTabstopAt(t);var e,t}).fold(function(){return r.cyclic?ln.some(!0):ln.none()},function(n){return r.focusManager.set(e,n),ln.some(!0)})},o=function(e,n,t,r){var o,i,u=ct(e.element(),t.selector);return(o=e,i=t,i.focusManager.get(o).bind(function(n){return ai(n,i.selector)})).bind(function(n){return K(u,g(ae,n)).bind(function(n){return a(e,u,n,t,r)})})},r=sn([Nl(kl([Tl,Cl([9])]),function(n,e,t){var r=t.cyclic?xl:Ol;return o(n,0,t,r)}),Nl(Cl([9]),function(n,e,t){var r=t.cyclic?Sl:El;return o(n,0,t,r)}),Nl(Cl([27]),function(e,t,n){return n.onEscape.bind(function(n){return n(e,t)})}),Nl(kl([Dl,Cl([13])]),function(e,t,n){return n.onEnter.bind(function(n){return n(e,t)})})]),i=sn([]);return ud(e,Tr.init,r,i,function(){return ln.some(t)})},ad=cd(kr("cyclic",sn(!1))),sd=cd(kr("cyclic",sn(!0))),fd=function(n){return"input"===Me(n)&&"radio"!==Ie(n,"type")||"textarea"===Me(n)},ld=function(n,e,t){return fd(t)&&Cl([32])(e.event())?ln.none():(lo(n,t,Xr()),ln.some(!0))},dd=function(n,e){return ln.some(!0)},md=[Er("execute",ld),Er("useSpace",!1),Er("useEnter",!0),Er("useControlEnter",!1),Er("useDown",!1)],gd=function(n,e,t){return t.execute(n,e,n.element())},pd=ud(md,Tr.init,function(n,e,t,r){var o=t.useSpace&&!fd(n.element())?[32]:[],i=t.useEnter?[13]:[],u=t.useDown?[40]:[],c=o.concat(i).concat(u);return[Nl(Cl(c),gd)].concat(t.useControlEnter?[Nl(kl([Ml,Cl([13])]),gd)]:[])},function(n,e,t,r){return t.useSpace&&!fd(n.element())?[Nl(Cl([32]),dd)]:[]},function(){return ln.none()}),vd=function(){var t=Tn(ln.none());return Mr({readState:function(){return t.get().map(function(n){return{numRows:String(n.numRows()),numColumns:String(n.numColumns())}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(n,e){t.set(ln.some({numRows:sn(n),numColumns:sn(e)}))},getNumRows:function(){return t.get().map(function(n){return n.numRows()})},getNumColumns:function(){return t.get().map(function(n){return n.numColumns()})}})},hd=Object.freeze({__proto__:null,flatgrid:vd,init:function(n){return n.state(n)}}),bd=function(i){return function(n,e,t,r){var o=i(n.element());return xd(o,n,e,t,r)}},yd=function(n,e){var t=fs(n,e);return bd(t)},_d=function(n,e){var t=fs(e,n);return bd(t)},wd=function(o){return function(n,e,t,r){return xd(o,n,e,t,r)}},xd=function(e,t,n,r,o){return r.focusManager.get(t).bind(function(n){return e(t.element(),n,r,o)}).map(function(n){return r.focusManager.set(t,n),!0})},Od=wd,Sd=wd,Ed=wd,Cd=function(n,e,t){var r,o=ct(n,t),i=z(o,Cf);return K(r=i,function(n){return ae(n,e)}).map(function(n){return{index:sn(n),candidates:sn(r)}})},kd=function(n,e){return K(n,function(n){return ae(e,n)})},Td=function(t,n,r,e){return e(Math.floor(n/r),n%r).bind(function(n){var e=n.row()*r+n.column();return 0<=e&&e<t.length?ln.some(t[e]):ln.none()})},Md=function(o,n,i,u,c){return Td(o,n,u,function(n,e){var t=n===i-1?o.length-n*u:u,r=ka(e,c,0,t-1);return ln.some({row:sn(n),column:sn(r)})})},Dd=function(i,n,u,c,a){return Td(i,n,c,function(n,e){var t=ka(n,a,0,u-1),r=t===u-1?i.length-t*c:c,o=Ta(e,0,r-1);return ln.some({row:sn(t),column:sn(o)})})},Nd=[hr("selector"),Er("execute",ld),Fu("onEscape"),Er("captureTab",!1),Pu()],Ad=function(e,t,n){ci(e.element(),t.selector).each(function(n){t.focusManager.set(e,n)})},Fd=function(o){return function(n,e,t,r){return Cd(n,e,t.selector).bind(function(n){return o(n.candidates(),n.index(),r.getNumRows().getOr(t.initSize.numRows),r.getNumColumns().getOr(t.initSize.numColumns))})}},Rd=function(n,e,t){return t.captureTab?ln.some(!0):ln.none()},Bd=Fd(function(n,e,t,r){return Md(n,e,t,r,-1)}),Id=Fd(function(n,e,t,r){return Md(n,e,t,r,1)}),Hd=Fd(function(n,e,t,r){return Dd(n,e,t,r,-1)}),Pd=Fd(function(n,e,t,r){return Dd(n,e,t,r,1)}),jd=sn([Nl(Cl([37]),yd(Bd,Id)),Nl(Cl([39]),_d(Bd,Id)),Nl(Cl([38]),Od(Hd)),Nl(Cl([40]),Sd(Pd)),Nl(kl([Tl,Cl([9])]),Rd),Nl(kl([Dl,Cl([9])]),Rd),Nl(Cl([27]),function(n,e,t){return t.onEscape(n,e)}),Nl(Cl([32].concat([13])),function(e,t,r,n){return(o=e,i=r,i.focusManager.get(o).bind(function(n){return ai(n,i.selector)})).bind(function(n){return r.execute(e,t,n)});var o,i})]),Ld=sn([Nl(Cl([32]),dd)]),Vd=ud(Nd,vd,jd,Ld,function(){return ln.some(Ad)}),Wd=function(n,e,t,i){var u=function(n,e,t){var r,o=ka(e,i,0,t.length-1);return o===n?ln.none():(r=t[o],"button"===Me(r)&&"disabled"===Ie(r,"disabled")?u(n,o,t):ln.from(t[o]))};return Cd(n,t,e).bind(function(n){var e=n.index(),t=n.candidates();return u(e,e,t)})},Ud=[hr("selector"),Er("getInitial",ln.none),Er("execute",ld),Fu("onEscape"),Er("executeOnMove",!1),Er("allowVertical",!0)],zd=function(e,t,r){return(n=e,o=r,o.focusManager.get(n).bind(function(n){return ai(n,o.selector)})).bind(function(n){return r.execute(e,t,n)});var n,o},qd=function(e,t,n){t.getInitial(e).orThunk(function(){return ci(e.element(),t.selector)}).each(function(n){t.focusManager.set(e,n)})},Gd=function(n,e,t){return Wd(n,t.selector,e,-1)},Yd=function(n,e,t){return Wd(n,t.selector,e,1)},Kd=function(o){return function(n,e,t,r){return o(n,e,t,r).bind(function(){return t.executeOnMove?zd(n,e,t):ln.some(!0)})}},Xd=function(n,e,t){return t.onEscape(n,e)},Jd=sn([Nl(Cl([32]),dd)]),Qd=ud(Ud,Tr.init,function(n,e,t,r){var o=[37].concat(t.allowVertical?[38]:[]),i=[39].concat(t.allowVertical?[40]:[]);return[Nl(Cl(o),Kd(yd(Gd,Yd))),Nl(Cl(i),Kd(_d(Gd,Yd))),Nl(Cl([13]),zd),Nl(Cl([32]),zd),Nl(Cl([27]),Xd)]},Jd,function(){return ln.some(qd)}),$d=yn(["rowIndex","columnIndex","cell"],[]),Zd=function(n,e,t){return ln.from(n[e]).bind(function(n){return ln.from(n[t]).map(function(n){return $d({rowIndex:e,columnIndex:t,cell:n})})})},nm=function(n,e,t,r){var o=n[e].length,i=ka(t,r,0,o-1);return Zd(n,e,i)},em=function(n,e,t,r){var o=ka(t,r,0,n.length-1),i=n[o].length,u=Ta(e,0,i-1);return Zd(n,o,u)},tm=function(n,e,t,r){var o=n[e].length,i=Ta(t+r,0,o-1);return Zd(n,e,i)},rm=function(n,e,t,r){var o=Ta(t+r,0,n.length-1),i=n[o].length,u=Ta(e,0,i-1);return Zd(n,o,u)},om=[_r("selectors",[hr("row"),hr("cell")]),Er("cycles",!0),Er("previousSelector",ln.none),Er("execute",ld)],im=function(e,t,n){t.previousSelector(e).orThunk(function(){var n=t.selectors;return ci(e.element(),n.cell)}).each(function(n){t.focusManager.set(e,n)})},um=function(n,e){return function(t,r,i){var u=i.cycles?n:e;return ai(r,i.selectors.row).bind(function(n){var e=ct(n,i.selectors.cell);return kd(e,r).bind(function(r){var o=ct(t,i.selectors.row);return kd(o,n).bind(function(n){var e,t=(e=i,W(o,function(n){return ct(n,e.selectors.cell)}));return u(t,n,r).map(function(n){return n.cell()})})})})}},cm=um(function(n,e,t){return nm(n,e,t,-1)},function(n,e,t){return tm(n,e,t,-1)}),am=um(function(n,e,t){return nm(n,e,t,1)},function(n,e,t){return tm(n,e,t,1)}),sm=um(function(n,e,t){return em(n,t,e,-1)},function(n,e,t){return rm(n,t,e,-1)}),fm=um(function(n,e,t){return em(n,t,e,1)},function(n,e,t){return rm(n,t,e,1)}),lm=sn([Nl(Cl([37]),yd(cm,am)),Nl(Cl([39]),_d(cm,am)),Nl(Cl([38]),Od(sm)),Nl(Cl([40]),Sd(fm)),Nl(Cl([32].concat([13])),function(e,t,r){return Uo(e.element()).bind(function(n){return r.execute(e,t,n)})})]),dm=sn([Nl(Cl([32]),dd)]),mm=ud(om,Tr.init,lm,dm,function(){return ln.some(im)}),gm=[hr("selector"),Er("execute",ld),Er("moveOnTab",!1)],pm=function(e,t,r){return r.focusManager.get(e).bind(function(n){return r.execute(e,t,n)})},vm=function(e,t,n){ci(e.element(),t.selector).each(function(n){t.focusManager.set(e,n)})},hm=function(n,e,t){return Wd(n,t.selector,e,-1)},bm=function(n,e,t){return Wd(n,t.selector,e,1)},ym=sn([Nl(Cl([38]),Ed(hm)),Nl(Cl([40]),Ed(bm)),Nl(kl([Tl,Cl([9])]),function(n,e,t,r){return t.moveOnTab?Ed(hm)(n,e,t,r):ln.none()}),Nl(kl([Dl,Cl([9])]),function(n,e,t,r){return t.moveOnTab?Ed(bm)(n,e,t,r):ln.none()}),Nl(Cl([13]),pm),Nl(Cl([32]),pm)]),_m=sn([Nl(Cl([32]),dd)]),wm=ud(gm,Tr.init,ym,_m,function(){return ln.some(vm)}),xm=[Fu("onSpace"),Fu("onEnter"),Fu("onShiftEnter"),Fu("onLeft"),Fu("onRight"),Fu("onTab"),Fu("onShiftTab"),Fu("onUp"),Fu("onDown"),Fu("onEscape"),Er("stopSpaceKeyup",!1),wr("focusIn")],Om=ud(xm,Tr.init,function(n,e,t){return[Nl(Cl([32]),t.onSpace),Nl(kl([Dl,Cl([13])]),t.onEnter),Nl(kl([Tl,Cl([13])]),t.onShiftEnter),Nl(kl([Tl,Cl([9])]),t.onShiftTab),Nl(kl([Dl,Cl([9])]),t.onTab),Nl(Cl([38]),t.onUp),Nl(Cl([40]),t.onDown),Nl(Cl([37]),t.onLeft),Nl(Cl([39]),t.onRight),Nl(Cl([32]),t.onSpace),Nl(Cl([27]),t.onEscape)]},function(n,e,t){return t.stopSpaceKeyup?[Nl(Cl([32]),dd)]:[]},function(n){return n.focusIn}),Sm=ad.schema(),Em=sd.schema(),Cm=Qd.schema(),km=Vd.schema(),Tm=mm.schema(),Mm=pd.schema(),Dm=wm.schema(),Nm=Om.schema(),Am=(ed=fr("Creating behaviour: "+(Gl={branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:Sm,cyclic:Em,flow:Cm,flatgrid:km,matrix:Tm,execution:Mm,menu:Dm,special:Nm}),name:"keying",active:{events:function(n,e){return n.handler.toEvents(n,e)}},apis:{focusIn:function(e,t,r){t.sendFocusIn(t).fold(function(){e.getSystem().triggerFocus(e.element(),e.element())},function(n){n(e,t,r)})},setGridSize:function(n,e,t,r,o){vn(t,"setGridSize")?t.setGridSize(r,o):b.console.error("Layout does not support setGridSize")}},state:hd}).name,Ao,Gl),Yl=dr(ed.branchKey,ed.branches),Kl=ed.name,Xl=ed.active,Jl=ed.apis,Ql=ed.extra,$l=ed.state,nd=Or(Kl,[xr("config",Zl=Yl)]),To(Zl,nd,Kl,Xl,Jl,Ql,$l)),Fm=Ec({name:"Button",factory:function(n){var e=wl(n.action),t=n.dom.tag,r=function(e){return gn(n.dom,"attributes").bind(function(n){return gn(n,e)})};return{uid:n.uid,dom:n.dom,components:n.components,events:e,behaviours:Eu(n.buttonBehaviours,[Rf.config({}),Am.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==t)return{role:r("role").getOr("button")};var n=r("type").getOr("button"),e=r("role").map(function(n){return{role:n}}).getOr({});return xn({type:n},e)}()},eventOrder:n.eventOrder}},configFields:[Er("uid",void 0),hr("dom"),Er("components",[]),Su("buttonBehaviours",[Rf,Am]),wr("action"),wr("role"),Er("eventOrder",{})]}),Rm=["input","button","textarea","select"],Bm=function(n,e,t){e.disabled&&Vm(n,e)},Im=function(n,e){return!0===e.useNative&&L(Rm,Me(n.element()))},Hm=function(n){Re(n.element(),"disabled","disabled")},Pm=function(n){Pe(n.element(),"disabled")},jm=function(n){Re(n.element(),"aria-disabled","true")},Lm=function(n){Re(n.element(),"aria-disabled","false")},Vm=function(e,n,t){n.disableClass.each(function(n){rt(e.element(),n)}),(Im(e,n)?Hm:jm)(e),n.onDisabled(e)},Wm=function(e,n,t){n.disableClass.each(function(n){it(e.element(),n)}),(Im(e,n)?Pm:Lm)(e),n.onEnabled(e)},Um=function(n,e){return Im(n,e)?He(n.element(),"disabled"):"true"===Ie(n.element(),"aria-disabled")},zm=Object.freeze({__proto__:null,enable:Wm,disable:Vm,isDisabled:Um,onLoad:Bm,set:function(n,e,t,r){(r?Vm:Wm)(n,e,t)}}),qm=Object.freeze({__proto__:null,exhibit:function(n,e){return So({classes:e.disabled?e.disableClass.map(nn).getOr([]):[]})},events:function(t,n){return go([(e=Xr(),r=function(n,e){return Um(n,t)},{key:e,value:Ar({abort:r})}),Eo(t,n,Bm)]);var e,r}}),Gm=[Er("disabled",!1),Er("useNative",!0),wr("disableClass"),Au("onDisabled"),Au("onEnabled")],Ym=No({fields:Gm,name:"disabling",active:qm,apis:zm}),Km=Object.freeze({__proto__:null,events:function(a){return go([po(Kr(),function(o,n){var e,t,i=a.channels,r=on(i),u=n,c=(e=r,(t=u).universal()?e:z(e,function(n){return L(t.channels(),n)}));U(c,function(n){var e=i[n],t=e.schema,r=fr("channel["+n+"] data\nReceiver: "+Qo(o.element()),t,u.data());e.onReceive(o,r)})})])}}),Xm=[br("channels",cr(Ke.value,Qt([Ru("onReceive"),Er("schema",mr())])))],Jm=No({fields:Xm,name:"receiving",active:Km}),Qm="comments.readonly",$m=function(n){return Ym.config(n)},Zm=function(){var n,e;return Jm.config({channels:(n={},n[Qm]={schema:Qt([(e="readonly",br(e,pr))]),onReceive:function(n,e){Ym.set(n,e.readonly)}},n)})},ng=function(n){return[$m(n),Zm()]},eg=Qm,tg="tox-button--naked",rg="tox-comment",og="tox-comment__body",ig="tox-textarea",ug="tox-comment__reply",cg="tox-comment__overlay",ag="tox-comment__overlaytext",sg="tox-comment__buttonspacing",fg="tox-button",lg="tox-comment__edit",dg="tox-comment__scroll",mg="tox-collection__item",gg="tox-conversations",pg="tox-comment__expander",vg=pg+" p:contains("+cl.tc_comment_buttons_showmore+")",hg=pg+" p:contains("+cl.tc_comment_buttons_showless+")",bg=function(n){return"."+n},yg=function(e){return function(n){return[bg(rg)+":contains("+n+")",bg(e)].join(" ")}},_g={selectors:{kebab:bg(tg),cardBody:bg(rg)+" "+bg(og),card:bg(rg),showMore:bg(vg),showLess:bg(hg),editItem:[".tox-menu",'[role="menuitem"]:contains('+cl.tc_kebab_edit+")"].join(" "),deleteItem:[".tox-menu",'[role="menuitem"]:contains('+cl.tc_kebab_delete+")"].join(" "),outerScroll:bg(dg),outerContainer:bg(gg),cardFor:function(n){return bg(rg)+':contains("'+n+'")'},cardN:function(n){return bg(rg)+":nth-child("+(n+1)+")"},kebabFor:yg(tg),showMoreFor:yg(vg),showLessFor:yg(hg),saveButton:".tox-button:contains("+cl.tc_edit_buttons_save+")",cancelButton:".tox-button:contains("+cl.tc_edit_buttons_cancel+")",clearButton:".tox-button:contains("+cl.tc_reply_buttons_clear+")",deleteButton:".tox-button:contains("+cl.tc_delete_buttons_proceed+")",commentText:[bg(gg),bg(dg),bg(rg),"textarea"].join(" "),editActions:bg(lg),cardDeleteButtons:bg(sg),cardDeleteOverlay:bg(cg),cardDeleteOverlayText:bg(ag),replyTextarea:"."+ug+" textarea",editTextarea:[bg(rg),"textarea"].join(" "),kebabMenu:bg("tox-menu"),textarea:bg(ig)},states:{kebabOpen:tg+"--open",bodyExpanded:"tox-comment__body--expanded",bodyNotAnimating:"tox-comment__body--pending",disappearing:"tox-comment--disappearing",deletingConversation:"tox-comment-thread__overlay",bodyHasGradient:"tox-comment__gradient",editingTextarea:ig},classes:{showMoreLessContainer:[pg],outerContainer:[gg],date:["tox-comment__date"],replySection:[ug],replyTextarea:[ig],textarea:[],editTextarea:[],kebab:[tg,fg,"tox-button--icon"],kebabIcon:["tox-icon"],card:[rg],cardHead:["tox-comment__header"],cardHeadMeta:["tox-comment__meta"],cardBody:[og],cardDelete:[cg],cardDeleteLabel:[ag],cardDeleteButtons:[sg],button:[fg],secondaryButton:[fg,"tox-button--secondary"],editActions:[lg],outerScroll:[dg],commentList:["tox-comment-thread"],avatar:["tox-user__avatar"],username:["tox-user__name"],user:["tox-user"],showMoreLess:[],kebabItem:[mg],kebabItemLabel:["tox-collection__item-label"],kebabDisabledItem:["tox-collection__item--state-disabled"],kebabMenu:["tox-menu","tox-collection","tox-collection--list"],kebabMenuGroup:["tox-collection__group"],roots:{silver:[gg],modern:[gg,"tox"]}},markers:{kebab:{backgroundMenu:"tox-menu--background",selectedMenu:"tox-menu--active",menu:"tox-menu",item:mg,selectedItem:"tox-collection__item--active"}}},wg=function(t){return function(n){var e=n.eventName.map(function(e){return{action:function(n){ao(n,e)}}}).getOr({});return Fm.sketch(xn(xn({dom:{tag:"button",classes:t,styles:void 0!==n.styles?n.styles:{},innerHtml:n.text}},e),{buttonBehaviours:Mo(Sn([Jf.config({})],ng({})))}))}},xg=wg(_g.classes.button),Og=wg(_g.classes.secondaryButton),Sg={withClasses:wg,primary:xg,secondary:Og},Eg="tc-save-edit",Cg="tc-cancel-edit",kg=xi("tc-patch-comment-state-event"),Tg=xi("tc-purge-comment-state-event"),Mg=xi("tc-force-patch-state-event");(rd=td||(td={})).None="Prop_None",rd.Collapsed="Prop_Collapsed",rd.Expanded="Prop_Expanded",rd.CollapsedOrNone="Prop_CollapsedOrNone",rd.ExpandOrNone="Prop_ExpandOrNone",rd.Edit="Prop_Edit",(id=od||(od={}))[id.BeforeDelete=0]="BeforeDelete",id[id.QueryingDelete=1]="QueryingDelete",id[id.PostDelete=2]="PostDelete";var Dg,Ng,Ag=function(n){return W(n.conversation,function(n){return n.props})},Fg=function(n,e){return xn(xn({},n),{targetUid:e})},Rg=function(n,e){return xn(xn({},n),{queue:n.queue.concat(e)})},Bg=function(n){if(0<n.queue.length){var e=(t=W((r=n).conversation,function(t){return Y(r.queue,function(n){return n.uid===t.uid}).fold(function(){return t},function(n){var e=void 0!==n.patch.content?{mode:td.ExpandOrNone}:{};return{uid:t.uid,props:xn(xn(xn({},t.props),n.patch),e)}})}),{targetUid:r.targetUid,conversation:t,queue:[]});return ln.some({world:e,props:Ag(e)})}return ln.none();var r,t},Ig=function(){return{targetUid:ln.none(),conversation:[],queue:[]}},Hg=function(t,r){return function(n){var e=r(n);so(n,kg,{uid:t,patch:e})}},Pg=function(t,r){return function(n){var e=r(n);so(n,kg,{uid:t,patch:e}),ao(n,Mg)}},jg=function(n){return ao(n,Mg)},Lg=function(n,e){ru(n.element(),"visibility","hidden"),yl.set(n,!1);var t=n.element().dom().clientHeight;return yl.set(n,!0),au(n.element(),"visibility"),n.element().dom().scrollHeight>t+1?e:td.None},Vg=function(n){yl.off(n),rt(n.element(),_g.states.bodyHasGradient)},Wg=function(n){yl.on(n),it(n.element(),_g.states.bodyHasGradient)},Ug=function(n){return ge(n.element())},zg=function(n,e){Gg(n),e.getOpt(n).fold(function(){Ef.append(n,e.asSpec())},function(){})},qg=function(n){it(n.element(),_g.states.bodyHasGradient),yl.set(n,!1),Pe(n.element(),"aria-expanded")},Gg=function(n){Ug(n).each(function(n){Pe(n,"readonly"),rt(n,_g.states.editingTextarea),Vo(n);var e=n.dom(),t=su(n).length;e.setSelectionRange(t,t)}),n.element().dom().scrollTop=0},Yg=function(n){Ug(n).each(function(n){Re(n,"readonly","true"),it(n,_g.states.editingTextarea)})},Kg=function(r){var n,e=function(n){return function(e){U(n,function(n){return n(e)})}},t=function(e){Ug(e).each(function(n){au(n,"height"),Yf.setValue(e,r.props.content),e.getSystem().triggerEvent(Vr(),n,{})})},o=function(n){return e=n,t=r.memCommands,Yg(e),void t.getOpt(e).each(function(n){Ef.remove(e,n)});var e,t},i=((n={})[td.None]=e([o,t,qg]),n[td.Expanded]=e([o,t,Wg]),n[td.Collapsed]=e([o,t,Vg]),n[td.ExpandOrNone]=e([o,t,function(n){rt(n.element(),_g.states.bodyNotAnimating);var e=Lg(n,td.Expanded);Hg(r.props.uid,function(){return{mode:e}})(n)}]),n[td.CollapsedOrNone]=e([o,t,function(n){rt(n.element(),_g.states.bodyNotAnimating);var e=Lg(n,td.Collapsed);e===td.Collapsed&&(rt(n.element(),_g.states.bodyHasGradient),yl.off(n)),n.element().dom().offsetWidth,Hg(r.props.uid,function(){return{mode:e}})(n)}]),n[td.Edit]=e([function(n){return e=n,t=r.memCommands,yl.on(e),it(e.element(),_g.states.bodyHasGradient),void zg(e,t);var e,t},t]),n);return gn(i,r.props.mode)},Xg=xi("tc-focus-outer-comment"),Jg=xi("tc-start-delete-comment"),Qg=xi("tc-start-delete-conversation"),$g=xi("tc-commit-delete"),Zg=xi("tc-start-edit-comment"),np=xi("tc-commit-edit-comment"),ep=(xi("tc-cancel-edit-comment"),xi("tc-long-content"),xi("tc-short-content"),xi("tc-toggle-comment")),tp=sn([wr("data"),Er("inputAttributes",{}),Er("inputStyles",{}),Er("tag","input"),Er("inputClasses",[]),Au("onSetValue"),Er("styles",{}),Er("eventOrder",{}),wu("inputBehaviours",[Yf,Rf]),Er("selectOnFocus",!0)]),rp=function(n){return xn(xn({},(e=n,Mo([Rf.config({onFocus:e.selectOnFocus?function(n){var e=n.element(),t=su(e);e.dom().setSelectionRange(0,t.length)}:_})]))),Ou(n.inputBehaviours,[Yf.config({store:xn(xn({mode:"manual"},n.data.map(function(n){return{initialValue:n}}).getOr({})),{getValue:function(n){return su(n.element())},setValue:function(n,e){su(n.element())!==e&&fu(n.element(),e)}}),onSetValue:n.onSetValue})]));var e},op=Ec({name:"Input",configFields:tp(),factory:function(n,e){return{uid:n.uid,dom:(t=n,{tag:t.tag,attributes:xn({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}),components:[],behaviours:rp(n),eventOrder:n.eventOrder};var t}}),ip="data-alloy-widget-tabstop",up=function(n){return Am.config({mode:"cyclic",onEscape:n.onEscape,useTabstopAt:function(n){return"textarea"!==Me(n)||"true"!==Ie(n,"readonly")}})},cp=function(e){return Am.config({mode:"special",onEnter:function(n){return ao(n,e.enterEvent),ln.some(!0)},onShiftEnter:function(n,e){return e.cut(),ln.none()},onSpace:function(n,e){return e.cut(),ln.none()}})},ap=function(t){return Am.config({mode:"cyclic",selector:"["+ip+'="true"]',focusInside:Fs.OnEnterOrSpaceMode,onEscape:function(n,e){return Nr(n,e)?ln.none():(ao(n,t.escapeEvent),ln.some(!0))}})},sp=function(n){return Am.config({mode:"flow",allowVertical:!0,selector:n.selector})},fp=ip,lp={"data-gramm_editor":"false",rows:"2"},dp={"white-space":"pre-wrap"},mp=function(n){var e=n.element().dom().clientHeight,t=n.element().dom().scrollHeight;e<t&&ru(n.element(),"height",t+"px")},gp=function(n,e){var t,r,o=Tn(n),i=function(n){ao(n,Xg),Pg(o.get().uid,function(n){return{mode:td.ExpandOrNone}})(n)},u={updateWith:function(e,n,t){o.set(n),Kg({props:n,memCommands:c}).each(function(n){it(e.element(),_g.states.bodyNotAnimating),n(e)})}},c=Hc((o.get(),t=e,{dom:{tag:"div",classes:_g.classes.editActions},components:[Sg.withClasses(_g.classes.secondaryButton)({text:t.translate(cl.tc_edit_buttons_cancel),eventName:ln.some(Cg)}),Sg.withClasses(_g.classes.button)({text:t.translate(cl.tc_edit_buttons_save),eventName:ln.some(Eg)})]}));return{dom:{tag:"div",classes:_g.classes.cardBody},components:[(r=o.get().content,op.sketch({tag:"textarea",inputAttributes:xn(xn({},lp),{readonly:"true"}),inputClasses:_g.classes.editTextarea,inputStyles:xn(xn({},dp),{"overflow-y":"hidden",border:"none !important"}),data:r,inputBehaviours:Mo(Sn([Ro("textarea-events",[bo(function(n){mp(n)}),po(Vr(),mp)]),cp({enterEvent:np}),Jf.config({})],ng({})))}))],behaviours:Mo([Ro("overflow-events",[bo(function(n){u.updateWith(n,o.get(),{})}),po(Eg,function(n){ao(n,np)}),po(Cg,i)]),up({onEscape:function(n,e){return i(n),ln.some(!0)}}),yl.config({toggleClass:_g.states.bodyExpanded,selected:!1,toggleOnExecute:!1,aria:{mode:"expanded"}}),Yf.config({store:{mode:"manual",getValue:function(n){return ge(n.element()).map(su).getOr("")},setValue:function(n,e){ge(n.element()).each(function(n){fu(n,e)})}}}),Ef.config({})]),apis:u}},pp=6048e5,vp=4*pp;(Ng=Dg||(Dg={}))[Ng.LessThanMinute=0]="LessThanMinute",Ng[Ng.Minute=1]="Minute",Ng[Ng.Hour=2]="Hour",Ng[Ng.Day=3]="Day",Ng[Ng.Week=4]="Week",Ng[Ng.Month=5]="Month",Ng[Ng.Year=6]="Year";var hp,bp,yp,_p=function(n,e){var t=n()-Date.parse(e);return t<6e4?{interval:Dg.LessThanMinute,intervalUnits:t,intervalMs:t}:t<36e5?{interval:Dg.Minute,intervalUnits:Math.floor(t/6e4),intervalMs:t}:t<864e5?{interval:Dg.Hour,intervalUnits:Math.floor(t/36e5),intervalMs:t}:t<pp?{interval:Dg.Day,intervalUnits:Math.floor(t/864e5),intervalMs:t}:t<vp?{interval:Dg.Week,intervalUnits:Math.floor(t/pp),intervalMs:t}:t<290304e5?{interval:Dg.Month,intervalUnits:Math.floor(t/vp),intervalMs:t}:{interval:Dg.Year,intervalUnits:Math.floor(t/290304e5),intervalMs:t}},wp={nowISO8601:function(){return(new Date).toISOString()},distanceFromNow:g(_p,function(){return Date.now()}),distanceFrom:_p},xp=((hp={})[Dg.LessThanMinute]=[cl.tc_date_less_than_a_minute_ago,cl.tc_date_less_than_a_minute_ago],hp[Dg.Minute]=[cl.tc_date_1_minute_ago,cl.tc_date_x_minutes_ago],hp[Dg.Hour]=[cl.tc_date_1_hour_ago,cl.tc_date_x_hours_ago],hp[Dg.Day]=[cl.tc_date_1_day_ago,cl.tc_date_x_days_ago],hp[Dg.Week]=[cl.tc_date_1_week_ago,cl.tc_date_x_weeks_ago],hp[Dg.Month]=[cl.tc_date_1_month_ago,cl.tc_date_x_months_ago],hp[Dg.Year]=[cl.tc_date_1_year_ago,cl.tc_date_x_years_ago],hp),Op=function(n,c){var r=function(n){return[(e=""+(r=wp.distanceFromNow(n.createdAt),o=c,i=xp[r.interval],u=1===r.intervalUnits?i[0]:i[1],o.translate([u,r.intervalUnits])),t=w.fromText(e),hu({element:t})),{dom:{tag:"span",classes:[],innerHtml:n.modifiedAt===n.createdAt?"":c.translate(cl.tc_date_comment_edited)}}];var e,t,r,o,i,u},e={updateWith:function(n,e,t){Ef.set(n,r(e))}};return{dom:{tag:"div",classes:_g.classes.date},components:r(n),behaviours:Mo([Ef.config({})]),apis:e}},Sp={editCommentEvent:xi("tc-conversation-edit-comment"),deleteCommentEvent:xi("tc-conversation-delete-comment"),deleteConversationEvent:xi("tc-conversation-delete-all"),createCommentEvent:xi("tc-conversation-create")},Ep=function(n){var e,t,r,o=w.fromHtml(n),i=de(o),u=(t=void 0!==(e=o).dom().attributes?e.dom().attributes:[],G(t,function(n,e){var t;return"class"===e.name?n:xn(xn({},n),((t={})[e.name]=e.value,t))},{})),c=(r=o,Array.prototype.slice.call(r.dom().classList,0)),a=0===i.length?{}:{innerHtml:Yo(o)};return xn({tag:Me(o),classes:c,attributes:u},a)},Cp=[Jf.config({}),Ro("overlay-button-events",[po(Hr(),function(n,e){e.event().prevent()})])],kp=function(n,e,t){t?(au(e.element(),"display"),e.hasConfigured(Am)&&Am.focusIn(e)):ru(e.element(),"display","none")},Tp=function(e,n){return(t=n,jo(t,function(n){if(!Ne(n))return!1;var e=Ie(n,"id");return void 0!==e&&-1<e.indexOf("aria-owns")}).bind(function(n){var e=Ie(n,"id"),t=se(n);return ci(t,'[aria-owns="'+e+'"]')})).exists(function(n){return Mp(e,n)});var t},Mp=function(e,n){return Lo(n,function(n){return ae(n,e.element())},sn(!1))||Tp(e,n)},Dp=Object.freeze({__proto__:null,getCoupled:function(n,e,t,r){return t.getOrCreate(n,e,r)}}),Np=[br("others",cr(Ke.value,mr()))],Ap=No({fields:Np,name:"coupling",apis:Dp,state:Object.freeze({__proto__:null,init:function(){var i={},n=sn({});return Mr({readState:n,getOrCreate:function(t,r,o){var n=on(r.others);if(n)return gn(i,o).getOrThunk(function(){var n=gn(r.others,o).getOrDie("No information found for coupled component: "+o)(t),e=t.getSystem().build(n);return i[o]=e});throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(n,null,2))}})}})}),Fp=function(e,n,t,r){t.get().each(function(n){Bc(e)});var o=n.getAttachPoint(e);Nc(o,e);var i=e.getSystem().build(r);return Nc(e,i),t.set(i),i},Rp=function(n,e,t,r){var o=Fp(n,e,t,r);return e.onOpen(n,o),o},Bp=function(e,t,r){r.get().each(function(n){Bc(e),Rc(e),t.onClose(e,n),r.clear()})},Ip=function(n,e,t){return t.isOpen()},Hp=function(n,e,t){var r,o,i,u,c=e.getAttachPoint(n);ru(n.element(),"position",_f.getMode(c)),r=n,o="visibility",i=e.cloakVisibilityAttr,u="hidden",cu(r.element(),o).fold(function(){Pe(r.element(),i)},function(n){Re(r.element(),i,n)}),ru(r.element(),o,u)},Pp=function(n,e,t){var r;r=n.element(),V(["top","left","right","bottom"],function(n){return cu(r,n).isSome()})||au(n.element(),"position"),function(n,e,t){if(He(n.element(),t)){var r=Ie(n.element(),t);ru(n.element(),e,r)}else au(n.element(),e)}(n,"visibility",e.cloakVisibilityAttr)},jp=Object.freeze({__proto__:null,cloak:Hp,decloak:Pp,open:Rp,openWhileCloaked:function(n,e,t,r,o){Hp(n,e),Rp(n,e,t,r),o(),Pp(n,e)},close:Bp,isOpen:Ip,isPartOf:function(e,t,n,r){return Ip(0,0,n)&&n.get().exists(function(n){return t.isPartOf(e,n,r)})},getState:function(n,e,t){return t.get()},setContent:function(n,e,t,r){return t.get().map(function(){return Fp(n,e,t,r)})}}),Lp=Object.freeze({__proto__:null,events:function(t,r){return go([po(Zr(),function(n,e){Bp(n,t,r)})])}}),Vp=[Au("onOpen"),Au("onClose"),hr("isPartOf"),hr("getAttachPoint"),Er("cloakVisibilityAttr","data-precloak-visibility")],Wp=No({fields:Vp,name:"sandboxing",active:Lp,apis:jp,state:Object.freeze({__proto__:null,init:function(){var e=Tn(ln.none()),n=sn("not-implemented");return Mr({readState:n,isOpen:function(){return e.get().isSome()},clear:function(){e.set(ln.none())},set:function(n){e.set(ln.some(n))},get:function(){return e.get()}})}})}),Up="alloy.item-hover",zp="alloy.item-focus",qp=function(n){(Uo(n.element()).isNone()||Rf.isFocused(n))&&(Rf.isFocused(n)||Rf.focus(n),so(n,Up,{item:n}))},Gp=function(n){so(n,zp,{item:n})},Yp=sn(Up),Kp=sn(zp),Xp=[hr("data"),hr("components"),hr("dom"),Er("hasSubmenu",!1),wr("toggling"),Su("itemBehaviours",[yl,Rf,Am,Yf]),Er("ignoreFocus",!1),Er("domModification",{}),Iu("builder",function(n){return{dom:n.dom,domModification:xn(xn({},n.domModification),{attributes:xn(xn(xn({role:n.toggling.isSome()?"menuitemcheckbox":"menuitem"},n.domModification.attributes),{"aria-haspopup":n.hasSubmenu}),n.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Eu(n.itemBehaviours,[n.toggling.fold(yl.revoke,function(n){return yl.config(xn({aria:{mode:"checked"}},n))}),Rf.config({ignore:n.ignoreFocus,stopMousedown:n.ignoreFocus,onFocus:function(n){Gp(n)}}),Am.config({mode:"execution"}),Yf.config({store:{mode:"memory",initialValue:n.data}}),Ro("item-type-events",Sn(_l(),[po(Pr(),qp),po(Jr(),Rf.focus)]))]),components:n.components,eventOrder:n.eventOrder}}),Er("eventOrder",{})],Jp=[hr("dom"),hr("components"),Iu("builder",function(n){return{dom:n.dom,components:n.components,events:go([(e=Jr(),po(e,function(n,e){e.stop()}))])};var e})],Qp=sn([ac({name:"widget",overrides:function(e){return{behaviours:Mo([Yf.config({store:{mode:"manual",getValue:function(n){return e.data},setValue:function(){}}})])}}})]),$p=[hr("uid"),hr("data"),hr("components"),hr("dom"),Er("autofocus",!1),Er("ignoreFocus",!1),Su("widgetBehaviours",[Yf,Rf,Am]),Er("domModification",{}),yc(Qp()),Iu("builder",function(i){var n=vc(0,i,Qp()),e=hc("item-widget",i,n.internals()),t=function(n){return(e=n,t=i,r="widget",o=t.partUids[r],e.getSystem().getByUid(o).toOption()).map(function(n){return Am.focusIn(n),n});var e,t,r,o},r=function(n,e){return fd(e.event().target())||i.autofocus&&e.setSource(n.element()),ln.none()};return{dom:i.dom,components:e,domModification:i.domModification,events:go([wo(function(n,e){t(n).each(function(n){e.stop()})}),po(Pr(),qp),po(Jr(),function(n,e){i.autofocus?t(n):Rf.focus(n)})]),behaviours:Eu(i.widgetBehaviours,[Yf.config({store:{mode:"memory",initialValue:i.data}}),Rf.config({ignore:i.ignoreFocus,onFocus:function(n){Gp(n)}}),Am.config({mode:"special",focusIn:i.autofocus?function(n){t(n)}:Fo(),onLeft:r,onRight:r,onEscape:function(n,e){return Rf.isFocused(n)||i.autofocus?(i.autofocus&&e.setSource(n.element()),ln.none()):(Rf.focus(n),ln.some(!0))}})])}})],Zp=dr("type",{widget:$p,item:Xp,separator:Jp}),nv=sn([lc({factory:{sketch:function(n){var e=fr("menu.spec item",Zp,n);return e.builder(e)}},name:"items",unit:"item",defaults:function(n,e){return e.hasOwnProperty("uid")?e:xn(xn({},e),{uid:Mi("item")})},overrides:function(n,e){return{type:e.type,ignoreFocus:n.fakeFocus,domModification:{classes:[n.markers.item]}}}})]),ev=sn([hr("value"),hr("items"),hr("dom"),hr("components"),Er("eventOrder",{}),wu("menuBehaviours",[Ul,Yf,Mf,Am]),Cr("movement",{mode:"menu",moveOnTab:!0},dr("mode",{grid:[Pu(),Iu("config",function(n,e){return{mode:"flatgrid",selector:"."+n.markers.item,initSize:{numColumns:e.initSize.numColumns,numRows:e.initSize.numRows},focusManager:n.focusManager}})],matrix:[Iu("config",function(n,e){return{mode:"matrix",selectors:{row:e.rowSelector,cell:"."+n.markers.item},focusManager:n.focusManager}}),hr("rowSelector")],menu:[Er("moveOnTab",!0),Iu("config",function(n,e){return{mode:"menu",selector:"."+n.markers.item,moveOnTab:e.moveOnTab,focusManager:n.focusManager}})]})),br("markers",Tu()),Er("fakeFocus",!1),Er("focusManager",ql()),Au("onHighlight")]),tv=sn("alloy.menu-focus"),rv=Cc({name:"Menu",configFields:ev(),partFields:nv(),factory:function(n,e,t,r){return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:Ou(n.menuBehaviours,[Ul.config({highlightClass:n.markers.selectedItem,itemClass:n.markers.item,onHighlight:n.onHighlight}),Yf.config({store:{mode:"memory",initialValue:n.value}}),Mf.config({find:ln.some}),Am.config(n.movement.config(n,n.movement))]),events:go([po(Kp(),function(e,t){var n=t.event();e.getSystem().getByDom(n.target()).each(function(n){Ul.highlight(e,n),t.stop(),so(e,tv(),{menu:e,item:n})})}),po(Yp(),function(n,e){var t=e.event().item();Ul.highlight(n,t)})]),components:e,eventOrder:n.eventOrder,domModification:{attributes:{role:"menu"}}}}}),ov=function(t,r,o,n){return gn(o,n).bind(function(n){return gn(t,n).bind(function(n){var e=ov(t,r,o,n);return ln.some([n].concat(e))})}).getOr([])},iv=function(n,e){var t={};cn(n,function(n,e){U(n,function(n){t[n]=e})});var r=e,o=dn(e,function(n,e){return{k:n,v:e}}),i=an(o,function(n,e){return[e].concat(ov(t,r,o,e))});return an(t,function(n){return gn(i,n).getOr([n])})},uv=function(n){return"prepared"===n.type?ln.some(n.menu):ln.none()},cv={init:function(){var i=Tn({}),u=Tn({}),c=Tn({}),a=Tn(ln.none()),s=Tn({}),f=function(t){return function(n,e){for(var t=on(n),r=0,o=t.length;r<o;r++){var i=t[r],u=n[i];if(e(u,i,n))return ln.some(u)}return ln.none()}(i.get(),function(n,e){return n===t})},l=function(n){return e(n).bind(uv)},e=function(n){return gn(u.get(),n)},t=function(n){return gn(i.get(),n)};return{setMenuBuilt:function(n,e){var t;u.set(xn(xn({},u.get()),((t={})[n]={type:"prepared",menu:e},t)))},setContents:function(n,e,t,r){a.set(ln.some(n)),i.set(t),u.set(e),s.set(r);var o=iv(r,t);c.set(o)},expand:function(t){return gn(i.get(),t).map(function(n){var e=gn(c.get(),t).getOr([]);return[n].concat(e)})},refresh:function(n){return gn(c.get(),n)},collapse:function(n){return gn(c.get(),n).bind(function(n){return 1<n.length?ln.some(n.slice(1)):ln.none()})},lookupMenu:e,lookupItem:t,otherMenus:function(n){var e=s.get();return Z(on(e),n)},getPrimary:function(){return a.get().bind(l)},getMenus:function(){return u.get()},clear:function(){i.set({}),u.set({}),c.set({}),a.set(ln.none())},isClear:function(){return a.get().isNone()},getTriggeringPath:function(n,u){var e=z(t(n).toArray(),function(n){return l(n).isSome()});return gn(c.get(),n).bind(function(n){var i=$(e.concat(n));return function(n){for(var e=[],t=0;t<n.length;t++){var r=n[t];if(!r.isSome())return ln.none();e.push(r.getOrDie())}return ln.some(e)}(J(i,function(n,e){return(t=n,r=u,o=i.slice(0,e+1),l(t).bind(function(e){return f(t).bind(function(n){return r(n).map(function(n){return{triggeredMenu:e,triggeringItem:n,triggeringPath:o}})})})).fold(function(){return a.get().is(n)?[]:[ln.none()]},function(n){return[ln.some(n)]});var t,r,o}))})}}},extractPreparedMenu:uv},av=sn("collapse-item"),sv=Ec({name:"TieredMenu",configFields:[Bu("onExecute"),Bu("onEscape"),Ru("onOpenMenu"),Ru("onOpenSubmenu"),Au("onRepositionMenu"),Au("onCollapseMenu"),Er("highlightImmediately",!0),_r("data",[hr("primary"),hr("menus"),hr("expansions")]),Er("fakeFocus",!1),Au("onHighlight"),Au("onHover"),Du(),hr("dom"),Er("navigateOnHover",!0),Er("stayInDom",!1),wu("tmenuBehaviours",[Am,Ul,Mf,Ef]),Er("eventOrder",{})],apis:{collapseMenu:function(n,e){n.collapseMenu(e)},highlightPrimary:function(n,e){n.highlightPrimary(e)},repositionMenus:function(n,e){n.repositionMenus(e)}},factory:function(c,n){var a,e,i=Tn(ln.none()),u=function(r,o,n){return an(n,function(n,e){var t=function(){return rv.sketch(xn(xn({dom:n.dom},n),{value:e,items:n.items,markers:c.markers,fakeFocus:c.fakeFocus,onHighlight:c.onHighlight,focusManager:c.fakeFocus?(o=function(n){return Ul.getHighlighted(n).map(function(n){return n.element()})},{get:o,set:function(e,n){var t=o(e);e.getSystem().getByDom(n).fold(_,function(n){Ul.highlight(e,n)});var r=o(e);zl(e,t,r)}}):ql()}));var o};return e===o?{type:"prepared",menu:r.getSystem().build(t())}:{type:"notbuilt",nbMenu:t}})},s=cv.init(),f=function(n){return Yf.getValue(n).value},l=function(n){return an(c.data.menus,function(n,e){return J(n.items,function(n){return"separator"===n.type?[]:[n.data.value]})})},d=function(e,n){Ul.highlight(e,n),Ul.getHighlighted(n).orThunk(function(){return Ul.getFirst(n)}).each(function(n){lo(e,n.element(),Jr())})},m=function(e,n){return Al(W(n,function(n){return e.lookupMenu(n).bind(function(n){return"prepared"===n.type?ln.some(n.menu):ln.none()})}))},g=function(e,n,t){var r=m(n,n.otherMenus(t));U(r,function(n){Zi(n.element(),[c.markers.backgroundMenu]),c.stayInDom||Ef.remove(e,n)})},p=function(n,r){var o,e=(o=n,i.get().getOrThunk(function(){var t={},n=ct(o.element(),"."+c.markers.item),e=z(n,function(n){return"true"===Ie(n,"aria-haspopup")});return U(e,function(n){o.getSystem().getByDom(n).each(function(n){var e=f(n);t[e]=n})}),i.set(ln.some(t)),t}));cn(e,function(n,e){var t=L(r,e);Re(n.element(),"aria-expanded",t)})},v=function(r,o,i){return ln.from(i[0]).bind(function(n){return o.lookupMenu(n).bind(function(n){if("notbuilt"===n.type)return ln.none();var e=n.menu,t=m(o,i.slice(1));return U(t,function(n){rt(n.element(),c.markers.backgroundMenu)}),Le(e.element())||Ef.append(r,_u(e)),Zi(e.element(),[c.markers.backgroundMenu]),d(r,e),g(r,o,i),ln.some(e)})})};(e=a||(a={}))[e.HighlightSubmenu=0]="HighlightSubmenu",e[e.HighlightParent=1]="HighlightParent";var h=function(o,i,u){void 0===u&&(u=a.HighlightSubmenu);var n=f(i);return s.expand(n).bind(function(r){return p(o,r),ln.from(r[0]).bind(function(t){return s.lookupMenu(t).bind(function(n){var e=function(n,e,t){if("notbuilt"!==t.type)return t.menu;var r=n.getSystem().build(t.nbMenu());return s.setMenuBuilt(e,r),r}(o,t,n);return Le(e.element())||Ef.append(o,_u(e)),c.onOpenSubmenu(o,i,e,$(r)),u===a.HighlightSubmenu?(Ul.highlightFirst(e),v(o,s,r)):(Ul.dehighlightAll(e),ln.some(i))})})})},r=function(e,t){var n=f(t);return s.collapse(n).bind(function(n){return p(e,n),v(e,s,n).map(function(n){return c.onCollapseMenu(e,t,n),n})})},t=function(t){return function(e,n){return ai(n.getSource(),"."+c.markers.item).bind(function(n){return e.getSystem().getByDom(n).toOption().bind(function(n){return t(e,n).map(function(){return!0})})})}},o=go([po(tv(),function(t,r){var n=r.event().item();s.lookupItem(f(n)).each(function(){var n=r.event().menu();Ul.highlight(t,n);var e=f(r.event().item());s.refresh(e).each(function(n){return g(t,s,n)})})}),wo(function(e,n){var t=n.event().target();e.getSystem().getByDom(t).each(function(n){0===f(n).indexOf("collapse-item")&&r(e,n),h(e,n,a.HighlightSubmenu).fold(function(){c.onExecute(e,n)},function(){})})}),bo(function(e,n){var t,r,o;(t=e,r=u(t,c.data.primary,c.data.menus),o=l(),s.setContents(c.data.primary,r,c.data.expansions,o),s.getPrimary()).each(function(n){Ef.append(e,_u(n)),c.onOpenMenu(e,n),c.highlightImmediately&&d(e,n)})})].concat(c.navigateOnHover?[po(Yp(),function(n,e){var t,r,o=e.event().item();t=n,r=f(o),s.refresh(r).bind(function(n){return p(t,n),v(t,s,n)}),h(n,o,a.HighlightParent),c.onHover(n,o)})]:[])),b=function(n){return Ul.getHighlighted(n).bind(Ul.getHighlighted)},y={collapseMenu:function(e){b(e).each(function(n){r(e,n)})},highlightPrimary:function(e){s.getPrimary().each(function(n){d(e,n)})},repositionMenus:function(r){s.getPrimary().bind(function(e){return b(r).bind(function(n){var e,t=f(n),r=(e=s.getMenus(),mn(e,function(n){return n})),o=Al(W(r,cv.extractPreparedMenu));return s.getTriggeringPath(t,function(n){return t=n,tn(o,function(n){if(!n.getSystem().isConnected())return ln.none();var e=Ul.getCandidates(n);return Y(e,function(n){return f(n)===t})});var t})}).map(function(n){return{primary:e,triggeringPath:n}})}).fold(function(){var n;(n=r,ln.from(n.components()[0]).filter(function(n){return"menu"===Ie(n.element(),"role")})).each(function(n){c.onRepositionMenu(r,n,[])})},function(n){var e=n.primary,t=n.triggeringPath;c.onRepositionMenu(r,e,t)})}};return{uid:c.uid,dom:c.dom,markers:c.markers,behaviours:Ou(c.tmenuBehaviours,[Am.config({mode:"special",onRight:t(function(n,e){return fd(e.element())?ln.none():h(n,e,a.HighlightSubmenu)}),onLeft:t(function(n,e){return fd(e.element())?ln.none():r(n,e)}),onEscape:t(function(n,e){return r(n,e).orThunk(function(){return c.onEscape(n,e).map(function(){return n})})}),focusIn:function(e,n){s.getPrimary().each(function(n){lo(e,n.element(),Jr())})}}),Ul.config({highlightClass:c.markers.selectedMenu,itemClass:c.markers.menu}),Mf.config({find:function(n){return Ul.getHighlighted(n)}}),Ef.config({})]),eventOrder:c.eventOrder,apis:y,events:o}},extraApis:{tieredData:function(n,e,t){return{primary:n,menus:e,expansions:t}},singleData:function(n,e){return{primary:n,menus:Pt(n,e),expansions:{}}},collapseItem:function(n){return{value:xi(av()),meta:{text:n}}}}}),fv=sn("sink"),lv=sn(fc({name:fv(),overrides:sn({dom:{tag:"div"},behaviours:Mo([_f.config({useFixed:i})]),events:go([ho(jr()),ho(Hr()),ho(Wr())])})})),dv=Qt([Er("isExtraPart",sn(!1)),Or("fireEventInstead",[Er("event",ro())])]),mv=Qt([Or("fireEventInstead",[Er("event",oo())]),yr("doReposition")]);(yp=bp||(bp={}))[yp.HighlightFirst=0]="HighlightFirst",yp[yp.HighlightNone=1]="HighlightNone";var gv,pv,vv=function(n,e){var t=n.getHotspot(e).getOr(e),r=n.getAnchorOverrides();return n.layouts.fold(function(){return{anchor:"hotspot",hotspot:t,overrides:r}},function(n){return{anchor:"hotspot",hotspot:t,overrides:r,layouts:n}})},hv=function(n,e,t,r,o,i,u){var c,a,s,f,l,d,m,g,p,v,h=vv(n,t);return(a=h,f=r,l=o,d=u,m=e,g=s=t,p=(0,(c=n).fetch)(g).map(m),v=wv(s,c),p.map(function(n){return n.bind(function(n){return ln.from(sv.sketch(xn(xn({},l.menu()),{uid:Mi(""),data:n,highlightImmediately:d===bp.HighlightFirst,onOpenMenu:function(n,e){var t=v().getOrDie();_f.position(t,a,e),Wp.decloak(f)},onOpenSubmenu:function(n,e,t){var r=v().getOrDie();_f.position(r,{anchor:"submenu",item:e},t),Wp.decloak(f)},onRepositionMenu:function(n,e,t){var r=v().getOrDie();_f.position(r,a,e),U(t,function(n){_f.position(r,{anchor:"submenu",item:n.triggeringItem},n.triggeredMenu)})},onEscape:function(){return Rf.focus(s),Wp.close(f),ln.some(!0)}})))})})).map(function(n){return n.fold(function(){Wp.isOpen(r)&&Wp.close(r)},function(n){Wp.cloak(r),Wp.open(r,n),i(r)}),r})},bv=function(n,e,t,r,o,i,u){return Wp.close(r),Te(r)},yv=function(n,e,t,r,o,i){var u=Ap.getCoupled(t,"sandbox");return(Wp.isOpen(u)?bv:hv)(n,e,t,u,r,o,i)},_v=function(n,e,t){var r,o,i,u=Mf.getCurrent(e).getOr(e),c=(r=n.element(),Xc.get(r));t?ru(u.element(),"min-width",c+"px"):(o=u.element(),i=c,Xc.set(o,i))},wv=function(e,n){return e.getSystem().getByUid(n.uid+"-"+fv()).map(function(n){return function(){return Ke.value(n)}}).getOrThunk(function(){return n.lazySink.fold(function(){return function(){return Ke.error(new Error("No internal sink is specified, nor could an external sink be found"))}},function(n){return function(){return n(e)}})})},xv=function(n){Wp.getState(n).each(function(n){sv.repositionMenus(n)})},Ov=function(r,o,i){var e,n,t,u,c,a,s,f=(e=xi("aria-owns"),{id:sn(e),link:function(n){Re(n,"aria-owns",e)},unlink:function(n){Pe(n,"aria-owns")}}),l=wv(o,r);return{dom:{tag:"div",classes:r.sandboxClasses,attributes:{id:f.id(),role:"listbox"}},behaviours:Eu(r.sandboxBehaviours,[Yf.config({store:{mode:"memory",initialValue:o}}),Wp.config({onOpen:function(n,e){var t=vv(r,o);f.link(o.element()),r.matchWidth&&_v(t.hotspot,e,r.useMinWidth),r.onOpen(t,n,e),void 0!==i&&void 0!==i.onOpen&&i.onOpen(n,e)},onClose:function(n,e){f.unlink(o.element()),void 0!==i&&void 0!==i.onClose&&i.onClose(n,e)},isPartOf:function(n,e,t){return Mp(e,t)||Mp(o,t)},getAttachPoint:function(){return l().getOrDie()}}),Mf.config({find:function(n){return Wp.getState(n).bind(function(n){return Mf.getCurrent(n)})}}),Jm.config({channels:xn(xn({},(c={isExtraPart:m},s=fr("Dismissal",dv,c),(a={})[y()]={schema:Qt([hr("target")]),onReceive:function(e,n){Wp.isOpen(e)&&(Wp.isPartOf(e,n.target)||s.isExtraPart(e,n.target)||s.fireEventInstead.fold(function(){return Wp.close(e)},function(n){return ao(e,n.event)}))}},a)),(n={doReposition:xv},u=fr("Reposition",mv,n),(t={})[p()]={onReceive:function(e){Wp.isOpen(e)&&u.fireEventInstead.fold(function(){return u.doReposition(e)},function(n){return ao(e,n.event)})}},t))})])}},Sv=sn([hr("dom"),hr("fetch"),Au("onOpen"),Fu("onExecute"),Er("getHotspot",ln.some),Er("getAnchorOverrides",sn({})),ms(),wu("dropdownBehaviours",[yl,Ap,Am,Rf]),hr("toggleClass"),Er("eventOrder",{}),wr("lazySink"),Er("matchWidth",!1),Er("useMinWidth",!1),wr("role")].concat([Er("sandboxClasses",[]),Su("sandboxBehaviours",[Mf,Jm,Wp,Yf])])),Ev=sn([sc({schema:[Du()],name:"menu",defaults:function(n){return{onExecute:n.onExecute}}}),lv()]),Cv=Cc({name:"Dropdown",configFields:Sv(),partFields:Ev(),factory:function(e,n,t,r){var o,i,u=function(n){Wp.getState(n).each(function(n){sv.highlightPrimary(n)})},c={expand:function(n){yl.isOn(n)||yv(e,function(n){return n},n,r,_,bp.HighlightNone).get(_)},open:function(n){yl.isOn(n)||yv(e,function(n){return n},n,r,_,bp.HighlightFirst).get(_)},isOpen:yl.isOn,close:function(n){yl.isOn(n)&&yv(e,function(n){return n},n,r,_,bp.HighlightFirst).get(_)},repositionMenus:function(n){var e,t;yl.isOn(n)&&(e=n,t=Ap.getCoupled(e,"sandbox"),xv(t))}},a=function(n,e){return fo(n),ln.some(!0)};return{uid:e.uid,dom:e.dom,components:n,behaviours:Ou(e.dropdownBehaviours,[yl.config({toggleClass:e.toggleClass,aria:{mode:"expanded"}}),Ap.config({others:{sandbox:function(n){return Ov(e,n,{onOpen:function(){yl.on(n)},onClose:function(){yl.off(n)}})}}}),Am.config({mode:"special",onSpace:a,onEnter:a,onDown:function(n,e){if(Cv.isOpen(n)){var t=Ap.getCoupled(n,"sandbox");u(t)}else Cv.open(n);return ln.some(!0)},onEscape:function(n,e){return Cv.isOpen(n)?(Cv.close(n),ln.some(!0)):ln.none()}}),Rf.config({})]),events:wl(ln.some(function(n){yv(e,function(n){return n},n,r,u,bp.HighlightFirst).get(_)})),eventOrder:xn(xn({},e.eventOrder),(o={},o[Xr()]=["disabling","toggling","alloy.base.behaviour"],o)),apis:c,domModification:{attributes:xn(xn({"aria-haspopup":"true"},e.role.fold(function(){return{}},function(n){return{role:n}})),"button"===e.dom.tag?{type:(i="type",gn(e.dom,"attributes").bind(function(n){return gn(n,i)})).getOr("button")}:{})}}},apis:{open:function(n,e){return n.open(e)},expand:function(n,e){return n.expand(e)},close:function(n,e){return n.close(e)},isOpen:function(n,e){return n.isOpen(e)},repositionMenus:function(n,e){return n.repositionMenus(e)}}}),kv=xi("tc-kebab-action"),Tv="basecamp",Mv="deleting",Dv={textKey:cl.tc_kebab_edit,eventName:Zg},Nv={textKey:cl.tc_kebab_delete,eventName:Jg},Av={textKey:cl.tc_kebab_deleteconversation,eventName:Qg},Fv=function(n,c,e,t,r){var o,i;void 0===e&&(e='<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 24C5.373 24 0 18.627 0 12S5.373 0 12 0s12 5.373 12 12-5.373 12-12 12zm-8.693-5.259A10.981 10.981 0 0 0 12 23c3.535 0 6.68-1.668 8.693-4.259C19.432 16.251 14.591 15 12 15c-2.59 0-7.432 1.25-8.693 3.741zm8.7-5.741C14.224 13 16 10.99 16 8.5S14.224 4 12.007 4C9.79 4 8 6.01 8 8.5S9.79 13 12.007 13z" fill-rule="nonzero"></path></svg>');var u,a,s,f,l,d,m,g,p,v,h,b,y,_,w,x,O=Tn(n),S=X([t.deleteConversation?[Av]:[],t.editComment?[Dv]:[],t.deleteComment?[Nv]:[]]),E=Hc(Op(n,r.universe)),C={updateWith:function(n,e,t){var r,o,i,u;O.set(e),T.getOpt(n).each(function(n){n.getApis().updateWith(n,e,{})}),M.getOpt(n).each(function(n){n.getApis().updateWith(n,e,{})}),r=n,o=t.numComments,i=e.isDeleting===od.QueryingDelete,u=c,D.getOpt(r).each(function(n){return kp(0,n,i)}),N.getOpt(r).each(function(n){var e=u?[cl.tc_delete_prompts_conversation,1===o?cl.tc_delete_prompts_conversation_detail_sing:{pattern:cl.tc_delete_prompts_conversation_detail_pl,targets:[o]}]:[cl.tc_delete_prompts_comment];n.getApis().setText(n,e),kp(0,n,i)}),e.isDeleting===od.PostDelete&&il.getCurrentRoute(n).filter(function(n){return n.destination===Mv}).fold(function(){il.progressTo(n,Mv)},function(n){}),E.getOpt(n).each(function(n){n.getApis().updateWith(n,e,{})})}},k={dom:{tag:"div",classes:_g.classes.cardHead},components:X([[{dom:{tag:"div",classes:_g.classes.cardHeadMeta},components:[(f=O.get().authorName,l=e,d={dom:{tag:"div",classes:_g.classes.avatar,innerHtml:l}},m={dom:{tag:"div",classes:_g.classes.username,innerHtml:f}},{dom:{tag:"div",classes:_g.classes.user},components:[d,{dom:{tag:"div"},components:[m,E.asSpec()]}]})]}],0<S.length?[(u=S,a=r,s=W(u,function(e){var n;return{type:"item",data:{value:e.eventName},dom:{tag:"div",classes:_g.classes.kebabItem},components:[{dom:{tag:"span",classes:_g.classes.kebabItemLabel,innerHtml:a.universe.translate(e.textKey)}}],itemBehaviours:Mo(Sn([Ro("item-events",[wo(function(n){so(n,kv,{eventName:e.eventName}),ao(n,Zr())})])],ng({disableClass:_g.classes.kebabDisabledItem.join(" ")}))),eventOrder:(n={},n[Xr()]=["disabling","alloy.base.behaviour","toggling","typeaheadevents","item-events"],n)}}),Cv.sketch({dom:{tag:"button",attributes:{type:"button"},classes:_g.classes.kebab},components:[{dom:{tag:"div",classes:_g.classes.kebabIcon,innerHtml:'<svg width="24" height="24" data-name="icon-image-options"><g id="icon-image-options" stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M6 10a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2zm12 0a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2zm-6 0a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2z" id="Shape" fill-rule="nonzero"></path></g></svg>'}}],lazySink:function(n){return a.getSink(n).fold(function(){return Ke.error("Could not find sink for kebab")},Ke.value)},dropdownBehaviours:Mo(Sn(ng({}),[Jf.config({tabAttr:fp})])),sandboxBehaviours:Mo([Ro("kebab-sandbox-events",[po(kv,function(n,e){var t=Yf.getValue(n);ao(t,e.event().eventName())})])]),parts:{menu:{dom:{tag:"div"},markers:_g.markers.kebab}},toggleClass:_g.states.kebabOpen,layouts:{onLtr:function(){return[Qa]},onRtl:function(){return[Ja]}},fetch:function(n){var e=xi("kebab-id");return Te(ln.some(sv.singleData(e,{value:xi(e),dom:{tag:"div",classes:_g.classes.kebabMenu},components:[{dom:{tag:"div",classes:_g.classes.kebabMenuGroup},components:[rv.parts().items({})]}],items:s})))}}))]:[]])},T=Hc((g={uid:n.uid,mode:n.mode},p=Tn(g),v={updateWith:function(n,e,t){switch(p.set(e),e.mode){case td.None:ru(n.element(),"display","none");break;case td.Collapsed:au(n.element(),"display"),ge(n.element()).each(function(n){return Ko(n,cl.tc_comment_buttons_showmore)});break;case td.Expanded:au(n.element(),"display"),ge(n.element()).each(function(n){return Ko(n,cl.tc_comment_buttons_showless)});break;case td.ExpandOrNone:case td.CollapsedOrNone:break;case td.Edit:ru(n.element(),"display","none")}}},{dom:{tag:"div",classes:_g.classes.showMoreLessContainer,styles:{display:"none"}},components:[Fm.sketch({dom:{tag:"p",classes:_g.classes.showMoreLess,innerHtml:cl.tc_comment_buttons_showmore},action:function(n){Pg(p.get().uid,function(n){return{mode:p.get().mode===td.Collapsed?td.Expanded:td.Collapsed}})(n)},buttonBehaviours:Mo([Jf.config({tabAttr:fp})])})],apis:v})),M=Hc(gp(O.get(),r.universe)),D=Hc((r.universe,{dom:{tag:"div",classes:_g.classes.cardDelete,styles:{display:"none"}}})),N=Hc((h=function(){return O.get().uid},b=r.universe,y=function(n){ao(n,Xg),Pg(h(),function(n){return{isDeleting:od.BeforeDelete}})(n)},_=function(n,e,t){var r;return Fm.sketch({dom:{tag:"button",classes:n?_g.classes.button:_g.classes.secondaryButton,innerHtml:e},eventOrder:(r={},r[Hr()]=["alloy.base.behaviour","focusing","overlay-button-events"],r),action:t,buttonBehaviours:Mo(Cp)})},w={setText:function(n,e){Ef.set(n,W(e,function(n){var e="string"==typeof n?b.translate(n):b.translate([n.pattern].concat(n.targets));return{dom:{tag:"div"},components:[{dom:Ep("<p>"+e+"</p>")}]}}).concat([x.asSpec()]))}},x=Hc({dom:{tag:"div",classes:_g.classes.cardDeleteButtons},components:[_(!0,b.translate(cl.tc_delete_buttons_cancel),y),_(!1,b.translate(cl.tc_delete_buttons_proceed),function(n){ao(n,$g)})]}),{dom:{tag:"div",styles:{display:"none"},classes:_g.classes.cardDeleteLabel},components:[],apis:w,behaviours:Mo([Ef.config({}),Ro("card-delete-events",[po(Gr(),function(n){Uo(n.element()).fold(function(){Pg(h(),function(n){return{isDeleting:od.BeforeDelete}})(n)},function(){})})]),Am.config({mode:"cyclic",onEscape:function(n){return y(n),ln.some(!0)}})])}));return{dom:{tag:"div",classes:_g.classes.card,styles:{position:"relative"}},components:[k,M.asSpec(),D.asSpec(),N.asSpec(),T.asSpec()],behaviours:Mo([Rf.config({}),Jf.config({}),ap({escapeEvent:Xg}),il.config({initialState:Tv,onTransition:function(n,e){var t;t=O.get().uid,so(n,Tg,{uid:t})},routes:(o={},o[Tv]=(i={},i[Mv]={transition:{property:"opacity",transitionClass:_g.states.disappearing}},i),o)}),Yf.config({store:{mode:"memory",initialValue:O.get().uid}}),Ro("comment-events",[po(ep,function(n){return Pg(O.get().uid,function(){return{mode:O.get().mode===td.Collapsed?td.Expanded:td.Collapsed}})(n)}),po(Xg,Rf.focus),po(Jg,function(n,e){Pg(O.get().uid,function(n){return{isDeleting:od.QueryingDelete}})(n)}),po(Qg,function(n,e){Pg(O.get().uid,function(n){return{isDeleting:od.QueryingDelete}})(n)}),po(Zg,function(n){return Pg(O.get().uid,function(n){return{mode:td.Edit}})(n)}),po(np,function(t){M.getOpt(t).each(function(n){var e=Yf.getValue(n);so(t,Sp.editCommentEvent,{uid:O.get().uid,content:e})})}),po($g,function(n,e){so(n,c?Sp.deleteConversationEvent:Sp.deleteCommentEvent,{uid:O.get().uid})})])]),apis:C}},Rv=function(n,r){return W(n,function(n,e){var t=0===e;return Fv(n,t,void 0,{editComment:!0,deleteComment:0<e,deleteConversation:t},r)})},Bv=function(n,o){var e={setComments:function(n,e){Mf.getCurrent(n).each(function(n){Ef.set(n,Rv(e,o))}),jg(n)},updateWith:function(e,r,n){Mf.getCurrent(e).each(function(n){var t=Ef.contents(n);en(r).exists(function(n){return n.isDeleting===od.QueryingDelete})?rt(n.element(),_g.states.deletingConversation):it(n.element(),_g.states.deletingConversation),t.length!==r.length?Ef.set(n,Rv(r,o)):U(t,function(n,e){t[e].getApis().updateWith(t[e],r[e],{numComments:r.length})}),jg(e)})},scrollToEnd:function(o){Mf.getCurrent(o).each(function(n){var e,t=Ef.contents(n);(e=t,0===e.length?ln.none():ln.some(e[e.length-1])).each(function(n){var e=o.element().dom(),t=e.getBoundingClientRect(),r=n.element().dom().getBoundingClientRect();r.top<t.top?e.scrollTop=r.top-t.top:r.bottom>t.bottom&&(e.scrollTop=r.bottom-t.bottom)})})}};return{dom:{tag:"div",classes:_g.classes.outerScroll},components:[{dom:{tag:"div",classes:_g.classes.commentList},components:Rv(n,o),behaviours:Mo([sp({selector:_g.selectors.card}),Ef.config({})])}],behaviours:Mo([Mf.config({find:function(e){return ge(e.element()).bind(function(n){return e.getSystem().getByDom(n).toOption()})}})]),apis:e}};(pv=gv||(gv={}))[pv.Start=0]="Start",pv[pv.Reply=1]="Reply";var Iv=xi("tc-clear-input"),Hv=xi("tc-submit-input"),Pv=function(n){return e=Hv,t=n,op.sketch({tag:"textarea",inputClasses:_g.classes.replyTextarea,inputAttributes:xn(xn({},lp),{placeholder:t.translate(cl.tc_reply_placeholders)}),inputStyles:dp,inputBehaviours:Mo(Sn([cp({enterEvent:e}),Jf.config({}),Ro("reply-events",[po(Vr(),mp)])],ng({})))});var e,t},jv=function(t,n){var r=Hc(Pv(n)),e={focusEditor:function(n){r.getOpt(n).each(Rf.focus)},updateWith:function(n,e,t){V(e,function(n){return n.mode===td.Edit})?ru(n.element(),"display","none"):au(n.element(),"display")}};return{dom:{tag:"div",classes:_g.classes.replySection},behaviours:Mo([Ro("reply-events",[po(Iv,function(n){r.getOpt(n).each(function(n){Yf.setValue(n,"")})}),po(Hv,function(e){r.getOpt(e).map(Yf.getValue).each(function(n){0<n.length&&so(e,Sp.createCommentEvent,{content:n,mode:t})})})])]),components:[r.asSpec(),Sg.secondary({text:n.translate(cl.tc_reply_buttons_clear),eventName:ln.some(Iv)}),Sg.primary({text:n.translate(cl.tc_reply_buttons_save),eventName:ln.some(Hv)})],apis:e}},Lv=function(){var r=Tn(Ig()),n=function(n){r.set(n(r.get()))};return{clearAll:function(){r.set(Ig())},recalibrate:function(r){n(function(n){return t=n,e=r.comments,{targetUid:t.targetUid,conversation:W(e,function(n,e){return{uid:n.uid,props:xn(xn({},n),{isDeleting:od.BeforeDelete,mode:t.targetUid.is(n.uid)?td.ExpandOrNone:td.CollapsedOrNone})}}),queue:[]};var t,e})},enqueuePatch:function(e,t){n(function(n){return Rg(n,[{uid:e,patch:t}])})},enqueuePatches:function(e){n(function(n){return Rg(n,e)})},setTargetUid:function(e){n(function(n){return Fg(n,ln.some(e))})},clearTargetUid:function(){n(function(n){return Fg(n,ln.none())})},processQueue:function(){return Bg(r.get()).map(function(n){var e=n.world,t=n.props;return r.set(e),t})},purge:function(t){n(function(n){var e=z(n.conversation,function(n){return n.uid!==t});return xn(xn({},n),{conversation:e})})},getProps:function(){return Ag(r.get())},adjust:function(e){n(function(n){return Rg(n,W(e,function(n){return{uid:n.uid,patch:"to-delete"===n.type?{isDeleting:od.PostDelete}:{}}}))})}}},Vv=function(n){return{type:"redraw-sidebar",view:n}},Wv=function(n,e){if(n.conversation.uid!==e.conversation.uid)return Vv(e);var t,r,o,i=W(n.conversation.comments,function(n){return n.uid}),u=W(e.conversation.comments,function(n){return n.uid});return t=i,r=u,void 0===o&&(o=I),R(o).eq(t,r)?{type:"refresh-comments",comments:W(e.conversation.comments,function(n,e){return{uid:n.uid,patch:xn({},n)}})}:0!==Z(u,i).length?Vv(e):{type:"remove-comments",adjustments:W(i,function(n){return{type:L(u,n)?"to-remain":"to-delete",uid:n}})}},Uv=xi("tc-escapeInSidebar"),zv=function(n,t,r,e){var o=function(e){l.get().each(function(n){"comments"===n.type&&e(n.conversation.uid)})},u=Lv(),c=function(){u.processQueue().each(function(e){h(e),m.getOpt(s).each(function(n){n.getApis().updateWith(n,e,{})})})},i=function(e){o(function(n){return e(n).get(function(n){n.fold(function(n){return n()},function(n){return n()})})})},a=function(n){n.get(function(n){n.fold(function(n){n()},function(n){u.setTargetUid(n.targetUid),n.fn()})})},s=yu({dom:{tag:"div",classes:n,styles:{position:"relative"}},behaviours:Mo([Ef.config({}),up({onEscape:function(n){return ao(n,Uv),ln.some(!0)}}),Ro("sidebar-events",[po(kg,function(n,e){u.enqueuePatch(e.event().uid(),e.event().patch())}),po(Tg,function(n,e){u.purge(e.event().uid()),m.getOpt(s).each(function(n){var e=u.getProps();h(e),n.getApis().updateWith(n,e,{})})}),po(Mg,function(n){c()}),po(Uv,function(n,e){t.onEscape()}),po(Sp.deleteConversationEvent,function(n,e){i(function(n){return r.deleteConversation(n,e.event().uid())})}),po(Sp.deleteCommentEvent,function(n,e){i(function(n){return r.deleteComment(n,e.event().uid())})}),po(Sp.editCommentEvent,function(n,e){o(function(n){a(r.editComment(n,e.event().uid(),e.event().content()))})}),po(Sp.createCommentEvent,function(n,e){e.event().mode()===gv.Reply?o(function(n){a(r.reply(n,e.event().content()))}):a(r.createConversation(e.event().content()))})])])}),f=Ic(s),l=Tn(ln.none()),d=function(n){Ef.set(s,[g.asSpec()].concat(n))},m=Hc(Bv([],{getSink:function(n){return g.getOpt(n)},universe:e})),g=Hc({dom:{tag:"div",styles:{"z-index":"100"}},behaviours:Mo([_f.config({})])}),p=Hc(jv(gv.Start,e)),v=Hc(jv(gv.Reply,e)),h=function(e){v.getOpt(s).each(function(n){n.getApis().updateWith(n,e,{})})},b=function(n){"splash"===n.view.type?(u.clearAll(),d([p.asSpec()])):"comments"===n.view.type&&(u.recalibrate(n.view.conversation),d([m.asSpec(),v.asSpec()]),m.getOpt(s).each(function(n){var e=u.getProps();h(e),n.getApis().setComments(n,e),n.getApis().scrollToEnd(n)}))};return{system:f,root:s,element:f.element,update:function(i){m.getOpt(s).bind(function(e){return l.get().map(function(n){return{convUi:e,pview:n}})}).fold(function(){return b(i)},function(n){n.convUi;var e,t,r=n.pview,o=(e=r,t=i.view,e.type!==t.type?Vv(t):"splash"===t.type?{type:"no-change"}:Wv(e,t));switch(o.type){case"add-comment":b(i);break;case"no-change":break;case"redraw-sidebar":b(i);break;case"remove-comments":u.adjust(o.adjustments),c();break;case"refresh-comments":u.enqueuePatches(o.comments),c()}}),l.set(ln.some(i.view)),Cf(s.element())&&i.grabFocus()&&v.getOpt(s).orThunk(function(){return p.getOpt(s)}).each(function(n){n.getApis().focusEditor(n)})},hasFocus:function(){return Uo(s.element()).isSome()},setReadonly:function(n){n&&f.broadcastOn([y()],{target:f.element()}),f.broadcastOn([eg],{readonly:n})},getSink:g.getOpt}},qv="tc-delete-conversation-at-cursor",Gv=function(n,e){n.execCommand(qv,null,{conversationUid:e})},Yv=function(n,e,t,r){return n.fold(function(n){return Ke.error({message:e,error:n,refresh:r})},function(n){return t(n).fold(function(n){return Ke.error({message:n.permError,error:n.reason,refresh:r})},Ke.value)})},Kv=function(n){return pn(n,"reason")?n.reason:""},Xv=function(o,r,i){var u=function(n){return function(){i().showError(n.message,n.error),n.refresh&&n.refresh()}};return{createConversation:function(n){return $e.wrap(o.create({content:n,createdAt:wp.nowISO8601()}).map(function(n){var e=Ke.value,t=_;return Yv(n,cl.tc_create_problem,e,t).fold(function(n){return Ke.error(u(n))},function(n){return Ke.value({targetUid:n.conversationUid,fn:function(){r.annotator.annotate(st(),{uid:n.conversationUid}),i().refreshSidebar(ln.some(n.conversationUid),3)}})})}))},reply:function(r,n){return $e.wrap(o.reply({conversationUid:r,content:n,createdAt:wp.nowISO8601()}).map(function(n){var e=Ke.value,t=_;return Yv(n,cl.tc_reply_problem,e,t).fold(function(n){return Ke.error(u(n))},function(n){return Ke.value({targetUid:n.commentUid,fn:function(){i().refreshSidebar(ln.some(r),3)}})})}))},editComment:function(t,r,n){return $e.wrap(o.editComment({conversationUid:t,commentUid:r,content:n,modifiedAt:wp.nowISO8601()}).map(function(n){var e=_;return Yv(n,cl.tc_edit_problem_comment,function(n){return n.canEdit?Ke.value(n):Ke.error({permError:cl.tc_edit_unauthorised_comment,reason:Kv(n)})},e).fold(function(n){return Ke.error(u(n))},function(n){return Ke.value({targetUid:r,fn:function(){i().refreshSidebar(ln.some(t),4)}})})}))},deleteComment:function(e,n){return $e.wrap(o.deleteComment({conversationUid:e,commentUid:n}).map(function(n){return Yv(n,cl.tc_delete_problem_comment,function(n){return n.canDelete?Ke.value(n):Ke.error({permError:cl.tc_delete_unauthorised_comment,reason:Kv(n)})},function(){i().refreshSidebar(ln.some(e),4)}).fold(function(n){return Ke.error(u(n))},function(n){return Ke.value(function(){i().refreshSidebar(ln.some(e),4)})})}))},deleteConversation:function(e){return $e.wrap(o.deleteConversation({conversationUid:e}).map(function(n){return Yv(n,cl.tc_delete_problem_conversation,function(n){return n.canDelete?Ke.value(n):Ke.error({permError:cl.tc_delete_unauthorised_conversation,reason:Kv(n)})},function(){i().refreshSidebar(ln.some(e),4)}).fold(function(n){return Ke.error(u(n))},function(n){return Ke.value(function(){Gv(r,e),i().refreshSidebar(ln.none(),2)})})}))}}};Ue(function(n,e,t,r,o,i){var u,c,a,s,f,l,d=Xv(t,e,function(){return p}),m=n===_e.Modern?(s=e,f=d,l=i,{createSidebar:function(){return zv(_g.classes.roots.modern,{onEscape:function(){return s.focus()}},f,l)},createController:ft}):(u=e,c=d,a=i,{createSidebar:function(){return zv(_g.classes.roots.silver,{onEscape:function(){return u.focus()}},c,a)},createController:ft}),g=m.createSidebar(),p=m.createController(t,r,e,g),v=function(n){g.system.broadcastOn([y()],{target:w.fromDom(n.target)})},h=x(w.fromDom(b.document),"mousedown",function(n){g.system.broadcastOn([y()],{target:n.target()})});e.on("mousedown",v),e.on("remove",function(){e.off("mousedown",v),h.unbind()});o({controller:p,attachTo:function(n){he(n,g.element())}})})}(window);