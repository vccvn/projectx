!function(global,docs){if(global.App)return global.App;var cl=function(){console.log.apply(console,arguments)},arr=[],document=window.document,div=document.createElement("div"),slice=arr.slice,createElement=document.createElement;"function"!=typeof Object.assign&&(Object.assign=function(target,varArgs){"use strict";if(null==target)throw new TypeError("Cannot convert undefined or null to object");for(var to=Object(target),index=1;index<arguments.length;index++){var nextSource=arguments[index];if(null!=nextSource)for(var nextKey in nextSource)Object.prototype.hasOwnProperty.call(nextSource,nextKey)&&(to[nextKey]=nextSource[nextKey])}return to});var isFunction=function isFunction(obj){return"function"==typeof obj&&"number"!=typeof obj.nodeType},isCallable=function(variable){return"function"==typeof variable},getType=function(obj){var t="null",type=typeof obj;return t="object"==type?null===obj?"null":obj.constructor==FormData?"formdata":obj.constructor==Array?"array":obj.constructor==Object?"object":obj.constructor==Number?"number":"object":type},isString=function isString(variable){var type=getType(variable);return"string"==type||"number"==type},isNull=function isNull(variable){return"null"==getType(variable)},isArray=function isArray(variable){return"array"==getType(variable)},isObject=function isObject(variable){return"object"==getType(variable)},isNumber=function isNumber(variable){var type=getType(variable);return("number"===type||"string"===type)&&!isNaN(variable-parseFloat(variable))},isFormData=function isFormData(variable){return"formdata"==getType(variable)},isEmail=function isEmail(email){var re;return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(email).toLowerCase())},checkEmptyType={object:function(object){for(const key in object)if(object.hasOwnProperty(key))return!1;return!0},array:function(ar){return 0==ar.length},string:function(ar){return 0==ar.length}},isEmpty=function(any){if(void 0===any)return!0;var type=getType(any);return"function"==typeof checkEmptyType[type]?checkEmptyType[type](any):!any},emptyFunc=function(){},addEventListener=function addEventListener(el,event,HandlerCallbackFunction){if(!(el instanceof Element)&&el!=document)return!1;let cb="function"==typeof HandlerCallbackFunction?HandlerCallbackFunction:function(e){App.func.call(HandlerCallbackFunction,[e.target])};el.addEventListener?el.addEventListener(event,cb):el.attachEvent&&el.attachEvent(event,cb)},removeEventListener=function removeEventListener(el,event,callback){if(!(el instanceof Element)&&el!=document)return!1;let cb="function"==typeof callback?callback:function(e){App.func.call(callback,[e.target])};el.removeEventListener&&el.removeEventListener(event,cb)},merge=function(dst,src){dst&&isObject(dst)||(dst={});var to=Object(dst),srclength=arguments.length;for(let i=1;i<srclength;i++){const srcObj=arguments[i];if(isObject(srcObj))for(const key in srcObj)if(srcObj.hasOwnProperty(key)){const val=srcObj[key];if(!isObject(val)&&!isArray(val)||isFormData(val)||val.constructor==CrazyXHR||val.constructor==CrazyAJAX||val.constructor==Promise||val.constructor==App.dom.HtmlQuery||val.constructor==App.dom.Form)to[key]=val;else{var d={};to[key]=merge(d,val)}}}return dst},deepCopy=function(src){var dst={},srclength=arguments.length;for(let i=0;i<srclength;i++){const srcObj=arguments[i];if(isArray(srcObj)&&1==srclength){dst=[];for(let i=0;i<srcObj.length;i++){const val=srcObj[i];!isObject(val)&&!isArray(val)||isFormData(val)||val.constructor==CrazyXHR||val.constructor==CrazyAJAX||val.constructor==Promise||val.constructor==App.dom.HtmlQuery||val.constructor==App.dom.Form?dst[i]=val:dst[i]=deepCopy(val)}}else if(isObject(srcObj))for(const key in srcObj)if(srcObj.hasOwnProperty(key)){const val=srcObj[key];!isObject(val)&&!isArray(val)||isFormData(val)||val.constructor==CrazyXHR||val.constructor==CrazyAJAX||val.constructor==Promise||val.constructor==App.dom.HtmlQuery||val.constructor==App.dom.Form?dst[key]=val:dst[key]=deepCopy(val)}}return dst},copyArray=function(src){var arr=[],t=getType(src);if("object"==t||"array"==t)if(src.length)for(let index=0;index<src.length;index++)void 0!==src[index]&&arr.push(src[index]);else if("object"==t)for(const key in src)if(src.hasOwnProperty(key)){const item=src[key];arr.push(item)}return arr},combine=function combine(list){var sth=function(lst,i){i||(i=0);var ls=[],arr;return lst.length<=i?[]:(lst[i].map((function(c){var s=c;if(i<lst.length-1){var tl=sth(lst,i+1);tl.length?tl.map((function(t){ls.push(c+""+t)})):ls.push(c)}else ls.push(c)})),ls)};return sth(list)},objectKeys=function(obj){var keys=[];if(isArray(obj)||isObject(obj))for(const key in obj)obj.hasOwnProperty(key)&&keys.push(key);return keys},objectValues=function(obj){var values=[];if(isArray(obj)||isObject(obj))for(const key in obj)obj.hasOwnProperty(key)&&values.push(obj[key]);return values},documentReady=function(){if("complete"===document.readyState)return!0},isGlobalOrRoot=function(obj){return obj==global||obj==document},Queue=function(work,delay,step){if(void 0===work)return this;this.status="pending",this.result=null;var d=void 0===delay||!isNumber(delay)||delay<1?10:delay,s=void 0===step||!isNumber(step)||step<0?-1:step,self=this,properties={timeDelay:d,stepCount:s,resolved:!1,rejected:!1,cancelled:!1,stopped:!1,status:"pending",timeId:null,turn:1,count:1},methods={then:function(rs){},catch:function(err){App.log(err)},clear:function(){properties.timeId&&(clearTimeout(properties.timeId),self.status=properties.status)},run:function(){var comtext=this,time=properties.timeDelay||10,stop=properties.stepCount,resolve=function(rs){return properties.resolved=rs,"pending"==properties.status?(properties.status="resolved",self.result=rs,comtext.clear(),comtext.then(rs)):(comtext.clear(),!0)},reject=function(err){return properties.rejected=err,"pending"==properties.status&&(properties.status="rejected",self.result=err,comtext.catch(err)),comtext.clear(),err},runtask=function(){properties.timeId=setTimeout((function(){if(properties.stepCount>-1&&properties.turn>properties.stepCount)return properties.status="stoped",properties.stopped="time out",comtext.clear(),!1;if("pending"!=properties.status)return!1;try{var stt;if(void 0!==work(resolve,reject,properties.turn)&&"pending"==properties.status)return comtext.stop(),!1;properties.turn++}catch(error){return comtext.stop(),comtext.catch(error),!1}properties.count++,runtask()}),time)};runtask()},stop:function(){properties.stepCount=0,properties.status="stopped",this.clear()},delay:function(delay){void 0===delay||!isNumber(delay)||delay<1||(properties.timeDelay=delay,this.clear(),this.run())},step:function(step){void 0===step||!isNumber(step)||step<-1||0==step||(properties.stepCount=step,this.clear(),this.run())},restart:function(){this.clear(),properties.turn=1,this.run()},getData:function(){return this},addThen:function(fn){"function"==typeof fn&&(this.then=fn)},addCatch:function(fn){"function"==typeof fn&&(this.catch=fn)},getData:function(){return properties}};this.e=function(){if(!arguments.length||"string"!=typeof arguments[0])return null;var method=arguments[0],r=null;if("function"==typeof methods[method]){var args=[];for(let i=1;i<arguments.length;i++){const arg=arguments[i];args.push(arg)}r=methods[method].apply(methods,args)}return r},setTimeout((function(){methods.run()}),10)};Queue.prototype={constructor:Queue,delay:function(delay){if(void 0!==delay&&isNumber(delay)&&!(delay<1))return this.e("delay",delay),this},step:function(step){if(void 0!==step&&isNumber(step)&&!(step<-1)&&0!=step)return this.e("step",step),this},try:function(step){if(void 0!==step&&isNumber(step)&&!(step<-1)&&0!=step)return this.e("step",step),this},restart:function(){return this.e("restart"),this},stop:function(){return this.e("stop"),this},then:function(fb){return"function"==typeof fn&&this.e("addThen",fn),this},catch:function(fb){return"function"==typeof fn&&this.e("addCatch",fn),this},getData:function(){return this.e("getData")}};var background={documentReady:!1,tasks:{},addTask:function(name,task){},removeTask:function(name){},checkReady:function(){if(this.documentReady)return!0;var self=this,queue=new Queue((function(resolve,reject){"complete"===document.readyState&&(self.documentReady=!0,resolve(!0))}),50,500)},queue:function(work,time){if(void 0===work||!isCallable(work))return!1;(void 0===time||!isNumber(time)||time<=0)&&(time=10);var tid=setInterval((function(){var resolve,reject,st;void 0!==work((function(status){status&&clearInterval(tid)}),(function(){clearInterval(tid)}))&&clearInterval(tid)}),time)}},App=function App(mod,options){var isConstructor=!1;(this instanceof App||this.constructor==App)&&(isConstructor=!0);var m=mod||null,o=options||null;if(!isConstructor)return isObject(m),App.parse(m,o);if("object"==typeof m&&(o=m),isObject(m)){for(const key in o)if(o.hasOwnProperty(key)){const v=o[key];this[key]=v}}else isString(m)&&m&&(this[m]=p)},initOptions={getType:getType,isArray:isArray,isObject:isObject,isString:isString,isNumber:isNumber,isEmail:isEmail,isNull:isNull,isFormData:isFormData,isEmpty:isEmpty,isCallable:isCallable,isFunction:isFunction,oeiginModules:[],log:cl,deepCopy:deepCopy,copyArray:copyArray,objectKeys:objectKeys,objectValues:objectValues,merge:merge,combine:combine,addModule:function(name,options){App.exists(name)||App.isOrigin(name)||(isObject(options)&&"object"!=typeof options.init&&(options.init_list||(options.init_list=[]),options.init=function(args){if(args&&void 0!==args)for(var key of this.init_list)if(void 0!==args[key]){var d=args[key],t=App.getType(d),t2=void 0!==this[key]?App.getType(this[key]):"string";if("array"==t&&"array"==t2||"object"==t&&"object"==t2)for(var k in d){var v=d[k];this[key][k]=v}else this[key]=d}}),App[name]=App.prototype[name]=options)},parse:function(name,options){if(!name)return null;if(isObject(name)){for(const key in name)if(name.hasOwnProperty(key)){const opt=name[key];App.parse(key,opt)}return!0}return App.exists(name)?App[name]:(App.addModule(name,options),App.exists(name)?App[name]:null)},extend:function(name,options){return this.parse(name,options)},exists:function(name){return void 0!==App[name]},isOrigin:function(name){return App.oeiginModules.indexOf(name)>=0},isReady:function(){return background.documentReady},setDefault:function(object,data){if(data&&void 0!==data){for(var key of object.init_list)if(void 0!==data[key]){var d=data[key],t=this.getType(d),t2=void 0!==object[key]?this.getType(object[key]):"string";if("array"==t&&"array"==t2||"object"==t&&"object"==t2)for(var k in d){var v=d[k];object[key][k]=v}else object[key]=d}return object}}};App.modules=App.prototype;for(const key in initOptions)if(initOptions.hasOwnProperty(key)){const val=initOptions[key];App[key]=App.modules[key]=App.prototype[key]=val}App.queue=App.prototype.queue=function(work,delay,step){if(void 0===work)return new Faker;var d=void 0===delay||!isNumber(delay)||delay<1?10:delay,s=void 0===step||!isNumber(step)||step<0?-1:step;return new Queue(work,delay,step)};var systemOptions={cssClassPrefix:"crazy-",test:"test",domQuery:"D",queryEngine:"App.query"};App.getSystemOption=App.prototype.getSystemOption=function(key){return void 0===key?systemOptions:isString(key)&&void 0!==systemOptions[key]?systemOptions[key]:null},App.setSystemOption=App.prototype.setSystemOption=function(key,value){var self=this;if(void 0===key)return this;if(isString(key)){if("domQuery"==key){let t=systemOptions[key];global[t]==App.query&&(delete global[t],global[value]=App.query)}systemOptions[key]=value}else isObject(key)&&App.setup(key);return this},App.setup=App.prototype.setup=function(options){if(options&&isObject(options))for(const key in options)if(options.hasOwnProperty(key)){const value=options[key];this.setSystemOption(key,value)}return this};var Faker=function(){this.then=function(){return this},this.catch=function(){return this}},httpMethods=["get","post","put","patch","delete","head","options"],crazyRequestApi={getStatus:function(){return this.e("get","status")},done:function(fn){return fn&&this.e("done",fn),this},success:function(fn){return fn&&this.e("done",fn),this},then:function(fn){return fn&&this.e("done",fn),this},catch:function(fn){return fn&&this.e("error",fn),this},error:function(fn){return fn&&this.e("error",fn),this},progress:function(fn){return fn&&this.e("progress",fn),this},onAbort:function(fn){return fn&&this.e("onAbort",fn),this},beforeSend:function(fn){return fn&&this.e("beforeSend",fn),this},transform:function(fn){return fn&&this.e("transform",fn),this},abort:function(fn){return this.e("abort",fn||null)},cancel:function(fn){return this.e("abort",fn||null)}};XMLHttpRequest.prototype.sendAsBinary||(XMLHttpRequest.prototype.sendAsBinary=function(sData){for(var nBytes=sData.length,ui8Data=new Uint8Array(nBytes),nIdx=0;nIdx<nBytes;nIdx++)ui8Data[nIdx]=255&sData.charCodeAt(nIdx);this.send(ui8Data)});var CrazyXHR=function(url,optionData){var status=null,self=this,xhr=null,isAbort=!1,properties={status:0,response:null,result:null,message:""},events={done:[],error:[],progress:[],abort:[],beforeSend:[],transform:[]},options=optionData||{};setTimeout((function(){var ab,eventList;if(isAbort)(events.abort.length?events.abort.shift():emptyFunc)("Bị hủy");else if(["done","success","error","transform","progress","beforeSend"].map((function(evt){"success"==evt&&(evt="done"),options[evt]&&null!=events[evt]&&0==events[evt].length&&isCallable(options[evt])&&events[evt].push(options[evt])})),url){isObject(url)?options=url:options.url=url;var method=options.method?options.method.toUpperCase():"GET",dataType=options.dataType||options.responseType||"";dataType=(dataType+"").toLowerCase();var sUrl=options.url||null,headers=App.request.getHeaders(),data=options.data||options.body||{},isUpload=options.isUpload||!1,responseType=options.responseType||dataType||"";if(responseType=(responseType+"").toLowerCase(),-1==["arraybuffer","blob","document","json","text"].indexOf(responseType)&&(responseType=""),"json"==dataType)data=JSON.stringify(data);else if(isFormData(data)||!isArray(data)&&!isObject(data)||isUpload){if(isUpload){var d;data=options.segments||data}}else data=App.request.toEncodedData(data);if(options.headers&&isObject(options.headers))for(const key in options.headers)if(options.headers.hasOwnProperty(key)){const value=options.headers[key];let k=App.request.strHeaderKey(key);void 0!==headers[k]?-1==headers[k].indexOf(value)&&(headers[k]+="; "+value):headers[k]=value}"json"==dataType?headers["Content-Type"]="application/json; charset=UTF-8":!Headers["Content-Type"]&&isString(data)&&(headers["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8"),headers.Accept||(headers.Accept="application/json; text/javascript; text/html; */*"),(xhr=new XMLHttpRequest).responseType=responseType,xhr.addEventListener("progress",(function(oEvent){if(oEvent.lengthComputable){var percentComplete=oEvent.loaded/oEvent.total*100,pfn;(events.progress.length?events.progress[0]:emptyFunc)(percentComplete)}})),xhr.addEventListener("load",(function(evt){var success=events.done.length?events.done.shift():"function"==typeof options.success?options.success:emptyFunc,error=events.error.length?events.error.shift():"function"==typeof options.error?options.error:emptyFunc,transform=events.transform.length?events.transform.shift():"function"==typeof options.transform?options.transform:null,progress=events.progress.length?events.progress.shift():"function"==typeof options.progress?options.progress:emptyFunc,d="text"==responseType?this.responseText:this.response,data=transform?transform(d):d;properties.response=d,properties.result=data,properties.status=this.status;var rs=success(data,this);if(void 0!==rs){var parseResult=function(result){if(result){if(result.constructor==CrazyXHR||"Promise"in global&&result.constructor==Promise){if(events.done.length)do{result.then(events.done.shift())}while(events.done.length>0);if(events.error.length)do{result.catch(events.error.shift())}while(events.error.length>0);else result.catch(error);if(result.constructor==CrazyXHR){if(events.transform.length)do{result.transform(events.transform.shift())}while(events.transform.length>0);if(events.progress.length)do{result.progress(events.progress.shift())}while(events.progress.length>0);else result.progress(progress)}}else if(events.done.length){var succeeded;result=(succeeded=events.done.shift())(result)}}else if(events.done.length&&void 0!==result)do{var succeeded=events.done.shift();if(void 0===(result=parseResult(succeeded(result)))){events.done=[];break}}while(events.done.length);return void 0===result&&(events.done=[]),result};parseResult(rs)}})),xhr.addEventListener("error",(function(evt){var error;(events.error.length?events.error.shift():emptyFunc)(new Error("Lỗi không xác định"))})),xhr.addEventListener("abort",(function(evt){var ab;properties.status=-1,(events.abort.length?events.abort.shift():emptyFunc)(evt)})),xhr.addEventListener("loadend",(function(e){})),xhr.open(method,sUrl);for(const key in headers)if(headers.hasOwnProperty(key)){const value=headers[key];xhr.setRequestHeader(key,value)}if(isUpload){var sBoundary="---------------------------"+Date.now().toString(16),fdata=isArray(data)?data.join("--"+sBoundary+"\r\n"):"";xhr.setRequestHeader("Content-Type","multipart/form-data; boundary="+sBoundary),xhr.sendAsBinary("--"+sBoundary+"\r\n"+fdata+"--"+sBoundary+"--\r\n")}else xhr.send(data)}else{var error1;(events.error.length?events.error.shift():emptyFunc)(new Error("URL ko hợp lệ"))}}),10);var methods={set:function(prop,vai){properties[prop]=value},get:function(prop){return prop?void 0!==properties[prop]?properties[prop]:null:properties},done:function(fn){"function"==typeof fn&&events.done.push(fn)},error:function(fn){"function"==typeof fn&&events.error.push(fn)},onAbort:function(fn){"function"==typeof fn&&events.abort.push(fn)},beforeSend:function(fn){"function"==typeof fn&&events.beforeSend.push(fn)},progress:function(fn){"function"==typeof fn&&events.progress.push(fn)},getXHR:function(){return xhr},abort:function(fn){if(isAbort=!0,xhr){if(xhr.abort(),"function"==typeof fn)return fn(xhr)}else"function"==typeof fn&&events.abort.push(fn)},transform:function(fn){"function"==typeof fn&&events.transform.push(fn)},getEvents:function(){return events}};this.e=function(){if(!arguments.length||"string"!=typeof arguments[0])return null;var method=arguments[0],r=null;if("function"==typeof methods[method]){var args=[];for(let i=1;i<arguments.length;i++){const arg=arguments[i];args.push(arg)}r=methods[method].apply(methods,args)}return r}};CrazyXHR.prototype=deepCopy(crazyRequestApi),CrazyXHR.prototype.constructor=CrazyXHR;var CrazyAJAX=function(url,optionData){var status=null,self=this,$ajax=null,isAbort=!1,properties={status:0,response:null,result:null,message:""},events={done:[],error:[],progress:[],abort:[],beforeSend:[],transform:[]},options="object"==typeof url?url:"object"==typeof optionData?optionData:{};setTimeout((function(){var ab;if(isAbort)(events.abort.length?events.abort.shift():emptyFunc)("Bị hủy");else if(url){var eventList;isObject(url)||(options.url=url),["done","success","error","transform","progress","beforeSend"].map((function(evt){"success"==evt&&(evt="done"),options[evt]&&null!=events[evt]&&0==events[evt].length&&isCallable(options[evt])&&events[evt].push(options[evt])}));var data=options.data||options.body||{},method=options.method||options.type||"GET";method=method.toUpperCase();var sUrl=options.url||null,responseType=options.responseType||options.dataType||"JSON";responseType=(responseType+"").toLowerCase(),-1==["arraybuffer","blob","document","json","text"].indexOf(responseType)&&(responseType="JSON");var ajaxData={url:sUrl,type:method,cookie:!0,data:data};options.headers&&(ajaxData.headers=options.headers),responseType&&(ajaxData.dataType=responseType),ajaxData.success=function(res){var success=events.done.length?events.done.shift():"function"==typeof options.success?options.success:emptyFunc,error=events.error.length?events.error.shift():"function"==typeof options.error?options.error:emptyFunc,transform=events.transform.length?events.transform.shift():"function"==typeof options.transform?options.transform:null,progress=events.progress.length?events.progress.shift():"function"==typeof options.progress?options.progress:emptyFunc,d=res,data=transform?transform(d):d;properties.response=d,properties.result=data;var rs=success(data);if(void 0!==rs){var parseResult=function(result){if(result){if(result.constructor==CrazyXHR||"Promise"in global&&result.constructor==Promise||result.constructor==CrazyAJAX){if(events.done.length)do{result.then(events.done.shift())}while(events.done.length>0);if(events.error.length)do{result.catch(events.error.shift())}while(events.error.length>0);else result.catch(error);if(result.constructor==CrazyXHR||result.constructor==CrazyAJAX){if(events.transform.length)do{result.transform(events.transform.shift())}while(events.transform.length>0);if(events.progress.length)do{result.progress(events.progress.shift())}while(events.progress.length>0);else result.progress(progress)}}else if(events.done.length){var succeeded;result=(succeeded=events.done.shift())(result)}}else if(events.done.length&&void 0!==result)do{var succeeded=events.done.shift();if(void 0===(result=parseResult(succeeded(result)))){events.done=[];break}}while(events.done.length);return void 0===result&&(events.done=[]),result};parseResult(rs)}},ajaxData.error=function(err){var error1;(events.error.length?events.error.shift():emptyFunc)(err)},$ajax=global.jQuery.ajax(ajaxData)}else{var error1;(events.error.length?events.error.shift():emptyFunc)(new Error("URL ko hợp lệ"))}}),10);var methods={set:function(prop,vai){properties[prop]=value},get:function(prop){return prop?void 0!==properties[prop]?properties[prop]:null:properties},done:function(fn){"function"==typeof fn&&events.done.push(fn)},error:function(fn){"function"==typeof fn&&events.error.push(fn)},onAbort:function(fn){"function"==typeof fn&&events.abort.push(fn)},beforeSend:function(fn){"function"==typeof fn&&events.beforeSend.push(fn)},progress:function(fn){"function"==typeof fn&&events.progress.push(fn)},getXHR:function(){return $ajax},abort:function(fn){if(isAbort=!0,xhr){if(xhr.abort(),"function"==typeof fn)return fn(xhr)}else"function"==typeof fn&&events.abort.push(fn)},transform:function(fn){"function"==typeof fn&&events.transform.push(fn)},getEvents:function(){return events}};this.e=function(){if(!arguments.length||"string"!=typeof arguments[0])return null;var method=arguments[0],r=null;if("function"==typeof methods[method]){var args=[];for(let i=1;i<arguments.length;i++){const arg=arguments[i];args.push(arg)}r=methods[method].apply(methods,args)}return r}};CrazyAJAX.prototype=deepCopy(crazyRequestApi),CrazyAJAX.prototype.constructor=CrazyAJAX,App.xhr=App.prototype.xhr=function(url,optionData){return void 0===url?new Faker:new CrazyXHR(url,optionData||{})},App.fetch=App.prototype.fetch=function(url,optionData){if(void 0===url)return new Faker;var data="object"==typeof url?url:"object"==typeof optionData?optionData:{};if(!("fetch"in global))return App.xhr(url,data);isObject(url)&&(date=url,url=data.url||null),data.headers=new Headers(merge(App.request.getHeaders(),data.headers||{})),data.body=data.body||data.data||data.segments||null;var f=fetch(url,data);return"function"==typeof data.success&&f.then(data.success),"function"==typeof data.error&&f.catch(data.error),f},App.ajax=App.prototype.ajax=function(url,optionData){if(void 0===url)return new Faker;var data="object"==typeof url?url:"object"==typeof optionData?optionData:{};return"jQuery"in global?(isString(url)&&(data.url=url),data.headers=merge(App.request.getHeaders(),data.headers||{}),new CrazyAJAX(data)):App.xhr(url,data)},App.axios=App.prototype.axios=function(url,optionData){if(void 0===url)return new Faker;var data=optionData||{},success,error;if(!("axios"in global))return App.xhr(url,data);isObject(url)?(date=url,url=data.url||null):isString(url)&&(data.url=url),data.headers=merge(App.request.getHeaders(),data.headers||{}),data.method&&"GET"==data.method.toUpperCase()&&(data.params=data.body||data.data||{}),"function"==typeof data.success&&(success=data.success,delete data.success),"function"==typeof data.error&&(error=data.error,delete data.error);var axiosPromiss=global.axios(url,data);return success&&axiosPromiss.then(success),error&&axiosPromiss.catch(error),axiosPromiss},App.axiosUpload=App.prototype.axiosUpload=function(url,data,optionData){if(void 0===url)return new Faker;var options=optionData||{},body=null,success,error;if(isObject(url)?(url=(options=url).url||null,body=options.body||options.data||data||null):isString(url)&&(optionData?body=data:isFormData(data)?body=data:data.body||data.data?(body=data.body||data.data,void 0!==data.body&&delete data.body,void 0!==data.data&&delete data.data,options=data):body=options),!("axios"in global))return options.data=body,options.url=url,App.xhr(options);options.headers=merge(App.request.getHeaders(),options.headers||{}),"function"==typeof options.success&&(success=options.success,delete options.success),"function"==typeof options.error&&(error=options.error,delete options.error);var axiosPromiss=global.axios.post(url,body,options);return success&&axiosPromiss.then(success),error&&axiosPromiss.catch(error),axiosPromiss},App.request=App.prototype.request={headers:{},engine:"xhr",engineList:["xhr","axios","fetch","ajax"],setHeaders:function(key,value){if(!key)return this;if(isString(key))key=this.strHeaderKey(key),value&&(void 0===this.headers[key]&&(this.headers[key]=[]),-1==this.headers[key].indexOf(value)&&this.headers[key].push(value));else if(isObject(key)){var s;for(const k in key)if(key.hasOwnProperty(k)){const v=key[k];this.setHeaders(k,v)}}return this},getHeaders:function(){var headers={};for(const key in this.headers)if(this.headers.hasOwnProperty(key)){const values=this.headers[key];headers[key]=values.join("; ")}return headers},toFormData:function(data){var f=new FormData;if(void 0===data)return f;if(isFormData(data))return data;if(data)if(isObject(data)){for(const key in data)if(data.hasOwnProperty(key)){const value=data[key];f.append(key,value)}}else isArray(data)&&data.map((function(d){isObject(d)&&d.name&&void 0!==d.value&&f.append(d.name,d.value)}));return f},strHeaderKey:function(key){return App.str.replace(App.str.ucword(App.str.replace(key,"-"," "))," ","-")},toEncodedData:function(data){var s=[],addData=function(d){if(d&&isObject(d))for(const fn in d)if(d.hasOwnProperty(fn)){const dat=d[fn];if(isArray(dat)){if(dat&&dat.length)for(let i=0;i<dat.length;i++){const d=dat[i];if(isArray(d)){var fname="[]"==fn.substring(fn.length-2)?fn:fn+"[]";for(let j=0;j<d.length;j++){const vd=d[j];s.push(encodeURIComponent(fname)+"="+encodeURIComponent(vd))}}else s.push(encodeURIComponent(fn)+"="+encodeURIComponent(d))}}else if(isArray(dat)){var fname="[]"==fn.substring(fn.length-2)?fn:fn+"[]";for(let j=0;j<dat.length;j++){const vd=dat[j];s.push(encodeURIComponent(fname)+"="+encodeURIComponent(vd))}}else s.push(encodeURIComponent(fn)+"="+encodeURIComponent(dat))}};return isObject(data)?addData(data):isArray(data)&&data.map((function(t){if(t.name&&void 0!==t.value){var d={};d[t.name]=t.value,addData(d)}else addData(t)})),s.join("&")},setEngine:function(engine){if(engine&&isString(engine)){var eng=engine.toLowerCase();this.engineList.indexOf(eng)>=0&&(this.engine=eng)}return this},getEngine:function(){var eng=this.engine.toLowerCase(),engineFunc;return this.engineList.indexOf(eng)>=0?App[eng]:App.xhr}},httpMethods.map((function(method){var mt=method.toUpperCase();App.request[method]=function(url,options){if(void 0===url)return new Faker;var data=options||{};return isObject(url)&&(date=deepCopy(url),url=data.url||null),data.method=mt,this.getEngine()(url,data)}})),App.request.axiosUpload=App.axiosUpload,App.request.queryString=function queryString(key){var pairs=window.location.search.substring(1).split("&"),obj={},pair,i;for(i in pairs)if(pairs.hasOwnProperty(i)){if(""===pairs[i])continue;pair=pairs[i].split("="),obj[decodeURIComponent(pair[0])]=decodeURIComponent(pair[1])}return void 0!==key?void 0!==obj[key]?obj[key]:null:obj};var domEvents="blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu load".split(" ");App.dom=App.prototype.dom={simpleTags:["img","meta","link","input","br","hr"],parse:function(str){var div=document.createElement("div"),div;return str instanceof Element?str:"object"==typeof str?str instanceof App.dom.DomQuery||str.constructor==App.dom.Query||str.constructor==App.dom.Form||str.constructor==App.query?str.length>0?str[0]:div:this.create(str):((div=document.createElement("div")).innerHTML=str.trim(),div.firstChild)},create:function(tag,content,attrs){var tagName="div",isSimple=!1;if("object"==typeof tag){attrs={};for(const kk in tag)if(tag.hasOwnProperty(kk)){const vv=tag[kk];let tt=kk.toLowerCase();"tag"==tt||"tagname"==tt?tagName=vv.toLowerCase():"content"==tt?content=vv:attrs[kk]=vv}this.simpleTags.indexOf(tagName.toLowerCase())>=0&&(isSimple=!0)}else"string"==typeof tag&&(tagName=tag);(isSimple||this.simpleTags.indexOf(tagName.toLowerCase())>=0)&&(attrs=content,isSimple=!0);var htmlObject=document.createElement(tagName);if(attrs&&"object"==typeof attrs)for(const prop in attrs)if(attrs.hasOwnProperty(prop)){let val=attrs[prop],key=prop.toLowerCase(),k=key,f=k.substring(0,1),f2=k.substring(0,2),isEvent=domEvents.indexOf(key)>=0;if("@"==f||"on"==f2||isEvent){let a=isEvent?key:k.substring("@"==f?1:2),cb="function"==typeof val?val:function(e){App.func.call(val,[e.target])};htmlObject.addEventListener?htmlObject.addEventListener(a,cb):htmlObject.attachEvent&&htmlObject.attachEvent(a,cb)}else if("object"==typeof val){let attrObj=App.str.convertTextObject({},val,prop,"-");for(const ak in attrObj)if(attrObj.hasOwnProperty(ak)){const v=attrObj[ak];htmlObject.setAttribute(ak,v)}}else"class"==key||"classname"==key?htmlObject.className=val:htmlObject.setAttribute(prop,val)}if(!isSimple){var cnt=null;if("textarea"==tagName.toLowerCase())htmlObject.innerText=content;else if(content instanceof Element)htmlObject.appendChild(content);else if(!content||"object"!=typeof content&&content.constructor!=Array)"string"==typeof content&&htmlObject.appendChild(this.parse(content));else if(isArray(content))for(let i=0;i<content.length;i++){const el=content[i];el instanceof Element?htmlObject.appendChild(el):(isObject(el)||isString(el))&&htmlObject.appendChild(this.parse(el))}else htmlObject.appendChild(this.parse(content))}return htmlObject},input:function(args){if("object"==typeof args){var tagName="input",attrs={},content=null,value=null,type="text",ignore=[],data=[];for(const prop in args)if(args.hasOwnProperty(prop)){const val=args[prop];let p=prop.toLowerCase();if("type"==p){let v="string"==typeof val?val.toLowerCase():"text";type=v,"textarea"==v?(tagName=v,ignore.push("type","value")):"select"==v?(tagName="select",ignore.push("type","value","data")):attrs[p]=v}else ignore.indexOf(p)>=0||(attrs[prop]=val);"value"==p?value=val:"data"==p&&(data=val)}var attributes={};for(const key in attrs)if(attrs.hasOwnProperty(key)){const va=attrs[key];ignore.indexOf(key.toLowerCase())>=0||(attributes[key]=va)}if("select"==type){if(content=[],"object"==typeof data)for(const vl in data)if(data.hasOwnProperty(vl)){const text=data[vl];let option={value:vl};vl==value&&(option.selected="selected"),content.push(this.create("option",text,option))}}else content="textarea"==type?value:attributes;return this.create(tagName,content,attributes)}return null},encode:function(html){var div=document.createElement("div");return div.appendChild(this.make(html)),div.innerHTML},decode:function(html){return this.make(html)},render:function(html,root){root instanceof Element?root.appendChild(this.parse(html)):document.body.appendChild(this.parse(html))},parseClass:function(className){var prefix=App.getSystemOption("cssClassPrefix"),cls="";if(cls+=prefix+className,arguments.length>1)for(let i=1;i<arguments.length;i++){const cln=arguments[i];cls+=" "+prefix+cln}return cls},make:function(tag,content,attributes){return new this.jDom(tag,content,attributes)},jDom:function(tag,content,attributes){var $html=App.dom;this.el=$html.create(tag,content,attributes),this.children=[],this.parent=null;var self=this;this.addClass=function(className){return this.el.classList.add(className),this},this.removeClass=function(className){return className?this.el.classList.remove(className):this.el.className="",this},this.append=function(child){return child.constructor==App.dom.jDom?(this.children.push(child),this.el.appendChild(child.el)):this.el.appendChild($html.parse(child)),this},this.prepend=function(child){return child.constructor==App.dom.jDom?(this.children.unshift(child),this.el.insertBefore($html.parse(child.el),this.el.firstChild)):this.el.insertBefore($html.parse(child),this.el.firstChild),this},this.toHTML=function(){return $html.encode(this.el)},this.html=function(){return this.el.innerHTML},this.text=function(){return this.el.innerText},this.appendTo=function(parent){return parent.constructor==App.dom.jDom?(this.parent=parent,parent.append(this)):parent instanceof Element&&parent.appendChild(this.el),this},this.prependTo=function(parent){return parent.constructor==App.dom.jDom?(this.parent=parent,parent.prepend(this)):parent instanceof Element&&parent.insertBefore(this.el,parent.firstChild),this},this.render=function(root){root instanceof Element?root.appendChild(this.el):document.body.appendChild(this.el)},this.remove=function(){this.parent?this.parent.removeChild(this):this.el.parentNode?this.el.parentNode.removeChild(this.el):(this.el.innerHTML="",this.el.style.display="none")},this.on=function(envent,callback){addEventListener(this.el,envent,callback)},"input"==this.el.tagName?this.val=function(value){return void 0!==value&&(this.el.value=value),this.el.value}:"input"==this.el.tagName?this.val=function(value){return void 0!==value&&(this.el.innerText=value),this.el.innerText}:"select"==this.el.tagName&&(this.val=function(value){return void 0!==value&&(this.el.value=value),this.el.value})}};var eventHandler=function(e){console.log(e.target)};App.dom.events=[],App.dom.addEvent=function(element,event,callback,data){if(!(element&&event&&(element instanceof Element||isGlobalOrRoot(element))&&isString(event)&&callback&&isCallable(callback)))return!1;event=event.toLowerCase(),data=data||null;for(let i=0;i<this.events.length;i++){const eventData=this.events[i];if(eventData.element===element&&eventData.event===event){for(let j=0;j<eventData.tasks.length;j++){const evCallback=eventData.tasks[j];if(data){if(data==evCallback.data&&evCallback.callback===callback)return!0}else if(evCallback.callback===callback)return!0}return addEventListener(element,event,callback),this.events[i].tasks.push({callback:callback,data:data}),!0}}return addEventListener(element,event,callback),this.events.push({element:element,event:event,data:data,tasks:[{callback:callback,data:data}]}),!0},App.dom.removeEvent=function(element,event,callback,data){if(!(element&&(element instanceof Element||isGlobalOrRoot(element))&&isString(event))){for(let i=0;i<this.events.length;i++){const eventData=this.events[i];eventData.tasks.length&&eventData.tasks.map((function(task){removeEventListener(eventData.element,eventData.event,task.callback)}))}return this.events=[],!1}event=event?event.toLowerCase():null,data=data||null;for(let i=0;i<this.events.length;i++){const eventData=this.events[i];if(eventData.element===element)if(event){if(eventData.event===event){for(let j=0;j<eventData.tasks.length;j++){const evCallback=eventData.tasks[j];data?data==evCallback.data&&callback&&isFunction(callback)&&evCallback.callback===callback&&(removeEventListener(eventData.element,eventData.event,evCallback.callback),this.events[i].tasks.splice(j,1),j--):callback&&isFunction(callback)?evCallback.callback===callback&&(removeEventListener(eventData.element,eventData.event,evCallback.callback),this.events[i].tasks.splice(j,1),j--):(removeEventListener(eventData.element,eventData.event,evCallback.callback),this.events[i].tasks.splice(j,1),j--)}this.events[i].tasks.length||(this.events.splice(i,1),i--)}}else eventData.tasks.length&&eventData.tasks.map((function(task){removeEventListener(eventData.element,eventData.event,task.callback)})),this.events.splice(i,1),i--}},App.dom.getEvents=function(element,event,data){event=event||null,data=data||null;var list=[];if(!(element=element||null)&&!event)return this.events;for(let i=0;i<this.events.length;i++){const eventData=this.events[i];element&&element!=eventData.element||event&&event!=eventData.event||list.push(eventData)}return list},App.dom.getEventData=function(element,event,data){if(event=event||null,data=data||null,!(element=element||null)&&!event)return null;for(let i=0;i<this.events.length;i++){const eventData=this.events[i];if(!(element&&element!=eventData.element||event&&event!=eventData.event))return eventData}return null};var $window=null,$root=null,DomQuery=App.dom.DomQuery=function DomQuery(selector,options){var elements=this.getDomElements(selector);let n=0;for(let index=0;index<elements.length;index++){const el=elements[index];this[n]=el,n++}this.length=n;var self=this,methods={all:function(){return elements}};this.e=function(){if(!arguments.length||"string"!=typeof arguments[0])return null;var method=arguments[0],r=null;if("function"==typeof methods[method]){var args=[];for(let i=1;i<arguments.length;i++){const arg=arguments[i];args.push(arg)}r=methods[method].apply(this,args)}return r}};App.query=App.prototype.query=App.dom.query=App.$=App.prototype.$=App.dom.$=function(selector,options){var a;return selector==document?$root?a=$root:$root=a=new App.dom.DomQuery(selector,options):a=selector==global?$window||($window=new App.dom.DomQuery(selector,options)):new App.dom.DomQuery(selector,options),a},DomQuery.prototype={simpleTags:["img","meta","link","input","br","hr"],splice:arr.splice,constructor:App.dom.DomQuery,length:0,toArray:function(){return slice.call(this)},get:function(num){return null==num?slice.call(this):num<0?this[num+this.length]:this[num]},slice:function(){return slice.apply(this,arguments)},getDomElements:function(selector){if(void 0===selector)return[];var elements=[];if("string"==typeof selector)if("<"==selector[0]&&">"==selector[selector.length-1])elements.push(App.dom.parse(selector));else if(selector.indexOf(" ")<0&&selector.indexOf(">")<0&&selector.indexOf("]")<0&&selector.indexOf("[")<0&&selector.indexOf(",")<0&&selector.split(".").length<3&&selector.split(",").length<2&&selector.split("#").length<2)if("#"==selector[0]){var el=document.getElementById(selector.slice(1));el&&elements.push(el)}else if("."==selector[0]&&0==selector.lastIndexOf(".")){var elems=document.getElementsByClassName(selector.slice(1));elems&&elems.length&&(elements=elems)}else{var els=document.getElementsByTagName(selector);els&&els.length&&(elements=els)}else elements=document.querySelectorAll(selector)||[];else if(selector instanceof Element||selector.constructor==HTMLHeadingElement||selector.constructor==HTMLElement||isGlobalOrRoot(selector))elements.push(selector);else if(selector.constructor==App.dom.jDom)elements.push(selector.el);else if(selector.constructor==App.query||selector.constructor==App.dom.DomQuery||selector.constructor==DomQuery||selector.constructor==App.dom.Form)elements=selector.e("all");else if(isArray(selector))for(let i=0;i<selector.length;i++){const elm=selector[i];elm instanceof Element||elm==document||elm==global?elements.push(elm):(elm instanceof App.dom.jDom||elm.constructor==App.dom.jDom)&&elements.push(elm.el)}return elements},on:function(){if(this.length){var args=[],event="string"==typeof arguments[0]?arguments[0]:"error";for(let i=0;i<arguments.length;i++){const arg=arguments[i];args.push(arg)}var self=this;for(let j=0;j<this.length;j++){const element=this[j];let selector=null,fn=null;3==args.length?("function"==typeof args[2]&&(fn=args[2]),args[1]instanceof App.dom.DomQuery||args[1].constructor==App.dom.DomQuery||isString(args[1])||args[1]instanceof Element||isGlobalOrRoot(arg[1])?(selector=args[1],fn||(fn=args[2])):isFunction(args[1])&&!fn&&(fn=args[1]),fn||App.func.check()):2==args.length&&(fn=args[1]);let fnc,fnt=fn||function(e){console.log(e)};"string"==typeof fn&&(fnt=function(e){return App.func.call(fn,[e])});let cb=fnt;selector&&(cb=function(e){let tag=e.target,evtag=null,children=self.getParentNodes(tag,[tag],element);var matchChild=App.query(children).filter(selector).getElements();if(children.length)for(let n=0;n<children.length;n++){const child=children[n];for(let m=0;m<matchChild.length;m++){const em=matchChild[m];child==em&&em&&(evtag=em,m+=matchChild.length,n+=children.length)}}if(evtag)return e.stopPropagation(),fnt.apply(evtag,[e,element])}),event.split(" ").filter((function(evt){return domEvents.indexOf(evt)>=0})).map((function(evt){App.dom.addEvent(element,evt,cb,selector)}))}}},off:function(events,data){if(data=data||null,this.length){var evs=events&&events.length?events.split(" "):domEvents;if(evs.length)for(let i=0;i<this.length;i++){const el=this[i];for(let j=0;j<evs.length;j++){const ev=evs[j];App.dom.removeEvent(el,ev,null,data)}}}return this},unbind:function(){return this.off.apply(this,arguments),this},getElements:function(selector,filter){if(!this.length)return[];var elements=[];for(let i=0;i<this.length;i++)if(void 0!==this[i]){const element=this[i];elements.push(element)}return"function"==typeof filter?elements.filter(filter):elements},map:function(mapFunc){if("function"!=typeof mapFunc)return[];var mapArr=[];for(let i=0;i<this.length;i++)if(void 0!==this[i]){const element=this[i];let mapEl;void 0!==mapFunc(element,i)&&mapArr.push()}return mapArr},each:function(eachFunc){if("function"!=typeof eachFunc)return[];var mapArr=[];for(let i=0;i<this.length;i++)if(void 0!==this[i]){const element=this[i];let mapEl;void 0!==eachFunc(i,element)&&mapArr.push()}return mapArr},filter:function(selector){var elems=this.getElements(),listMatch=App.query(selector).getElements().filter((function(el){for(let i=0;i<elems.length;i++){const elem=elems[i];if(el==elem)return!0}return!1}));return App.query(listMatch)},children:function(selector){if(!this.length)return App.query();var childList=[];if(this.map((function(el){if(el.children.length)for(let i=0;i<el.children.length;i++){const element=el.children[i];childList.push(element)}})),!childList.length)return App.query();var children=App.query(childList);return void 0===selector||null==selector?children:children.filter(selector)},getTree:function(elem,list){if(void 0===elem)return[];if(void 0!==list&&isArray(list)||(list=[]),elem instanceof Element){var self=this;if(!elem.children.length)return list;for(let i=0;i<elem.children.length;i++){const child=elem.children[i];list.push(child),child.children.length&&(list=this.getTree(child,list))}}return list},getParentNodes:function(elem,list,elementStop){if(void 0===elem)return[];if(void 0!==list&&isArray(list)||(list=[]),elem instanceof Element){if(!elem.parentNode||elementStop&&elementStop==elem)return list;var self=this;list.push(elem.parentNode),list=this.getParentNodes(elem.parentNode,list,elementStop)}return list},parent:function(selector){var list=[];if(this.map((function(el){el.parentNode&&list.push(el.parentNode)})),!selector)return App.query(list);var finders=App.query(selector).getElements(),filterList=finders.length&&list.length?list.filter((function(el){for(let i=0;i<finders.length;i++){const element=finders[i];if(el==element)return!0}return!1})):[];return App.query(filterList)},closest:function(selector){if(null==selector)return this.parent();var finder=App.query(selector).getElements(),closestList=[],findLength=finder.length;if(findLength){var elements=this.getElements(),elementLength=elements.length,parents=[],parentLength=0,parent,find;if(1==findLength){if(finder=finder[0],1==elementLength)parents=this.getParentNodes(elements[0]);else for(let i=0;i<elementLength;i++){const element=elements[i];let ps;this.getParentNodes(element).map((function(p){parents.push(p)}))}parentLength=parents.length;for(let n=0;n<parentLength;n++)if((parent=parents[n])==finder){closestList.indexOf(parent)<0&&closestList.push(parent),n+=parentLength;break}}else{if(1==elementLength)parents=this.getParentNodes(elements[0]);else for(let i=0;i<elementLength;i++){const element=elements[i];let ps;this.getParentNodes(element).map((function(p){parents.push(p)}))}parentLength=parents.length;for(let n=0;n<parentLength;n++){parent=parents[n];for(let m=0;m<findLength;m++)parent==(find=finder[m])&&(closestList.indexOf(parent)<0&&closestList.push(parent),m+=findLength)}}}return App.query(closestList)},is:function(selector){if(1==this.length){if(isString(selector)&&selector.length>1&&":"==selector.substring(0,1))return!(void 0===this[0][selector.substring(1)]||!this[0][selector.substring(1)]);var $list;if(1==App.query(selector).filter(this[0]).length)return!0}return!1},find:function(selector){if(void 0===selector||!selector)return App.query();var listChild=[],self=this;return this.map((function(el){var ch=el.querySelectorAll(selector)||[],l=ch.length;if(l)for(let i=0;i<l;i++){const c=ch[i];listChild.push(c)}})),App.query(listChild)},get:function get(index){if(void 0===index)return this;if(isNumber(index)){var elements=this.getElements();if(void 0!==elements[index])return App.query(elements[index])}return App.query()},first:function(){return App.query(this.length?this.getElements(null,(function(el,i){return 0==i})):[])},last:function(){var elements=this.getElements();return App.query(elements.length?elements[elements.length-1]:[])},append:function(child){return child.constructor==App.dom.jDom?this.map((function(el){el.appendChild(child.el)})):this.map((function(el){el.appendChild(App.dom.parse(child))})),this},prepend:function(child){return child.constructor==App.dom.jDom?this.map((function(el){el.insertBefore(App.dom.parse(child.el),el.firstChild)})):this.map((function(el){el.insertBefore(App.dom.parse(child),el.firstChild)})),this},remove:function(){return this.map((function(el){el.parentNode?el.parentNode.removeChild(el):el.remove&&isFunction(el.remove)&&el.remove()})),this},getProp:function(prop,all){if(!this.length)return"";if(all){var p=[];return this.map((function(el){p.push(el[prop])})),p}return void 0!==this[0][prop]?this[0][prop]:null},setProp:function(prop,value){if(!this.length)return this;var props={};"object"==typeof prop?props=pros:props[prop]=value;var elements=this.getElements();for(const p in props)if(props.hasOwnProperty(p)){const val=props[p];elements.map((function(element,index){element[prop]=val}))}return this},removeProp:function(prop){if(void 0!==prop){var elements=this.e("all");isString(prop)&&(prop=[prop]),isArray(prop)&&elements.map((function(el){prop.map((function(p){isString(p)&&delete el[p]}))}))}return this},prop:function(prop,value){if(!prop){if(!this.length)return{};var props={};for(const key in this[0])if(this[0].hasOwnProperty(key)){const propVal=this[0][key];props[key]=propVal}return props}return void 0===value?this.length&&this[0][prop]||null:this.length?void this.map((function(el){!1===value?delete el[prop]:el[prop]=value})):this},val:function(value){if(null==value){if(!this.length)return null;var inputs;if((inputs=this.getElements().filter((function(el){if(isGlobalOrRoot(el))return!1;var tag=el.tagName.toLowerCase();return["input","select","textarea"].indexOf(tag)>=0}))).length)for(let i=0;i<inputs.length;i++){const input=inputs[i];let tag=input.tagName.toLowerCase(),type=input.getAttribute("type");return"textarea"==tag||"textarea"==type?input.value||input.innerText:["rasio","checkbox"].indexOf(type)>=0?input.checked?null!=input.value?input.value:"on":null:input.value}return null}var inputs;if((inputs=this.getElements().filter((function(el){if(isGlobalOrRoot(el))return!1;var tag=el.tagName.toLowerCase();return["input","select","tetxtarea"].indexOf(tag)>=0}))).length)for(let i=0;i<inputs.length;i++){const input=inputs[i];let tag;"textarea"==input.tagName.toLowerCase()?input.innerText=value:input.value=value}return this},serialize:function(){if(!this.length||isGlobalOrRoot(this[0])||"form"!=this[0].tagName.toLowerCase())return"";for(var form=this[0],serialized=[],i=0;i<form.elements.length;i++){var field=form.elements[i];if(field.name&&!field.disabled&&"file"!==field.type&&"reset"!==field.type&&"submit"!==field.type&&"button"!==field.type)if("select-multiple"===field.type)for(var n=0;n<field.options.length;n++)field.options[n].selected&&serialized.push(encodeURIComponent(field.name)+"="+encodeURIComponent(field.options[n].value));else("checkbox"!==field.type&&"radio"!==field.type||field.checked)&&serialized.push(encodeURIComponent(field.name)+"="+encodeURIComponent(field.value))}return serialized.join("&")},
/*!
        * Serialize all form data into a array
        * (c) 2018 Chris Ferdinandi, MIT License, https://gomakethings.com
        * @param  {Node}   form The form to serialize
        * @return {array}      The serialized form data
        */
serializeArray:function(){if(!this.length||isGlobalOrRoot(this[0])||"form"!=this[0].tagName.toLowerCase())return[];for(var form=this[0],serialized=[],i=0;i<form.elements.length;i++){var field=form.elements[i];if(field.name&&!field.disabled&&"file"!==field.type&&"reset"!==field.type&&"button"!==field.type)if("select-multiple"===field.type)for(var n=0;n<field.options.length;n++)field.options[n].selected&&serialized.push({name:field.name,value:field.options[n].value});else("checkbox"!==field.type&&"radio"!==field.type||field.checked)&&serialized.push({name:field.name,value:field.value})}return serialized},formdata:function(){if(!this.length||isGlobalOrRoot(this[0])||"form"!=this[0].tagName.toLowerCase())return[];var form=this[0],f;return new FormData(form)},serializeObject:function(){var serialized=this.serializeArray(),data={};return serialized.map((function(inp){null!=typeof data[inp.name]?App.getType("array"==data[inp.name])?data[inp.name].push(inp.value):data[inp.name]=[data[inp.name]]:data[inp.name]=inp.value})),data},getHtml:function(all,joinKey){if(!this.length)return"";if(all||isGlobalOrRoot(this[0])){var html="";return joinKey||(joinKey=""),html=this.getElements().map((function(el){return isGlobalOrRoot(el)?"":el.innerHTML})).join(joinKey)}return this[0].innerHTML},html:function(str,all){if(this.length){if(null==str)return this.getHtml(all,"");var self=this,elements=this.getElements(null,(function(el){if(isGlobalOrRoot(el))return!1;var tag=el.tagName.toLowerCase();return self.simpleTags.indexOf(tag)<0})).map((function(el){el.innerHTML=str}))}return this},getAttribute:function(attr){return this.length>0?this[0].getAttribute(attr):null},setAttribute:function(attr,value){return this.getElements().map((function(el){el.setAttribute(attr,value)})),this},attr:function(attr,value){if(null==value&&"object"!=typeof attr)return this.getAttribute(attr);if(void 0!==attr&&"object"==getType(attr)){var elements=this.getElements();for(const key in attr)if(attr.hasOwnProperty(key)){const ava=attr[key];elements.map((function(t){t.setAttribute(key,ava)}))}}else if(null==attr)return this.length?this[0].attributes:{};return this.setAttribute(attr,value)},data:function(key){if(!this.length)return null;if(!this.__data){var data={},dataRaw={},attrs=this[0].attributes;if(attrs.length)for(let i=0;i<attrs.length;i++){const attr=attrs[i];if(0===attr.name.toLowerCase().indexOf("data-")){let a=attr.name.substring(5);dataRaw[a]=attr.value;let b=a.split("-"),c=b.shift(),d=b.map((function(v){return App.str.ucfirst(v)})),k;data[c+(d.length?d.join(""):"")]=attr.value}}this.__data={raw:dataRaw,parse:data}}if(void 0===key||null==key)return this.__data.parse;if("string"==typeof key)return void 0!==this.__data.raw[key]?this.__data.raw[key]:null;if(isArray(key)){var arrData={};for(let i=0;i<key.length;i++){const kk=key[i];void 0!==this.__data.raw[kk]&&(arrData[kk]=this.__data.raw[kk])}return arrData}return null},addClass:function(classname){var classlist=[],mapFunc=function(val){isString(val)?classlist.push(val):isArray(val)&&val.map(mapFunc)};if(arguments.length)for(let i=0;i<arguments.length;i++){const arg=arguments[i];mapFunc(arg)}return this.getElements(null,(function(el){return!isGlobalOrRoot(el)})).map((function(el){classlist.map((function(str){el.classList.add(str)}))})),this},removeClass:function(classname){var elems=this.getElements(null,(function(el){return!isGlobalOrRoot(el)})),classlist=[],mapFunc=function(val){isString(val)?classlist.push(val):isArray(val)&&val.map(mapFunc)},args=[];if(arguments.length){for(let i=0;i<arguments.length;i++){const arg=arguments[i];mapFunc(arg)}elems.map((function(el){classlist.map((function(str){el.classList.remove(str)}))}))}else elems.map((function(el){el.className=""}));return this},hasClass:function(classname){return!!this.length&&this.length==this.getElements(null,(function(el){return!isGlobalOrRoot(el)&&el.classList.contains(classname)})).length},setCssProp:function(element,prop,value){element instanceof Element&&isString(prop)&&isString(value)&&(element.style[prop]=value)},getCssProp:function(element,prop){return element instanceof Element&&isString(prop)&&void 0!==element.style[prop]?String(element.style[prop]):""},css:function(prop,value){var self=this;if(!prop||isEmpty(value)||!this.length)return this;if(isString(prop))this.map((function(e){self.setCssProp(e,App.str.camelToSlug(prop),value)}));else if(isObject(prop)){var props={};for(const key in prop)if(prop.hasOwnProperty(key)){const v=prop[key];var p=App.str.camelToSlug(key);props[p]=v}this.map((function(e){for(const key in props)if(props.hasOwnProperty(key)){const v=props[key];self.setCssProp(e,key,v)}}))}return this},show:function(time,callback){var self=this,t=isNumber(time)?parseInt(time):0,cb=isCallable(time)?time:isCallable(callback)?callback:emptyFunc;if(this.css("display","block"),t>0){var vpt=1/time,opc=0;this.map((function(e){var opacity;if("1"!=self.getCssProp(e,"opacity")){self.setCssProp(e,"opacity",0);for(let i=0;i<t;i++)setTimeout((function(){opc+=vpt,self.setCssProp(e,"opacity",opc)}),i+1);setTimeout((function(){self.setCssProp(e,"opacity",1),cb.call(e)}),t)}else setTimeout((function(){cb.call(e)}),t)}))}else this.map((function(e){var opacity;"1"!=self.getCssProp(e,"opacity")?(self.setCssProp(e,"opacity",1),cb.call(e)):cb.call(e)}));return this},hide:function(time,callback){var self=this,t=isNumber(time)?parseInt(time):0,cb=isCallable(time)?time:isCallable(callback)?callback:emptyFunc;if(t>0){var vpt=1/time,opc=1;this.map((function(e){var opacity=self.getCssProp(e,"opacity");if("0"!=opacity&&""!=opacity){for(let i=0;i<t;i++)setTimeout((function(){opc-=vpt,self.setCssProp(e,"opacity",opc)}),i+1);setTimeout((function(){self.setCssProp(e,"opacity",0),self.setCssProp(e,"display","none"),cb.call(e)}),t)}else setTimeout((function(){cb.call(e),self.setCssProp(e,"display","none")}),t)}))}else this.map((function(e){self.setCssProp(e,"opacity",0),self.setCssProp(e,"display","none"),cb.call(e)}));return this}};for(let i=0;i<domEvents.length;i++){const ev=domEvents[i];DomQuery.prototype[ev]=function(fn){var args=[ev];for(let i=0;i<arguments.length;i++){const param=arguments[i];args.push(param)}return 1==args.length?(this.map((function(el){null!=el[ev]&&isFunction(el[ev])&&el[ev].call(el)})),this):this.on.apply(this,args)}}App.addQueryModule=App.prototype.addQueryModule=App.dom.addQueryModule=DomQuery.prototype.extends=function(moduleName,moduleData){if(moduleName)if(isString(moduleName)&&!isNumber(moduleName))DomQuery.prototype[moduleName]=moduleData;else if(isObject(moduleName))for(const key in moduleName)if(moduleName.hasOwnProperty(key)){const val=moduleName[key];DomQuery.prototype[key]=val}};var Validator={rules:{required:function(value){return void 0===value?void 0:!isString(value)&&!isArray(value)||value.length>0},email:function(value){return void 0===value?void 0:isString(value)&&isEmail(value)},number:function(value){return void 0===value?void 0:isNumber(value)},array:function(value){return void 0===value?void 0:isArray(value)},min:function(value,params){if(void 0!==value)return isNumber(value)?void 0!==params&&isArray(params)&&params.length&&isNumber(params[0])?parseFloat(value)>=parseFloat(params[0]):null:0},max:function(value,params){if(void 0!==value)return isNumber(value)?void 0!==params&&isArray(params)&&params.length&&isNumber(params[0])?parseFloat(value)<=parseFloat(params[0]):null:0},not:function(value,params){if(void 0!==value){if(void 0===params||!isArray(params)||!params.length)return null;for(var i=0,val=params[i];i<params.length;i++)if(value===val)return!1;return!0}},equalTo:function(value,params){if(void 0!==value){if(void 0===params||!isArray(params)||!params.length)return null;for(var i=0,val=params[i];i<params.length;i++)if(value===val)return!0;return!1}},minlength:function(value,params){if(void 0!==value)return void 0!==params&&isArray(params)&&params.length&&isNumber(params[0])?String(value).length>=parseFloat(params[0]):null},maxlength:function(value,params){if(void 0!==value)return void 0!==params&&isArray(params)&&params.length&&isNumber(params[0])?String(value).length<=parseFloat(params[0]):null},mimes:function(value,params){if(void 0!==value){if(void 0===params||!isArray(params)||!params.length)return null;for(let i=0;i<params.length;i++){const v=params[i];if(value==v)return!0}return!1}}},messages:{required:":label Không được bỏ trống",email:":label không đúng định dạng email",number:":label phải là số",min:":label phải nhỏ hơn :params",min_number:":label không phải là số",min_null:"Tham số validate.min không hợp lệ",max:":label phải lớn hơn :params",max_number:":label không phải là số",max_null:"Tham số validate.max không hợp lệ",minlength:":label phải chứa tối thiểu :params ký tự",minlength_null:"Tham số validate.minlength không hợp lệ",maxlength:":label không được vượt quá :params ký tự",maxlength_null:"Tham số validate.maxlength không hợp lệ",not:":label phải khác :params",not_null:"Tham số validate.maxlength không hợp lệ",equalTo:":label phải nằm trong các giá trị :params",equalTo_null:"Tham số validate.equalTo không hợp lệ"},currentMessages:{},extend:function(rule,func,message){if(rule)if(isObject(rule)){if("string"==typeof rule.name&&"function"==typeof rule.rule)this.rules[rule.name]=rule.rule,"string"==typeof rule.message&&(this.messages[rule.name]=rule.message);else for(const n in rule)if(rule.hasOwnProperty(n)){const r=rule[n];(isObject(r)||isCallable(r))&&this.extend(n,r)}}else if(isCallable(rule)&&rule.name)this.rules[rule.name]=rule;else if(isString(rule)&&func)return isCallable(func)?(this.rules[rule]=func,void("string"==typeof message&&(this.messages[rule]=message))):void(isObject(func)&&"function"==typeof func.rule&&(this.rules[rule]=func,"string"==typeof func.message&&(this.messages[rule]=func.message)))},parseRule:function(str){if(!str)return null;var rule=App.str.replace(str," ","").split("|"),rules={},paramStr,params,ruleName="";for(let i=0;i<rule.length;i++){const rp=rule[i];if(0!=rp.length){var st=rp.indexOf(":");if(st<1||st==rp.length-1){var rn=App.str.replace(rp,":","0");rules[rn]={rule:rn,str_params:"",params:[]}}else{var rps=rp.split(":");ruleName=rps[0],params=(paramStr=rps[1]).split(","),rules[ruleName]={rule:ruleName,str_params:paramStr,params:params}}}}return rules},parseMessage:function(slug,rule,ruleExt,label,params,elem){var msg="";return slug&&isString(slug)?(ruleExt=ruleExt?rule+"_"+ruleExt:rule,rule?this.currentMessages[slug+"_"+rule]?msg=this.currentMessages[slug+"_"+rule]:this.currentMessages[slug]?msg=this.currentMessages[slug]:this.messages[ruleExt]?msg=this.messages[ruleExt]:this.messages[rule]&&(msg=this.messages[rule]):msg=this.currentMessages[slug]||"",label=label||slug,params=params||label,App.str.replace(msg,{":label":label,":params":String(params)})):""},make:function(data,rules,messages){rules=rules&&isObject(rules)?rules:null;var validate={status:!0,messages:[],errors:{},errorMap:{},errorData:{},fields:{},allMessage:function(){var list=[];for(const key in this.errors)if(this.errors.hasOwnProperty(key)){const msg=this.errors[key];list.push(msg)}return list}};if(!rules)return validate;var firstError=function(){for(const rk in this.errors)if(this.errors.hasOwnProperty(rk)){const mess=this.errors[rk];if(!isArray(mess))return mess;if(mess.length)return mess[0]}return""},getMessage=function(ruleKey,index){var isKey="string"==typeof ruleKey&&ruleKey.length,IsIndex=void 0===index&&isNumber(index),list=[];for(const rk in this.errors)if(this.errors.hasOwnProperty(rk)){const mess=this.errors[rk];if(isArray(mess)){if(isKey&&ruleKey==rk)return IsIndex?void 0!==mess[index]?mess[index]:"":mess.join(", ");list.push(mess.join(", "))}else{if(isKey&&ruleKey==rk)return mess;list.push(mess)}}return list},addFieldError=function(field,name,rule,message){field instanceof Element&&(name=name||field.name,void 0===validate.fields[name]&&(validate.fields[name]={field:field,errors:{},firstError:firstError,getMessage:getMessage}),validate.fields[name].errors[rule]=message)};this.currentMessages=messages&&isObject(messages)?deepCopy(this.messages,messages):this.messages,isEmptyData="object"!=typeof data;for(const name in rules)if(rules.hasOwnProperty(name)){var input=data[name]||null;const ruleStr=rules[name];var ruleObj=this.parseRule(ruleStr);if(ruleObj){var isRequired=void 0!==ruleObj.required,msg;if(isEmptyData){if(isRequired)validate.status=!1,(msg=this.parseMessage(name,"required"))&&(validate.messages.push(msg),validate.errors[name]=msg)}else if(!isRequired||void 0!==data[name]&&this.rules.required(data[name].value)){for(const ruleKey in ruleObj)if(ruleObj.hasOwnProperty(ruleKey)){const ruleData=ruleObj[ruleKey];var f=ruleData.rule,check=!0;if("required"!=f&&"function"==typeof this.rules[f])if(name.lastIndexOf("*")==NamedNodeMap.length-1&&isArray(input.value)&&"array"!=f){var ts=!0,nameR=name.substring(0,name.length-2),msg;for(let n=0;n<input.value.length;n++){const v=input.value[n];var ruleExt,nameN=nameR+"."+n,msg;if(!(check=this.rules[f].call(this.rules,v,ruleData.params,input?input.el:null)))ts=!1,ruleExt=void 0===check?"undefined":getType(check),(msg=this.parseMessage(nameN,f,"boolean"==ruleExt?null:ruleExt,input.label||input.name,ruleData.str_params,input.el))&&(validate.messages.indexOf(msg)<0&&validate.messages.push(msg),void 0===validate.errorData[nameR]&&(validate.errorData[nameR]={}),void 0===validate.errorData[nameR][n]&&(validate.errorData[nameR][n]={}),validate.errorData[nameR][n][f]=msg,validate.errorMap[nameR+"_"+n+"__"+f]=msg),validate.status=!1}if(!ts)(msg=this.parseMessage(name,f,"boolean"==ruleExt?null:ruleExt,input.label||input.name,ruleData.str_params,input.el))&&(validate.messages.indexOf(msg)<0&&validate.messages.push(msg),addFieldError(input.el,nameR,f,msg),validate.errors[name]=msg,validate.errorMap[nameR+"_"+f]=msg,void 0===validate.errorData[nameR]&&(validate.errorData[nameR]={}),validate.errorData[nameR][f]=msg)}else if(!(check=this.rules[f].call(this.rules,input.value,ruleData.params,input?input.el:null)))if(void 0!==check&&0!=input.value.length||isRequired){var ruleExt=void 0===check?"undefined":getType(check),msg;(msg=this.parseMessage(name,f,"boolean"==ruleExt?null:ruleExt,input.label||input.name,ruleData.str_params,input.el))&&(validate.messages.push(msg),addFieldError(input.el,name,f,msg),validate.errors[name]=msg,validate.status=!1,void 0===validate.errorData[name]&&(validate.errorData[name]={}),validate.errorData[name][f]=msg,validate.errorMap[name+"_"+f]=msg)}else;}}else{var msg;validate.status=!1,(msg=this.parseMessage(name,"required",null,input?input.label||input.name:null))&&(validate.messages.push(msg),validate.errors[name]=msg,validate.errorMap[name+"_required"]=msg,void 0===validate.errorData[name]&&(validate.errorData[name]={}),validate.errorData[name].required=msg,input&&addFieldError(input.el,nameR,"required",msg))}}}return validate}};App.validator=App.prototype=Validator,App.validate=App.prototype.validate=function(data,rules,messages,fails){var valid=Validator.make(data||null,rules||null,messages||messages);if(!valid.status){if("function"==typeof fails)return fails(valid);console.log(valid)}return valid.status};var Form=App.dom.Form=function(selector,opts){var elements=this.getDomElements(selector);let n=0;for(let index=0;index<elements.length;index++){const el=elements[index];this[n]=el,n++}this.length=n;var current=this.length?this[0]:null,$data={},self=this,options={url:null,submitType:"redirect",dataType:null,validate:null,method:null,test:""},eventListeners={},methods={all:function(){return elements},el:function(num){return void 0===num?self.length?self[0]:null:isNumber(num)&&void 0!==self[num]?self[num]:null},form:function(num){return void 0===num?(num=this.getCurrentIndex(),self.length<2?self:self.get(num)):isNumber(num)?void 0!==self[num]?App.query(self[num]):App.query():"all"==num?$form:void App.query()},setCurrent:function(element){return element&&element instanceof Element&&(current=element),self},getCurrent:function(){return current},getCurrentIndex:function(){var index=-1;if(current)for(let i=0;i<elements.length;i++){const element=elements[i];if(element==current){index=i;break}}return index},getCurrentData:function(){var ci=this.getCurrentIndex();return ci>=0&&void 0!==$data[ci]?$data[ci]:null},updateCurrentData:function(data){var ci=this.getCurrentIndex();ci>=0&&void 0!==$data[ci]&&($data[ci]=data)},get:function(key){var d=this.getCurrentData();return null==d?null:void 0===key?d.data:isString(key)&&void 0!==d.data[key]?d.data[key]:null},set:function(key,value){var d=this.getCurrentData();if(null==d)return self;if(void 0===key)return self;if(isString(key))d.data[key]=value;else if(isObject(key))for(const k in key)if(key.hasOwnProperty(k)){const v=key[k];d.data[k]=v}return this.updateCurrentData(d),this},getFile:function(key){var d=this.getCurrentData();return null==d?[]:void 0===key?d.filedata:isString(key)&&void 0!==d.filedata[key]?d.filedata[key]:[]},setFile:function(key,value){var d=this.getCurrentData();if(null==d||void 0===key)return self;if(isString(key))d.filedata[key]=value;else if(isObject(key))for(const k in key)if(key.hasOwnProperty(k)){const v=key[k];d.filedata[k]=v}return this.updateCurrentData(d),self},getEvent:function(event){return void 0===event?eventListeners:isString(event)&&void 0!==eventListeners[event]?eventListeners[event]:null},addEvent:function(event,handler){if(void 0===event)return self;if(isString(event)&&"function"==typeof handler)eventListeners[event]=handler;else if(isObject(event))for(const k in event)if(key.hasOwnProperty(k)){const v=event[k];"function"==typeof v&&(eventListeners[k]=v)}return this},setOption:function(key,value){if(void 0===key)return this;if(isObject(key))for(const k in key){const v=key[k];key.hasOwnProperty(k)&&(-1!=["done","error","then","catch","transform","beforeSenf"].indexOf(k)?"function"==typeof v&&"function"==typeof self[k]&&self[k].call(self,v):options[k]=v)}else void 0!==value&&(-1!=["done","error","then","catch","transform","beforeSenf"].indexOf(key)?"function"==typeof value&&"function"==typeof self[key]&&self[key].call(self,value):options[key]=value)},getOption:function(key){return void 0===key?options:(isString(key)||isNumber(key))&&void 0!==options[key]?options[key]:null},getContext:function(){return self}};this.e=function(){if(!arguments.length||"string"!=typeof arguments[0])return null;var method=arguments[0],r=null;if("function"==typeof methods[method]){var args=[];for(let i=1;i<arguments.length;i++){const arg=arguments[i];args.push(arg)}r=methods[method].apply(methods,args)}return r},methods.setOption(opts),this.off("submit").on("submit",(function(e){self.e("setCurrent",e.target);try{var rs=self.onSubmit(e);return"redirect"==methods.getOption("submitType")?rs:(e.preventDefault(),!1)}catch(error){return cl(error),!1}})),this.off("change").on("change",(function(e){return self.e("setCurrent",App.query(e.target).closest("form")[0]),self.onChange(e)}));for(let i=0;i<elements.length;i++){const f=elements[i];$data[i]={data:{},filedata:{}}}$data.length=elements.length};Form.prototype=deepCopy(DomQuery.prototype,{constructor:App.dom.Form,onChange:function(e){var self=this,tag=e.target,tagname=tag.tagName.toLowerCase(),type=tag.type.toLowerCase(),$form=this.e("form");if(["input","textarea","select"].indexOf(tagname)>=0&&(this.e("getOption","serializeFile")||"ajax"==$form.attr("submit-type"))&&"file"==type)var test=App.files.readFileInput(tag,(function(list){self.e("setFile",tag.name,list)}))},onSubmit:function(e){var self=this.e("getContext"),handler=this.e("getEvent","submit"),currentForm=this.e("getCurrent")||e.target,rs=null;try{var options=self.e("getOption"),$form=App.query(currentForm),submitType=$form.data("submit-type")||$form.attr("submit-type")||options.submitType||"redirect",firstSubmitType=submitType=submitType.toLowerCase(),validateData=this.e("getOption","validate")||this.e("getOption","validation"),vs;if("object"==typeof validateData.rules)if(!this.validate(validateData.rules,"object"==typeof validateData.messages?validateData.messages:{},"function"==typeof validateData.fails?validateData.fails:function(validator){cl(validator)}))return e.preventDefault(),!1;if(isCallable(handler)&&(rs=handler.apply(currentForm,[e])),-1==["fetch","api","ajax","xhr","axios"].indexOf(submitType))return rs;"ajax"!=submitType||globalThis.jQuery||"ajax"!=$form.attr("submit-type")||($form.attr("submit-type","xhr"),submitType="xhr");var url=$form.attr("submit-url")||$form.attr("ajax-url")||$form.data("ajax-url")||options.url||$form.attr("action"),dataType=$form.data("type")||options.dataType||"raw";dataType=isString(dataType)?dataType.toLowerCase():"raw";var method=options.method||$form.attr("method");method=isString(method)?method.toUpperCase():"GET",-1===["POST","PUT","PATCH","DELETE","OPTIONS","GET","HEAD"].indexOf(method)&&(method="GET");var IsPost,contentType,isUpload="multipart/form-data"==("post"===method.toLowerCase()&&currentForm.enctype?currentForm.enctype:"application/x-www-form-urlencoded").toLowerCase()||options.isUpload||!1,body=null,responseType=$form.attr("response-type")||options.responseType||"";responseType=(responseType+"").toLowerCase(),-1==["arraybuffer","blob","document","json","text"].indexOf(responseType)&&(responseType="");var contentTypes=[],accept=[];"GET"==method||"encoded"==dataType?(body=self.serialize(),contentTypes.push("application/x-www-form-urlencoded","charset=UTF-8"),"GET"==method&&(url+=(url.indexOf("?")>=0?"&":"?")+body)):isUpload&&"ajax"!=submitType?isUpload||"json"!=dataType?(body=self.toFormData(),accept.push("application/json","text/javascript","text/html")):(contentTypes.push("application/json"),accept.push("application/json"),body=self.serializeObject()):(body=self.serializeArray(),"ajax"!=submitType&&accept.push("application/json","text/javascript","text/html"));var headers={};contentTypes.length&&(headers["Content-type"]=contentTypes.join("; ")),"json"==responseType&&-1==accept.indexOf("application/json")&&accept.push("application/json"),accept.length&&(headers.Accept=accept.join("; "));var eventListeners=self.e("getEvent"),success,error,transform,beforeSend,params={method:method,responseType:responseType,success:eventListeners.success||emptyFunc,error:eventListeners.error||emptyFunc,transform:eventListeners.transform||function(rs){return rs},beforeSend:eventListeners.beforeSend||emptyFunc,requestApi:firstSubmitType};if(headers&&(params.headers=headers),"fetch"==submitType||"api"==submitType){params.credentials="same-origin",params.headers=new Headers(headers),-1==["GET","HEAD"].indexOf(method)&&("json"==dataType&&(body=JSON.stringify(body)),params.body=body);var fetchdata=App.fetch(url,params)}else if("xhr"!=submitType&&submitType){if("axios"==submitType){var axiosData;isUpload?axiosData=App.axiosUpload(url,body,params):(params.body=body,axiosData=App.axios(url,params))}else if("ajax"==submitType){var ajax;params.data=body,params.url=url,ajax=App.ajax(params)}}else{var xhr;-1==["GET","HEAD"].indexOf(method)&&(params.body=body),xhr=App.xhr(url,params)}}catch(error){cl(error),e.preventDefault()}return e.preventDefault(),!1},segments:[],fileload:0,fileloadSuccess:0,readComplete:!1,callback:cl,segmentList:[],segmentsDone:function(){var self=this;this.fileload!=this.fileloadSuccess||this.readComplete||(this.callback(this.segments.map((function(t){return t}))),this.readComplete=!0)},pushSegments:function(form,callback){var self=this;if(self.segments=[],self.segmentList=[],self.fileload=0,self.fileloadSuccess=0,self.readComplete=!1,form){isCallable(form)&&(callback=form,form=self.e("getCurrent")),callback&&isCallable(callback)||(callback=cl),self.callback=callback;for(var elements=form.elements,elength=elements.length,field,n,oFile,fileReader,sFieldType,i=0;i<elength;i++)if((field=elements[i]).hasAttribute("name")&&!field.disabled)if("FILE"===(sFieldType="INPUT"===field.nodeName.toUpperCase()?field.getAttribute("type").toUpperCase():"TEXT")&&field.files.length>0)for(n=0;n<field.files.length;n++)oFile=field.files[n],(fileReader=new FileReader).segmentIdx=this.segments.length,fileReader.owner=this,fileReader.onload=onFileLoad,this.segments.push('Content-Disposition: form-data; name="'+field.name+'"; filename="'+oFile.name+'"\r\nContent-Type: '+oFile.type+"\r\n\r\n"),self.fileload++,fileReader.readAsBinaryString(oFile);else("RADIO"!==sFieldType&&"CHECKBOX"!==sFieldType||field.checked)&&this.segments.push('Content-Disposition: form-data; name="'+field.name+'"\r\n\r\n'+field.value+"\r\n");self.fileload==self.fileloadSuccess&&self.segmentsDone()}function onFileLoad(oFREvt){this.owner.segments[this.segmentIdx]+=oFREvt.target.result+"\r\n",self.fileloadSuccess++,self.segmentList.push(this.segmentIdx),self.segmentsDone()}},hasFile:function(){var form,elements=this.e("getCurrent").elements,elength=elements.length;if(0==elength)return!1;for(var i=0;i<elength;i++){var field=elements[i];if("file"===field.type&&field.files.length)return!0}return!0},toFormData:function(){for(var form=this.e("getCurrent"),formData=new FormData,i=0;i<form.elements.length;i++){var field=form.elements[i];if(field.name&&!field.disabled&&"reset"!==field.type&&"button"!==field.type)if("file"===field.type){let files=field.files;if(files.length)for(let j=0;j<files.length;j++){const file=files[j];formData.append(field.name,file)}}else if("select-multiple"===field.type)for(var n=0;n<field.options.length;n++)field.options[n].selected&&formData.append(field.name,field.options[n].value);else("checkbox"!==field.type&&"radio"!==field.type||field.checked)&&formData.append(field.name,field.value)}return formData},getValidateData:function(){for(var form=this.e("getCurrent"),formData={},addDataValue=function(field,value){if(field){var slug=App.str.formSlug(field.name);if(void 0===formData[slug])return formData[slug]={el:field,name:field.name,type:field.type,value:value},!0;isArray(formData[slug].value)||(formData[slug].value=[formData[slug].value]),formData[slug].value.push(value)}},i=0;i<form.elements.length;i++){var field=form.elements[i],inputType=field.type.toLowerCase();if(field.name&&!field.disabled&&"reset"!==field.type&&"button"!==field.type)if("file"===field.type){let files=field.files;var fieldvals=[];if(files.length)for(let j=0;j<files.length;j++){const file=files[j];fieldvals.push({name:file.name,type:file.type,size:file.size})}addDataValue(field,fieldvals)}else if("select-multiple"===field.type){for(var fieldvals=[],n=0;n<field.options.length;n++)field.options[n].selected&&fieldvals.push(field.options[n].value);addDataValue(field,fieldvals)}else("checkbox"!==field.type&&"radio"!==field.type||field.checked)&&addDataValue(field,field.value)}return formData},serialize:function(serializeFile){serializeFile=void 0===serializeFile?null:serializeFile;for(var self=this,$form=this.e("form"),form=this.e("getCurrent"),serialized=[],i=0;i<form.elements.length;i++){var field=form.elements[i];if(field.name&&!field.disabled&&"file"!==field.type&&"reset"!==field.type&&"submit"!==field.type&&"button"!==field.type)if("select-multiple"===field.type)for(var n=0;n<field.options.length;n++)field.options[n].selected&&serialized.push(encodeURIComponent(field.name)+"="+encodeURIComponent(field.options[n].value));else("checkbox"!==field.type&&"radio"!==field.type||field.checked)&&serialized.push(encodeURIComponent(field.name)+"="+encodeURIComponent(field.value))}if(this.e("getOption","serializeFile")){var filedata=this.e("getFile");if(filedata)for(const fn in filedata)if(filedata.hasOwnProperty(fn)){const data=filedata[fn];if(isArray(data)){if(data&&data.length)for(let i=0;i<data.length;i++){const d=data[i];serialized.push(encodeURIComponent(fn)+"="+encodeURIComponent(d))}}else serialized.push(encodeURIComponent(fn)+"="+encodeURIComponent(data))}}return serialized.join("&")},serializeArray:function(serializeFile){serializeFile=void 0===serializeFile?null:serializeFile;for(var self=this,form=this.e("getCurrent"),$form=this.e("form"),serialized=[],i=0;i<form.elements.length;i++){var field=form.elements[i];if(field.name&&!field.disabled&&"file"!==field.type&&"reset"!==field.type&&"button"!==field.type)if("select-multiple"===field.type)for(var n=0;n<field.options.length;n++)field.options[n].selected&&serialized.push({name:field.name,value:field.options[n].value});else("checkbox"!==field.type&&"radio"!==field.type||field.checked)&&serialized.push({name:field.name,value:field.value})}if(this.e("getOption","serializeFile")||"ajax"==$form.attr("submit-type")||"ajax"==this.e("getOption","submitType")){var filedata=this.e("getFile");if(filedata)for(const fn in filedata)if(filedata.hasOwnProperty(fn)){const data=filedata[fn];data&&data.length&&serialized.push({name:fn,value:data})}}return serialized},serializeObject:function(){var serialized=this.serializeArray(),data={};return serialized.map((function(inp){null!=typeof data[inp.name]?App.getType("array"==data[inp.name])?data[inp.name].push(inp.value):data[inp.name]=[data[inp.name]]:data[inp.name]=inp.value})),data},formdata:function(){var self=this,$form,$data;return this.e("form").formdata()},submit:function(fn){if(void 0===fn){var form=this.e("form");form.length&&form[0].submit()}else isCallable(fn)&&this.e("addEvent","submit",fn);return this},change:function(fn){return void 0===fn?this:(isCallable(fn)&&this.e("addEvent","change",fn),this)},done:function(fn){return void 0!==fn&&isCallable(fn)&&this.e("addEvent","success",fn),this},success:function(fb){return this.done.apply(this,arguments)},then:function(fb){return this.done.apply(this,arguments)},transform:function(fn){return void 0!==fn&&isCallable(fn)&&this.e("addEvent","transform",fn),this},beforeSend:function(fn){return void 0!==fn&&isCallable(fn)&&this.e("addEvent","beforeSend",fn),this},error:function(fn){return void 0!==fn&&isCallable(fn)&&this.e("addEvent","error",fn),this},catch:function(fb){return this.error.apply(this,arguments)},setOption:function(key,value){var k=key||null,v=void 0!==value?value:null;return k&&this.e("setOption",k,v),this},validate:function(rules,messages,fails){var validateData=this.e("getOption","validate")||this.e("getOption","validation"),isValidate="object"==typeof validateData,r="object"==typeof rules?rules:isValidate&&"object"==typeof validateData.rules?validateData.rules:null,m="object"==typeof messages?messages:isValidate&&"object"==typeof validateData.messages?validateData.messages:{};if(!r)return!0;var validator=Validator.make(this.getValidateData(),r,m),f;validator.status||("function"==typeof fails?fails:"function"==typeof rules?rules:"function"==typeof messages?messages:isValidate&&"function"==typeof validateData.fails?validateData.fails:emptyFunc).call(this,validator);return validator.status},beforeSend:function(callback){return this.e("addEvent","beforeSend",callback),this}}),App.addQueryModule("form",(function(options){return new App.dom.Form(this.getElements(),options||{})})),App.form=App.prototype.form=function(selector,options){var s=selector||null,o=options||{};return new App.dom.Form(s,0)},App.files=App.prototype.files={data:{},readFileInput:function(input,callback){if(!(input&&input instanceof Element&&"file"==input.type))return null;var tagname=input.tagName.toLowerCase(),type=input.type.toLowerCase(),self=this,dataList=[],segments=[],files=input.files;if(window.File&&window.FileList&&window.FileReader&&files&&files.length)for(var l=files.length,base64=!1,binary=!1,i=0;i<l;i++)!function(file,index,coumt){let fileReader=new FileReader;fileReader.onload=function(f){let src=f.target.result;dataList.push(src),index==coumt&&(input.multiple||(dataList=dataList.length?dataList[0]:null),self.data[input.name]=dataList,callback&&isCallable(callback)&&callback(dataList))},fileReader.readAsDataURL(file)}(files[i],i,files.length-1);else self.data[input.name]=dataList,callback&&isCallable(callback)&&callback(dataList,segments);return dataList}};var listApi=["xhr","ajax","axios","fetch","dom","form","request"];listApi.map((function(fnc){App[fnc]&&(App.query[fnc]=App[fnc])})),App.ready=App.prototype.ready=App.run=App.prototype.run=App.task=App.prototype.task=function(task){if("function"==typeof task){var queryEngine=App.getSystemOption("queryEngine");if(documentReady()){var query=isString(queryEngine)&&"jquery"==queryEngine.toLowerCase()&&global.jQuery?global.jQuery:App.query;try{task(query)}catch(error){App.log(error)}}else window.Apptask=App.queue((function(resolve,reject){try{if(documentReady()){var query=isString(queryEngine)&&"jquery"==queryEngine.toLowerCase()&&global.jQuery?global.jQuery:App.query;return task(query),resolve("thành công")}}catch(error){return reject(error)}}),50).step(500).catch(rs=>App.log(rs))}};var getEl=App.getEl=App.prototype.getEl=function(obj,key,delimiter){if(void 0===obj)return null;if(void 0===key)return obj;var tpo=getType(obj),tpk=getType(key);if("array"==tpo){var k=NaN;if("number"==tpk?k=key:NaN!=parseInt(key)&&(k=parseInt(key)),!isNaN(k)&&void 0!==obj[k])return obj[k]}else if("object"==tpo||obj==App){if("number"==tpk){if(void 0!==obj[key])return obj[key]}else if("string"==tpk){if(void 0===delimiter)delimiter=".";else{var t=getType(delimiter);"string"!=t&&"number"!=t&&(delimiter=".")}for(var _keys=key.split(delimiter),d=obj,i=0;i<_keys.length;i++){var k;void 0!==d[k=_keys[i]]?d=d[k]:(d=null,i+=_keys.length)}}return d}return null};App.str=App.prototype.str={html_char_raw:["%","&","=","?","#","+",":","/"," ","\n","{","}"],html_char_enc:["%25","%26","%3D","%3F","%23","%2B","%3A","%2F","+","%0D%0A","%7B","%7D"],urlcode:{"%":"%25","&":"%26","=":"%3D","?":"%3F","#":"%23","+":"%2B",":":"%3A","/":"%2F"," ":"%20","\n":"%0D%0A","{":"%7B","}":"%7D"},unicode:{js:["\\u00e0","\\u00e1","\\u1ea1","\\u1ea3","\\u00e3","\\u00e2","\\u1ea7","\\u1ea5","\\u1ead","\\u1ea9","\\u1eab","\\u0103","\\u1eb1","\\u1eaf","\\u1eb7","\\u1eb3","\\u1eb5","\\u00e8","\\u00e9","\\u1eb9","\\u1ebb","\\u1ebd","\\u00ea","\\u1ec1","\\u1ebf","\\u1ec7","\\u1ec3","\\u1ec5","\\u00ec","\\u00ed","\\u1ecb","\\u1ec9","\\u0129","\\u00f2","\\u00f3","\\u1ecd","\\u1ecf","\\u00f5","\\u00f4","\\u1ed3","\\u1ed1","\\u1ed9","\\u1ed5","\\u1ed7","\\u01a1","\\u1edd","\\u1edb","\\u1ee3","\\u1edf","\\u1ee1","\\u00f9","\\u00fa","\\u1ee5","\\u1ee7","\\u0169","\\u01b0","\\u1eeb","\\u1ee9","\\u1ef1","\\u1eed","\\u1eef","\\u1ef3","\\u00fd","\\u1ef5","\\u1ef7","\\u1ef9","\\u0111","\\u00c0","\\u00c1","\\u1ea0","\\u1ea2","\\u00c3","\\u00c2","\\u1ea6","\\u1ea4","\\u1eac","\\u1ea8","\\u1eaa","\\u0102","\\u1eb0","\\u1eae","\\u1eb6","\\u1eb2","\\u1eb4","\\u00c8","\\u00c9","\\u1eb8","\\u1eba","\\u1ebc","\\u00ca","\\u1ec0","\\u1ebe","\\u1ec6","\\u1ec2","\\u1ec4","\\u00cc","\\u00cd","\\u1eca","\\u1ec8","\\u0128","\\u00d2","\\u00d3","\\u1ecc","\\u1ece","\\u00d5","\\u00d4","\\u1ed2","\\u1ed0","\\u1ed8","\\u1ed4","\\u1ed6","\\u01a0","\\u1edc","\\u1eda","\\u1ee2","\\u1ede","\\u1ee0","\\u00d9","\\u00da","\\u1ee4","\\u1ee6","\\u0168","\\u01af","\\u1eea","\\u1ee8","\\u1ef0","\\u1eec","\\u1eee","\\u1ef2","\\u00dd","\\u1ef4","\\u1ef6","\\u1ef8","\\u0110"],vi:["à","á","ạ","ả","ã","â","ầ","ấ","ậ","ẩ","ẫ","ă","ằ","ắ","ặ","ẳ","ẵ","è","é","ẹ","ẻ","ẽ","ê","ề","ế","ệ","ể","ễ","ì","í","ị","ỉ","ĩ","ò","ó","ọ","ỏ","õ","ô","ồ","ố","ộ","ổ","ỗ","ơ","ờ","ớ","ợ","ở","ỡ","ù","ú","ụ","ủ","ũ","ư","ừ","ứ","ự","ử","ữ","ỳ","ý","ỵ","ỷ","ỹ","đ","À","Á","Ạ","Ả","Ã","Â","Ầ","Ấ","Ậ","Ẩ","Ẫ","Ă","Ằ","Ắ","Ặ","Ẳ","Ẵ","È","É","Ẹ","Ẻ","Ẽ","Ê","Ề","Ế","Ệ","Ể","Ễ","Ì","Í","Ị","Ỉ","Ĩ","Ò","Ó","Ọ","Ỏ","Õ","Ô","Ồ","Ố","Ộ","Ổ","Ỗ","Ơ","Ờ","Ớ","Ợ","Ở","Ỡ","Ù","Ú","Ụ","Ủ","Ũ","Ư","Ừ","Ứ","Ự","Ử","Ữ","Ỳ","Ý","Ỵ","Ỷ","Ỹ","Đ"],en:["a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","e","e","e","e","e","e","e","e","e","e","e","i","i","i","i","i","o","o","o","o","o","o","o","o","o","o","o","o","o","o","o","o","o","u","u","u","u","u","u","u","u","u","u","u","y","y","y","y","y","d","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","E","E","E","E","E","E","E","E","E","E","E","I","I","I","I","I","O","O","O","O","O","O","O","O","O","O","O","O","O","O","O","O","O","U","U","U","U","U","U","U","U","U","U","U","Y","Y","Y","Y","Y","D"],upper:["À","Á","Ạ","Ả","Ã","Â","Ầ","Ấ","Ậ","Ẩ","Ẫ","Ă","Ằ","Ắ","Ặ","Ẳ","Ẵ","È","É","Ẹ","Ẻ","Ẽ","Ê","Ề","Ế","Ệ","Ể","Ễ","Ì","Í","Ị","Ỉ","Ĩ","Ò","Ó","Ọ","Ỏ","Õ","Ô","Ồ","Ố","Ộ","Ổ","Ỗ","Ơ","Ờ","Ớ","Ợ","Ở","Ỡ","Ù","Ú","Ụ","Ủ","Ũ","Ư","Ừ","Ứ","Ự","Ử","Ữ","Ỳ","Ý","Ỵ","Ỷ","Ỹ","Đ"],lower:["à","á","ạ","ả","ã","â","ầ","ấ","ậ","ẩ","ẫ","ă","ằ","ắ","ặ","ẳ","ẵ","è","é","ẹ","ẻ","ẽ","ê","ề","ế","ệ","ể","ễ","ì","í","ị","ỉ","ĩ","ò","ó","ọ","ỏ","õ","ô","ồ","ố","ộ","ổ","ỗ","ơ","ờ","ớ","ợ","ở","ỡ","ù","ú","ụ","ủ","ũ","ư","ừ","ứ","ự","ử","ữ","ỳ","ý","ỵ","ỷ","ỹ","đ"]},clearUnicode:function(str){return this.replace(str,this.unicode.vi,this.unicode.en)},isSN:function(str){if(void 0===str)return null;var t=App.getType(str);return"string"==t||"number"==t},replace:function(){var a=arguments,t=a.length;if(0==t)return"";if("string"!=typeof a[0]||t<2)return a[0];var str=a[0],b=App.getType(a[1]),obj;if(this.isSN(a[1]))t>=3&&this.isSN(a[2])&&((obj={})[a[1]]=a[2],str=this.replaceByObj(str,obj));else if("array"==b){if(t>=3&&"array"==App.getType(a[2]))str=this.replaceByArr(str,a[1],a[2]);else if(t>=3&&"string"==App.getType(a[2])){var obj={},val=a[2],d=a[1];for(var k in d)obj[d[k]]=val;str=this.replaceByObj(str,obj)}}else"object"==b&&(str=this.replaceByObj(str,a[1]));return str},replaceByArr:function(){var a=arguments,t=a.length;if(0==t)return"";if("string"!=typeof a[0]||t<2)return a[0];var str=a[0],b=App.getType(a[1]);if("object"==b)str=this.replaceByObj(str,a[1]);else if("array"==b){var obj={};if(t>=3){var f=App.getType(a[2]);if("string"==f)for(var k in a[1])obj[a[1][k]]=a[2];else if("array"==f)for(var e=a[1].length,g=a[2].length,max=e>g?e:g,i=0;i<max;i++)obj[a[1][i]]=a[2][i]}str=this.replaceByObj(str,obj)}return str},replaceByObj:function(){var a=arguments,t=a.length;if(0==t)return"";if("string"!=typeof a[0]||t<2)return a[0];var str=a[0],b=App.getType(a[1]);if("object"==b){var max=null;"number"==typeof a[2]&&(max=a[2]);var i=1,sts=a[1];for(var key in sts){var txt=sts[key];if(str=this.preg_replace(key,txt,str),max&&i>=max)break;i++}}return str},escapeRegExp:function(string){var str;return(""+string).replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},preg_replace:function(find,replace,string){var string;return(string=""+string).replace(new RegExp(this.escapeRegExp(find),"g"),replace)},rand:function(){for(var st,sp="ABCDEFGHIJKLMNOPQRSTUVWYZabcdefghijklmnopqrstuvwyz0123456789".split(""),l=sp.length-1,s="",i=0;i<32;i++)s+=sp[App.number.rand(0,l)];return s},camelToSlug:function(str,joinKey){var st,sp="ABCDEFGHIJKLMNOPQRSTUVWYZ".split(""),l=sp.length-1,s="",find=[],replace=[],k=isString(joinKey)?joinKey:"-";return sp.map((function(c){find.push(c),replace.push(k+c.toLowerCase())})),this.replace(str,find,replace)},urlencode:function(str){for(var t=this.html_char_raw.length,i=0;i<t;i++)str=this.replace(str,this.html_char_raw[i],this.html_char_enc[i]);return str},urldecode:function(str){for(var t,i=this.html_char_raw.length-1;i>=0;i--)str=this.replace(str,this.html_char_enc[i],this.html_char_raw[i]);return str},eval:function(template,data){var t=typeof data,tpl=template;if("object"==t||"array"==t)for(var k in data=this.convertTextObject({},data)){var val=data[k];null===val&&(val="");var f="{$"+k+"}";tpl=this.replace(tpl,f,val)}return tpl},convertTextObject:function(root,object,name,joinKey){for(const key in object)if(object.hasOwnProperty(key)){"string"!=typeof joinKey&&(joinKey=".");const val=object[key];var t=typeof val,k=void 0!==name&&(""+name).length?name+joinKey+key:key;null==val||"object"!=t&&"array"!=t?root[k]=val:root=this.convertTextObject(root,val,k,joinKey)}return root},upper:function(str){if(void 0===str)return null;if(isString(str)){var s=str.toUpperCase();return this.replace(s,this.unicode.lower,this.unicode.upper)}if(isObject(str)&&void 0!==str.length||isArray(str)){for(let i=0;i<str.length;i++)str[i]=this.upper(str[i]);return str}if(isObject(str)){for(const key in str)if(str.hasOwnProperty(key)){const st=str[key];str[key]=this.upper(st)}return str}},lower:function(str){if(void 0===str)return null;if(isString(str)){var s=str.toLowerCase();str=this.replace(s,this.unicode.upper,this.unicode.lower)}else if(isObject(str)&&void 0!==str.length||isArray(str))for(let i=0;i<str.length;i++)str[i]=this.upper(str[i]);else if(isObject(str))for(const key in str)if(str.hasOwnProperty(key)){const st=str[key];str[key]=this.upper(st)}return str},ucfirst:function(str){if(isString(str)){if(str.length){var first=str.substring(0,1);str=this.upper(first)+str.substring(1)}}else if(isObject(str)&&void 0!==str.length||isArray(str))for(let i=0;i<str.length;i++)str[i]=this.ucfirst(str[i]);else if(isObject(str))for(const key in str)str.hasOwnProperty(key)&&(str[key]=this.ucfirst(str[key]));return str},ucword:function(str){if(isString(str))str.length&&(str=str.split(" ").map((function(s){return App.str.ucfirst(s)})).join(" "));else if(isObject(str)&&void 0!==str.length||isArray(str))for(let i=0;i<str.length;i++)str[i]=this.ucword(str[i]);else if(isObject(str))for(const key in str)str.hasOwnProperty(key)&&(str[key]=this.ucword(str[key]));return str},htmlentities:function(str){return this.eval(str,{"<":"&lt;",">":"&gt;",'"':"&quote;","&":"&amp;"})},formSlug:function(str){return"string"!=typeof str?str:this.replace(this.replace(str,"[]",".*"),{"[":".","]":""})},slug:function(str,key){key||(key="-");var s=String(str),l="ABCDEFGHIJKLMNOPQRSTUVWYZabcdefghijklmnopqrstuvwyz0123456789",list=[],n=0,t=this.replace(this.replace(this.clearUnicode(this.lower(s)),"[]{}();:'\"\\|,./?~!@#$%^&*+=".split(""),"-"),"--","-");for(let i=0;i<t.length;i++){const st=t[i];-1==l.indexOf(st)?n>0&&l.indexOf(t[i-1])>=0&&n++:void 0===list[n]?list[n]=st:list[n]+=st}return list.join(key)}},App.number=App.prototype.number={rand:function(from,to){var rand;return from||(from=0),to||(to=0),0==from&&to++,Math.floor(Math.random()*to)+from},currency:function(x){return x.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1.")},format:function(num,decimals,decimal_separator,thousands_separator,currency,currencyPosition){decimals||(decimals=0);var _int=parseInt(num),_decmal="";if(decimals>0){var e=Math.pow(10,decimals),nt,t=parseInt(num*e)/e,r=t.toString().split(".");_int=parseInt(t);var d=(_decmal=2==r.length&&r[1].length>0?r[1]:"").length;for(let index=0;index<decimals-d;index++)_decmal+=" 0";_decmal=App.str.replace(_decmal," ","")}else{var n=num.toString().split(".");2==n.length&&n[1].length&&(_decmal=n[1])}decimal_separator||(decimal_separator="."),thousands_separator||(thousands_separator=",");var nums=_int.toString().split("").reverse(),nf=[];for(let index=0;index<nums.length;index++){const n=nums[index];index>0&&index%3==0&&nf.push(thousands_separator),nf.push(n)}var dt=nf.reverse().join("")+""+(_decmal.length?decimal_separator+""+_decmal:"");return currency?"left"==currencyPosition?currency+""+dt:dt+""+currency:dt}},App.date=App.prototype.date=function(format,offset){offset||(offset=0);var d=new Date,t={},dl=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],f;if(utc=d.getTime()+6e4*d.getTimezoneOffset(),d=new Date(utc+36e5*offset),t.ms=d.getMilliseconds(),t.Y=d.getFullYear(),t.y=d.getYear(),t.H=d.getHours(),t.i=d.getMinutes(),t.m=d.getMonth()+1,t.s=d.getSeconds(),t.time=d.getTime(),t.d=d.getDate(),t.D=dl[d.getDay()],!format)return t;if("string"==App.getType(format)){var txt=format;return txt=this.str.replace(txt,"ms",t.ms),txt=this.str.replace(txt,"time",t.time),txt=this.str.replace(txt,t)}return null},App.fn=App.prototype.fn=function(){this.timeout_status=!0,this.args_type="array",this.calling=null,this.system_list={},this.disableTimeout=function(){this.timeout_status=!1},this.enableTimeout=function(){this.timeout_status=!0,"list"==this.args_type&&(this.args_type="array")},this.setArgsType=function(){var a=arguments,t="array",tt=0;if(a.length>0&&(t=a[0]),"string"==typeof t){var t2=t.toLowerCase();"array"!=t2&&"0"!=t2&&(tt=1)}else tt=t?1:0;tt?(this.args_type="list",this.disableTimeout()):this.args_type="array"},this.getFuncPath=function(fn){if(!fn)return null;var t=App.getType(fn),f="";if("function"==t)f="fn";else if("string"==t){var a=App.str.replace(fn," ","");if(!a)return null;if("function"==App.getType(App.getEl(this,a)))f="_this."+a;else if("function"==App.getType(App.getEl(App,a)))f="App."+a;else{var func_paths=a.split(".");if(func_paths.length<2)"function"==typeof window[a]&&(f=a);else{var kk=func_paths[0];if("object"==typeof window[kk]||"App"==kk){for(var kz="",i=1;i<func_paths.length;i++){var dt="";i>1&&(dt="."),kz+=dt+func_paths[i],dt=""}"function"==App.getType(App.getEl(window[kk],kz))&&(f=a)}}}}return f},this.get=function(fn){var r=function(){console.log(arguments)};if(!fn)return r;var t=App.getType(fn),f="",_this=this;if("function"==t)f="fn";else if("string"==t){var fp=this.getFuncPath(fn);fp&&(f=fp)}return f&&eval("r = "+f+";"),r},this.check=function(fn){return"string"==typeof fn&&!!this.getFuncPath(fn)},this.add=function(func_name,fn,main){if("string"!=typeof func_name||"function"!=typeof fn)return!1;var s=!1;return this.system_list[func_name]||(this[func_name]=fn,s=!0),s},this.remove=function(fn){return"string"==typeof fn&&(this.system_list[fn]||"function"!=typeof this[fn]||(this[fn]=void 0,delete this[fn]),!0)},this.call=function(fn,args,time){if(!fn)return null;var t=App.getType(fn),f="",agm=arguments;if("function"==t)f="fn";else if("string"==t){var fp=this.getFuncPath(fn);fp&&(f=fp)}if(f){var _this=this,arg=[];if("array"==this.args_type)void 0!==args&&("array"==App.getType(args)?arg=args:arg[0]=args);else for(var n=0,i=1;i<agm.length;i++)arg[n]=agm[i],n++;var t=arg.length;f+="(";for(var i=0;i<t;i++)f+="arg["+i+"]",i<t-1&&(f+=",");f+=");";var r=null,o="r = "+f;if(this.timeout_status&&time&&"number"==App.getType(time)&&time>0)return this.calling=setTimeout((function(){return eval(o),r}),time),!0;try{eval(o)}catch(error){}return r}},this.parse=function(fn){var f=function(){};if(!fn)return f;var t=App.getType(fn);return"function"==t?f=fn:"string"==t&&this.check(fn)&&(f=this.get(fn)),f},this.goTo=function(url){window.open(url,"_blank")},this.openWindow=function(url,title,width,height,x,y){var swidth=screen.width,sheight=screen.height;width||(width=600),height||(height=300);var left=x||(swidth-width)/2,top=y||(sheight-height)/2-100;top<0&&(top=0),title||(title="Blank Page"),window.open(url,title,"targetWindow,toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width="+width+",height="+height+",top="+top+",left="+left)};var a=this,st={};for(var k in a)st[k]=k;this.system_list=st},App.func=App.prototype.func=new App.fn,App.videos=App.prototype.videos={getVideoUrlData:function(url){if(!url)return{};var data={},u1=url.match(/.*youtu\.be\/(.*?)($|\?|#)/i),u2=url.match(/youtube\.com\/watch\?.*v=(.*?)($|&|#)/i),u3=url.match(/\.*vimeo.com\/(.*?)($|\?)/i),u4=url.match(/.*facebook.com\/(.*?)\/videos\/(.*?)\//i),id;if(u1)data={id:id=u1[1],server:"youtube",thumbnail:"http://img.youtube.com/vi/"+id+"/hqdefault.jpg",embed_url:"http://www.youtube.com/embed/"+id+"?rel=0&wmode=opaque"};else if(u2){var id;data={id:id=u2[1],server:"youtube",thumbnail:"http://img.youtube.com/vi/"+id+"/hqdefault.jpg",embed_url:"http://www.youtube.com/embed/"+id+"?rel=0&wmode=opaque"}}else if(u3){var d=u3[1].split("/"),id;data={id:id=d[d.length-1],server:"vimeo",thumbnail:null,embed_url:"http://player.vimeo.com/video/"+id+"?rel=0&wmode=opaque"}}else if(u4){var page_id=u4[1],id;data={id:id=u4[2],server:"vimeo",thumbnail:"http://img.youtube.com/vi/"+id+"/hqdefault.jpg",embed_url:"https://www.facebook.com/v2.0/plugins/video.php?allowfullscreen=true&container_width=620&href=$ac%2F"+page_id+"%2Fvideos%2Fvb."+page_id+"%2F"+id+"%2F%3Ftype%3D3&locale=en_US&sdk=joey"}}return data}};for(const prop in App.prototype)if(App.prototype.hasOwnProperty(prop)){const opt=App.prototype[prop];App.oeiginModules.push(prop)}background.checkReady(),global.App=App,global.D=App.query}(window,document);