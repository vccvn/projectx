!function(_){var __delay=function(){App.setSystemOption({queryEngine:"jQuery"}),App.task((function($){var csrf=$('meta[name="csrf-token"]').attr("content");"jQuery"in window&&jQuery.ajaxSetup({headers:{"X-CSRF-TOKEN":csrf}});var prefixClass="."+(App.getSystemOption("cssClassPrefix")||"");App.extend({storage:{key:"__storage__object__list__",support:function(){return!0},getObjectList:function(){if(!this.support())return[];var val=localStorage.getItem(this.key);return val?JSON.parse(val):[]},addToObjectList:function(key){if(!this.support())return this;var objList=this.getObjectList();return-1===objList.indexOf(key)&&(objList.push(key),localStorage.setItem(this.key,JSON.stringify(objList))),this},removeInObjectList:function(key){if(!this.support())return this;var list=this.getObjectList(),ind=list.indexOf(key);return ind>-1&&(list.splice(ind,1),localStorage.setItem(this.key,JSON.stringify(list))),this},checkObjectList:function(key){var stt=!1,list;return this.getObjectList().indexOf(key)>=0},set:function(key,value){if(!this.support())return!1;if(App.isObject(Key)){for(const k in key)if(key.hasOwnProperty(k)){const v=key[k];this.set(k,v)}return this}return App.isObject(value)&&(value=JSON.stringify(value),this.addToObjectList(key)),localStorage.setItem(key,value),!0},get:function(key){if(!this.support())return null;var val=localStorage.getItem(key);return this.checkObjectList(key)&&(val=JSON.parse(val)),val},remove:function(key){return!!this.support()&&(this.removeInObjectList(key),localStorage.removeItem(key),!0)}}});var CrazySelect=function(selector,template){this.$el=$(selector),this.template=template,this.searchUrl="",this.addUrl="",this.advanceHandler="",this.addData={},this.addField="name",this.searchField="search",this.keywords="",this.hiddenKeywords="",this.type="static",this.oldValue="",this.hasDefault=!1,this.activeValue="",this.activeText="",this.$menu=this.$el.find(".select-option-menu"),this.$message=this.$menu.find(".message"),this.$buttons=this.$menu.find(".buttons"),this.$options=this.$menu.find(".option-list"),this.$text=this.$el.find(".show-text-value"),this.$select=this.$el.find(".btn-dropdown-select"),this.$input=$("#"+this.$el.data("id")),this.$searchBlock=this.$el.find(".search-block"),this.$searchInput=this.$el.find("input"),this.searchParamSelectors=this.$el.data("search-params")||"",this.confirmChange=!1;var self=this;this.init=function(){var $el=this.$el;let selectType=$el.data("select-type")||"static";this.type=selectType;let cc=$el.data("confirm-change")||"";if(cc&&"false"!=cc&&(this.confirmChange=!0),"static"==selectType){let itemCount=$el.find(".option-item").length,disableSearch=$el.data("disable-search")||null;disableSearch&&"false"!=disableSearch?this.$searchBlock.hide():itemCount>10?this.$searchBlock.show():this.$searchBlock.hide()}else"search"==selectType?($el.data("search-field")&&(this.searchField=$el.data("search-field")),$el.data("search-url")&&(this.searchUrl=$el.data("search-url"))):"dynamic"==selectType&&($el.data("search-field")&&(this.searchField=$el.data("search-field")),$el.data("search-url")&&(this.searchUrl=$el.data("search-url")),this.advanceHandler=$el.data("advance-click")||cl);this.parseMultiLevelText(),$el.children(".select-option-menu").on("keyup mouseup",(function(e){var el=e.target,tag;if("input"==el.tagName.toLowerCase()&&"search_options"==el.getAttribute("data-name")){let keywords=el.value;var text=el.value.toLocaleLowerCase();if(text==self.keywords.toLocaleLowerCase())return;self.keywords=keywords,"static"==selectType?self.staticSearch(text):"search"!=selectType&&"dynamic"!=selectType||self.ajaxSearch(text)}})),$(window).on("scroll",(function(e){self.checkPosRef()})),$(document).on("click",(function(e){var $e=$(e.target);if($e.closest(self.$el).length)if($e.is(self.$select)||$e.closest(self.$select).length)self.toggle();else if($e.is(".search-block")||$e.closest(".search-block").length);else{let $item=[];if($elm=$e.closest(".select-option-item"),$e.hasClass("select-option-item")?$item=$e:$elm.length&&($item=$elm),$item.length){var value=$item.data("value");let isl=self.$input,old=isl.val();if(value!=old){const changeValue=function(){var text=$item.data("text");let datadisable=self.$el.data("disable")||null;datadisable&&"false"!=datadisable||(self.$text.html(text),self.$text.val(value),isl.val(value),$el.find(".select-option-menu").find(".option-item").removeClass("active"),$item.addClass("active"),self.parseMultiLevelText());var onc=$el.data("changed-callback")||$el.data("on-change");if(onc){let oncbs=onc.split(",");oncbs.length>1?oncbs.forEach(element=>{let func=element.trim();App.func.check(func)&&App.func.call(func,[value,text,e.target])}):App.func.check(onc)&&App.func.call(onc,[value,text,e.target])}};if(self.confirmChange){let message=self.$el.data("confirm-message")||"Thay đổi giá trị trường này có thể gây sáo trộn hoặc mất dữ liệu một số trường khác.>br>Bạn có muốn thực hiện thay đổi?";App.popup.confirm(message,(function(agree){agree&&(changeValue(),self.hide())}))}else changeValue(),self.hide()}else self.hide()}}else self.hide()}))},this.show=function(){return this.$el.hasClass("show")||this.$el.addClass("show"),this.checkPosRef(),this},this.hide=function(){return this.$el.removeClass("show"),this},this.toggle=function(){return this.$el.hasClass("show")?this.$el.removeClass("show"):this.show(),this},this.checkPosRef=function(){var top=$(document).scrollTop(),osTop=self.$el.offset().top,e,b=self.$el[0].getBoundingClientRect(),winHeight=window.innerHeight,outScreen=top+winHeight,optHeight=self.$el.find(".select-option-menu").height();b.y+b.height+optHeight>=winHeight?self.$el.hasClass("dis-above")||self.$el.addClass("dis-above"):self.$el.removeClass("dis-above")},this.staticSearch=function(keyword){var cc=0,$options=self.$el.children(".select-option-menu"),k=App.str.clearUnicode(keyword),kws=(keyword=k.toLocaleLowerCase()).split(","),keywords=[];kws.map((function(kw,ind){let k=kw.trim();""!==k&&" "!==k&&keywords.push(k)}));var findText=function(text,find){var t=App.str.clearUnicode(String(text)).toLowerCase(),rs=t.split(find).length>1;return console.log("tim",find,"trong",t),console.log("kq",rs),rs};$options.find(".option-list .option-item").removeClass("found").removeClass("hidden-item"),$options.find(".option-list>.option-item").each((function(ind,elem){if(keywords.length){let isSearch=!1;keywords.forEach(text=>{isSearch||(findText($(elem).data("text"),text)||findText($(elem).html(),text)||findText($(elem).data("value"),text)?($(elem).show(),$(elem).addClass("found"),cc++,isSearch=!0):$(elem).hide())}),isSearch||$(elem).addClass("hidden-item")}else findText($(elem).data("text"),keyword)||findText($(elem).html(),keyword)||findText($(elem).data("value"),keyword)?($(elem).show(),$(elem).addClass("found"),cc++):($(elem).hide(),$(elem).addClass("hidden-item"))}));var checkGroup=function(group,callback){var s=!1,dropdownHeader=$(group).children(".select-option-header");if(dropdownHeader.length)if(keywords.length){let isSearch=!1;keywords.forEach(text=>{isSearch||(findText($(dropdownHeader[0]).data("text"),text)||findText($(dropdownHeader[0]).html(),text)||findText($(dropdownHeader[0]).data("value"),text))&&($(group).find(".option-group").show(),$(group).find(".option-item").show(),$(group).find(".option-item").addClass("found"),isSearch=!0,s=!0)})}else(findText($(dropdownHeader[0]).data("text"),keyword)||findText($(dropdownHeader[0]).html(),keyword)||findText($(dropdownHeader[0]).data("value"),keyword))&&(s=!0,$(group).find(".option-group").show(),$(group).find(".option-item").show(),$(group).find(".option-item").addClass("found"));return s||$(group).children().each((function(ind,elm){if($(elm).hasClass("option-item"))if(keywords.length){let isSearch=!1;keywords.forEach(text=>{isSearch||(findText($(elem).data("text"),text)||findText($(elem).html(),text)||findText($(elem).data("value"),text))&&($(elm).show(),$(elm).addClass("found"),isSearch=!0,s=!0)}),isSearch||($(elm).hide(),$(elm).addClass("hidden-item"))}else findText($(elem).data("text"),keyword)||findText($(elem).html(),keyword)||findText($(elem).data("value"),keyword)?(s=!0,$(elm).show(),$(elm).addClass("found")):($(elm).hide(),$(elm).addClass("hidden-item"));else if($(elm).hasClass("option-group")){var a=callback(elm,callback);a&&(s=a)}})),s?($(group).show(),dropdownHeader.show(),dropdownHeader.hasClass("option-item")&&dropdownHeader.addClass("found")):($(group).hide(),dropdownHeader.hide(),dropdownHeader.hasClass("option-item")&&dropdownHeader.addClass("hidden-item")),s};$options.find(".option-list>.option-group").each((function(index,elem){checkGroup(elem,checkGroup)&&cc++})),cc?$options.find(".message").hide():self.hideLoader("Không có kết quả")},this.ajaxSearch=function(keyword,callback){var data={};data[this.searchField]=keyword;var $el=self.$el;self.searchParamSelectors&&$(self.searchParamSelectors).length&&$(self.searchParamSelectors).each((function(i,ele){let $e=$(ele);$e.attr("name")&&(data[$e.attr("name")]=$e.val())})),self.showLoader("Đang tìm kiếm..."),self.$options.hide(),self.$buttons.hide(),App.ajax(this.searchUrl,{type:"GET",dataType:"json",data:data,cookie:!0}).then((function(rs){rs.status&&rs.data?(self.hideLoader(),self.$options.html(self.getSelectOptions(rs.data)),self.$options.children().length&&(self.$message.hide(),self.$options.show()),!self.has(keyword)&&keyword.length&&"dynamic"==self.type&&self.$buttons.show(),"function"==typeof callback&&callback()):(self.hideLoader("Không có kết quả"),self.$options.hide(),"dynamic"==self.type&&self.$buttons.show())})).catch((function(e){self.hideLoader("Lỗi không xác định!"),self.$options.hide()}))},this.has=function(keyword){keyword+="";var cc=0,$options=self.$el.children(".select-option-menu"),kws=(keyword=App.str.clearUnicode(keyword).toLowerCase()).split(","),keywords=[];kws.map((function(kw,ind){let k=kw.trim();""!==k&&" "!==k&&keywords.push(k)})),$options.find(".option-list>.option-item").each((function(ind,elem){if(keywords.length){let isSearch=!1;keywords.forEach(text=>{isSearch||App.str.clearUnicode($(elem).data("text")+"").toLowerCase()==text&&(cc++,isSearch=!0)})}else App.str.clearUnicode($(elem).data("text")+"").toLowerCase()==keyword&&cc++}));var checkGroup=function(group,callback){var s=!1,$selectHeader=$(group).children(".select-option-header");if($selectHeader.length)if(keywords.length){let isSearch=!1;keywords.forEach(text=>{isSearch||App.str.clearUnicode($($selectHeader[0]).data("text")+"").toLowerCase()==text&&(isSearch=!0,s=!0)})}else App.str.clearUnicode($($selectHeader[0]).data("text")+"").toLowerCase()==keyword&&(s=!0);return s||$(group).children().each((function(ind,elm){if($(elm).hasClass("option-item"))if(keywords.length){let isSearch=!1;keywords.forEach(text=>{isSearch||App.str.clearUnicode($(elm).data("text")+"").toLowerCase()==text&&(isSearch=!0,s=!0)})}else App.str.clearUnicode($(elm).data("text")+"").toLowerCase()==keyword&&(s=!0);else if($(elm).hasClass("option-group")){var a=callback(elm,callback);a&&(s=a)}})),s};return $options.find(".option-list>.option-group").each((function(index,elem){checkGroup(elem,checkGroup)&&cc++})),cc},this.active=function(value){var cc=0,$options=self.$el.children(".select-option-menu");if(value=App.str.clearUnicode(""+value).toLowerCase(),$options.find(".option-list>.option-item").each((function(ind,elem){App.str.clearUnicode($(elem).data("value")+"").toLowerCase()==value&&(self.deactive(),self.changeText($(elem).data("text")),self.changeValue($(elem).data("value")),$(elem).addClass("active"),cc++)})),cc&&this.parseMultiLevelText(),cc)return!0;var checkGroup=function(group,callback){var s=!1;return $(group).children().each((function(ind,elm){if($(elm).hasClass("option-item"))App.str.clearUnicode($(elm).data("value")+"").toLowerCase()==value&&(self.deactive(),self.changeText($(elm).data("text")),self.changeValue($(elm).data("value")),$(elm).addClass("active"),s=!0);else if($(elm).hasClass("option-group")){var a=callback(elm,callback);a&&(s=a)}})),s};return $options.find(".option-list>.option-group").each((function(index,elem){checkGroup(elem,checkGroup)&&cc++})),cc&&this.parseMultiLevelText(),cc},this.disableSearch=function(){this.$searchBlock.hide()},this.enableSearch=function(){this.$searchBlock.show()},this.showLoader=function(message){self.$message.addClass("m-loader m-loader--success m-loader--right").show(),message&&self.$message.html(message)},this.hideLoader=function(message){self.$message.removeClass("m-loader m-loader--success m-loader--right").hide(),message&&(self.$message.html(message),self.$message.show())},this.getSelectOptions=function(options,defaultVal,html,level,template){var otype=App.getType(options);if("object"!=otype&&"array"!=otype)return"";html||(html="");var group_header=self.getOptionLabelType();template||(template='<a href="javascript:void(0);" data-value="{$value}" data-text="{$hetext}" class="select-option-item option-item {$class} {$active}">{$text}</a>');var df=defaultVal||null;for(const key in options){let val=options[key],t=App.getType(val);if(["object","array"].indexOf(t)>=0){let opt=val,lbl=key;if("object"==t&&(val.hasOwnProperty("label")||val.hasOwnProperty("text"))&&(val.hasOwnProperty("data")||val.hasOwnProperty("list"))){lbl=val.hasOwnProperty("label")?val.label:val.text;let isset=!1;val.hasOwnProperty("data")&&["array","object"].indexOf(App.getType(val.data))&&(opt=val.data,isset=!0),!isset&&val.hasOwnProperty("list")&&["array","object"].indexOf(App.getType(val.list))&&(opt=val.data,isset=!0)}html+='<div class="option-group">',key==df&&(self.changeText(lbl),self.hasDefault=!0,self.activeText=lbl,self.activeValue=key),html+="value"!=group_header?'<h6 class="select-option-header">'+lbl+"</h6>":App.str.eval(template,{value:key,text:App.str.htmlentities(lbl),hetext:App.str.htmlentities(lbl),active:df==key?"active":"",class:"select-option-header option-header"}),html=self.getSelectOptions(opt,df,html,level+1,template),html+="</div>"}else key==df&&(self.changeText(val),self.hasDefault=!0,self.activeText=val,self.activeValue=key),html+=App.str.eval(template,{value:key,text:App.str.htmlentities(val),hetext:App.str.htmlentities(val),active:df==key?"active":"",class:""})}return html},this.getOptionLabelType=function(){var group_label="header",type=self.$el.data("label-type")||null;return type&&["header","value","label"].indexOf(type)>-1&&(group_label=type),group_label},this.parseMultiLevelText=function(){var $options=self.$el.children(".select-option-menu"),maxLevel=-1,data={},items=$options.find(".option-list>.option-item.active");if(items.length)data[0]=$(items[0]).html(),maxLevel=0;else{var checkGroup=function(group,callback,level){var s=!1,$selectHeader=$(group).children(".select-option-header");return $selectHeader.length&&$($selectHeader[0]).hasClass("active")&&(data[level]=$($selectHeader[0]).html(),level>maxLevel&&(maxLevel=level),s=!0),s||$(group).children().each((function(ind,elm){if($(elm).hasClass("option-item"))$(elm).hasClass("active")&&(data[level+1]=$(elm).html(),s=!0,level+1>maxLevel&&(maxLevel=level+1));else if($(elm).hasClass("option-group")){var a=callback(elm,callback,level+1);a&&(s=a)}})),s&&(data[level]=$selectHeader.html(),level>maxLevel&&(maxLevel=level)),s};$options.find(".option-list>.option-group").each((function(index,elem){var $header=$(elem).children(".select-option-header");checkGroup(elem,checkGroup,0)&&(data[0]=$header.html())}))}var dataText=[];if(maxLevel>=0){for(let i=0;i<=maxLevel;i++)dataText[i]=data[i];self.changeText(dataText.join(" / "))}},this.changeText=function(text){text&&(this.$text.html(text),this.$text.val(text))},this.changeValue=function(value){var val=void 0!==value?value:"";this.$input.val(val)},this.changeOptions=function(options){self.changeText("Chọn một");let currentValue=self.$input.val();self.hasDefault=!1,self.activeValue="",self.activeText="Chọn một",self.oldValue=self.$input.val(),self.$input.val(""),self.$options.html(self.getSelectOptions(options,self.oldValue)),self.hasDefault&&(self.$input.val(self.activeValue),self.changeText(self.activeText)),self.hasDefault=!1,self.showSearchBlock(),this.parseMultiLevelText()},this.addOption=function(value,text){var type=App.getType(value),options={};"object"==type||"array"==type?(this.deactive(),self.$options.append(self.getSelectOptions(value,self.oldValue))):(options[value]=text,this.deactive(),self.$options.append(self.getSelectOptions(options,value)),self.changeValue(value),self.changeText(text)),self.$options.show(),self.$buttons.hide(),self.$message.hide()},this.deactive=function(){this.$el.find(".select-option-menu").find(".option-item").removeClass("active")},this.showSearchBlock=function(){if("static"==self.type){let itemCount=self.$el.find(".option-item").length;itemCount>10?self.$el.find(".search-block").show():self.$el.find(".search-block").hide()}},this.resetDefault=function(){let activeItem=this.$options.find(".option-item.active");if(cl(activeItem),activeItem.length&&!activeItem.hasClass("hidden-item"))return this.changeValue(activeItem.data("value")),this.changeText(activeItem.data("text")),!0;let foundItem=this.$options.find(".option-item");foundItem.removeClass("active");let status=!1;if(foundItem.length)for(let index=0;index<foundItem.length;index++){const element=foundItem[index];if(!$(element).hasClass("hidden-item")){this.changeValue($(element).data("value")),this.changeText($(element).data("text")),status=!0;break}}status||(this.changeValue(""),this.changeText("-- Chọn một --"))},this.val=function(){return self.$input.val()}};App.dom.select={list:{},add:function(selector){var $el=$(selector);if($el.length){let $select=new CrazySelect($el[0]);$select.init(),this.list[$el.data("id")]=$select}},getTag:function(id){return id&&void 0!==this.list[id]?this.list[id]:null},changeOptions:function(id,options){void 0!==this.list[id]&&this.list[id].changeOptions(options)},addOption:function(id,value,text){void 0!==this.list[id]&&this.list[id].addOption(value,text)},ajaxSearch:function(id,keywords,callback){void 0!==this.list[id]&&this.list[id].ajaxSearch(keywords,callback)},staticSearch:function(id,keywords){void 0!==this.list[id]&&this.list[id].staticSearch(keywords)},deactive:function(id){void 0!==this.list[id]&&this.list[id].deactive()},active:function(id,value){void 0!==this.list[id]&&this.list[id].active(value)},getValue:function(id,defaultValue){var val=defaultValue||null;return void 0!==this.list[id]&&(val=this.list[id].val()),val}};var $cs=$(".crazy-select");if($cs.length&&$cs.each((function(i,el){App.dom.select.add(el)})),App.extend({popup:{alert:function(message,showCallback,hideCallback){Swal.fire({title:"Thông báo",html:message,icon:"info",type:"info",width:500,animation:!1,customClass:{popup:"animated tada"}})},warning:function(message,showCallback,hideCallback){Swal.fire({icon:"warning",type:"warning",title:"Cảnh báo",width:500,html:message,animation:!1,customClass:{popup:"animated tada"}})},error:function(message,showCallback,hideCallback){Swal.fire({icon:"error",title:"Ối! Lỗi rồi!...",html:message,animation:!1,width:500,customClass:{popup:"animated tada"}})},success:function(message,showCallback,hideCallback){Swal.fire({icon:"success",title:"Thành công!",html:message,animation:!1,width:500,customClass:{popup:"animated tada"}})},show:function(message,options){Swal.fire({title:message,width:500,animation:!1,customClass:{popup:"animated tada"}})},confirm:function(question,callback){Swal.fire({title:"Xác nhận",text:question,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Không",confirmButtonText:"Có",animation:!1,customClass:{popup:"animated tada"},width:500}).then(result=>{result.value&&"function"==typeof callback&&callback()})}},Swal:{alert:function(message,callback,hideCallback){Swal.fire({title:"Thông báo",html:message,type:"info",onBeforeOpen:function onBeforeOpen(){"function"==typeof callback&&callback()},onClose:function onClose(){"function"==typeof hideCallback&&hideCallback()}})},info:function(message,callback,hideCallback){Swal.fire({title:"Thông tin",html:message,type:"info",onBeforeOpen:function onBeforeOpen(){"function"==typeof callback&&callback()},onClose:function onClose(){"function"==typeof hideCallback&&hideCallback()}})},success:function(message,callback,hideCallback){Swal.fire({title:"Thành công!",html:message,type:"success",onBeforeOpen:function onBeforeOpen(){"function"==typeof callback&&callback()},onClose:function onClose(){"function"==typeof hideCallback&&hideCallback()}})},warning:function(message,callback,hideCallback){Swal.fire({title:"Cảnh báo!",html:message,type:"warning",onBeforeOpen:function onBeforeOpen(){"function"==typeof callback&&callback()},onClose:function onClose(){"function"==typeof hideCallback&&hideCallback()}})},error:function(message,callback,hideCallback){Swal.fire({title:"Lỗi rồi!",html:message,type:"error",onBeforeOpen:function onBeforeOpen(){"function"==typeof callback&&callback()},onClose:function onClose(){"function"==typeof hideCallback&&hideCallback()}})},errorDetail:function(title,detail,callback,hideCallback){var message="",tyoe;return"string"==App.getType(detail)?message=App.str.replace(detail,["[nl]","\r\n","\n"],"<br />"):"array"==type?message=detail.map((function(m){return App.str.replace(m,["[nl]","\r\n","\n"],"<br />")})).join("<br />"):"object"==type&&(message=Object.keys(detail).map((function(m){return App.str.replace(detail[m],["[nl]","\r\n","\n"],"<br />")})).join("<br />")),Swal.fire({title:title,html:message,type:"error",onBeforeOpen:function onBeforeOpen(){"function"==typeof callback&&callback()},onClose:function onClose(){"function"==typeof hideCallback&&hideCallback()}})},confirm:function(message,yes,no,callback,hideCallback){Swal.fire({title:"Xác nhận",html:message,type:"question",showCancelButton:!0,confirmButtonColor:"#0000FF",cancelButtonColor:"#d33",confirmButtonText:"Đồng ý",cancelButtonText:"Không",onBeforeOpen:function onBeforeOpen(){"function"==typeof callback&&callback()},onClose:function onClose(){"function"==typeof hideCallback&&hideCallback()}}).then((function(result){result.value?"function"==typeof yes&&yes():"function"==typeof no&&no()}))},timer:function(timer,message,title,type,button,position){timer||(timer=1500),type||(type="success");var option={type:type,timer:timer};void 0!==button&&(!1===button?option.showConfirmButton=!1:App.isString(button)&&(option.confirmButtonText=button)),position&&(option.position=position),message&&(title?(option.title=message,option.html=title):option.title=message),Swal.fire(option)},showLoading:function(timer,title,message){let timerInterval;timer&&!isNaN(timer)||App.isObject(timer);var getDots=function(t){var dots=".";for(let i=0;i<t;i++)dots+=".";return dots},n=0;Swal.fire({title:"Đang xử lý",html:"Vui lòng chờ trong giây lát...",timer:timer,timerProgressBar:!0,onBeforeOpen:()=>{Swal.showLoading(),timerInterval=setInterval(()=>{},100)},onClose:()=>{clearInterval(timerInterval)}}).then(result=>{result.dismiss,Swal.DismissReason.timer})},hideLoading:function(timer){timer&&App.isNumber(timer)?setTimeout((function(){Swal.close()}),timer):Swal.close()}}}),App.extend({comments:{urls:{},init_list:["urls"],form:null,send:function(form){var self=this;try{let $form=$(form),data={},errors=[];this.form=$form,$form.find("textarea, input, select").each((function(index,el){let $inp=$(el),name=$inp.attr("name");if("_token"!=name){let value=$inp.val();data[name]=value}}));let url=$form.data("ajax-url"),btn=$form.find(".post-comment"),btnClass=btn.data("class")||"btn-primary",btnDisableClass=btn.data("disable-class")||"btn-default",BtnHtml=btn.html(),sendingText=btn.data("sending-text")||"Đang gửi liên hệ...";btn.length&&(btn.prop("disable",!0),btn.html(sendingText),btn.removeClass(btnClass).addClass(btnDisableClass)),App.ajax(url,{method:"post",data:data,cookie:!0}).then((function(res){if(App.isString(res)&&(res=JSON.parse(res)),res.status)self.alert("Bạn đã gửi bình luận thành công! <br />Chúng tôi sẽ phản hồi trong thời gian sớm nhất!","success"),$(form).find(".inp").each((function(ind,el){let $inp;$(el).val("")})),$(form).find(".cancel-reply").hide(300,(function(){$("input#comment-reply-id").val(0),$(this).parent().parent().removeClass("reply-mode"),$(this).parent().remove()}));else{var message="";if(res.errors){var messages=[];for(const key in res.errors)if(res.errors.hasOwnProperty(key)){const error=res.errors[key];messages.push(error)}message=messages.join("<br>")}else message=res.message;self.alert(message)}btn.length&&(btn.prop("disable",!1),btn.html(BtnHtml),btn.removeClass(btnDisableClass).addClass(btnClass))})).catch((function(e){let msg=e.responseText;self.alert(msg,200==e.status?"success":"danger"),btn.length&&(btn.prop("disable",!1),btn.html(BtnHtml),btn.removeClass(btnDisableClass).addClass(btnClass))}))}catch(e){self.alert("Đã có lỗi bất ngờ xảy ra. vui lòng thử lại trong giây lát")}},alert:function(message,type){var self=this;type||(type="danger"),self.form.find("#contact-alert-"+type).length&&self.form.find("#contact-alert-"+type).remove();let alertTag='<div id="contact-alert-'+type+'" class="alert alert-'+type+' mt-4" role="'+type+'">'+message+"</div>";self.form.append(alertTag),self.form.find("#contact-alert-"+type).show(400),setTimeout((function(){self.form.find("#contact-alert-"+type).hide(400,(function(){$(this).remove()}))}),1e4)}}}),$((function(){var $commentForm=$(prefixClass+"comment-form");$(prefixClass+"comment-form").submit((function(e){return e.preventDefault(),App.comments.send(this),!1})),$(document).on("click",".btn-reply-comment, "+prefixClass+"btn-reply-comment",(function(){let replyID=$(this).data("id"),user=$(this).data("reply-for");if(replyID&&($("input#comment-reply-id").val(replyID),user)){let txtField=$(".comment-message-content");if(txtField.length){let wrapper=txtField.parent();wrapper.addClass("reply-mode"),wrapper.find(".reply-item").remove(),wrapper.prepend('<div class="reply-item">Trả lời '+user+' <a href="javascripy:void(0);" class="cancel-reply" data-id="'+replyID+'">x</a></div>'),$commentForm.length&&$commentForm[0].scrollIntoView(!1)}}})),$(document).on("click",".cancel-reply",(function(){$("input#comment-reply-id").val(0),$(this).parent().parent().removeClass("reply-mode"),$(this).parent().remove()}))})),App.extend({products:{decimal:0,urls:{},templates:{item:"<p>{$name} - {{$price}}</p>"},init_list:["urls","templates","decimal"],checkPrice:function(data){App.ajax(this.urls.check_price,{method:"post",data:data,dataType:"json"}).then((function(res){if(res.status){var d=res.data;$(prefixClass+"product-detail-info-"+d.product.id).find(prefixClass+"product-price").html(App.cart.currency(d.price))}}))},checkPriceOfForm:function(form){var data={product_id:$(form).find(prefixClass+"product-order-id").val(),attrs:[],quantity:$(form).find(prefixClass+"product-order-quantity").val()||1},inputs=$(form).find(prefixClass+"product-variants").find('select, input[type="radio"]:checked, input[type="rcheckbox"]:checked');for(let i=0;i<inputs.length;i++){const inp=inputs[i];data.attrs.push($(inp).val())}this.checkPrice(data)},getData:function(id,callback){var ajax=App.ajax(this.urls.get_data,{method:"GET",data:{id:id},dataType:"json"});return App.isCallable(callback)&&ajax.then(callback),ajax},currency:function(total){var c=App.config.currency;return App.number.format(total,c.decimal,c.decimal_poiter,c.thousands_sep,c.currency_type,c.currency_position)},review:function(form){var serialized=$(form).serializeArray(),data={},$form=$(form);serialized.map((function(inp){if("_token"==inp.name)return null;void 0!==data[inp.name]?"array"==App.getType(data[inp.name])?data[inp.name].push(inp.value):data[inp.name]=[data[inp.name],inp.value]:data[inp.name]=inp.value})),data.rating&&"0"!=data.rating&&data.name&&data.email?App.ajax(this.urls.review,{method:"post",data:data,dataType:"JSON"}).then((function(res){if(res.status)App.popup.alert(res.message),$form.find("input,textarea").map((function(inp){["comment","name","email"].indexOf(inp.name)>=0&&$(inp).val("")}));else{var errMessage="";if(res.errors)for(const key in res.errors)if(res.errors.hasOwnProperty(key)){const error=res.errors[key];errMessage=error;break}App.popup.error(errMessage||"Kiểm tra lại thông tin")}})).catch((function(e){App.popup.error("Lỗi không xác định")})):App.popup.warning("Vui lòng xếp hạn sản phẩm, điều đầy dủ họ tên và email!")}},orderFormSelector:null}),"function"==typeof window.productAppInit||"function"==typeof window.customProductAppInit){"function"==typeof window.productAppInit&&window.productAppInit(),"function"==typeof window.customProductAppInit&&window.customProductAppInit();var detailClass,frmSelector=(detailClass=prefixClass+"product-detail")+" "+prefixClass+"product-order-form";App.products.orderFormSelector=frmSelector,$(document).on("change",frmSelector,(function(e){App.products.checkPriceOfForm(this)}));var productOrderForms=$(frmSelector);if(productOrderForms.length)for(let i=0;i<productOrderForms.length;i++){const form=productOrderForms[i];App.products.checkPriceOfForm(form)}$(prefixClass+"product-review-form").submit((function(e){return e.preventDefault(),App.products.review(this),!1}))}var APIMethods={urls:{},init_list:["urls"],url:function(action){return void 0!==this.urls[action]?this.urls[action]:null},callApi:function(method,url,data,headers){headers||(headers={});var apiUrl=this.url(url)||url;return App.axios(apiUrl,{method:method,data:data,dataType:"JSON",cookie:!0,headers:headers}).then((function(response){var res=response.data;if("OK"==response.statusText&&res)return res;throw new Error("Lỗi không xác định")}))},upload:function(url,data,options){return App.axiosUpload(url,data,options).then((function(response){var res=response.data;if("OK"==response.statusText&&res)return res;throw new Error("Lỗi không xác định")}))}},contactForm;if(["get","post","put","patch","delete","head","options"].map((function(method){var mt=method.toUpperCase();APIMethods[method]=function(url,data,headers){return this.callApi(mt,url,data,headers)}})),App.extend({api:APIMethods}),"function"!=typeof window.apiInit&&"function"!=typeof window.custoAapiInit||"function"==typeof window.apiInit&&window.apiInit(),App.extend({auth:{urls:{},templates:{link:"<li><a href='{$link}'>{$text}</a></li>",account_section:"{$name}"},init_list:["urls","templates"],check:function(callback){var self=this;App.ajax(this.urls.check,{method:"post",data:{a:1},dataType:"json"}).then((function(res){var d=res.data;if(res.status&&$(prefixClass+"account-section").html(App.str.eval(self.templates.account_section||"{$name}",d)),d.links&&d.links.length){var links=d.links,$links=$(prefixClass+"account-links");$links.html("");for(const key in links)if(links.hasOwnProperty(key)){const item=links[key];$links.append(App.str.eval(self.templates.link||"<li><a href='{$link}'>{$text}</a></li>",item))}}var a="function"==typeof callback?callback(res):null}))}}}),"function"!=typeof window.authInit&&"function"!=typeof window.customauthInit||"function"==typeof window.authInit&&window.authInit(),App.extend({location:{urls:{},init_list:["urls"],regionID:0,districtID:0,changeRegionID:function(value,text,el){value!=this.regionID&&(this.regionID=value,App.dom.select.deactive("district_id"),App.dom.select.deactive("ward_id"),App.dom.select.changeOptions("district_id",{0:"Chọn một"}),App.dom.select.changeOptions("ward_id",{0:"Chọn một"}),value&&"0"!=value&&App.ajax(this.urls.district_options,{method:"get",data:{region_id:value},dataType:"JSON"}).then((function(res){res.status&&App.dom.select.changeOptions("district_id",res.data)})))},changeDistrictID:function(value,text,el){value!=this.districtID&&(this.districtID=value,App.dom.select.deactive("ward_id"),App.dom.select.changeOptions("ward_id",{0:"Chọn một"}),value&&"0"!=value&&App.ajax(this.urls.ward_options,{method:"get",data:{district_id:value},dataType:"JSON"}).then((function(res){res.status&&App.dom.select.changeOptions("ward_id",res.data)})))}}}),"function"==typeof window.locationInit&&"function"==typeof window.locationInit&&window.locationInit(),App.extend({contact:{urls:{},init_list:["urls"],send:function(form,success,error){var self=this,formData=$(form).serialize(),url=this.urls.send_contact_url||$(form).attr("data-ajax-url")||$(form).attr("action"),successCallback="function"==typeof success?success:function(res){if(res.status){App.popup.success("Bạn đã gữi liên hệ thành công!</br>Chúng tôi sẽ phản hồi trong thời gian sớm nhất");var inps=$(form).find(".inp");if(inps.length)for(let i=0;i<inps.length;i++){const inp=inps[i];$(inp).val("")}}else App.popup.warning("Vui lòng điền đầy đủ thông tin!")},errorCallback="function"==typeof error?error:function(e){App.popup.error(e.responseText)};App.ajax(url,{method:"post",data:formData,dataType:"json"}).then(successCallback).catch(errorCallback)}}}),"function"!=typeof window.contactInit&&"function"!=typeof window.customcontactInit||"function"==typeof window.contactInit&&window.contactInit(),$(prefixClass+"contact-form").submit((function(e){e.preventDefault(),App.contact.send(this)})),App.extend({cart:{decimal:2,urls:{},currency_position:"right",templates:{item:"<p>{$name} - {$price}</p>"},currency_unit:"Đ",init_list:["urls","templates","decimal","currency_unit","currency_position"],regionID:0,districtID:0,shippingRegionID:0,shippingDistrictID:0,checkPrice:function(data){App.ajax(this.urls.check_price,{method:"post",data:data,dataType:"json"}).then((function(res){if(res.status){var d=res.data;$(prefixClass+"product-detail-info-"+d.product.id).find(prefixClass+"product-price").html(App.cart.currency(d.price))}}))},updateCartData:function(data){App.isObject(data)||(data={});var cart_quantity=0,sub_total=data.sub_total||0,tax=data.tax||0,total_money=data.total_money||0,promo_total=data.promo_total||0,shipping_fee=data.shipping_fee||0,details=data.details&&data.details.length?data.details:[];$(prefixClass+"cart-sub-total-ammount, "+prefixClass+"cart-sub-total-amount").html(this.currency(sub_total)),$(prefixClass+"cart-total-ammount, "+prefixClass+"cart-total-money-ammount, "+prefixClass+"cart-total-amount, "+prefixClass+"cart-total-money-amount").html(this.currency(total_money)),$(prefixClass+"cart-promo-total, "+prefixClass+"cart-promo-total-ammount, "+prefixClass+"cart-promo-total, "+prefixClass+"cart-promo-total-amount, "+prefixClass+"cart-promo-amount, "+prefixClass+"cart-promo-total-amount").html(this.currency(promo_total)),$(prefixClass+"cart-tax-ammount, "+prefixClass+"cart-tax-total-ammount, "+prefixClass+"cart-tax-amount, "+prefixClass+"cart-tax-total-amount").html(this.currency(tax)),$(prefixClass+"cart-shipping-fee, "+prefixClass+"cart-shipping-fee-ammount, "+prefixClass+"cart-shipping-fee, "+prefixClass+"cart-shipping-fee-amount").html(this.currency(shipping_fee));var itemTemplate=this.templates.item,attrTemplate=this.templates.attribute,detailLength=details.length,cartItems="";if(detailLength)for(let i=0;i<detailLength;i++){var item=details[i];item.name||(item.name=item.product_name),item.price=this.currency(item.final_price),cart_quantity+=item.quantity,$(prefixClass+"item-total-price-"+item.id+", #cart-item-"+item.id).find(prefixClass+"item-total-price").html(this.currency(item.quantity*item.final_price));var attributes="",attrLength;if(item.attributes&&App.isArray(item.attributes))if(item.attributes.length)for(let j=0;j<item.attributes.length;j++){var attr=item.attributes[j];attr.value=attr.text_value||attr[attr.value_type+"_value"]||"",attributes+=App.str.eval(attrTemplate,attr)}item.attributes=attributes,item.total_price=this.currency(item.quantity*item.final_price),cartItems+=App.str.eval(itemTemplate,item)}else cartItems="<p>Không có sản phẩm nào</p>";$(prefixClass+"cart-quantity").html(cart_quantity),$(prefixClass+"cart-items").html(cartItems)},checkCartData:function(){App.ajax(this.urls.check_cart_data,{method:"POST",data:{key:App.str.rand()},cookie:!0,dataType:"JSON"}).then((function(result){result.status&&App.cart.updateCartData(result.data)}))},addCartItem:function(data,redirect){if(!data||!data.product_id)return App.popup.alert("Hành động không hợp lệ!");App.ajax(this.urls.add_cart_item,{method:"POST",data:data,dataType:"json"}).then((function(result){result.status?(App.cart.updateCartData(result.data),"checkout"==redirect?top.location.href=App.cart.urls.checkout:App.popup.confirm("Sản phẩm đã được thêm vào giỏ hàng thành công!\nBạn có muốn đến trang thanh toán không?",(function(p){top.location.href=App.cart.urls.view_cart}))):App.popup.alert("Lổi không xác định")}))},removeCartItem:function(id){if(!id)return App.popup.alert("ID giỏ hàng không hợp lệ");App.ajax(this.urls.remove_cart_item,{method:"POST",data:{id:id},dataType:"json"}).then((function(result){result.status?(App.cart.updateCartData(result.data),$("#cart-item-"+id+", "+prefixClass+"cart-item-"+id).hide(300,(function(e){$(this).remove()}))):App.popup.alert("Lỗi không xác định")}))},applyCoupon:function(coupon){if(!coupon)return App.Swal.warning("Vui lòng nhập mã giảm giá");var self=this;App.api.post(this.urls.apply_coupon,{coupon:coupon}).then((function(rs){rs.status?App.cart.updateCartData(rs.data):App.Swal.error(rs.message)})).catch((function(error){App.Swal.error("Lỗi không xác định")}))},checkPriceOfForm:function(form){var data={product_id:$(form).find(prefixClass+"product-order-id").val(),attrs:[],quantity:$(form).find(prefixClass+"product-order-quantity").val()||1},inputs=$(form).find(prefixClass+"product-varients").find('select, input[type="radio"]:checked, input[type="rcheckbox"]:checked');for(let i=0;i<inputs.length;i++){const inp=inputs[i];data.attrs.push($(inp).val())}this.checkPrice(data)},addToCartByForm:function(form){var data={product_id:0,attrs:[],quantity:1},redirect=null,inputs=$(form).serializeArray();for(let i=0;i<inputs.length;i++){const inp=inputs[i];"_token"!=inp.name&&("product_id"==inp.name||"quantity"==inp.name?data[inp.name]=inp.value:"qty"==inp.name?data.quantity=inp.value:"redirect"==inp.name?redirect=inp.value:data.attrs.push(inp.value))}this.addCartItem(data)},updateCartQuantity:function(data){var self=this;App.ajax(this.urls.update_cart_quantity,{method:"post",data:data,dataType:"JSON"}).then((function(result){result.status?self.updateCartData(result.data):App.popup.alert(result.message)})).catch((function(error){App.log(error)}))},updateAllCartItemQuantity:function(){var data={},inputs=$(prefixClass+"item-quantity");if(inputs.length){for(let i=0;i<inputs.length;i++){const inp=inputs[i];var $inp=$(inp),id=$inp.data("item-id"),qty=parseInt($inp.val());!isNaN(qty)&&qty>0&&(data[$inp.attr("name")]=qty)}App.isEmpty(data)||this.updateCartQuantity(data)}},currency:function(total){var c=App.config.currency;return App.number.format(total,c.decimal,c.decimal_poiter,c.thousands_sep,c.currency_type,c.currency_position)},changeRegionID:function(value,text,el){value!=this.regionID&&(this.regionID=value,App.dom.select.deactive("billing_district_id"),App.dom.select.deactive("billing_ward_id"),App.dom.select.changeOptions("billing_district_id",{0:"Chọn một"}),App.dom.select.changeOptions("billing_ward_id",{0:"Chọn một"}),value&&"0"!=value&&App.ajax(this.urls.district_options,{method:"get",data:{region_id:value},dataType:"JSON"}).then((function(res){res.status&&App.dom.select.changeOptions("billing_district_id",res.data)})))},changeDistrictID:function(value,text,el){value!=this.districtID&&(this.districtID=value,App.dom.select.deactive("billing_ward_id"),App.dom.select.changeOptions("billing_ward_id",{0:"Chọn một"}),value&&"0"!=value&&App.ajax(this.urls.ward_options,{method:"get",data:{district_id:value},dataType:"JSON"}).then((function(res){res.status&&App.dom.select.changeOptions("billing_ward_id",res.data)})))},changeShippingRegionID:function(value,text,el){value!=this.shippingRegionID&&(this.shippingRegionID=value,App.dom.select.deactive("shipping_district_id"),App.dom.select.deactive("shipping_ward_id"),App.dom.select.changeOptions("shipping_district_id",{0:"Chọn một"}),App.dom.select.changeOptions("shipping_ward_id",{0:"Chọn một"}),value&&"0"!=value&&App.ajax(this.urls.district_options,{method:"get",data:{region_id:value},dataType:"JSON"}).then((function(res){res.status&&App.dom.select.changeOptions("shipping_district_id",res.data)})))},changeShippingDistrictID:function(value,text,el){value!=this.shippingDistrictID&&(this.shippingDistrictID=value,App.dom.select.deactive("shipping_ward_id"),App.dom.select.changeOptions("shipping_ward_id",{0:"Chọn một"}),value&&"0"!=value&&App.ajax(this.urls.ward_options,{method:"get",data:{district_id:value},dataType:"JSON"}).then((function(res){res.status&&App.dom.select.changeOptions("shipping_ward_id",res.data)})))}}}),"function"==typeof window.orderCartInit||"function"==typeof window.customCartInit){"function"==typeof window.orderCartInit&&window.orderCartInit(),"function"==typeof window.customCartInit&&window.customCartInit(),App.cart.checkCartData();var detailClass,frmSelector=(detailClass=prefixClass+"product-detail")+" "+prefixClass+"product-order-form";$(document).on("submit",frmSelector,(function(e){return e.preventDefault(),App.cart.addToCartByForm(this),!1})),$(document).on("click",prefixClass+"remove-cart-item",(function(e){e.preventDefault();try{App.cart.removeCartItem($(this).data("item-id"))}catch(error){App.log(error)}return!1})),$(document).on("click",prefixClass+"add-to-cart",(function(e){e.preventDefault();try{App.cart.addCartItem({product_id:$(this).data("product-id")},$(this).data("redirect"))}catch(error){App.log(error)}return!1})),$(document).on("click",prefixClass+"btn-update-cart",(function(e){e.preventDefault();try{App.cart.updateAllCartItemQuantity()}catch(error){App.log(error)}return!1})),$(document).on("click",prefixClass+"btn-apply-coupon",(function(e){e.preventDefault();try{var $cupon=$(prefixClass+"coupon-code");$cupon.length&&$cupon.val()?App.cart.applyCoupon($cupon.val()):App.Swal.warning("Bạn chưa nhập mã giảm giá")}catch(error){App.log(error)}return!1})),$(prefixClass+"cart-form").submit((function(e){e.preventDefault();try{App.cart.updateAllCartItemQuantity()}catch(error){App.log(error)}return!1})),$(document).on("change",prefixClass+"product-order-quantity",(function(e){App.cart.updateAllCartItemQuantity()}));var createAccountCheckbox=$(prefixClass+"create-account-checkbox");if(createAccountCheckbox.length){var createAccountGroup=$(prefixClass+"create-account-group"),toggleCreateAccountGroup=function(){createAccountCheckbox.is(":checked")?createAccountGroup.show(300):createAccountGroup.hide(300)};createAccountCheckbox.on("change",(function(e){toggleCreateAccountGroup()})),toggleCreateAccountGroup()}var shiptoDifferentAddressCheckbox=$(prefixClass+"ship-to-different-address");if(shiptoDifferentAddressCheckbox.length){var shiptoDifferentAddressGroup=$(prefixClass+"shipping-address-group"),toggleshiptoDifferentAddressGroup=function(){shiptoDifferentAddressCheckbox.is(":checked")?shiptoDifferentAddressGroup.show(300):shiptoDifferentAddressGroup.hide(300)};shiptoDifferentAddressCheckbox.on("change",(function(e){toggleshiptoDifferentAddressGroup()})),toggleshiptoDifferentAddressGroup()}var paymentMethods=$(prefixClass+"payment-methods");if(paymentMethods.length){var hidePaymentMethodDescription=function(){paymentMethods.find(prefixClass+"payment-method-description").removeClass("show")},showPaymentMethodDescription=function(value){hidePaymentMethodDescription(),paymentMethods.find(prefixClass+"payment-method-description[data-method="+value+"]").addClass("show")},paymentValues;paymentMethods.find(prefixClass+"payment-method-value").map((function(e){$(e).is(":checked")&&showPaymentMethodDescription($(e).val())})),$(document).on("change",prefixClass+"payment-method-value",(function(e){$(this).is(":checked")&&showPaymentMethodDescription($(this).val())}))}}if(App.extend({orders:{urls:{},init_list:["urls"],cancel:function(id,success){App.ajax(this.urls.cancel,{method:"POST",dataType:"json",data:{id:id}}).then((function(result){result.status?(App.popup.alert("Đã hủy đơn hàng "+id+" thành công!"),"function"==typeof success&&success()):App.popup.alert(result.message)})).catch((function(err){App.popup.alert("Lỗi không xác định")}))}}}),"function"==typeof window.orderInit&&("function"==typeof window.orderInit&&window.orderInit(),$(document).on("click",prefixClass+"btn-cancel-order",(function(e){e.preventDefault();var self=this,id=$(this).data("id");return App.popup.confirm("Bạn có chắc chắn muốn hủy đơn hàng "+id+" không?",(function(){App.orders.cancel(id,(function(){$(self).remove()}))})),!1}))),App.extend({subcribes:{urls:{},init_list:["urls"],subcribe:function(email){return App.ajax(this.urls.subcribe,{method:"POST",dataType:"json",data:{email:email}}).then((function(result){if(result.status)return App.popup.alert("Đăng ký theo dõi thành công!"),!0;var message="";if(result.errors){var errors=result.errors,messages=[];for(const key in errors)if(errors.hasOwnProperty(key)){const error=errors[key];messages.push(error)}message=messages.join("<br>")}else message=result.message;App.popup.alert(message)})).catch((function(err){App.popup.alert("Lỗi không xác định")}))}}}),"function"==typeof window.subcribeInit){"function"==typeof window.subcribeInit&&window.subcribeInit();var subcribeForm=$(prefixClass+"subcribe-form");subcribeForm.length&&subcribeForm.submit((function(e){e.preventDefault();var self=this;return App.subcribes.subcribe($(this).find('input[name="email"]').val()).then((function(res){$(self).find('input[name="email"]').val("")})),!1}))}App.extend({visitors:{urls:{},init_list:["urls"],tasks:[],data:{},checkVisitor:function(data){var self=this;App.api.post(this.urls.check,data||this.data).then((function(rs){rs.status&&self.tasks.length&&self.tasks.map((function(fn){"function"==typeof fn&&fn(rs.data)}))}))},addTask:function(fn){return"function"==typeof fn&&(this.tasks.push(fn),!0)}}}),"function"==typeof window.visitorInit&&"function"==typeof window.visitorInit&&(window.visitorInit(),setTimeout((function(){App.visitors.checkVisitor()}),1e3))}))};App.laravel&&App.laravel.cache?App.request.get(App.laravel.urls.token,{data:{key:App.str.rand()},dataType:"json"}).then((function(res){if(res.status){var token=res.data.token;App.request.setHeaders({"X-CSRF-TOKEN":token}),_('meta[name="csrf-token"]').attr("content",token),_('input[name="_token"]').val(token),__delay(),__delay=null}else __delay(),App.popup.warning("Có lỗi trong quá trình tải dữ liệu. Một số tính năng có thể sẽ không hoạt động"),__delay=null})).catch((function(err){__delay(),App.popup.warning("Có lỗi trong quá trình tải dữ liệu. Một số tính năng có thể sẽ không hoạt động"),__delay=null})):(__delay(),__delay=null)}(App.query);