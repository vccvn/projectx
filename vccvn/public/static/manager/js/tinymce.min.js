function addTinymceEditor($content){var tinyEditor,h=500,$content;($content=$("textarea.tiny-mce")).attr("height")&&(h=$content.attr("height"));var options={selector:"textarea.tiny-mce",branding:!1,language:"vi",height:h,plugins:["print preview powerpaste importcss searchreplace autolink autosave save directionality ","visualblocks visualchars fullscreen image link media  template codesample table ","charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists  wordcount  a11ychecker ","imagetools textpattern noneditable help formatpainter charmap mentions emoticons openGallery "],mobile:{plugins:"print preview powerpaste importcss searchreplace autolink autosave save directionality visualblocks visualchars fullscreen image link media  template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists  wordcount  a11ychecker textpattern noneditable help formatpainter charmap mentions emoticons openGallery"},image_advtab:!0,relative_urls:!1,remove_script_host:!1,convert_urls:!0,menubar:!1,contextmenu:"bold italic underline | alignleft aligncenter alignright alignjustify | link",content_css:["//fonts.googleapis.com/css?family=Source+Sans+Pro","/static/plugins/tinymce/style.css","/static/plugins/tinymce/bs4/bootstrap-grid.min.css"],toolbar:"undo redo | formatselect |bold italic underline  formatgroup  | alignleft aligncenter alignright | paragraphgroup | table link image media emoticons insertgroup",toolbar_groups:{formatgroup:{icon:"format",tooltip:"Định dạng",items:" fontselect fontsizeselect | forecolor backcolor | superscript subscript | removeformat"},paragraphgroup:{icon:"paragraph",tooltip:"Định dạng doạn văn",items:"bullist numlist | alignleft aligncenter alignright alignjustify | indent outdent"},insertgroup:{icon:"plus",tooltip:"Chèn",items:"openGallery | charmap hr codesample template | pagebreak nonbreaking anchor insertdatetime advlist "}}};tinymce.init(options);var cmo={value:$content.val(),mode:"text/html",extraKeys:{"Ctrl-Space":"autocomplete"},lineNumbers:!0,styleActiveLine:!0,matchBrackets:!0,matchTags:{bothTags:!0},extraKeys:{"Ctrl-J":"toMatchingTag"},lineWrapping:!0,extraKeys:{"Ctrl-Q":function(cm){cm.foldCode(cm.getCursor())}},foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"]},myCodeMirror=null,currentTab="editor_tab";$('.tiny-mce-wrapper a[data-toggle="tab"]').on("shown.bs.tab",(function(e){var $this,tab=$(e.target).attr("href").substr(1);if(currentTab!=tab)if(currentTab=tab,"code_tab"==tab){var content=tinymce.activeEditor.getContent();myCodeMirror?myCodeMirror.setValue(content):(cmo.value=content,(myCodeMirror=CodeMirror(document.getElementById("code_tab"),cmo)).setSize(null,parseInt(h)),myCodeMirror.on("change",(function(){if("code_tab"==currentTab){var cnt=myCodeMirror.getValue();$content.val(cnt),tinymce.activeEditor.setContent(cnt)}})))}else myCodeMirror&&tinymce.activeEditor.setContent(myCodeMirror.getValue())})),$("#"+$content.attr("id")+"-tabs .btn-insert-gallery").on("click",(function(){if("code_tab"==currentTab){var doc=myCodeMirror.getDoc(),cursor=doc.getCursor();App.library.open({mode:"many",type:"image",done:function(images){for(var content="",index=0;index<images.length;index++){var img=images[index];content+='<img src="'+img.url+'" alt="'+(img.title||img.originnal_filename)+'">'}doc.replaceRange(content,cursor)}})}else{var $editor=tinymce.activeEditor;App.library.open({mode:"many",type:"image",done:function(images){for(var content="",index=0;index<images.length;index++){var img=images[index];content+='<img src="'+img.url+'" alt="'+(img.title||img.originnal_filename)+'">'}$editor.insertHtml(content)}})}}))}if($("textarea.tiny-mce").length){var $content=$("textarea.tiny-mce");for(let index=0;index<$content.length;index++){const element=$content[index];addTinymceEditor($(element))}}